var iFileName = "pub_20240917_PHB.js";
RequiredSheetVersion("13.2.1");
SourceList.PHB2024 = {
  name: "2024 Player's Handbook",
  abbreviation: "PHB2024",
  abbreviationSpellsheet: "PHB",
  group: "Core Sources",
  url: "https://marketplace.dndbeyond.com/core-rules/3709000?pid=DB3709000",
  date: "2024/09/17",
};
SourceList.LEGACY = {
  name: "Spells Deprecated by 2024 Player's Handbook",
  abbreviation: "LEGACY",
  abbreviationSpellsheet: "L",
  group: "Core Sources",
  url: "https://marketplace.dndbeyond.com/core-rules/3709000?pid=DB3709000",
  date: "2024/09/17",
};
// Coded By : ThePokésimmer with contributions from MasterJedi2014, Shroo, TrackAtNite

//Functions
function legacySpellRefactor(spellKey, newSpell) {
  if (newSpell.replaces && newSpell.replaces in SpellsList) {
    SpellsList[spellKey] = SpellsList[newSpell.replaces];
    delete SpellsList[newSpell.replaces];
  }
  if (!(spellKey in SpellsList)) {
    SpellsList[spellKey] = newSpell;
  } else {
    var oldspell = SpellsList[spellKey]
    SpellsList[spellKey] = newSpell;
    var test = newSpell.replaces || spellKey;
    for (var i in ClassSubList) {
      var subclass = ClassSubList[i]
      if ("spellcastingExtra" in subclass) {
        var index = subclass.spellcastingExtra.indexOf(test);
        if (index !== -1) {
          if (test !== spellKey) {
            subclass.spellcastingExtra[index] = spellKey
          }
          if (!('subclassfeature24' in subclass.features)) {
            subclass.features['subclassfeature24'] = {
              name: "Legacy spells",
              source: [["LEGACY", 1]],
              minlevel: 1,
              description: "\n I can choose to access to the legacy version of spells",
              choices: ["Show Legacy", "Hide Legacy"],
              "show legacy": {
                name: "Show legacy spells",
                description: "\n   I have access to the legacy version of spells",
                spellcastingExtra: []
              },
              "hide legacy": {
                name: "Hide legacy spells",
                description: "\n   I have hidden the legacy version of spells",
                spellcastingExtra: []
              },
              legacySpells: [],
            }
          }
          subclass.features['subclassfeature24'].legacySpells.push(test + " legacy");
          subclass.features['subclassfeature24']["show legacy"].spellcastingExtra = subclass.spellcastingExtra.concat(subclass.features['subclassfeature24'].legacySpells);
          subclass.features['subclassfeature24']["hide legacy"].spellcastingExtra = subclass.spellcastingExtra
        }
      }
    }
    oldspell.source = [["LEGACY", 1]];
    oldspell.name = oldspell.name + " (Legacy)";
    if ('nameShort' in oldspell) {
      oldspell.nameShort = oldspell.nameShort + " (L)"
    }
    SpellsList[test + " legacy"] = oldspell;
  }
}

function legacyClassRefactor(classKey, newClass) {
  if (!(classKey in ClassList)) {
    ClassList[classKey] = newClass;
  } else {
    newClass.subclasses = ClassList[classKey].subclasses;
    ClassList[classKey] = newClass;
  }
}

function archiveSubClass(classKey, replacementSubclass, subClass) {
  subClass.subname = subClass.subname + " - 2014"
  if ('fullname' in subClass) {
    subClass.fullname = subClass.fullname + " - 2014"
  }
  for (var i of ClassList[classKey].subclasses[1]) {
    if (ClassSubList[i].regExpSearch.test(replacementSubclass)) {
      var oldRegex = "(?=^.*" + subClass.regExpSearch.source + ".*$)"
      var newRegex = "(?!^" + replacementSubclass + "$)"
      ClassSubList[i].regExpSearch = new RegExp(oldRegex + newRegex, 'i')
      console.println(replacementSubclass + ": " + i)
      console.println(ClassSubList[i].regExpSearch)
    }
  }
  subClass.source = [["LEGACY", 1]];
}

function legacySubClassRefactor(classKey, subClassKey, newSubClass) {
  var newSubClassName = classKey + "-" + subClassKey
  if (newSubClassName in ClassSubList) {
    var oldSubClass = ClassSubList[newSubClassName]

    archiveSubClass(classKey, newSubClass.subname, oldSubClass)
    ClassSubList[newSubClassName] = newSubClass
    AddSubClass(classKey, subClassKey + "_2014", oldSubClass)
  } else {
    if ('replaces' in newSubClass) {
      const subclassName = classKey + '-' + newSubClass.replaces
      if (subclassName in ClassSubList) {
        archiveSubClass(classKey, newSubClass.subname, ClassSubList[subclassName])
      }
    }
    AddSubClass(classKey, subClassKey, newSubClass)
  }
}

//Classes
legacyClassRefactor("barbarian", {
  regExpSearch: /barbarian/i,
  name: "Barbarian",
  source: [["PHB2024", 51]],
  primaryAbility: ["Strength"],
  abilitySave: 1,
  prereqs: "Strength 13",
  improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
  die: 12,
  saves: ["Str", "Con"],
  skillstxt: {
    primary: "Choose 2: Animal Handling, Athletics, Intimidation, Nature, Perception, or Survival",
  },
  armorProfs: {
    primary: [true, true, false, true],
    secondary: [false, false, false, true],
  },
  weaponProfs: {
    primary: [true, true],
    secondary: [false, true],
  },
  equipment: "Barbarian starting equipment:" +
    "\n \u2022 A Greataxe;" +
    "\n \u2022 4 Handaxes;" +
    "\n \u2022 An Explorer's Pack, and 15 gp." +
    "\n\nAlternatively, choose 75 gp worth of starting equipment instead of the class's starting equipment.",
  subclasses: ["Barbarian Subclass", []],
  attacks: [1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
  features: {
    "rage": {
      name: "Rage",
      source: [["PHB2024", 51]],
      minlevel: 1,
      action: ["bonus action", "Enter Rage"],
      usages: [2, 2, 3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 6, 6, 6, 6],
      recovery: "long rest",
      additional: ["2 Uses, +2 Damage", "2 Uses, +2 Damage", "3 Uses, +2 Damage", "3 Uses, +2 Damage", "3 Uses, +2 Damage", "4 Uses, +2 Damage", "4 Uses, +2 Damage", "4 Uses, +2 Damage", "4 Uses, +3 Damage", "4 Uses, +3 Damage", "4 Uses, +3 Damage", "5 Uses, +3 Damage", "5 Uses, +3 Damage", "5 Uses, +3 Damage", "5 Uses, +3 Damage", "5 Uses, +4 Damage", "6 Uses, +4 Damage", "6 Uses, +4 Damage", "6 Uses, +4 Damage", "6 Uses, +4 Damage"],
      dmgres: [["Bludgeoning", "Bludgeon. (in rage)"], ["Piercing", "Piercing (in rage)"], ["Slashing", "Slashing (in rage)"]],
      savetxt: {adv_vs: ["Str checks and saves in rage; "]},
      calcChanges: {
        atkCalc: [
          function (fields, v, output) {
            if (v.isMeleeWeapon && fields.Mod === 1 && classes.known.barbarian && classes.known.barbarian.level && /\brage\b/i.test(v.WeaponTextName)) {
              output.extraDmg += classes.known.barbarian.level < 9 ? 2 : classes.known.barbarian.level < 16 ? 3 : 4;
            }
          },
          "If I include the word 'Rage' in a melee weapon's name that uses Strength, the calculation will add my Rage's bonus damage to it. Be aware that if the weapon is used to make a ranged attack, the rage bonus damage shouldn't be added (e.g. when using a thrown weapon)."
        ]
      },
      description: desc([
        "You can imbue yourself with a primal power called Rage, a force that grants you extraordinary might and resilience. You can enter it as a Bonus Action if you aren't wearing Heavy armor.",
        "You can enter your Rage the number of times shown for your Barbarian level in the Rages column of the Barbarian Features table. You regain one expended use when you finish a Short Rest, and you regain all expended uses when you finish a Long Rest.",
        "While active, your Rage follows the rules below.",
        "Damage Resistance : You have Resistance to Bludgeoning, Piercing, and Slashing Damage.",
        "Rage Damage : When you make an attack using Strength – with either a weapon or an Unarmed Strike - and deal damage to the target, you gain a bonus to the damage that increases as you gain levels as a Barbarian, as shown in the Rage Damage column of the Barbarian Features table.",
        "Strength Advantage : You have Advantage on Strength checks and Strength saving throws.",
        "No Concentration or Spells : You can't maintain Concentration, and you can't cast spells.",
        "Duration : The Rage lasts until the end of your next turn, and it ends early if you don Heavy armor or have the Incapacitated condition. If your Rage is still active on your next turn, you can extend the Rage for another round by doing one of the following:",
        "* Make an attack roll against an enemy.",
        "*Force an enemy to make a saving throw.",
        "*Take a Bonus Action to extend your Rage.",
        "Each time the Range is extended, it lasts until the end of your next turn. You can maintain a Rage for up to 10 minutes.",
      ]),
    },
    "unarmored defense": {
      name: "Unarmored Defense",
      source: [["PHB2024", 51]],
      minlevel: 1,
      description: desc([
        "While you aren't wearing any armor, your base Armor Class equals 10 plus your Dexterity and Constitution modifiers. You can use a Shield and still gain this benefit.",
      ]),
      armorOptions: [{
        regExpSearch: /justToAddToDropDownAndEffectWildShape/,
        name: "Unarmored Defense (Con)",
        source: [["PHB2024", 51]],
        ac: "10+Con",
        affectsWildShape: true,
        selectNow: true
      }],
    },
    "weapon mastery": {
      name: "Weapon Mastery",
      source: [["PHB2024", 52]],
      minlevel: 1,
      description: desc([
        "Your training with weapons allows you to use the mastery properties of two kinds of Simple or Martial Melee weapons of your choice, such as Greataxes and Handaxes. Whenever you finish a Long Rest, you can practice weapon drills and change one of those weapon choices.",
        "When you reach certain Barbarian levels, you gain the ability to use the mastery properties of more kinds of weapons, as shown in the Weapon Mastery column of the Barbarian Features table.",
      ]),
      additional: ["2 Weapon Masteries", "2 Weapon Masteries", "2 Weapon Masteries", "3 Weapon Masteries", "3 Weapon Masteries", "3 Weapon Masteries", "3 Weapon Masteries", "3 Weapon Masteries", "3 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries"],
      extraname: "Weapon Mastery",
      extrachoices: ["Club", "Dagger", "Greatclub", "Handaxe", "Javelin", "Light Hammer", "Mace", "Quarterstaff", "Sickle", "Spear", "Battleaxe", "Flail", "Glaive", "Greataxe", "Greatsword", "Halberd", "Lance", "Longsword", "Maul", "Morningstar", "Pike", "Rapier", "Scimitar", "Shortsword", "Trident", "Warhammer", "War Pick", "Whip"],
      extraTimes: [2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
      "club": {
        name: "Club",
        description: desc([
          "You gain access to the Club's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "dagger": {
        name: "Dagger",
        description: desc([
          "You gain access to the Dagger's 'Nick' Mastery feature",
          "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
        ]),
      },
      "greatclub": {
        name: "Greatclub",
        description: desc([
          "You gain access to the Greatclub's 'Push' Mastery feature",
          "Push : If you hit a creature with this weapon, you can push the creature up to 10 feet straight away from yourself if it is Large or smaller.",
        ]),
      },
      "handaxe": {
        name: "Handaxe",
        description: desc([
          "You gain access to the Handaxe's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "javelin": {
        name: "Javelin",
        description: desc([
          "You gain access to the Javelin's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "light hammer": {
        name: "Light Hammer",
        description: desc([
          "You gain access to the Light Hammer's 'Nick' Mastery feature",
          "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
        ]),
      },
      "mace": {
        name: "Mace",
        description: desc([
          "You gain access to the Mace's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "quarterstaff": {
        name: "Quarterstaff",
        description: desc([
          "You gain access to the Quarterstaff's 'Topple' Mastery feature",
          "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        ]),
      },
      "sickle": {
        name: "Sickle",
        description: desc([
          "You gain access to the Sickle's 'Nick' Mastery feature",
          "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
        ]),
      },
      "spear": {
        name: "Spear",
        description: desc([
          "You gain access to the Spear's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "battleaxe": {
        name: "Battleaxe",
        description: desc([
          "You gain access to the Battleaxe's 'Topple' Mastery feature",
          "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        ]),
      },
      "flail": {
        name: "Flail",
        description: desc([
          "You gain access to the Flail's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "glaive": {
        name: "Glaive",
        description: desc([
          "You gain access to the Glaive's 'Graze' Mastery feature",
          "Graze : If your attack roll with this weapon misses a creature, you can deal damage to that creature equal to the ability modifier you used to make the attack roll. This damage is the same type dealt by the weapon, and the damage can be increased only by increasing the ability modifier.",
        ]),
      },
      "greataxe": {
        name: "Greataxe",
        description: desc([
          "You gain access to the Greataxe's 'Cleave' Mastery feature",
          "Cleave : If you hit a creature with a melee attack roll using this weapon, you can make a melee attack roll with the weapon against a second creature within 5 feet of the first that is also within your reach. On a hit the second creature takes the weapon's damage, but don't add your ability modifier to that damage unless the modifier is negative. You can make this extra attack only once per turn.",
        ]),
      },
      "greatsword": {
        name: "Greatsword",
        description: desc([
          "You gain access to the Greatsword's 'Graze' Mastery feature",
          "Graze : If your attack roll with this weapon misses a creature, you can deal damage to that creature equal to the ability modifier you used to make the attack roll. This damage is the same type dealt by the weapon, and the damage can be increased only by increasing the ability modifier.",
        ]),
      },
      "halberd": {
        name: "Halberd",
        description: desc([
          "You gain access to the Halberd's 'Cleave' Mastery feature",
          "Cleave : If you hit a creature with a melee attack roll using this weapon, you can make a melee attack roll with the weapon against a second creature within 5 feet of the first that is also within your reach. On a hit the second creature takes the weapon's damage, but don't add your ability modifier to that damage unless the modifier is negative. You can make this extra attack only once per turn.",
        ]),
      },
      "lance": {
        name: "Lance",
        description: desc([
          "You gain access to the Lance's 'Topple' Mastery feature",
          "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        ]),
      },
      "longsword": {
        name: "Longsword",
        description: desc([
          "You gain access to the Longsword's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "maul": {
        name: "Maul",
        description: desc([
          "You gain access to the Maul's 'Topple' Mastery feature",
          "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        ]),
      },
      "morningstar": {
        name: "Morningstar",
        description: desc([
          "You gain access to the Morningstar's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "pike": {
        name: "Pike",
        description: desc([
          "You gain access to the Pike's 'Push' Mastery feature",
          "Push : If you hit a creature with this weapon, you can push the creature up to 10 feet straight away from yourself if it is Large or smaller.",
        ]),
      },
      "rapier": {
        name: "Rapier",
        description: desc([
          "You gain access to the Rapier's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "scimitar": {
        name: "Scimitar",
        description: desc([
          "You gain access to the Scimitar's 'Nick' Mastery feature",
          "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
        ]),
      },
      "shortsword": {
        name: "Shortsword",
        description: desc([
          "You gain access to the Shortsword's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "trident": {
        name: "Trident",
        description: desc([
          "You gain access to the Trident's 'Topple' Mastery feature",
          "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        ]),
      },
      "warhammer": {
        name: "Warhammer",
        description: desc([
          "You gain access to the Warhammer's 'Push' Mastery feature",
          "Push : If you hit a creature with this weapon, you can push the creature up to 10 feet straight away from yourself if it is Large or smaller.",
        ]),
      },
      "war pick": {
        name: "War Pick",
        description: desc([
          "You gain access to the War Pick's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "whip": {
        name: "Whip",
        description: desc([
          "You gain access to the Whip's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
    },
    "danger sense": {
      name: "Danger Sense",
      source: [["PHB2024", 52]],
      minlevel: 2,
      savetxt: {adv_vs: ["Dex saves, when not Incapacitated; "]},
      description: desc([
        "You gain an uncanny sense of when things aren't as they should be, giving you an edge when you dodge perils. You have Advantage on Dexterity saving throws unless you have the Incapacitated condition.",
      ]),
    },
    "reckless attack": {
      name: "Reckless Attack",
      source: [["PHB2024", 52]],
      minlevel: 2,
      description: desc([
        "You can throw aside all concern for defense to attack with increased ferocity. When you make your first attack roll on your turn, you can decide to attack recklessly. Doing so gives you Advantage on attack rolls using Strength until the start of your next turn, but attack rolls against you have Advantage during that time.",
      ]),
    },
    "subclassfeature3": {
      name: "Barbarian Subclass",
      source: [["PHB2024", 52]],
      minlevel: 3,
      description: desc([
        "You gain a Barbarian subclass of your choice. The Path of the Berserker, Path of the Wild Heart, Path of the World Tree, and Path of the Zealot subclasses are detailed after this class's description. A subclass is a specialization that grants you features at certain Barbarian levels. For the rest of your career, you gain each of your subclass's features that are of your Barbarian level or lower.",
      ]),
    },
    "primal knowledge": {
      name: "Primal Knowledge",
      source: [["PHB2024", 52]],
      minlevel: 3,
      description: desc([
        "You gain proficiency in another skill of your choice from the skills list available to Barbarians at level 1.",
        "In addition, while your Rage is active, you can channel primal power when you attempt certain tasks, whenever you make an ability check using one of the following skills, you can make it as a Strength check even if it normally uses a different ability; Acrobatics, Intimidation, Perception, Stealth, or Survival. When you use this ability, your Strength represents primal power coursing through you, honing your ability, bearing, and senses.",
      ]),
      choices: ["Primal Knowledge : Animal Handling", "Primal Knowledge : Athletics", "Primal Knowledge : Intimidation", "Primal Knowledge : Nature", "Primal Knowledge : Perception", "Primal Knowledge : Survival"],
      "primal knowledge : animal handling": {
        name: "Primal Knowledge : Animal Handling",
        skills: ["Animal Handling"],
        description: desc([
          "You gain proficiency in Animal Handling",
          "In addition, while your Rage is active, you can channel primal power when you attempt certain tasks, whenever you make an ability check using one of the following skills, you can make it as a Strength check even if it normally uses a different ability; Acrobatics, Intimidation, Perception, Stealth, or Survival. When you use this ability, your Strength represents primal power coursing through you, honing your ability, bearing, and senses.",
        ]),
      },
      "primal knowledge : athletics": {
        name: "Primal Knowledge : Athletics",
        skills: ["Athletics"],
        description: desc([
          "You gain proficiency in Athletics",
          "In addition, while your Rage is active, you can channel primal power when you attempt certain tasks, whenever you make an ability check using one of the following skills, you can make it as a Strength check even if it normally uses a different ability; Acrobatics, Intimidation, Perception, Stealth, or Survival. When you use this ability, your Strength represents primal power coursing through you, honing your ability, bearing, and senses.",
        ]),
      },
      "primal knowledge : intimidation": {
        name: "Primal Knowledge : Intimidation",
        skills: ["Intimidation"],
        description: desc([
          "You gain proficiency in Intimidation",
          "In addition, while your Rage is active, you can channel primal power when you attempt certain tasks, whenever you make an ability check using one of the following skills, you can make it as a Strength check even if it normally uses a different ability; Acrobatics, Intimidation, Perception, Stealth, or Survival. When you use this ability, your Strength represents primal power coursing through you, honing your ability, bearing, and senses.",
        ]),
      },
      "primal knowledge : nature": {
        name: "Primal Knowledge : Nature",
        skills: ["Nature"],
        description: desc([
          "You gain proficiency in Nature",
          "In addition, while your Rage is active, you can channel primal power when you attempt certain tasks, whenever you make an ability check using one of the following skills, you can make it as a Strength check even if it normally uses a different ability; Acrobatics, Intimidation, Perception, Stealth, or Survival. When you use this ability, your Strength represents primal power coursing through you, honing your ability, bearing, and senses.",
        ]),
      },
      "primal knowledge : perception": {
        name: "Primal Knowledge : Perception",
        skills: ["Perception"],
        description: desc([
          "You gain proficiency in Perception",
          "In addition, while your Rage is active, you can channel primal power when you attempt certain tasks, whenever you make an ability check using one of the following skills, you can make it as a Strength check even if it normally uses a different ability; Acrobatics, Intimidation, Perception, Stealth, or Survival. When you use this ability, your Strength represents primal power coursing through you, honing your ability, bearing, and senses.",
        ]),
      },
      "primal knowledge : survival": {
        name: "Primal Knowledge : Survival",
        skills: ["Survival"],
        description: desc([
          "You gain proficiency in Survival",
          "In addition, while your Rage is active, you can channel primal power when you attempt certain tasks, whenever you make an ability check using one of the following skills, you can make it as a Strength check even if it normally uses a different ability; Acrobatics, Intimidation, Perception, Stealth, or Survival. When you use this ability, your Strength represents primal power coursing through you, honing your ability, bearing, and senses.",
        ]),
      },
    },
    "extra attack": {
      name: "Extra Attack",
      source: [["PHB2024", 53]],
      minlevel: 5,
      description: desc([
        "You can attack twice instead of once whenever you take the Attack Action on your Turn.",
      ]),
    },
    "fast movement": {
      name: "Fast Movement",
      source: [["PHB2024", 53]],
      minlevel: 5,
      speed: {allModes: "+10"},
      description: desc([
        "Your speed increases by 10 feet while you aren't wearing Heavy armor.",
      ]),
    },
    "feral instinct": {
      name: "Feral Instinct",
      source: [["PHB2024", 53]],
      minlevel: 7,
      description: desc([
        "Your instincts are so honed that you have Advantage on Initiative rolls.",
      ]),
    },
    "instinctive pounce": {
      name: "Instinctive Pounce",
      source: [["PHB2024", 53]],
      minlevel: 7,
      description: desc([
        "As part of the Bonus Action you take to enter your Rage, you can move up to half your Speed.",
      ]),
    },
    "brutal strike": {
      name: "Brutal Strike",
      source: [["PHB2024", 53]],
      minlevel: 9,
      description: desc([
        "If you use Reckless Attack, you can forego any Advantage on one Strength-based attack roll of your choice on your turn. The chosen attack roll mustn't have Disadvantage. If the chosen attack roll hits, the target takes an extra 1d10 damage of the same type dealt by the weapon or Unarmed Strike, and you can cause one Brutal Strike effect of your choice.",
        "You have the following effect options.",
        "Forceful Blow : The target is pushed 15 feet straight away from you. You can then move up to half your speed strait towards the target without provoking Opportunity Attacks.",
        "Hamstring Blow : The target's Speed is reduced by 15 feet until the start of your next turn. A target can be affected by only one Hamstring Blow at a time – the most recent one.",
      ]),
    },
    "relentless rage": {
      name: "Relentless Rage",
      source: [["PHB2024", 53]],
      minlevel: 9,
      description: desc([
        "Your Rage can keep you fighting despite grievous wounds. If you drop to 0 Hit Points while your Rage is active and don't die outright, you can make a DC 10 Constitution saving throw. If you succeed, your Hit Points instead change to a number equal to half your Barbarian level",
        "Each time you use this feature after the first, the DC increases by 5. When you finish a Short or Long Rest, the DC resets to 10.",
      ]),
    },
    "improved brutal strike": {
      name: "Improved Brutal Strike",
      source: [["PHB2024", 53]],
      minlevel: 13,
      description: desc([
        "You have honed new ways to attack furiously.",
        "The following effects are now among your Brutal Strike options.",
        "Staggering Blow : The target has Disadvantage on the next saving throw it makes, and it can't make Opportunity Attacks until the start of your next turn.",
        "Sundering Blow : Before the start of your next turn, the next attack roll made by another creature against the target gains a +5 bonus to the roll. An attack roll can gain only one Sundering Blow bonus.",
      ]),
    },
    "persistent rage": {
      name: "Persistent Rage",
      source: [["PHB2024", 53]],
      minlevel: 15,
      description: desc([
        "When you roll Initiative, you can regain all expended uses of Rage. After you regain uses of Rage in this way, you can't do so again until you finish a Long Rest.",
        "In addition, your rage is so fierce that it now lasts for 10 minutes without you needing to do anything to extend it from round to round. Your Rage ends early if you have the Unconscious condition (not just the Incapacitated condition) or don Heavy armor.",
      ]),
    },
    "improved brutal strike2": {
      name: "Improved Brutal Strike",
      source: [["PHB2024", 53]],
      minlevel: 17,
      description: desc([
        "The extra damage f your Brutal Strike increases to 2d10. In addition, you can use two different Brutal Strike effects whenever you use your Brutal Strike feature.",
      ]),
    },
    "indomitable might": {
      name: "Indomitable Might",
      source: [["PHB2024", 53]],
      minlevel: 18,
      description: desc([
        "If your total for a Strength check or Strength saving throw is less than your Strength score, you can use that score in place of the total.",
      ]),
    },
    "epic boon": {
      name: "Epic Boon",
      source: [["PHB2024", 53]],
      minlevel: 19,
      description: desc([
        "You gain an Epic Boon feat (see chapter 5) or another feat of your choice for which you qualify. Boon of Irresistible Offense is recommended.",
      ]),
    },
    "primal champion": {
      name: "Primal Champion",
      source: [["PHB2024", 53]],
      minlevel: 20,
      scores: [4, 0, 4, 0, 0, 0],
      scoresMaximum: [25, 0, 25, 0, 0, 0],
      description: desc([
        "You embody primal power. Your Strength and Constitution scores increase by 4, to a maximum of 25.",
      ]),
    },
  },
});
legacySubClassRefactor("barbarian", "berserker", {
  regExpSearch: /^(?=.*(barbarian))(?=.*(berserker)).*$/i,
  subname: "Path of the Berserker",
  source: [["PHB2024", 54]],
  features: {
    "subclassfeature3": {
      name: "Frenzy",
      source: [["PHB2024", 54]],
      minlevel: 3,
      additional: ["2d6", "2d6", "2d6", "2d6", "2d6", "2d6", "2d6", "2d6", "3d6", "3d6", "3d6", "3d6", "3d6", "3d6", "3d6", "4d6", "4d6", "4d6", "4d6", "4d6"],
      description: desc([
        "If you use Reckless Attack while your Rage is active, you deal extra damage to the first target you hit on your turn with a Strength based attack. To determine the extra damage, roll a number of d6s equal to your Rage Damage bonus, and add them together. The damage has the same type as the weapon or Unarmed Strike used for the attack.",
      ]),
    },
    "subclassfeature6": {
      name: "Mindless Rage",
      source: [["PHB2024", 54]],
      minlevel: 6,
      savetxt: {immune: ["Charmed while Raging; ", "Frightened while Raging; "]},
      description: desc([
        "You have Immunity to the Charmed and Frightened conditions while your Rage is active. If you're Charmed or Frightened when you enter your Rage the condition ends on you.",
      ]),
    },
    "subclassfeature10": {
      name: "Retaliation",
      source: [["PHB2024", 54]],
      minlevel: 10,
      action: ["reaction", "Retaliation"],
      description: desc([
        "When you take damage from a creature that is within 5 feet of you, you can take a Reaction to make one melee attack against that creature, using a weapon or an Unarmed Strike.",
      ]),
    },
    "subclassfeature14": {
      name: "Intimidating Presence",
      source: [["PHB2024", 54]],
      minlevel: 14,
      action: "action",
      usages: 1,
      recovery: "long rest",
      description: desc([
        "As a Bonus Action, you can strike terror into others with your menacing presence and primal power. When you do so each creature of your choice in a 30-foot Emanation originating from you must make a Wisdom saving throw (DC 8 plus your Strength modifier and Proficiency Bonus). On a failed save, a creature has the Frightened condition for 1 minute. At the end of each of the Frightened creature's turns, the creature repeats the save, ending the effect on itself on a success.",
        "Once you use this feature you can't use it again until you finish a Long Rest unless you expend a use of your Rage (no action required) to restore your use of it.",
      ]),
    },
  },
});
legacySubClassRefactor("barbarian", "wild heart", {
  regExpSearch: /^(?=.*(barbarian))(?=.*(wild))(?=.*(heart)).*$/i,
  subname: "Path of the Wild Heart",
  source: [["PHB2024", 55]],
  features: {
    "subclassfeature3": {
      name: "Animal Speaker",
      source: [["PHB2024", 55]],
      minlevel: 3,
      spellcastingAbility: 5,
      spellcastingBonus: [{
        name: "Animal Speaker",
        spells: ["beast sense", "speak with animals"],
        selection: ["beast sense", "speak with animals"],
        times: 2,
        firstCol: "R",
      }],
      description: desc([
        "You can cast the Beast Sense and Speak with Animals spells but only as Rituals. Wisdom is your spellcasting ability for them.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Rage of the Wilds",
      source: [["PHB2024", 55]],
      minlevel: 3,
      description: desc([
        "Your Rage taps into the primal power of animals. Whenever you activate your Rage, you gain one of the following options of your choice.",
        "Bear : While your Rage is active you have Resistance to every damage type except Force, Necrotic, Psychic, and Radiant.",
        "Eagle : When you activate your Rage, you can take the Disengage and Dash action as part of that Bonus Action. While your Rage is active, you can take a Bonus Action to take both of those actions.",
        "Wolf : While your Rage is active, your allies have Advantage on attack rolls against any enemy of yours within 5 feet of you.",
      ]),
    },
    "subclassfeature6": {
      name: "Aspect of the Wilds",
      source: [["PHB2024", 55]],
      minlevel: 6,
      choices: ["Owl", "Panther", "Salmon"],
      "owl": {
        name: "Owl",
        vision: [["Darkvision", "fixed 60"], ["Darkvision", "+60"]],
        description: desc([
          "You have Darkvision with a range of 60 feet. If you already have Darkvision, its range increases by 60 feet.",
        ]),
      },
      "panther": {
        name: "Panther",
        speed: {climb: {spd: "walk", enc: "walk"}},
        description: desc([
          "You have a Climb Speed equal to your Speed",
        ]),
      },
      "salmon": {
        name: "Salmon",
        speed: {swim: {spd: "walk", enc: "walk"}},
        description: desc([
          "You have a Swim Speed equal to your Speed",
        ])
      },
      description: desc([
        "You gain one of the following options of your choice. Whenever you finish a Long Rest, you can change your choice.",
      ]),
    },
    "subclassfeature10": {
      name: "Nature Speaker",
      source: [["PHB2024", 55]],
      minlevel: 10,
      spellcastingBonus: [{
        name: "Nature Speaker",
        spells: ["commune with nature"],
        selection: ["commune with nature"],
        times: 1,
        firstCol: "R",
      }],
      description: desc([
        "You can cast the Commune with Nature spell but only as a Ritual. Wisdom is your spellcasting ability for it.",
      ]),
    },
    "subclassfeature14": {
      name: "Power of the Wilds",
      source: [["PHB2024", 55]],
      minlevel: 14,
      description: desc([
        "Whenever you activate your Rage, you gain one of the following options of your choice.",
        "Falcon : While your Rage is active, you have a Fly Speed equal to your Speed if you aren't wearing any armor.",
        "Lion : While your Rage is active, any of your enemies within 5 feet of you have Disadvantage on attack rolls against targets other than you or another Barbarian who has this option active.",
        "Ram : While your Rage is active, you can cause a Large or smaller creature to have the Prone condition when you hit it with a melee attack.",
      ]),
    },
  },
});
legacySubClassRefactor("barbarian", "world tree", {
  regExpSearch: /^(?=.*(barbarian))(?=.*(world))(?=.*(tree)).*$/i,
  subname: "Path of the World Tree",
  source: [["PHB2024", 56]],
  features: {
    "subclassfeature3": {
      name: "Vitality of the Tree",
      source: [["PHB2024", 56]],
      minlevel: 3,
      additional: ["2d6", "2d6", "2d6", "2d6", "2d6", "2d6", "2d6", "2d6", "3d6", "3d6", "3d6", "3d6", "3d6", "3d6", "3d6", "4d6", "4d6", "4d6", "4d6", "4d6"],
      description: desc([
        "Your Rage taps into the life force of the World Tree. You gain the following benefits.",
        "Vitality Surge : When you activate your Rage, you gain a number of Temporary Hit Points equal to your Barbarian level",
        "Life-Giving Force : At the start of each of your turns while your Rage is active, you can choose another creature within 10 feet of yourself to gain Temporary Hit Points. To determine the number of Temporary Hit Points, roll a number of d6s equal to your Rage Damage bonus, and add them together. If any of these Temporary Hit Points remain when your Rage ends, they vanish.",
      ]),
    },
    "subclassfeature6": {
      name: "Branches of the Tree",
      source: [["PHB2024", 54]],
      minlevel: 6,
      action: "reaction",
      description: desc([
        "Whenever a creature you can see starts its turn within 30 feet of you while your Rage is active, you can take a Reaction to summon spectral branches of the World Tree around it. The target must succeed on a Strength saving throw (DC 8 plus your Strength modifier and Proficiency Bonus) or be teleported to an unoccupied space you can see within 5 feet of yourself or in the nearest unoccupied space you can see. After the target teleports, you can reduce its Speed to 0 until the end of the current turn.",
      ]),
    },
    "subclassfeature10": {
      name: "Battering Roots",
      source: [["PHB2024", 56]],
      minlevel: 10,
      action: ["reaction", "Retaliation"],
      description: desc([
        "During your turn, your reach is 10 feet greater with any Melee weapon that has the Heavy or Versatile properties, as tendrils of the World Tree extend from you. When you hit with such a weapon on your turn, you can activate the Push or Topple mastery properties in addition to a different mastery property you're using with that weapon.",
      ]),
    },
    "subclassfeature14": {
      name: "Travel Along the Tree",
      source: [["PHB2024", 56]],
      minlevel: 14,
      action: "bonus action",
      description: desc([
        "When you activate your Rage and as a Bonus Action while your Rage is active, you can teleport up to 60 feet to an unoccupied space you can see.",
        "In addition, once per Rage, you can increase the range of that teleport to 150 feet. When you do so you can also bring up to six willing creatures who are within 10 feet of you. Each creature teleports to an unoccupied space of you choice within 10 feet of your destination space.",
      ]),
    },
  },
});
legacySubClassRefactor("barbarian", "zealot", {
  regExpSearch: /^(?=.*(barbarian))(?=.*(zealot)).*$/i,
  subname: "Path of the Zealot",
  source: [["PHB2024", 57]],
  features: {
    "subclassfeature3": {
      name: "Divine Fury",
      source: [["PHB2024", 57]],
      minlevel: 3,
      description: desc([
        "You can channel divine power into your strikes. On each of your turns while your Rage is active. the first creature you hit with a weapon or an Unarmed Strike takes damage equal to 1d6 plus half your Barbarian level (rounded down). The extra damage is Necrotic or Radiant, you chose the type each time you deal the damage.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Warrior of the Gods",
      source: [["PHB2024", 57]],
      minlevel: 3,
      action: "Bonus Action",
      usages: [0, 0, 4, 4, 4, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 7, 7, 7, 7],
      recovery: "long rest",
      description: desc([
        "A divine entity helps ensure you can continue the fight. You have a pool of four d12s that you can spend to heal yourself. As a Bonus Action, you can expend dice from the pool roll them and regain a number of Hit Points equal to the roll's total.",
        "Your pool regains all expended dice when you finish a Long Rest",
        "The pool's maximum number of dice increases by one when you reach Barbarian levels 6 (5 Dice), 12 (6 Dice), and 17 (7 Dice).",
      ]),
    },
    "subclassfeature6": {
      name: "Fanatical Focus",
      source: [["PHB2024", 57]],
      minlevel: 6,
      description: desc([
        "Once per active Rage, if you fail a saving throw, you can reroll it with a bonus equal to your Rage Damage bonus, and you must use the new roll.",
      ]),
    },
    "subclassfeature10": {
      name: "Zealous Presence",
      source: [["PHB2024", 57]],
      minlevel: 10,
      action: "bonus action",
      usages: 1,
      recovery: "long rest",
      description: desc([
        "As a Bonus Action, you unleash a battle cry infused with divine energy. Up to ten other creatures of your choice within 60 feet of you gain Advantage on attack rolls and saving throws until the start of your next turn.",
        "Once you use this feature, you can't use it again until you finish a Long Rest unless you expend a use of your Rage (no action required) to restore your use of it.",
      ]),
    },
    "subclassfeature14": {
      name: "Rage of the Gods",
      source: [["PHB2024", 57]],
      minlevel: 14,
      action: ["reaction", "Revivification"],
      usages: 1,
      recovery: "long rest",
      description: desc([
        "When you activate your Rage, you can assume the form of a divine warrior. This form lasts for 1 minute or until you drop to 0 Hit Points. Once you use this feature, you can't do so again until you finish a Long Rest.",
        "While in this form, you gain the benefits below",
        "Flight : You have a Fly Speed equal to your Speed and can hover.",
        "Resistance : You have Resistance to Necrotic, Psychic, and Radiant damage.",
        "Revivification : When a creature within 30 feet of you would drop to 0 Hit Points, you can take a Reaction to expend a use of your Rage to instead change the target's Hit Points to a number equal to your Barbarian level.",
      ]),
    },
  },
});
legacyClassRefactor("bard", {
  regExpSearch: /bard/i,
  name: "Bard",
  source: [["PHB2024", 59]],
  primaryAbility: ["Charisma"],
  abilitySave: 6,
  prereqs: "Charisma 13",
  improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
  die: 8,
  saves: ["Dex", "Cha"],
  skillstxt: {
    primary: "Choose any 3 skills",
  },
  armorProfs: {
    primary: [true, false, false, false],
    secondary: [true, false, false, false],
  },
  weaponProfs: {
    primary: [true, false],
  },
  toolProfs: {
    primary: ["Musical Instrument", 3],
    secondary: ["Musical Instrument", 1],
  },
  equipment: "Bard starting equipment:" +
    "\n \u2022 Leather Armor;" +
    "\n \u2022 2 Daggers;" +
    "\n \u2022 A Musical Instrument;" +
    "\n \u2022 An Entertainer's Pack, and 19 gp." +
    "\n\nAlternatively, choose 90 gp worth of starting equipment instead of the class's starting equipment.",
  subclasses: ["Bard Subclass", []],
  attacks: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
  spellcastingAbility: 6,
  spellcastingFactor: 1,
  spellcastingKnown: {
    cantrips: [2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
    spells: "list",
    prepared: true,
  },
  features: {
    "bardic inspiration": {
      name: "Bardic Inspiration",
      source: [["PHB2024", 59]],
      minlevel: 1,
      action: "bonus action",
      additional: ["d6", "d6", "d6", "d6", "d8", "d8", "d8", "d8", "d8", "d10", "d10", "d10", "d10", "d10", "d12", "d12", "d12", "d12", "d12", "d12"],
      usages: "Charisma modifier per ",
      usagescalc: "event.value = Math.max(1, What('Cha Mod'));",
      recovery: levels.map(function (n) {
        return n < 5 ? "long rest" : "short rest";
      }),
      description: desc([
        "You can supernaturally inspire others through words, music or dance. This inspiration is represented by your Bardic Inspiration die, which is a d6.",
        "Using Bardic Inspiration : As a Bonus Action, you can inspire another creature within 60 feet of yourself who can see or hear you. That creature gains one of your Bardic Inspiration dice. A creature can have only one Bardic Inspiration dice. A creature can have only one Bardic Inspiration die at a time.",
        "Once within the next hour when the creature fails a D20 Test, the creature can roll the Bardic Inspiration die and add the number rolled to the d20, potentially turning the failure into a success. A Bardic Inspiration die is expended when it's rolled.",
        "Number of Uses : You can confer a Bardic Inspiration die a number of times equal to your Charisma modifier (minimum of once), and you regain all expended uses when you finish a Long Rest.",
        "At Higher Levels : Your Bardic Inspiration die changes when you reach certain Bard levels, as shown in the Bardic Die column of the Bard Features table. The die becomes a d8 at level 5, a d10 at level 10, and a d12 at level 15.",
      ]),
    },
    "spellcasting": {
      name: "Spellcasting",
      source: [["PHB2024", 59 - 60]],
      minlevel: 1,
      calcChanges: {
        spellCalc: [
          function (type, spellcasters, ability) {
            if (type === "prepare" && spellcasters.indexOf("bard") !== -1) {
              var lvl = classes.known.bard.level;
              var sArr = [0, 4, 5, 6, 7, 9, 10, 11, 12, 14, 15, 16, 16, 17, 17, 18, 18, 19, 20, 21, 22];
              return sArr[lvl] - lvl - Number(What("Cha Mod"));
            }
          }
        ]
      },
      description: desc([
        "You have learned to cast spells through your bardic arts. See chapter 7 for the rules on spellcasting. The information below details how you use those rules with Bard spells, which appear in the Bard spell list later in the class's description.",
        "Cantrips : You know two cantrips of your choice from the Bard spell list. Dancing Lights and Vicious Mockery are recommended.",
        "Whenever you gain a Bard level, you can replace one of your cantrips with another cantrip of your choice from the Bard spell list.",
        "When you reach Bard levels 4 and 10, you learn another cantrip of your choice from the Bard spell list, as shown in the Cantrips column of the Bard Features table.",
        "Spell Slots : The Bard Features table shows how many spell slots you have to cast your level 1+ spells. You regain all expended slots when you finish a Long Rest.",
        "Prepared Spells of Level 1+ : You prepare the list of level 1+ spells that are available for you to cast with this feature. To start, choose four level 1 spells from the Bard spell list. Charm Person, Color Spray, Dissonant Whispers, and Healing Word are recommended.",
        "The number of spells on your list increases as you gain Bard levels, as shown in the Prepared Spells column of the Bard Features table. Whenever that number increases, choose additional spells from the Bard spell list until the number of spells on your list matches the number on the table. The chosen spells must be of a level for which you have spell slots. For example, if you're a level 3 Bard, your list of prepared spells can include six spells of levels 1 and 2 in any combination",
        "If another Bard feature gives you spells that you always have prepared, those spells don't count against the number of spells you can prepare with this feature, but those spells otherwise count as Bard spells for you.",
        "Changing Your Prepared Spells : Whenever you gain a Bard level, you can replace one spell on your list with another Bard spell for which you have spell slots.",
        "Spellcasting Ability : Charisma is your spellcasting ability for your Bard Spells",
        "Spellcasting Focus : You can use a Musical Instrument as a Spellcasting Focus for your Bard spells.",
      ]),
    },
    "expertise": function () {
      var a = {
        name: "Expertise",
        source: [["PHB2024", 60]],
        minlevel: 2,
        description: "You gain Expertise (see the rules glossary) in two of your skill proficiencies of your choice. Performance and Persuasion are recommended if you have proficiency in them. At Bard level 9, you gain Expertise in two more of your skill proficiencies of your choice.",
        skillstxt: "Expertise with any two skill proficiencies, and two more at 9th level",
        additional: levels.map(function (n) {
          return n < 2 ? "" : "with " + (n < 9 ? 2 : 4) + " skills";
        }),
        extraname: "Bard Expertise",
        extrachoices: ["Acrobatics", "Animal Handling", "Arcana", "Athletics", "Deception", "History", "Insight", "Intimidation", "Investigation", "Medicine", "Nature", "Perception", "Performance", "Persuasion", "Religion", "Sleight of Hand", "Stealth", "Survival"],
        extraTimes: levels.map(function (n) {
          return n < 2 ? 0 : n < 9 ? 2 : 4;
        })
      };
      for (var i = 0; i < a.extrachoices.length; i++) {
        var attr = a.extrachoices[i].toLowerCase();
        a[attr] = {
          name: a.extrachoices[i] + " Expertise",
          description: "",
          source: a.source,
          skills: [[a.extrachoices[i], "only"]],
          prereqeval: function (v) {
            return v.skillProfsLC.indexOf(v.choice) === -1 ? false : v.skillExpertiseLC.indexOf(v.choice) === -1 ? true : "markButDisable";
          }
        };
      }
      return a;
    }(),
    "jack of all trades": {
      name: "Jack of All Trades",
      source: [["PHB2024", 60]],
      minlevel: 2,
      eval: function () {
        Checkbox('Jack of All Trades', true);
      },
      removeeval: function () {
        Checkbox('Jack of All Trades', false);
      },
      description: desc([
        "You can add half your Proficiency Bonus (round down) to any ability check you make that uses a skill proficiency you lack and that doesn't otherwise use your Proficiency Bonus.",
        "For example, if you make a Strength (Athletics) check and lack Athletics proficiency, you can add half your Proficiency Bonus to the check.",
      ]),
    },
    "subclassfeature3": {
      name: "Bard Subclass",
      source: [["PHB2024", 60]],
      minlevel: 3,
      description: desc([
        "You gain a Bard subclass of your choice. The College of Dance, College of Glamour, College of Lore, and College of Valor subclasses are detailed after this class's description. A subclass is a specialization that grants you features at certain Bard levels. For the rest of your career, you gain each of your subclass's features that are of your Bard level or lower.",
      ]),
    },
    "font of inspiration": {
      name: "Font of Inspiration",
      source: [["PHB2024", 61]],
      minlevel: 5,
      description: desc([
        "You now regain all your expended uses of Bardic Inspiration when you finish a Short or Long Rest.",
        "In addition, you can expend a spell slot (no action required) to regain one expended use of Bardic Inspiration.",
      ]),
    },
    "countercharm": {
      name: "Countercharm",
      source: [["PHB2024", 61]],
      minlevel: 7,
      action: "reaction",
      description: desc([
        "You can use musical notes or words of power to disrupt mind-influencing effects. If you or a creature within 30 feet of you fails a saving throw against an effect that applies the Charmed or Frightened condition, you can take a Reaction to cause the save to be rerolled, and the new roll has Advantage.",
      ]),
    },
    "magical secrets": {
      name: "Magical Secrets",
      source: [["PHB2024", 61]],
      minlevel: 10,
      spellcastingList: {
        class: ["bard", "cleric", "druid", "wizard"],
      },
      description: desc([
        "You've learned secrets from various magical traditions. Whenever you reach a Bard level (including this level) and the Prepared Spells number in the Bard Features table increases, you can choose any of your new prepared spells from the Bard, Cleric, Druid, and Wizard spell list, and the chosen spells count as Bard spells for you (see a class's section for its spell list). In addition, whenever you replace a spell prepared for this class, yo can replace it with a spell from those lists.",
      ]),
    },
    "superior inspiration": {
      name: "Superior Inspiration",
      source: [["PHB2024", 61]],
      minlevel: 18,
      description: desc([
        "When you roll Initiative, you regain expended uses of Bardic Inspiration until you have two if you have fewer than that.",
      ]),
    },
    "epic boon": {
      name: "Epic Boon",
      source: [["PHB2024", 53]],
      minlevel: 19,
      description: desc([
        "You gain an Epic Boon feat (see chapter 5) or another feat of your choice for which you qualify. Boon of Irresistible Offense is recommended.",
      ]),
    },
    "words of creation": {
      name: "Words of Creation",
      source: [["PHB2024", 61]],
      minlevel: 20,
      spellcastingBonus: [{
        name: "Words of Creation",
        spells: ["power word heal", "power word kill"],
        selection: ["power word heal", "power word kill"],
        times: 2,
      }],
      description: desc([
        "You have mastered two of the Words of Creation: the words of life and death. You therefore always have the Power Word Heal and Power Word Kill spells prepared. When you cast either spell, you can target a second creature with it if that creature is within 10 feet of the first target.",
      ]),
    },
  },
});
legacySubClassRefactor("bard", "dance", {
  regExpSearch: /^(?=.*(bard))(?=.*(dance)).*$/i,
  subname: "College of Dance",
  source: [["PHB2024", 64]],
  replaces: "college of dance",
  features: {
    "subclassfeature3": {
      name: "Dazzling Footwork",
      source: [["PHB2024", 64]],
      minlevel: 3,
      armorOptions: [{
        regExpSearch: /justToAddToDropDownAndEffectWildShape/,
        name: "Unarmored Defense (Cha)",
        source: [["PHB2024", 64]],
        ac: "10+Cha",
        affectsWildShape: true,
        selectNow: true
      }],
      calcChanges: {
        atkAdd: [
          function (fields, v) {
            if (classes.known.bard && classes.known.bard.level && (v.baseWeaponName == "unarmed strike")) {
              v.theWea.monkweapon = true;
              var aBardDie = function (n) {
                return n < 5 ? 6 : n < 10 ? 8 : n < 15 ? 10 : 12;
              }(classes.known.bard.level);
              try {
                var curDie = eval_ish(fields.Damage_Die.replace('d', '*'));
              } catch (e) {
                var curDie = 'x';
              }
              if (isNaN(curDie) || curDie < aBardDie) {
                fields.Damage_Die = '1d' + aBardDie;
              }
              if (fields.Mod === 1 || fields.Mod === 2 || What(AbilityScores.abbreviations[fields.Mod - 1] + " Mod") < What(AbilityScores.abbreviations[v.StrDex - 1] + " Mod")) {
                fields.Mod = v.StrDex;
              }
            }
          },
          "I can use either Strength or Dexterity and my Bardic Inspiration damage die in place of the normal damage die for any unarmed strike.",
          5
        ]
      },
      description: desc([
        "While you aren't wearing armor or wielding a Shield, you gain the following benefits.",
        "Dance Virtuoso : You have Advantage on any Charisma (Performance) check you make that involves you dancing",
        "Unarmored Defense : Your base Armor Class equals 10 plus your Dexterity and Charisma modifiers",
        "Agile Strikes : When you expend a use of your Bardic Inspiration as part of an action, a Bonus Action, or a Reaction, you can make one Unarmed Strike as part of that action, Bonus Action, or Reaction.",
        "Bardic Damage : You can use Dexterity instead of Strength for the attack rolls of your Unarmed Strikes. When you deal damage with an Unarmed Strike, you can deal Bludgeoning damage equal to a roll of your Bardic Inspiration die plus your Dexterity modifier, instead of the strike's normal damage. This roll doesn't expend the die.",
      ]),
    },
    "subclassfeature6": {
      name: "Inspiring Movement",
      source: [["PHB2024", 64]],
      minlevel: 6,
      action: "reaction",
      description: desc([
        "When an enemy you can see ends its turn within 5 feet of you, you can take a Reaction and expend one use of your Bardic Inspiration to move up to half your Speed. Then one ally of your choice within 30 feet of you can also move up to half their Speed using their Reaction.",
        "None of his feature's movement provokes Opportunity Attacks.",
      ]),
    },
    "subclassfeature6.1": {
      name: "Tandem Footwork",
      source: [["PHB2024", 64]],
      minlevel: 6,
      description: desc([
        "When you roll Initiative, you can expend one use of your Bardic Inspiration if you don't have the Incapacitated condition. When you do so, roll your Bardic Inspiration die you and each ally within 30 feet of you who can see or hear you gains a bonus to Initiative equals to the number rolled.",
      ]),
    },
    "subclassfeature14": {
      name: "Leading Evasion",
      source: [["PHB2024", 65]],
      minlevel: 14,
      description: desc([
        "When you are subjected to an effect that allows you to make a Dexterity saving throw to take only half damage, you instead take no damage if you succeed on the saving throw and only half damage if you fail. If any creatures within 5 feet of you are making he same Dexterity saving throw, you can share this benefit with them for that save.",
        "You can't use this feature if you have the Incapacitated condition.",
      ]),
    },
  },
});
legacySubClassRefactor("bard", "glamour", {
  regExpSearch: /^(?=.*(bard))(?=.*(glamour)).*$/i,
  subname: "College of Glamour",
  source: [["PHB2024", 65]],
  replaces: "college of glamour",
  features: {
    "subclassfeature3": {
      name: "Beguiling Magic",
      source: [["PHB2024", 65]],
      minlevel: 3,
      usages: 1,
      recovery: "long rest",
      spellcastingBonus: [{
        name: "Animal Speaker",
        spells: ["charm person", "mirror image"],
        selection: ["charm person", "mirror image"],
        times: 2,
      }],
      description: desc([
        "You always have the Charm Person and Mirror Image spells prepared.",
        "In addition, immediately after you cast an Enchantment or Illusion spell using a spell slot, you can cause a creature you can see within 60 feet of yourself to make a Wisdom saving throw against your spell save DC. On a failed save, the target has the Charmed or Frightened condition (your choice) for 1 minute. The target repeats the save at the end of each of its turns, ending the effect on itself on a success",
        "Once you use this benefit, you can't use it again until you finish a Long Rest. You can also restore your use of it by expending one use of your Bardic Inspiration (no action required).",
      ]),
    },
    "subclassfeature3.1": {
      name: "Mantle of Inspiration",
      source: [["PHB2024", 65]],
      minlevel: 3,
      action: "bonus action",
      description: desc([
        "You can weave fey magic into a song or dance to fill others with vigor. As a Bonus Action, you can expend a use of Bardic Inspiration, rolling a Bardic Inspiration die. When you do so, choose a number of other creatures within 60 feet of yourself, up to a number equal to your Charisma modifier (minimum of one creature). Each of those creatures gain a number of Temporary Hit Points equal to two times the number rolled on the Bardic Inspiration die, and then each can use its Reaction to move up to its Speed without provoking Opportunity Attacks.",
      ]),
    },
    "subclassfeature6": {
      name: "Mantle of Majesty",
      source: [["PHB2024", 65 - 66]],
      minlevel: 6,
      action: "bonus action",
      usages: 1,
      recovery: "long rest",
      spellcastingBonus: [{
        name: "Mantle of Majesty",
        spells: ["command"],
        selection: ["command"],
        times: 1,
        firstCol: "oncelr",
      }],
      description: desc([
        "You always have the Command spell prepared.",
        "As a Bonus Action, you can cast Command without expending a spell slot, and you take on an unearthly appearance for 1 minute or until your Concentration ends. During this time, you can cast Command as a Bonus Action without expending a spell slot.",
        "Any creature Charmed by you automatically fails its saving throw against the Command you cast with this feature.",
        "Once you use this feature, you can't use it again until you finish a Long Rest. You can also restore your use of it by expending a level 3+ spell slot (no action required).",
      ]),
    },
    "subclassfeature14": {
      name: "Unbreakable Majesty",
      source: [["PHB2024", 66]],
      minlevel: 14,
      action: "bonus action",
      usages: 1,
      recovery: "short rest",
      description: desc([
        "As a Bonus Action, you can assume a magically majestic presence for 1 minute or until you have the Incapacitated condition. For the duration, whenever any creature hits you with an attack roll for the first time on a turn, the attacker must succeed on a Charisma saving throw against your spell save DC or the attack misses instead, as the creature recoils from your majesty",
        "Once you assume this majestic presence, you can't do so again until you finish a Short or Long Rest.",
      ]),
    },
  },
});
legacySubClassRefactor("bard", "lore", {
  regExpSearch: /^(?=.*(bard))(?=.*(lore)).*$/i,
  subname: "College of Lore",
  source: [["PHB2024", 66]],
  replaces: "college of lore",
  features: {
    "subclassfeature3": {
      name: "Bonus Proficiencies",
      source: [["PHB2024", 66]],
      minlevel: 3,
      skillstxt: "Choose any 3 skills",
      description: desc([
        "You gain proficiency with three skills of choice.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Cutting Words",
      source: [["PHB2024", 66]],
      minlevel: 3,
      action: "reaction",
      description: desc([
        "You learn to use your wit to supernaturally distract, confuse, and otherwise sap the confidence and competence of others. When a creature that you can see within 60 feet of yourself makes a damage roll or succeeds on an ability check or attack roll, you can take a Reaction to expend one use of your Bardic Inspiration, roll your Bardic Inspiration die, and subtract the number rolled from the creature's roll, reducing the damage r potentially turning the success into a failure.",
      ]),
    },
    "subclassfeature6": {
      name: "Magical Discoveries",
      source: [["PHB2024", 66 - 67]],
      minlevel: 6,
      spellcastingBonus: [{
        name: "Magical Discoveries",
        "class": ["cleric", "druid", "wizard"],
        times: 2,
      }],
      description: desc([
        "You learn two spells of your choice. These spells can come from the Cleric, Druid, or Wizard spell list or any combination thereof (see a class's section for its spell list). A spell you choose must be a cantrip or a spell for which you have spell slots, as shown in the Bardic Features table.",
        "You always have the chosen spells prepared, and whenever you gain a Bard level, you can replace one of the spells with another spell that meets these requirements.",
      ]),
    },
    "subclassfeature14": {
      name: "Peerless Skill",
      source: [["PHB2024", 67]],
      minlevel: 14,
      description: desc([
        "When you make an ability check or attack roll and fail, you can expend one use of Bardic Inspiration; roll the Bardic Inspiration die, and add the number rolled to the d20, potentially turning a failure into a success. On a failure, the Bardic Inspiration isn't expended.",
      ]),
    },
  },
});
legacySubClassRefactor("bard", "valor", {
  regExpSearch: /^(?=.*(bard))(?=.*(valor)).*$/i,
  subname: "College of Valor",
  source: [["PHB2024", 67]],
  replaces: "college of valor",
  attacks: [1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
  features: {
    "subclassfeature3": {
      name: "Combat Inspiration",
      source: [["PHB2024", 67]],
      minlevel: 3,
      description: desc([
        "You can use your wit to turn the tide of battle. A creature that has a Bardic Inspiration die from you can use it for one of the following effects.",
        "Defense : When the creature is hit by an attack roll, that creature can use its Reaction to roll the Bardic Inspiration die and add the number rolled to its AC against that attack, potentially causing the attack to miss.",
        "Offense : Immediately after the creature hits a target with an attack roll, the creature can roll the Bardic Inspiration die and add the number rolled to the attack's damage against the target.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Martial Training",
      source: [["PHB2024", 67]],
      minlevel: 3,
      armorProfs: [false, true, false, true],
      weaponProfs: [false, true],
      description: desc([
        "You gain proficiency with Martial weapons and training with Medium armor and Shields.",
        "In addition, you can use a Simple or Martial weapon as a Spellcasting Focus to cast spells from your Bard Spell List.",
      ]),
    },
    "subclassfeature6": {
      name: "Extra Attack",
      source: [["PHB2024", 67]],
      minlevel: 6,
      description: desc([
        "You can attack twice instead of once whenever you take the Attack action on your turn.",
        "In addition, you can cast one of your cantrips that has a casting time of an action in place of one of those attacks.",
      ]),
    },
    "subclassfeature14": {
      name: "Battle Magic",
      source: [["PHB2024", 67]],
      minlevel: 14,
      action: ["bonus action", "Weapon Attack (After Casing Spell)"],
      description: desc([
        "After you cast a spell that has a casting time of an action, you can make one attack with a weapon as a Bonus Action.",
      ]),
    },
  },
});
legacyClassRefactor("cleric", {
  regExpSearch: /cleric/i,
  name: "Cleric",
  source: [["PHB2024", 59]],
  primaryAbility: ["Wisdom"],
  abilitySave: 5,
  prereqs: "Wisdom 13",
  improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
  die: 8,
  saves: ["Wis", "Cha"],
  skillstxt: {
    primary: "Choose 2: History, Insight, Medicine, Persuasion, or Religion",
  },
  armorProfs: {
    primary: [true, true, false, true],
    secondary: [true, true, false, true],
  },
  weaponProfs: {
    primary: [true, false],
  },
  equipment: "Cleric starting equipment:" +
    "\n \u2022 Chain Shirt;" +
    "\n \u2022 A Shield;" +
    "\n \u2022 A Mace;" +
    "\n \u2022 A Holy Symbol;" +
    "\n \u2022 A Priest's Pack, and 7 gp." +
    "\n\nAlternatively, choose 110 gp worth of starting equipment instead of the class' starting equipment.",
  subclasses: ["Cleric Subclass", []],
  attacks: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
  spellcastingAbility: 5,
  spellcastingFactor: 1,
  spellcastingKnown: {
    cantrips: [3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5],
    spells: "list",
    prepared: true,
  },
  features: {
    "spellcasting": {
      name: "Spellcasting",
      source: [["PHB2024", 69]],
      minlevel: 1,
      additional: levels.map(function (n, idx) {
        var cantr = [3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5][idx];
        var splls = [4, 5, 6, 7, 9, 10, 11, 12, 14, 15, 16, 16, 17, 17, 18, 18, 19, 20, 21, 22][idx];
        return cantr + " cantrips \u0026 " + splls + " spells prepared";
      }),
      calcChanges: {
        spellCalc: [
          function (type, spellcasters, ability) {
            if (type === "prepare" && spellcasters.indexOf("cleric") !== -1) {
              var lvl = classes.known.cleric.level;
              var sArr = [0, 4, 5, 6, 7, 9, 10, 11, 12, 14, 15, 16, 16, 17, 17, 18, 18, 19, 20, 21, 22];
              return sArr[lvl] - lvl - Number(What("Wis Mod"));
            }
          }
        ]
      },
      description: desc([
        "You have learned to cast spells through prayer and meditation. See chapter 7 for the rules on spellcasting. The information below details how you use those rules with Cleric spells, which appear in the Cleric spell list later in the class's description.",
        "Cantrips : You know three cantrips of your choice from the Cleric spell list. Guidance, Sacred Flame, and Thaumaturgy are recommended.",
        "Whenever you gain a Cleric level, you can replace one of your cantrips with another cantrip of your choice from the Cleric spell list.",
        "When you reach Cleric levels 4 and 10, you learn another cantrip of your choice from the Cleric spell list, as shown in the Cantrips column of the Cleric Features table.",
        "Spell Slots : The Cleric Features table shows how many spell slots you have to cast your level 1+ spells. You regain all expended slots when you finish a Long Rest.",
        "Prepared Spells of Level 1+ : You prepare the list of level 1+ spells that are available for you to cast with this feature. To start, choose four level 1 spells from the Cleric spell list. Bless, Cure Wounds, Guiding Bolt, and Shield of Faith are recommended.",
        "The number of spells on your list increases as you gain Cleric levels, as shown in the Prepared Spells column of the Cleric Features table. Whenever that number increases, choose additional spells from the Cleric spell list until the number of spells on your list matches the number on the table. The chosen spells must be of a level for which you have spell slots. For example, if you're a level 3 Cleric, your list of prepared spells can include six spells of levels 1 and 2 in any combination",
        "If another Cleric feature gives you spells that you always have prepared, those spells don't count against the number of spells you can prepare with this feature, but those spells otherwise count as Cleric spells for you.",
        "Changing Your Prepared Spells : Whenever you finish a Long Rest, you can change your list of prepared spells replacing any of the spells there with other Cleric spells for which you have spell slots.",
        "Spellcasting Ability : Wisdom is your spellcasting ability for your Cleric Spells",
        "Spellcasting Focus : You can use a Holy Symbol as a Spellcasting Focus for your Cleric spells.",
      ]),
    },
    "divine order": {
      name: "Divine Order",
      source: [["PHB2024", 70]],
      minlevel: 1,
      choices: ["Protector", "Thaumaturge (Arcana)", "Thaumaturge (Religion)"],
      "protector": {
        name: "Protector",
        armorProfs: [false, false, true, false],
        weaponProfs: [false, true],
        description: "Trained for battle, you gain proficiency with Martial weapons and training with Heavy armor."
      },
      "thaumaturge (arcana)": {
        name: "Thaumaturge (Arcana)",
        spellcastingBonus: [{
          name: "Thaumaturge",
          "class": ["cleric"],
          level: [0, 0],
          times: 1,
        }],
        addMod: [
          {type: "skill", field: "Arcana", mod: "Wis", text: "I can add my Wisdom modifier to Arcana rolls."},
        ],
        description: "You know one extra cantrip from the Cleric spell list. In addition, your mystical connection to the divine gives you a bonus to your Intelligence (Arcana) checks. The bonus equals your Wisdom modifier (minimum of +1).",
      },
      "thaumaturge (religion)": {
        name: "Thaumaturge (Religion)",
        spellcastingBonus: [{
          name: "Thaumaturge",
          "class": ["cleric"],
          level: [0, 0],
          times: 1,
        }],
        addMod: [
          {type: "skill", field: "Religion", mod: "Wis", text: "I can add my Wisdom modifier to Religion rolls."},
        ],
        description: "You know one extra cantrip from the Cleric spell list. In addition, your mystical connection to the divine gives you a bonus to your Intelligence (Religion) checks. The bonus equals your Wisdom modifier (minimum of +1).",
      },
      description: desc([
        "You have dedicated yourself to one of the following sacred roles of your choice.",
      ]),
    },
    "channel divinity": {
      name: "Channel Divinity",
      source: [["PHB2024", 70]],
      minlevel: 2,
      description: desc([
        "You can channel divine energy directly from the Outer Planes to fuel magical effects. You start with two such effects : Divine Spark and Turn Undead, each of which is described below. Each time you use this class's Channel Divinity, choose which Channel Divinity effect from this class to create. You gain additional effect options at higher Cleric levels.",
        "You can use this class's Channel Divinity twice. You regain one of its expended uses when you finish a Short Rest, and you regain all expended uses when you finish a Long Rest. You gain additional uses when you reach certain Cleric levels, as shown in the Channel Divinity column of the Cleric Features table.",
        "If a Channel Divinity effect requires a saving throw, the DC equals the spell save DC from this class's Spellcasting feature.",
        "Divine Spark : As a Magic action, you point your Holy Symbol at another creature you can see within 30 feet of yourself and focus divine energy at it. Roll 1d8 and add your Wisdom modifier. You either restore Hit Points to the creature equal to that total or force the creature to make a Constitution saving throw. On a failed save, the creature takes Necrotic or Radiant damage (your choice) equal to that total. On a successful save, the creature takes half as much damage (round down).",
        "You roll an additional d8 when you reach Cleric level 7 (2d8), 13 (3d8), and 18 (4d8).",
        "Turn Undead : As a Magic action, you present your Holy Symbol and censure Undead creatures. Each Undead of your choice within 30 feet of you must make a Wisdom saving throw. If the creature fails its save, it has the Frightened and Incapacitated conditions for 1 minute. For that duration it tries to move as far from you as it can on its turns. This effect ends early on the creature if it takes any damage, if you have the Incapacitated condition, or if you die.",
      ]),
    },
    "subclassfeature3": {
      name: "Cleric Subclass",
      source: [["PHB2024", 71]],
      minlevel: 3,
      description: desc([
        "You gain a Cleric subclass of your choice. The Life Domain, Light Domain, Trickery Domain, and War Domain subclasses are detailed after this class's description. A subclass is a specialization that grants you features at certain Cleric levels. For the rest of your career, you gain each of your subclass's features that are of your Cleric level or lower.",
      ]),
    },
    "sear undead": {
      name: "Sear Undead",
      source: [["PHB2024", 61]],
      minlevel: 5,
      description: desc([
        "Whenever you use Turn Undead, you can roll a number of D8s equal to your Wisdom modifier (minimum of 1d8) and add the rolls together. Each Undead that fails its saving throw against that use of Turn Undead takes Radiant damage equal to the roll's total. This damage doesn't end the turn effect.",
      ]),
    },
    "blessed strikes": {
      name: "Blessed Strikes",
      source: [["PHB2024", 71]],
      minlevel: 7,
      choices: ["Divine Strike", "Potent Spellcasting"],
      "divine strike": {
        name: "Divine Strike",
        description: desc([
          "Once on each of your turns when you hit a creature with an attack roll using a weapon, you can cause the target to take an extra 1d8 Necrotic or Radiant damage (your choice).",
        ]),
      },
      "potent spellcasting": {
        name: "Potent Spellcasting",
        calcChanges: {
          atkCalc: [
            function (fields, v, output) {
              if (v.thisWeapon[3] && /\bcleric\b/.test(v.thisWeapon[4]) && SpellsList[v.thisWeapon[3]].level === 0 && /\d/.test(fields.Damage_Die)) {
                output.extraDmg += What('Wis Mod');
              }
            },
            "My cleric cantrips get my Wisdom modifier added to their damage."
          ],
          spellAdd: [
            function (spellKey, spellObj, spName) {
              if (spellObj.psionic || spellObj.level !== 0 || spName.indexOf("cleric") == -1 || !What("Wis Mod") || Number(What("Wis Mod")) <= 0) return;
              return genericSpellDmgEdit(spellKey, spellObj, "\\w+\\.?", "Wis");
            },
            "My cleric cantrips get my Wisdom modifier added to their damage."
          ]
        },
        description: desc([
          "Add your Wisdom modifier to the damage you deal with any Cleric cantrip.",
        ]),
      },
      description: desc([
        "Divine power infuses you in battle. You gain one of the following options of your choice (if you get either option from a Cleric subclass in an older book, use only the option you choose for this feature).",
      ]),
    },
    "divine intervention": {
      name: "Divine Intervention",
      source: [["PHB2024", 71]],
      minlevel: 10,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "You can call on your deity or pantheon to intervene on your behalf. As a Magic action, choose any Cleric spell of level 5 or lower that doesn't require a Reaction to cast. As part of the same action, you cast that spell without expending a spell slot or needing Material components. You can't use this feature again until you finish a Long Rest.",
      ]),
    },
    "improved blessed strikes": {
      name: "Improved Blessed Strikes",
      source: [["PHB2024", 71]],
      minlevel: 14,
      choices: ["Divine Strike", "Potent Spellcasting"],
      "divine strike": {
        name: "Divine Strike",
        description: desc([
          "The extra damage of your Divine Strikes increases to 2d8",
        ]),
      },
      "potent spellcasting": {
        name: "Potent Spellcasting",
        description: desc([
          "When you cast a Cleric cantrip and deal damage to a creature with it, you can give vitality to yourself or another creature within 60 feet of yourself, granting a number of Temporary Hit Points equal to twice your Wisdom modifier.",
        ]),
      },
      description: desc([
        "The option you chose for Blessed Strikes grow more powerful.",
      ]),
    },
    "epic boon": {
      name: "Epic Boon",
      source: [["PHB2024", 71]],
      minlevel: 19,
      description: desc([
        "You gain an Epic Boon feat (see chapter 5) or another feat of your choice for which you qualify. Boon of Fate is recommended.",
      ]),
    },
    "greater divine intervention": {
      name: "Greater Divine Intervention",
      source: [["PHB2024", 71]],
      minlevel: 20,
      description: desc([
        "You can call on even more powerful divine intervention. When you use your Divine Intervention feature, you can choose Wish when you select a sell. If you do so, you can't use Divine Intervention again until you finish 2d4 Long Rests.",
      ]),
    },
  },
});
legacySubClassRefactor("cleric", "life", {
  regExpSearch: /^(?=.*(cleric))(?=.*(life)).*$/i,
  subname: "Life Domain",
  source: [["PHB2024", 73]],
  replaces: "life domain",
  spellcastingExtra: ["aid", "bless", "cure wounds", "lesser restoration", "mass healing word", "revivify", "aura of life", "death ward", "greater restoration", "mass cure wounds"],
  features: {
    "subclassfeature3": {
      name: "Disciple of Life",
      source: [["PHB2024", 73]],
      minlevel: 3,
      description: desc([
        "When a spell you cast with a spell slot restores Hit Points to a creature, that creature regains additional Hit Points on the turn you cast the spell. The additional Hit Points equal 2 plus the spell slot's level.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Preserve Life",
      source: [["PHB2024", 73]],
      minlevel: 3,
      action: "action",
      description: desc([
        "As a Magic action, you present your Holy Symbol and expend a use of your Channel Divinity to evoke healing energy that can restore a number of Hit Points equal to five times your Cleric Level. Choose Bloodied creatures within 30 feet of yourself (which can include you), and divide those Hit Points among them. This feature can restore a creature o no more than half its Hit Point maximum.",
      ]),
    },
    "subclassfeature6": {
      name: "Blessed Healer",
      source: [["PHB2024", 74]],
      minlevel: 6,
      description: desc([
        "The healing spells you cast on others heal you as well. Immediately after you cast a spell with a spell slot that restores Hit Points to one or more creatures other than yourself, you regain Hit Points equal to 2 plus the spell slot's level.",
      ]),
    },
    "subclassfeature17": {
      name: "Supreme Healing",
      source: [["PHB2024", 74]],
      minlevel: 17,
      description: desc([
        "When you would normally roll one or more dice to restore Hit Points to a creature with a spell or Channel Divinity, don't roll those dice for the healing, instead use the highest number possible for each die. For example, instead of restoring 2d6 Hit Points to a creature with a spell, you restore 12.",
      ]),
    },
  },
});
legacySubClassRefactor("cleric", "light", {
  regExpSearch: /^(?=.*(cleric))(?=.*(light)).*$/i,
  subname: "Light Domain",
  source: [["PHB2024", 74]],
  replaces: "light domain",
  spellcastingExtra: ["burning hands", "faerie fire", "scorching ray", "see invisibility", "daylight", "fireball", "arcane eye", "wall of fire", "flame strike", "scrying"],
  features: {
    "subclassfeature3": {
      name: "Radiance of Dawn",
      source: [["PHB2024", 74]],
      minlevel: 3,
      description: desc([
        "As a Magic action, you present your Holy Symbol and expend a use of your Channel Divinity to emit a flash of light in a 30-foot Emanation originating from yourself. Any magical Darkness - such as that created by the Darkness spell - is that area is dispelled. Additionally, each creature of your choice in that area must make a Constitution saving throw. taking Radiant damage equal to 2d10 plus your Cleric level on a failed save or half as much damage on a successful one.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Warding Flare",
      source: [["PHB2024", 74]],
      minlevel: 3,
      usages: "Wisdom modifier per ",
      usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
      recovery: levels.map(function (n) {
        return n < 6 ? "long rest" : "short rest";
      }),
      description: desc([
        "When a creature that you can see within 30 feet of yourself makes an attack roll, you can take a Reaction to impose Disadvantage on the attack roll, causing light to flare before it hits or misses.",
        "You can use this feature a number of times equal to your Wisdom modifier (minimum of once). You regain all expended uses when you finish a Long Rest.",
      ]),
    },
    "subclassfeature6": {
      name: "Improved Warding Flare",
      source: [["PHB2024", 75]],
      minlevel: 6,
      description: desc([
        "You regain all expended uses of your Warding Flare when you finish a Short or Long rest.",
        "In addition, whenever you use warding Flare, you can give the target of the attack a number of Temporary Hit Points equal to 2d6 plus your Wisdom modifier.",
      ]),
    },
    "subclassfeature17": {
      name: "Corona of Light",
      source: [["PHB2024", 66]],
      minlevel: 17,
      usages: "Wisdom modifier per ",
      usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
      recovery: "long rest",
      description: desc([
        "As a Magic action, you cause yourself to emit an aura of sunlight that lasts for 1 minute or until you dismiss it (no action required). You emit Bright Light in a 60-foot radius and Dim Light for an additional 30 feet. Your enemies in the Bright Light have Disadvantage on saving throws against your Radiance of the Dawn and any spell that deals Fire or Radiant damage.",
        "You can use this feature a number of times equal to your Wisdom modifier (minimum of once), and you regain all expended uses when you finish a Long Rest.",
      ]),
    },
  },
});
legacySubClassRefactor("cleric", "trickery", {
  regExpSearch: /^(?=.*(cleric))(?=.*(trickery)).*$/i,
  subname: "Trickery Domain",
  source: [["PHB2024", 75]],
  replaces: "trickery domain",
  spellcastingExtra: ["charm person", "disguise self", "invisibility", "pass without trace", "hypnotic pattern", "nondetection", "confusion", "dimension door", "dominate person", "modify memory"],
  features: {
    "subclassfeature3": {
      name: "Blessing of the Trickster",
      source: [["PHB2024", 75]],
      minlevel: 3,
      action: "action",
      description: desc([
        "As a Magic action, you can choose yourself or a willing creature within 30 feet of yourself to have Advantage on Dexterity (Stealth) checks. This.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Invoke Duplicity",
      source: [["PHB2024", 75 - 76]],
      minlevel: 3,
      action: ["bonus action", "Invoke/Move"],
      description: desc([
        "As a Bonus Action, you can expend one use of your Channel Divinity to create a perfect visual illusion of yourself in an unoccupied space you can see within 30 feet of yourself. The illusion is intangible and doesn't occupy its space. It lasts for 1 minute, but ends early if you dismiss it (no action required) or have the Incapacitated condition. The illusion is animated and mimics your expressions and gestures. While it persists, you gain the following benefits.",
        "Cast Spells : You can cast spells as though you were in the illusion's space, but you must use your own senses.",
        "Distract : When both you and your illusion are within 5 feet of a creature that can see the illusion, you have Advantage on attack rolls against that creature, given how distracting the illusion is to the target.",
        "Move : As a Bonus Action, you can move the illusion up to 30 feet to an unoccupied space you can see within 120 feet of yourself.",
      ]),
    },
    "subclassfeature6": {
      name: "Trickster's Transposition",
      source: [["PHB2024", 76]],
      minlevel: 6,
      description: desc([
        "Whenever you take the Bonus Action to create or move the illusion of your Invoke Duplicity, you can teleport, swapping places with the illusion.",
      ]),
    },
    "subclassfeature17": {
      name: "Improved Duplicity",
      source: [["PHB2024", 76]],
      minlevel: 17,
      description: desc([
        "The illusion of your Invoke Duplicity has grown more powerful in the following ways.",
        "Shared Distraction : When you and your allies make attack rolls against a creature within 5 feet of the illusion, the attack rolls have Advantage",
        "Healing Illusion : When the illusion ends you or a creature of your choice within 5 feet of it regain a number of Hit Points equal to your Cleric level.",
      ]),
    },
  },
});
legacySubClassRefactor("cleric", "war", {
  regExpSearch: /^(?=.*(cleric))(?=.*(war)).*$/i,
  subname: "War Domain",
  source: [["PHB2024", 76]],
  replaces: "war domain",
  spellcastingExtra: ["guiding bolt", "magic weapon", "shield of faith", "spiritual weapon", "crusader's mantle", "spirit guardians", "fire shield", "freedom of movement", "hold monster", "steel wind strike"],
  features: {
    "subclassfeature3": {
      name: "Guided Strikes",
      source: [["PHB2024", 77]],
      minlevel: 3,
      action: "reaction",
      description: desc([
        "When you or a creature within 300 feet of you misses with an attack roll, you can expend one use of your Channel Divinity and give that roll a +10 bonus, potentially causing it to hit. When you use this feature to benefit another creature's attack roll, you must take a Reaction to do so.",
      ]),
    },
    "subclassfeature3.1": {
      name: "War Priest",
      source: [["PHB2024", 67]],
      minlevel: 3,
      usages: "Wisdom modifier per ",
      usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
      recovery: "short rest",
      action: ["bonus action", "Weapon/Unarmed Strike"],
      description: desc([
        "As a Bonus Action, you can make one attack with a weapon or an Unarmed Strike. You can use this Bonus Action a number of times equal to your Wisdom modifier (minimum of once). You regain all expended uses when you finish a Short or Long rest.",
      ]),
    },
    "subclassfeature6": {
      name: "War God's Blessing",
      source: [["PHB2024", 77]],
      minlevel: 6,
      description: desc([
        "You can expend a use of your Channel Divinity to cast Shield of Faith or Spiritual Weapon rather than expending a spell slot. When you cast either spell in this way, the spell doesn't require Concentration. Instead the spell lasts for 1 minute, but it ends early if you cast that spell again, have the Incapacitated condition, or die.",
      ]),
    },
    "subclassfeature14": {
      name: "Avatar of Battle",
      source: [["PHB2024", 67]],
      minlevel: 14,
      dmgres: ["Bludgeoning", "Piercing", "Slashing"],
      description: desc([
        "You gain Resistance to Bludgeoning, Piercing, and Slashing damage.",
      ]),
    },
  },
});
legacyClassRefactor("druid", {
  regExpSearch: /druid/i,
  name: "Druid",
  source: [["PHB2024", 79]],
  primaryAbility: ["Wisdom"],
  abilitySave: 5,
  prereqs: "Wisdom 13",
  improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
  die: 8,
  saves: ["Int", "Wis"],
  skillstxt: {
    primary: "Choose 2: Arcana, Animal Handling, Insight, Medicine, Nature, Perception, religion, or Survival",
  },
  armorProfs: {
    primary: [true, false, false, true],
    secondary: [true, false, false, true],
  },
  toolProfs: {
    primary: [["Herbalism Kit"]],
    secondary: [[""]],
  },
  weaponProfs: {
    primary: [true, false],
    secondary: [false, false],
  },
  equipment: "Druid starting equipment:" +
    "\n \u2022 Leather Armor;" +
    "\n \u2022 A Shield;" +
    "\n \u2022 A Sickle;" +
    "\n \u2022 A Druidic Focus(Quarterstaff);" +
    "\n \u2022 An Herbalism Kit;" +
    "\n \u2022 An Explorer's Pack, and 9 gp." +
    "\n\nAlternatively, choose 50 gp worth of starting equipment instead of the class' starting equipment.",
  subclasses: ["Druid Subclass", []],
  attacks: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
  spellcastingAbility: 5,
  spellcastingFactor: 1,
  spellcastingKnown: {
    cantrips: [2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
    spells: "list",
    prepared: true,
  },
  features: {
    "spellcasting": {
      name: "Spellcasting",
      source: [["PHB2024", 79]],
      minlevel: 1,
      additional: levels.map(function (n, idx) {
        var cantr = [2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4][idx];
        var splls = [4, 5, 6, 7, 9, 10, 11, 12, 14, 15, 16, 16, 17, 17, 18, 18, 19, 20, 21, 22][idx];
        return cantr + " cantrips \u0026 " + splls + " spells prepared";
      }),
      calcChanges: {
        spellCalc: [
          function (type, spellcasters, ability) {
            if (type === "prepare" && spellcasters.indexOf("druid") !== -1) {
              var lvl = classes.known.druid.level;
              var sArr = [0, 4, 5, 6, 7, 9, 10, 11, 12, 14, 15, 16, 16, 17, 17, 18, 18, 19, 20, 21, 22];
              return sArr[lvl] - lvl - Number(What("Wis Mod"));
            }
          }
        ]
      },
      description: desc([
        "You have learned to cast spells through studying the mystical forces of nature. See chapter 7 for the rules on spellcasting. The information below details how you use those rules with Druid spells, which appear in the Druid spell list later in the class's description.",
        "Cantrips : You know two cantrips of your choice from the Druid spell list. Druidcraft, and Produce Flame are recommended.",
        "Whenever you gain a Druid level, you can replace one of your cantrips with another cantrip of your choice from the Druid spell list.",
        "When you reach Druid levels 4 and 10, you learn another cantrip of your choice from the Druid spell list, as shown in the Cantrips column of the Druid Features table.",
        "Spell Slots : The Druid Features table shows how many spell slots you have to cast your level 1+ spells. You regain all expended slots when you finish a Long Rest.",
        "Prepared Spells of Level 1+ : You prepare the list of level 1+ spells that are available for you to cast with this feature. To start, choose four level 1 spells from the Druid spell list. Animal Friendship, Cure Wounds, Faerie Fire, and Thunderwave are recommended.",
        "The number of spells on your list increases as you gain Druid levels, as shown in the Prepared Spells column of the Druid Features table. Whenever that number increases, choose additional spells from the Druid spell list until the number of spells on your list matches the number on the table. The chosen spells must be of a level for which you have spell slots. For example, if you're a level 3 Druid, your list of prepared spells can include six spells of levels 1 and 2 in any combination",
        "If another Druid feature gives you spells that you always have prepared, those spells don't count against the number of spells you can prepare with this feature, but those spells otherwise count as Druid spells for you.",
        "Changing Your Prepared Spells : Whenever you finish a Long Rest, you can change your list of prepared spells replacing any of the spells there with other Druid spells for which you have spell slots.",
        "Spellcasting Ability : Wisdom is your spellcasting ability for your Druid Spells",
        "Spellcasting Focus : You can use a Druidic Focus as a Spellcasting Focus for your Druid spells.",
      ]),
    },
    "druidic": {
      name: "Druidic",
      source: [["PHB2024", 80]],
      minlevel: 1,
      languageProfs: ["Druidic"],
      spellcastingBonus: [{
        name: "Druidic",
        spells: ["speak with animals"],
        selection: ["speak with animals"],
        times: 1,
      }],
      description: desc([
        "You know Druidic, the secret language of Druids. While learning this ancient tongue, you also unlocked the magic of communicating with animals, you always have the Speak with Animals spell prepared.",
        "You can use Druidic to leave hidden messages, You and others who know Druidic automatically spot such a message, Others spot the message's presence with a successful DC 15 Intelligence (Investigation) check but cant decipher it without magic.",
      ]),
    },
    "primal order": {
      name: "Primal Order",
      source: [["PHB2024", 80]],
      minlevel: 1,
      choices: ["Magician (Arcana)", "Magician (Nature)", "Warden"],
      "magician (arcana)": {
        name: "Magician (Arcana)",
        spellcastingBonus: [{
          name: "Magician",
          "class": ["druid"],
          level: [0, 0],
          times: 1,
        }],
        addMod: [
          {type: "skill", field: "Arcana", mod: "Wis", text: "I can add my Wisdom modifier to Arcana rolls."},
        ],
        description: "You know one extra cantrip from the Druid spell list. In addition, your mystical connection to nature gives you a bonus to your Intelligence (Arcana) checks. The bonus equals your Wisdom modifier (minimum of +1).",
      },
      "magician (nature)": {
        name: "Magician (Nature)",
        spellcastingBonus: [{
          name: "Magician",
          "class": ["druid"],
          level: [0, 0],
          times: 1,
        }],
        addMod: [
          {type: "skill", field: "Nature", mod: "Wis", text: "I can add my Wisdom modifier to Nature rolls."},
        ],
        description: "You know one extra cantrip from the Druid spell list. In addition, your mystical connection to nature gives you a bonus to your Intelligence (Nature) checks. The bonus equals your Wisdom modifier (minimum of +1).",
      },
      "warden": {
        name: "Warden",
        armorProfs: [false, false, true, false],
        weaponProfs: [false, true],
        description: "Trained for battle, you gain proficiency with Martial weapons and training with Heavy armor."
      },
      description: desc([
        "You have dedicated yourself to one of the following sacred roles of your choice.",
      ]),
    },
    "wild shape": {
      name: "Wild Shape",
      source: [["PHB2024", 80 - 81]],
      minlevel: 2,
      action: ["bonus action", "Wild Shape (Shift/Revert)"],
      usages: [0, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4],
      recovery: "long rest",
      additional: levels.map(function (n) {
        if (n < 2) return "";
        var cr = n < 4 ? "1/4" : n < 8 ? "1/2" : 1;
        var hr = Math.floor(n / 2);
        var restr = n < 8 ? ", no fly" : "";
        return "CR " + cr + restr + "; " + hr + (restr.length ? " h" : " hours");
      }),
      description: desc([
        "The power of nature allows you to assume the form of an animal. As a Bonus Action, you shape-shift into a Beast form that you have learned from this feature (see 'Known Forms' below). You stay in that form for a number of hours equal to half your druid level or until you use Wild Shape again, have the Incapacitated condition, or die. You can also leave the form early as a Bonus Action.",
        "Number of Use : You can use Wild Shape twice. You regain one expended use when you finish a Short Rest, and you regain all expended uses when you finish a Long Rest.",
        "You gain additional uses when you reach certain Druid levels, as shown in the Wild Shapes column of the Druid Features table.",
        "Known Forms : You know four Beast forms for this feature, chosen from among Beast stat blocks that have a maximum Challenge Rating of 1/4 and that lack a Fly Speed (see appendix B for stat block options). The Rat, Riding Horse, Spider, and Wolf are recommended. Whenever you finish a Long Rest you can replace one of your known forms with another eligible form.",
        "When you reach certain Druid levels, your number of known forms and the maximum Challenge Rating for these forms increases, as shown in the Beast Shapes table. In addition, starting at level 8, you can adopt a form that has a Fly Speed.",
        "When choosing known forms you may look in the Monster Manual or elsewhere for eligible Beasts if the Dungeon Master permits you to do so.",
        "Rules While Shape-Shifted : While in a form, you retain your personality, memories, and ability to speak, and the following rules apply.",
        "Temporary Hit Points : When you assume a Wild Shape form, you gain a number of Temporary Hit Points equal to your Druid level.",
        "Game Statistics : Your game statistics are replaced by the Beast's stat block, but you retain your creature type, Hit Points, Hit Point Dice, Intelligence, Wisdom, and Charisma scores, class features, languages, and feats. You also retain your skill and saving throw proficiencies and use your Proficiency Bonus for them. In addition to gaining the proficiencies of the creature. If a skill or saving throw modifier in the Beast's stat block is higher than yours, use the one in the stat block.",
        "No Spellcasting : You can't cast spells, but shape-shifting doesn't break your Concentration or otherwise interfere wit a spell you've already cast.",
        "Objects : Your ability to handle objects is determined by the form's limbs rather than your own. In addition, you choose whether your equipment falls in your space, merges into your new form, or is worn by it. Worn equipment functions as normal, but the DM decides whether it's practical for the new form to wear a piece of equipment based on the creature's size and shape. Your equipment doesn't change size or shape to match the new form, and any equipment that the new form can't wear must either fall to the ground or merge with he form. Equipment that merges with the form has no effect while you're in that form.",
      ]),
    },
    "wild companion": {
      name: "Wild Companion",
      source: [["PHB2024", 81]],
      minlevel: 2,
      spellcastingBonus: [{
        name: "Wild Companion",
        spells: ["find familiar"],
        selection: ["find familiar"],
        times: 1,
      }],
      description: desc([
        "You can summon a nature spirit that assumes an animal form to aid you. As a Magic action, you can expend a spell slot or a use of Wild Shape to cast the Find Familiar spell without Material components.",
        "When you cast the spell in this way, the familiar is Fey and disappears when you finish a Long Rest.",
      ]),
    },
    "subclassfeature3": {
      name: "Druid Subclass",
      source: [["PHB2024", 81]],
      minlevel: 3,
      description: desc([
        "You gain a Druid subclass of your choice. The Circle of the Land, Circle of the Moon, Circle of the Sea, and Circle of the Stars subclasses are detailed after this class's description. A subclass is a specialization that grants you features at certain Druid levels. For the rest of your career, you gain each of your subclass's features that are of your Druid level or lower.",
      ]),
    },
    "wild resurgence": {
      name: "Wild Resurgence",
      source: [["PHB2024", 81]],
      minlevel: 5,
      limfeaname: "Exchange Wild Shape",
      usages: 1,
      recovery: "long rest",
      description: desc([
        "Once on each of your turns, if you have no uses of Wild Shape left, you can give yourself one use by expending a spell slot (no action required).",
        "In addition, you can expend one use of your Wild Shape (no action required) to give yourself a level 1 spell slot, but you can't do so again until you finish a Long Rest.",
      ]),
    },
    "elemental fury": {
      name: "Elemental Fury",
      source: [["PHB2024", 81]],
      minlevel: 7,
      choices: ["Primal Strike", "Potent Spellcasting"],
      "primal strike": {
        name: "Primal Strike",
        description: desc([
          "Once on each of your turns when you hit a creature with an attack roll using a weapon, you can cause the target to take an extra 1d8 Cold, Fire, Lightning, or Thunder damage (choose when you hit).",
        ]),
      },
      "potent spellcasting": {
        name: "Potent Spellcasting",
        calcChanges: {
          atkCalc: [
            function (fields, v, output) {
              if (v.thisWeapon[3] && /\bdruid\b/.test(v.thisWeapon[4]) && SpellsList[v.thisWeapon[3]].level === 0 && /\d/.test(fields.Damage_Die)) {
                output.extraDmg += What('Wis Mod');
              }
            },
            "My druid cantrips get my Wisdom modifier added to their damage."
          ],
          spellAdd: [
            function (spellKey, spellObj, spName) {
              if (spellObj.psionic || spellObj.level !== 0 || spName.indexOf("druid") == -1 || !What("Wis Mod") || Number(What("Wis Mod")) <= 0) return;
              return genericSpellDmgEdit(spellKey, spellObj, "\\w+\\.?", "Wis");
            },
            "My druid cantrips get my Wisdom modifier added to their damage."
          ]
        },
        description: desc([
          "Add your Wisdom modifier to the damage you deal with any Druid cantrip.",
        ]),
      },
      description: desc([
        "The might of the elements flows through you. You gain one of the following options of your choice.",
      ]),
    },
    "improved elemental fury": {
      name: "Improved Elemental Fury",
      source: [["PHB2024", 81]],
      minlevel: 15,
      choices: ["Primal Strike", "Potent Spellcasting"],
      "primal strike": {
        name: "Primal Strike",
        description: desc([
          "The extra damage of your Primal Strikes increases to 2d8",
        ]),
      },
      "potent spellcasting": {
        name: "Potent Spellcasting",
        description: desc([
          "When you cast a Druid cantrip with a range of 10 feet or greater, the spell's range increases by 300 feet.",
        ]),
      },
      description: desc([
        "The option you chose for Elemental Fury grow more powerful.",
      ]),
    },
    "beast spells": {
      name: "Beast Spells",
      source: [["PHB2024", 81]],
      minlevel: 18,
      description: desc([
        "While using Wild Shape, you can cast spells in Beast form, except any spell that has a Material component with a cost specified or that consumes its Material component.",
      ]),
    },
    "epic boon": {
      name: "Epic Boon",
      source: [["PHB2024", 71]],
      minlevel: 19,
      description: desc([
        "You gain an Epic Boon feat (see chapter 5) or another feat of your choice for which you qualify. Boon of Dimensional Travel is recommended.",
      ]),
    },
    "archdruid": {
      name: "Archdruid",
      source: [["PHB2024", 82]],
      minlevel: 20,
      limfeaname: "Nature Magician",
      usages: 1,
      recovery: "long rest",
      description: desc([
        "The vitality of nature constantly blossoms within you, granting you the following benefits.",
        "Evergreen Wild Shape : Whenever you roll Initiative and have no uses of Wild Shape left, you regain one expended use of it.",
        "Nature Magician : You can convert use of Wild Shape into a spell slot (no action required). Choose a number o your unexpended uses of Wild Shape and convert them into a single spell slot, with each use contributing 2 spell levels. For example, if you convert two uses of Wild Shape, you produce a level 4 spell slot. Once you use this benefit, you can't do so again until you finish a Long Rest.",
        "Longevity : The primal magic that you wield causes you to age more slowly. For every ten years that pass, your body ages only one year.",
      ]),
    },
  },
});
legacySubClassRefactor("druid", "land", {
  regExpSearch: /^(?=.*(druid))(?=.*(land)).*$/i,
  subname: "Circle of the Land",
  source: [["PHB2024", 84]],
  replaces: "circle of the land",
  features: {
    "subclassfeature3": {
      name: "Circle of the Land Spells",
      source: [["PHB2024", 84 - 85]],
      minlevel: 3,
      choices: ["Arid Land", "Polar Land", "Temperate Land", "Tropical Land"],
      "arid land": {
        name: "Arid Land",
        spellcastingExtra: ["blur", "burning hands", "fire bolt", "fireball", "blight", "wall of stone"],
        description: desc([
          "Whenever you finish a Long Rest, choose one type of land; arid, polar, temperate, or tropical. Consult the table below that corresponds to the chosen type, you have the spells listed for your Druid level and lower prepared.",
        ]),
      },
      "polar land": {
        name: "Polar Land",
        spellcastingExtra: ["fog cloud", "hold person", "ray of frost", "sleet storm", "ice storm", "cone of cold"],
        description: desc([
          "Whenever you finish a Long Rest, choose one type of land; arid, polar, temperate, or tropical. Consult the table below that corresponds to the chosen type, you have the spells listed for your Druid level and lower prepared.",
        ]),
      },
      "temperate land": {
        name: "Temperate Land",
        spellcastingExtra: ["misty step", "shocking grasp", "sleep", "lightning bolt", "freedom of movement", "tree stride"],
        description: desc([
          "Whenever you finish a Long Rest, choose one type of land; arid, polar, temperate, or tropical. Consult the table below that corresponds to the chosen type, you have the spells listed for your Druid level and lower prepared.",
        ]),
      },
      "tropical land": {
        name: "Tropical Land",
        spellcastingExtra: ["acid splash", "ray of sickness", "web", "stinking cloud", "polymorph", "insect plague"],
        description: desc([
          "Whenever you finish a Long Rest, choose one type of land; arid, polar, temperate, or tropical. Consult the table below that corresponds to the chosen type, you have the spells listed for your Druid level and lower prepared.",
        ]),
      },
      description: desc([
        "Whenever you finish a Long Rest, choose one type of land; arid, polar, temperate, or tropical. Consult the table below that corresponds to the chosen type, you have the spells listed for your Druid level and lower prepared.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Land's Aid",
      source: [["PHB2024", 85]],
      minlevel: 3,
      action: "action",
      description: desc([
        "As a Magic action, you can expend a use of your Wild Shape and choose a point within 60 feet of yourself. Vitality giving flowers and life-draining thorns appear for a moment in a 10-foot radius Sphere centered on that point. Each creature of your choice in the Sphere must make a Constitution saving throw against your spell save DC, taking 2d6 Necrotic damage on a failed save or half as much damage on a successful one. One creature of your choice in that area regains 2d6 Hit Points.",
        "The damage and Healing increases by 1d6 when you reach Druid levels 10 (3d6) and 14 (4d6).",
      ]),
    },
    "subclassfeature6": {
      name: "Natural Recovery",
      source: [["PHB2024", 85]],
      minlevel: 6,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "You can cast one of the level 1+ spells that you have prepared from your circle spells feature without expending a spell slot, and you must finish a Long Rest before you do so again.",
        "In addition, when you finish a Short Rest, you can expended spell slots to recover. The spell slots can have a combined level that is equal to or less than half your Druid level (round up), and none of them ca be level 6+. For example, if you're a level 6 Druid, you can recover up to three levels worth of spell slots. You can recover a level 3 spell slot, a level 2 and a level 1 spell slot, or three level 1 spell slots. Once you recover spell slots with this feature, you can't do so again until you finish a Long Rest.",
      ]),
    },
    "subclassfeature10": {
      name: "Nature's Ward",
      source: [["PHB2024", 85]],
      minlevel: 10,
      savetxt: {
        immune: ["Poisoned condition"],
      },
      choices: ["Arid Land", "Polar Land", "Temperate Land", "Tropical Land"],
      "arid land": {
        name: "Arid Land",
        dmgres: "Fire",
        description: desc([
          "You are immune to the Poisoned condition, and you have Resistance to a damage type associated with your current land choice in the Circle Spells feature, as shown in the Nature's Ward table.[Fire]",
        ]),
      },
      "polar land": {
        name: "Polar Land",
        dmgres: "Cold",
        description: desc([
          "You are immune to the Poisoned condition, and you have Resistance to a damage type associated with your current land choice in the Circle Spells feature, as shown in the Nature's Ward table.[Cold]",
        ]),
      },
      "temperate land": {
        name: "Temperate Land",
        dmgres: "Lightning",
        description: desc([
          "You are immune to the Poisoned condition, and you have Resistance to a damage type associated with your current land choice in the Circle Spells feature, as shown in the Nature's Ward table.[Lightning]",
        ]),
      },
      "tropical land": {
        name: "Tropical Land",
        dmgres: "Poison",
        description: desc([
          "You are immune to the Poisoned condition, and you have Resistance to a damage type associated with your current land choice in the Circle Spells feature, as shown in the Nature's Ward table.[Poison]",
        ]),
      },
      description: desc([
        "You are immune to the Poisoned condition, and you have Resistance to a damage type associated with your current land choice in the Circle Spells feature, as shown in the Nature's Ward table.",
      ]),
    },
    "subclassfeature14": {
      name: "Nature's Sanctuary",
      source: [["PHB2024", 86]],
      minlevel: 14,
      action: [["action", "Summon Sanctuary"], ["bonus action", "Move Sanctuary"]],
      description: desc([
        "As a Magic action, you can expend a use of your Wild Shape and cause spectral trees and vines to appear in a 15-foo Cube on the ground within 120 feet of yourself. They last for 1 minute or until you have the Incapacitated condition or die. You and your allies have Half Cover while in that area and your allies gain the current Resistance of your Nature's Ward while there.",
        "As a Bonus Action, you can move the Cube up to 60 feet to ground within 120 feet of yourself.",
      ]),
    },
  },
});
legacySubClassRefactor("druid", "moon", {
  regExpSearch: /^(?=.*(druid))(?=.*(moon)).*$/i,
  subname: "Circle of the Moon",
  source: [["PHB2024", 86]],
  replaces: "circle of the moon",
  spellcastingExtra: ["cure wounds", "moonbeam", "starry wisp", "conjure animals", "fount of moonlight", "mass cure wounds"],
  features: {
    "subclassfeature3": {
      name: "Circle Forms",
      source: [["PHB2024", 86]],
      minlevel: 3,
      description: desc([
        "You can channel lunar magic when you assume a Wild Shape form, granting you the benefits below",
        "Challenge Rating : The maximum Challenge Rating for the forms equals your Druid level divined by 3 (round down).",
        "Armor Class : Until you leave the form, your AC equals 13 plus your Wisdom modifier if that total is higher than the Beast's AC.",
        "Temporary Hit Points : You gain a number of Temporary Hit Points equal to three times your Druid level.",
      ]),
    },
    "subclassfeature6": {
      name: "Improved Circle Forms",
      source: [["PHB2024", 87]],
      minlevel: 6,
      description: desc([
        "While in a Wild Shape form, you gain the following benefits.",
        "Lunar Radiance : Each of your attacks in a Wild Shape form can deal its normal damage type or Radiance. You make this choice each time you hit with those attacks.",
        "Increased Toughness : You can add your Wisdom modifier to your Constitution saving throws.",
      ]),
    },
    "subclassfeature10": {
      name: "Moonlight Step",
      source: [["PHB2024", 87]],
      minlevel: 10,
      usages: "Wisdom modifier per ",
      usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
      recovery: "long rest",
      description: desc([
        "You magically transport yourself, reappearing amid a burst of moonlight. As a Bonus Action, you teleport up to 30 feet to an unoccupied space you can see, and you have Advantage on the next attack roll you make before the end of this turn.",
        "You can use this feature a number of times equal to your Wisdom modifier (minimum of once), and you regain all expended uses when you finish a Long Rest. You can also regain uses by expending a level 2+ spell slot for each use you want to restore (no action required).",
      ]),
    },
    "subclassfeature14": {
      name: "Lunar Form",
      source: [["PHB2024", 87]],
      minlevel: 14,
      description: desc([
        "The power of the moon suffuses you, granting you the following benefits.",
        "Improved Lunar Radiance : Once per turn, you can deal an extra 2d10 Radiant damage to a target you hit with a Wild Shape form's attack.",
        "Shared Moonlight : Whenever you use Moonlight Step, you can also teleport one willing creature. That creature must be within 10 feet of you, and you teleport it to an unoccupied space you can see within 10 feet of your destination space."
      ]),
    },
  },
});
legacySubClassRefactor("druid", "sea", {
  regExpSearch: /^(?=.*(druid))(?=.*(sea)).*$/i,
  subname: "Circle of the Sea",
  source: [["PHB2024", 87]],
  replaces: "circle of the sea",
  spellcastingExtra: ["fog cloud", "gust of wind", "ray of frost", "shatter", "thunderwave", "lightning bolt", "water breathing", "control water", "ice storm", "conjure elemental", "hold monster"],
  features: {
    "subclassfeature3": {
      name: "Wrath of the Sea",
      source: [["PHB2024", 87]],
      minlevel: 3,
      action: "bonus action",
      description: desc([
        "As a Bonus Action, you can expend a use of your Wild Shape to manifest a 5-foot Emanation that takes the form of ocean spray that surrounds you for 10 minutes. It ends early if you dismiss it (no action required). manifest it again, or have the Incapacitated condition.",
        "When you manifest the Emanation and as a Bonus Action on your subsequent turns, you can choose another creature you can see in the Emanation. The target must succeed on a Constitution saving throw against your spell save DC or take Cold damage and if the creature is Large or smaller, be pushed up to 15 feet way from you. To determine this damage roll a number of d6s equal to your Wisdom modifier (minimum of one die).",
      ]),
    },
    "subclassfeature6": {
      name: "Aquatic Affinity",
      source: [["PHB2024", 87]],
      minlevel: 6,
      speed: {swim: {spd: "walk", enc: "walk"}},
      description: desc([
        "The size of the Emanation created by your Wrath of the Sea increases to 10 feet.",
        "In addition, you gain a Swim Speed equal to your Speed.",
      ]),
    },
    "subclassfeature10": {
      name: "Stormborn",
      source: [["PHB2024", 87]],
      minlevel: 10,
      description: desc([
        "Your Wrath of the Sea confers two more benefits while active, as detailed below.",
        "Flight : You gain a Fly Speed equal to your Speed",
        "Resistance : You have Resistance to Cold, Lightning, and Thunder damage.",
      ]),
    },
    "subclassfeature14": {
      name: "Oceanic Gift",
      source: [["PHB2024", 88]],
      minlevel: 14,
      description: desc([
        "Instead of manifesting the Emanation of Wrath of the Sea around yourself, you can manifest it around one willing creature within 60 feet of yourself. That creature gains all benefits of the Emanation and uses your spell save DC and Wisdom modifier for it.",
        "In addition, you can manifest the Emanation around both the other creature and yourself if you expend two uses of your Wild Shape instead of one when manifesting it.",
      ]),
    },
  },
});
legacySubClassRefactor("druid", "stars", {
  regExpSearch: /^(?=.*(druid))(?=.*(stars)).*$/i,
  subname: "Circle of Stars",
  source: [["PHB2024", 88]],
  replaces: "circle of the stars",
  features: {
    "subclassfeature3": {
      name: "Star Map",
      source: [["PHB2024", 88]],
      minlevel: 3,
      description: desc([
        "You've created a star chart as part of your heavenly studies. It is a Tiny object, and you can use it as a Spellcasting Focus for your Druid spells. You determine its form by rolling on the Star Map table or by choosing one.",
        "When holding the map, you have the Guidance and Guiding Bolt spells prepared, and you can cast Guiding Bolt without expending a spell slot. You can cast it in that way a number of times equal to your Wisdom modifier (minimum of once), and you regain all expended uses when you finish a Long Rest.",
        "If you lose the map, you can perform a 1-hour ceremony to magically create a replacement. This ceremony can be performed during a Short or Long Rest, and it destroys the previous map.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Starry Form",
      source: [["PHB2024", 88 - 89]],
      minlevel: 3,
      toNotesPage: [{
        name: "Starry Forms",
        note: [
          "Archer : A constellation of an archer appears on you. When you activate this form and as a Bonus Action on your subsequent turns while it lasts, you can make a ranged spell attack, hurling a luminous arrow that targets one creature within 60 feet of yourself. On a hit, the attack deals Radiant damage equal to 1d8 plus your Wisdom modifier.",
          "Chalice : A constellation of a life-giving goblet appears on you. Whenever you cast a spell using a spell slot that restores Hit Points to a creature, you or another creature within 30 feet of you can regain Hit Points equal to 1d8 plus your Wisdom modifier.",
          "Dragon : A constellation of a wise dragon appears on you. When you make an Intelligence or a Wisdom check or a Constitution saving throw to maintain Concentration, you can treat a roll of 9 or lower on the d20 as a 10.",
        ],
      }],
      description: desc([
        "As a Bonus Action, you can expend a use of your Wild Shape feature to take on a starry form rather than shape-shifting.",
        "While in your starry form, you retain your game statistics, but your body becomes luminous, your joints glimmer like stars, and glowing lines connect them as on a star chart. This form sheds Bright Light in a 10-foot radius and Dim Light in an additional 10 feet. This form lasts for 10 minutes. It ends earlier if you dismiss it (no action required), have the Incapacitated condition, or use this feature again.",
        "Whenever you assume your starry form, choose which of the following constellations glimmer on your body, your choice gives you certain benefits while in this form.",
      ]),
    },
    "subclassfeature6": {
      name: "Cosmic Omen",
      source: [["PHB2024", 89]],
      minlevel: 6,
      description: desc([
        "Whenever you finish a Long Rest, you can consult your Star Map for omens and roll a die. Until you finish your next Long Rest, you gain access to a special Reaction based on whether you roll an even or an odd number on the die.",
        "Weal (Even) : Whenever a creature you can see within 30 feet of you is about to make a D20 Test, you can take a Reaction to roll 1d6 and add the number rolled to the total.",
        "Woe (Odd) : Whenever a creature you can see within 30 feet of you is about to make a D20 Test, you can take a Reaction to roll 1d6 and subtract the number rolled from the total.",
        "You can use this Reaction a number of times equal to your Wisdom modifier (minimum of once), and you regain all expended uses when you finish a Long Rest.",
      ]),
    },
    "subclassfeature10": {
      name: "Twinkling Constellations",
      source: [["PHB2024", 89]],
      minlevel: 10,
      description: desc([
        "The constellations of your Starry Form improve. The 1d8 of the Archer and the Chalice becomes 2d8, and while the dragon is active, you have a Fly speed of 20 feet and can hover.",
        "Moreover, at the start of each of your turns while in your Starry Form, you can change which constellation glimmers on your body.",
      ]),
    },
    "subclassfeature14": {
      name: "Full of Stars",
      source: [["PHB2024", 89]],
      minlevel: 14,
      dmgres: ["Bludgeoning", "Piercing", "Slashing"],
      description: desc([
        "While in your Starry Form, you become partially incorporeal, giving you Resistance to Bludgeoning, Piercing, and Slashing damage.",
      ]),
    },
  },
});
legacyClassRefactor("fighter", {
  regExpSearch: /fighter/i,
  name: "Fighter",
  source: [["PHB2024", 91]],
  primaryAbility: "Strength or Dexterity",
  prereqs: "Strength 13 or Dexterity 13",
  improvements: [0, 0, 0, 1, 1, 2, 2, 3, 3, 3, 3, 4, 4, 5, 5, 6, 6, 6, 7, 7],
  die: 10,
  saves: ["Str", "Con"],
  skillstxt: {
    primary: "Choose 2: Acrobatics, Animal Handling, Athletics, History, Insight, Intimidation, Persuasion, Perception, or Survival",
  },
  armorProfs: {
    primary: [true, true, true, true],
    secondary: [true, true, false, true],
  },
  weaponProfs: {
    primary: [true, true],
    secondary: [false, true],
  },
  equipment: "Fighter starting equipment:" +
    "\n \u2022 (a) Chain Mail -or- (b) Studded Leather Armor;" +
    "\n \u2022 (a) Greatsword -or- (b) Scimitar;" +
    "\n \u2022 (a) Flail -or- (b) Shortsword;" +
    "\n \u2022 (a) 8 Javelins -or- (b) Longbow and Quiver of 20 Arrows;" +
    "\n \u2022 (a) Dungeoneer's Pack, and 4 gp -or- (b) Dungeoneer's Pack, and 11 gp;" +
    "\n\nAlternatively, choose 155 gp worth of starting equipment instead of the class's starting equipment.",
  subclasses: ["Fighter Subclass", []],
  attacks: [1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4],
  features: {
    "fighting style": {
      name: "Fighting Style",
      source: [["PHB2024", 91]],
      minlevel: 1,
      description: desc([
        "You have honed your martial prowess and gain a Fighting Style feat of your choice (see chapter 5). Defense is recommended.",
        "Whenever you gain a Fighter level, you can replace the feat you chose with a different Fighting Style feat.",
      ]),
      choices: ["Fighting Style"],
      "fighting style": {
        name: "Fighting Style",
        eval: function () {
          AddString('Feat Note 2', 'Fighting Style feat', '; ');
        },
        removeeval: function () {
          RemoveString('Feat Note 2', 'Fighting Style feat');
        },
        description: desc([
          "you gain a fighting style feat of your choice (see chapter 5 for feats).",
        ]),
      },
    },
    "second wind": {
      name: "Second Wind",
      source: [["PHB2024", 91]],
      minlevel: 1,
      usages: [2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
      recovery: "long rest",
      description: desc([
        "You have a limited well of physical and mental stamina that you can draw on. As a Bonus Action, you can use it to regain Hit Points equal to 1d10 plus your Fighter level.",
        "You can use this feature twice. You regain one expended use when you finish a Short Rest, and you regain all expended uses when you finish a Long Rest.",
        "When you reach certain Fighter levels, you gain more uses of this feature, as shown in the Second Wind column of the Fighter Features table.",
      ]),
    },
    "weapon mastery": {
      name: "Weapon Mastery",
      source: [["PHB2024", 52]],
      minlevel: 1,
      description: desc([
        "Your training with weapons allows you to use the mastery properties of three kinds of Simple or Martial Melee weapons of your choice. Whenever you finish a Long Rest, you can practice weapon drills and change one of those weapon choices.",
        "When you reach certain Fighter levels, you gain the ability to use the mastery properties of more kinds of weapons, as shown in the Weapon Mastery column of the Fighter Features table.",
      ]),
      additional: ["3 Weapon Masteries", "3 Weapon Masteries", "3 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "4 Weapon Masteries", "5 Weapon Masteries", "5 Weapon Masteries", "5 Weapon Masteries", "5 Weapon Masteries", "5 Weapon Masteries", "5 Weapon Masteries", "6 Weapon Masteries", "6 Weapon Masteries", "6 Weapon Masteries", "6 Weapon Masteries", "6 Weapon Masteries"],
      extraname: "Weapon Mastery",
      extrachoices: ["Club", "Dagger", "Greatclub", "Handaxe", "Javelin", "Light Hammer", "Mace", "Quarterstaff", "Sickle", "Spear", "Dart", "Light Crossbow", "Shortbow", "Sling", "Battleaxe", "Flail", "Glaive", "Greataxe", "Greatsword", "Halberd", "Lance", "Longsword", "Maul", "Morningstar", "Pike", "Rapier", "Scimitar", "Shortsword", "Trident", "Warhammer", "War Pick", "Whip", "Blowgun", "Hand Crossbow", "Heavy Crossbow", "Longbow", "Musket", "pistol"],
      extraTimes: [3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6],
      "club": {
        name: "Club",
        description: desc([
          "You gain access to the Club's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "dagger": {
        name: "Dagger",
        description: desc([
          "You gain access to the Dagger's 'Nick' Mastery feature",
          "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
        ]),
      },
      "greatclub": {
        name: "Greatclub",
        description: desc([
          "You gain access to the Greatclub's 'Push' Mastery feature",
          "Push : If you hit a creature with this weapon, you can push the creature up to 10 feet straight away from yourself if it is Large or smaller.",
        ]),
      },
      "handaxe": {
        name: "Handaxe",
        description: desc([
          "You gain access to the Handaxe's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "javelin": {
        name: "Javelin",
        description: desc([
          "You gain access to the Javelin's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "light hammer": {
        name: "Light Hammer",
        description: desc([
          "You gain access to the Light Hammer's 'Nick' Mastery feature",
          "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
        ]),
      },
      "mace": {
        name: "Mace",
        description: desc([
          "You gain access to the Mace's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "quarterstaff": {
        name: "Quarterstaff",
        description: desc([
          "You gain access to the Quarterstaff's 'Topple' Mastery feature",
          "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        ]),
      },
      "sickle": {
        name: "Sickle",
        description: desc([
          "You gain access to the Sickle's 'Nick' Mastery feature",
          "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
        ]),
      },
      "spear": {
        name: "Spear",
        description: desc([
          "You gain access to the Spear's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "dart": {
        name: "Dart",
        description: desc([
          "You gain access to the Dart's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "light crossbow": {
        name: "Light Crossbow",
        description: desc([
          "You gain access to the Light Crossbow's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "shortbow": {
        name: "Shortbow",
        description: desc([
          "You gain access to the Shortbow's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "sling": {
        name: "Sling",
        description: desc([
          "You gain access to the Sling's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "battleaxe": {
        name: "Battleaxe",
        description: desc([
          "You gain access to the Battleaxe's 'Topple' Mastery feature",
          "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        ]),
      },
      "flail": {
        name: "Flail",
        description: desc([
          "You gain access to the Flail's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "glaive": {
        name: "Glaive",
        description: desc([
          "You gain access to the Glaive's 'Graze' Mastery feature",
          "Graze : If your attack roll with this weapon misses a creature, you can deal damage to that creature equal to the ability modifier you used to make the attack roll. This damage is the same type dealt by the weapon, and the damage can be increased only by increasing the ability modifier.",
        ]),
      },
      "greataxe": {
        name: "Greataxe",
        description: desc([
          "You gain access to the Greataxe's 'Cleave' Mastery feature",
          "Cleave : If you hit a creature with a melee attack roll using this weapon, you can make a melee attack roll with the weapon against a second creature within 5 feet of the first that is also within your reach. On a hit the second creature takes the weapon's damage, but don't add your ability modifier to that damage unless the modifier is negative. You can make this extra attack only once per turn.",
        ]),
      },
      "greatsword": {
        name: "Greatsword",
        description: desc([
          "You gain access to the Greatsword's 'Graze' Mastery feature",
          "Graze : If your attack roll with this weapon misses a creature, you can deal damage to that creature equal to the ability modifier you used to make the attack roll. This damage is the same type dealt by the weapon, and the damage can be increased only by increasing the ability modifier.",
        ]),
      },
      "halberd": {
        name: "Halberd",
        description: desc([
          "You gain access to the Halberd's 'Cleave' Mastery feature",
          "Cleave : If you hit a creature with a melee attack roll using this weapon, you can make a melee attack roll with the weapon against a second creature within 5 feet of the first that is also within your reach. On a hit the second creature takes the weapon's damage, but don't add your ability modifier to that damage unless the modifier is negative. You can make this extra attack only once per turn.",
        ]),
      },
      "lance": {
        name: "Lance",
        description: desc([
          "You gain access to the Lance's 'Topple' Mastery feature",
          "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        ]),
      },
      "longsword": {
        name: "Longsword",
        description: desc([
          "You gain access to the Longsword's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "maul": {
        name: "Maul",
        description: desc([
          "You gain access to the Maul's 'Topple' Mastery feature",
          "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        ]),
      },
      "morningstar": {
        name: "Morningstar",
        description: desc([
          "You gain access to the Morningstar's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "pike": {
        name: "Pike",
        description: desc([
          "You gain access to the Pike's 'Push' Mastery feature",
          "Push : If you hit a creature with this weapon, you can push the creature up to 10 feet straight away from yourself if it is Large or smaller.",
        ]),
      },
      "rapier": {
        name: "Rapier",
        description: desc([
          "You gain access to the Rapier's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "scimitar": {
        name: "Scimitar",
        description: desc([
          "You gain access to the Scimitar's 'Nick' Mastery feature",
          "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
        ]),
      },
      "shortsword": {
        name: "Shortsword",
        description: desc([
          "You gain access to the Shortsword's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "trident": {
        name: "Trident",
        description: desc([
          "You gain access to the Trident's 'Topple' Mastery feature",
          "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        ]),
      },
      "warhammer": {
        name: "Warhammer",
        description: desc([
          "You gain access to the Warhammer's 'Push' Mastery feature",
          "Push : If you hit a creature with this weapon, you can push the creature up to 10 feet straight away from yourself if it is Large or smaller.",
        ]),
      },
      "war pick": {
        name: "War Pick",
        description: desc([
          "You gain access to the War Pick's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "whip": {
        name: "Whip",
        description: desc([
          "You gain access to the Whip's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "blowgun": {
        name: "Blowgun",
        description: desc([
          "You gain access to the Blowgun's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "hand crossbow": {
        name: "Hand Crossbow",
        description: desc([
          "You gain access to the Hand Crossbow's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "heavy crossbow": {
        name: "Heavy Crossbow",
        description: desc([
          "You gain access to the Heavy Crossbow's 'Push' Mastery feature",
          "Push : If you hit a creature with this weapon, you can push the creature up to 10 feet straight away from yourself if it is Large or smaller.",
        ]),
      },
      "longbow": {
        name: "Longbow",
        description: desc([
          "You gain access to the Longbow's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "musket": {
        name: "Musket",
        description: desc([
          "You gain access to the Musket's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "pistol": {
        name: "Pistol",
        description: desc([
          "You gain access to the Pistol's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
    },
    "action surge": {
      name: "Action Surge",
      source: [["PHB2024", 91]],
      minlevel: 2,
      usages: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2],
      description: desc([
        "You can push yourself beyond your normal limits for a moment. On your turn, you can take one additional action, except the Magic action.",
        "Once you use this feature, you can't do so again until finish a Short or Long Rest. Starting at level 17, you can use it twice before a rest but only once per turn.",
      ]),
    },
    "tactical mind": {
      name: "Tactical Mind",
      source: [["PHB2024", 91]],
      minlevel: 2,
      description: desc([
        "You have a mind for tactics on and off the battlefield. When you fail an ability check, you can expend a use of your Second Wind to push yourself toward success. Rather than regaining Hit Points, you roll 1d10 and add the number rolled to the ability check, potentially turning it into a success. If the check still fails, this use of Second Wind isn't expended.",
      ]),
    },
    "subclassfeature3": {
      name: "Fighter Subclass",
      source: [["PHB2024", 92]],
      minlevel: 3,
      description: desc([
        "You gain a Fighter subclass of your choice. The Battle Master, Champion, Eldritch Knight, and Psi Warrior subclasses are detailed after this class's description. A subclass is a specialization that grants you features at certain Fighter levels. For the rest of your career, you gain each of your subclass's features that are of your Fighter level or lower.",
      ]),
    },
    "extra attack": {
      name: "Extra Attack",
      source: [["PHB2024", 53]],
      minlevel: 5,
      description: desc([
        "You can attack twice instead of once whenever you take the Attack Action on your Turn.",
      ]),
    },
    "tactical shift": {
      name: "Tactical Shift",
      source: [["PHB2024", 92]],
      minlevel: 5,
      description: desc([
        "Whenever you activate your Second Wind with a Bonus Action, you can move up to half your Speed without provoking Opportunity Attacks.",
      ]),
    },
    "indomitable": {
      name: "Indomitable",
      source: [["PHB2024", 92]],
      minlevel: 9,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "If you fail a saving throw, you can reroll it with a bonus equal to your Fighter level. You must use the new roll, and you can't use this feature again until you finish a Long Rest.",
      ]),
    },
    "tactical master": {
      name: "Tactical Master",
      source: [["PHB2024", 92]],
      minlevel: 9,
      description: desc([
        "When you attack with a weapon whose mastery property you can use, you can replace that property with the Push, Sap, or Slow property for that attack.",
      ]),
    },
    "two extra attack": {
      name: "Two Extra Attack",
      source: [["PHB2024", 92]],
      minlevel: 11,
      description: desc([
        "You can attack three times instead of once whenever you take the Attack action on your turn.",
      ]),
    },
    "studied attacks": {
      name: "Studied Attacks",
      source: [["PHB2024", 92]],
      minlevel: 13,
      description: desc([
        "You study your opponents and learn from each attack you make. If you make an attack roll against a creature and miss, you have Advantage on your next attack roll against that creature before the end of your turn.",
      ]),
    },
    "epic boon": {
      name: "Epic Boon",
      source: [["PHB2024", 92]],
      minlevel: 19,
      description: desc([
        "You gain an Epic Boon feat (see chapter 5) or another feat of your choice for which you qualify. Boon of Combat Prowess is recommended.",
      ]),
    },
    "three extra attacks": {
      name: "Three Extra Attacks",
      source: [["PHB2024", 92]],
      minlevel: 20,
      description: desc([
        "You can attack four times instead of once whenever you take the Attack action on your turn.",
      ]),
    },
  },
});
legacySubClassRefactor("fighter", "battle master", {
  regExpSearch: /^(?=.*(fighter))(?=.*(battle))(?=.*(master)).*$/i,
  subname: "Battle Master",
  source: [["PHB2024", 93]],
  features: {
    "subclassfeature3": {
      name: "Combat Superiority",
      source: [["PHB2024", 93]],
      minlevel: 3,
      additional: ["", "", "d8", "d8", "d8", "d8", "d8", "d8", "d8", "d10", "d10", "d10", "d10", "d10", "d10", "d10", "d10", "d12", "d12", "d12"],
      usages: [0, 0, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6],
      recovery: "short rest",
      description: desc([
        "Your experience on the battlefield has refined your fighting techniques. You learn maneuvers that are fueled by special dice called Superiority Dice.",
        "Maneuvers : You learn three maneuvers of your choice from the 'Maneuver Options' section later in this subclass's description. Many maneuvers enhance an attack in some way. You can use only one maneuver per attack.",
        "You learn two additional maneuvers of your choice when you reach Fighter levels 7, 10, and 15. Each time you learn new maneuvers, you can also replace one maneuver you know with a different one.",
        "Superiority Dice : You have four Superiority Dice, which are d8s. A Superiority Die is expended when you use it. You gain all expended Superiority Dice when you finish a Short or Long Rest.",
        "You gain an additional Superiority Die when you reach Fighter levels 7 (five dice total) and 15 (six dice total).",
        "Saving Throws : If a maneuver requires a saving throw, the DC equals 8 plus your Strength or Dexterity modifier (your choice) and Proficiency Bonus",
      ]),
      extraname: "Maneuver Options",
      extrachoices: ["Ambush", "Bait and Switch", "Commander's Strike", "Commanding Presence", "Disarming Attack", "Distracting Strike", "Evasive Footwork", "Feinting Attack", "Goading Attack", "Lunging Attack", "Maneuvering Attack", "Menacing Attack", "Parry", "Precision Attack", "Pushing Attack", "Rally", "Riposte", "Sweeping Attack", "Tactical Assessment", "Trip Attack",],
      extraTimes: [3, 3, 3, 3, 3, 3, 5, 5, 5, 7, 7, 7, 7, 7, 9, 9, 9, 9, 9, 9],
      "ambush": {
        name: "Ambush",
        description: desc([
          "When you make a Dexterity (Stealth) check or an Initiative roll, you can expend one Superiority Die and add the die to the roll, unless you have the Incapacitated condition.",
        ]),
      },
      "bait and switch": {
        name: "Bait and Switch",
        description: desc([
          "When you're within 5 feet of a creature on your turn, you can expend one Superiority Die and switch places with that creature, provided you spend at least 5 feet of movement and the creature is willing and doesn't have the Incapacitated condition. This movement doesn't provoke Opportunity Attacks.",
          "Roll the Superiority Die. Until the Start of your next turn, you or the other creature (your choice) gains a bonus to AC equal to the number rolled.",
        ]),
      },
      "commander's strike": {
        name: "Commander's Strike",
        description: desc([
          "When you take the Attack action on your turn, you can replace one of your attacks to direct one of your companions to strike. When you do so, choose a willing creature who can see or hear you and expend one Superiority Die. That creature can immediately use its Reaction to make one attack with a weapon or an Unarmed Strike, adding the Superiority Die to the attack's damage roll on a hit.",
        ]),
      },
      "commanding presence": {
        name: "commanding presence",
        description: desc([
          "When you make a Charisma (Intimidation, Performance, or Persuasion) check, you can expend one Superiority Die and add that die to the roll.",
        ]),
      },
      "disarming attack": {
        name: "Disarming Attack",
        description: desc([
          "When you hit a creature with an attack roll, you can expend one Superiority Die to attempt to disarm the target. Add the Superiority Die roll to the attack's damage roll. The target must succeed on a Strength saving throw or drop one object of your choice that it's holding with the object landing in its space.",
        ]),
      },
      "distracting strike": {
        name: "Distracting Strike",
        description: desc([
          "When you hit a creature with an attack roll, you can expend one Superiority Die to distract the target. Add the Superiority Die roll to the attack's damage roll. The next attack roll to against the target by an attacker other than you has Advantage if the attack is made before the start of your next turn.",
        ]),
      },
      "evasive footwork": {
        name: "evasive footwork",
        description: desc([
          "As a Bonus Action, you can expend one Superiority Die and take the Disengage action. You also roll the die and add the number rolled to your AC until the start of your next turn.",
        ]),
      },
      "feinting attack": {
        name: "Feinting Attack",
        description: desc([
          "As a Bonus Action, you can expend one Superiority Die to feint, choosing one creature within 5 feet of yourself as your target. You have Advantage on your next attack roll against that target this turn. If that attack hits, add the Superiority Die to the attack's damage roll.",
        ]),
      },
      "goading attack": {
        name: "Goading Attack",
        description: desc([
          "When you hit a creature with an attack roll, you can expend one Superiority Die to attempt to goad the target into attacking you. Add the Superiority Die to the attack's damage roll. The target must succeed on a Wisdom saving throw or have Disadvantage on attack rolls against the targets other than you until the end of your next turn.",
        ]),
      },
      "lunging attack": {
        name: "Lunging Attack",
        description: desc([
          "As a Bonus Action, you can expend one Superiority Die and take the Dash action. If you move at least 5 feet in a straight line immediately before hitting with a melee attack as part of the Attack action on this turn, you can add the Superiority Die to the attack's damage roll.",
        ]),
      },
      "maneuvering attack": {
        name: "Maneuvering Attack",
        description: desc([
          "When you hit a creature with an attack roll, you can expend one Superiority Die to maneuver one of your comrades into another position. Add the Superiority Die roll to the attack's damage roll, and choose a willing creature who can see or hear you. That creature can use its Reaction o move up to half its Speed without provoking an Opportunity Attack from the target of your attack.",
        ]),
      },
      "menacing attack": {
        name: "Menacing Attack",
        description: desc([
          "When you hit a creature with an attack roll, you can expend one Superiority Die to attempt to frighten the target. Add the Superiority Due to the attack's damage roll. The target must succeed on a Wisdom saving throw or have the Frightened condition until the end of your next turn.",
        ]),
      },
      "parry": {
        name: "Parry",
        description: desc([
          "When another creature damages you with a melee attack roll, you can take a Reaction and expend one Superiority Die to reduce the damage by the number you roll on your Superiority Die plus you Strength or Dexterity modifier (your choice).",
        ]),
      },
      "precision attack": {
        name: "Precision Attack",
        description: desc([
          "When you miss with an attack roll, you can expend one Superiority Die, roll that die, and add it to the attack roll, potentially causing the attack to hit.",
        ]),
      },
      "pushing attack": {
        name: "Pushing Attack",
        description: desc([
          "When you hit a creature with an attack roll using a weapon or an Unarmed Strike, you can expend one Superiority Die to attempt to drive the target back. Add the Superiority Die to the attack's damage roll. If the target is Large or smaller, it must succeed on a Strength saving throw or be pushed up to 15 feet directly away from you.",
        ]),
      },
      "rally": {
        name: "Rally",
        description: desc([
          "As a Bonus Action, you can expend one Superiority Die to bolster the resolve of a companion. Choose an ally of yours within 30 feet of yourself who can see or hear you. That creature gains Temporary Hit Points equal to the Superiority Die roll plus half your Fighter level (round down).",
        ]),
      },
      "riposte": {
        name: "Riposte",
        description: desc([
          "When a creature misses you with a melee attack roll, you can take a Reaction and expend one Superiority Die to make a melee attack roll with a weapon or an Unarmed Strike against the creature. If you hit, add the Superiority Die to the attack's damage.",
        ]),
      },
      "sweeping attack": {
        name: "Sweeping Attack",
        description: desc([
          "When you hit a creature with a melee attack roll using a weapon or an Unarmed Strike, you can expend one Superiority Die to attempt to damage another creature. Choose another creature within 5 feet of the original target and within your reach. If the original attack roll would hit the second creature, it takes damage equal to the number you rolled on your Superiority Die. The damage is of the same type dealt by the original attack.",
        ]),
      },
      "tactical assessment": {
        name: "Tactical Assessment",
        description: desc([
          "When you make an Intelligence (History or Investigation) check or a Wisdom (Insight) check, you can expend one Superiority Die and add that die to the ability check.",
        ]),
      },
      "trip attack": {
        name: "Trip Attack",
        description: desc([
          "When you hit a creature with an attack roll using a weapon or an Unarmed Strike, you can expend one Superiority Die and add the die to the attack's damage roll. If the target is Large or smaller it must succeed on a Strength saving throw or have the Prone condition.",
        ]),
      },
    },
    "subclassfeature3.1": {
      name: "Student of War",
      source: [["PHB2024", 94]],
      minlevel: 3,
      toolProfs: [["Artisan's Tools", 1]],
      skillstxt: [["You gain 1 additional Fighter skill of choice."]],
      description: desc([
        "You gain proficiency with one type of Artisan's Tools of your choice and you gain proficiency in one skill of your choice from the skills available to Fighters at level 1.",
      ]),
    },
    "subclassfeature7": {
      name: "Know Your Enemy",
      source: [["PHB2024", 94]],
      minlevel: 7,
      description: desc([
        "As a Bonus Action, you can discern certain strengths and weaknesses of a creature you can see within 30 feet of yourself, you know whether that creature has any Immunities, Resistances, or Vulnerabilities, and if the creature has any, you know what they are.",
        "Once you use this feature. You can't do so again until you finish a Long Rest. You can also restore a use of this feature by expending one Superiority Die (no action required).",
      ]),
    },
    "subclassfeature10": {
      name: "Improved Combat Superiority",
      source: [["PHB2024", 54]],
      minlevel: 10,
      action: ["reaction", "Retaliation"],
      description: desc([
        "When you take damage from a creature that is within 5 feet of you, you can take a Reaction to make one melee attack against that creature, using a weapon or an Unarmed Strike.",
      ]),
    },
    "subclassfeature15": {
      name: "Relentless",
      source: [["PHB2024", 94]],
      minlevel: 15,
      description: desc([
        "Once per turn, when you use a maneuver, you can roll 1d8 and use the number rolled instead of expending a Superiority Die.",
      ]),
    },
    "subclassfeature18": {
      name: "Relentless",
      source: [["PHB2024", 94]],
      minlevel: 18,
      description: desc([
        "Your Superiority Die becomes a d12.",
      ]),
    },
  },
});
legacySubClassRefactor("fighter", "champion", {
  regExpSearch: /^(?=.*(fighter))(?=.*(champion)).*$/i,
  subname: "Champion",
  source: [["PHB2024", 96]],
  features: {
    "subclassfeature3": {
      name: "Improved Critical",
      source: [["PHB2024", 96]],
      minlevel: 3,
      calcChanges: {
        atkAdd: [
          function (fields, v) {
            if (!v.isSpell && !v.CritChance && classes.known.fighter && classes.known.fighter.level < 15) {
              fields.Description += (fields.Description ? '; ' : '') + 'Crit on 19-20';
              v.CritChance = 19;
            }
          },
          "My weapon attacks score a critical on a to hit roll of both 19 and 20.",
          19
        ]
      },
      description: desc([
        "Your attack rolls with weapons and Unarmed Strikes can score a Critical Hit on a roll of 19 or 20 on the d20.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Remarkable Athlete",
      source: [["PHB2024", 96]],
      minlevel: 3,
      description: desc([
        "Thanks to your athleticism, you have Advantage on Initiative rolls and Strength (Athletics) checks.",
        "In addition, immediately after you score a Critical Hit, you can move up to half your Speed without provoking Opportunity Attacks.",
      ]),
    },
    "subclassfeature7": {
      name: "Additional Fighting Style",
      source: [["PHB2024", 96]],
      minlevel: 7,
      eval: function () {
        AddString('Feat Note 1', 'Champion Fighting Style feat', '; ');
      },
      removeeval: function () {
        RemoveString('Feat Note 1', 'Champion Fighting Style feat');
      },
      description: desc([
        "You gain another Fighting Style feat of your choice.",
      ]),
    },
    "subclassfeature10": {
      name: "Heroic Warrior",
      source: [["PHB2024", 96]],
      minlevel: 10,
      description: desc([
        "The thrill of battle drives you toward victory. During combat, you can give yourself Heroic Inspiration whenever you start your turn without it.",
      ]),
    },
    "subclassfeature15": {
      name: "Superior Critical",
      source: [["PHB2024", 96]],
      minlevel: 15,
      calcChanges: {
        atkAdd: [
          function (fields, v) {
            if (v.isSpell) return;
            if (v.CritChance && v.CritChance > 18) {
              fields.Description = fields.Description.replace('Crit on ' + CritChance + '-20', 'Crit on 18-20');
              v.CritChance = 18;
            } else if (!v.CritChance) {
              fields.Description += (fields.Description ? '; ' : '') + 'Crit on 18-20';
              v.CritChance = 18;
            }
          },
          "My weapon attacks also score a critical on a to hit roll of 18.",
          18
        ]
      },
      description: desc([
        "Your attack rolls with weapons and Unarmed Strikes can now score a Critical Hit on a roll of 18-20 on the d20.",
      ]),
    },
    "subclassfeature18": {
      name: "Survivor",
      source: [["PHB2024", 96]],
      minlevel: 18,
      description: desc([
        "You attain the pinnacle of resilience in battle giving you these benefits.",
        "Defy Death : You have Advantage on Death Saving Throws. Moreover, when you roll 18-20 on a Death Saving Throw, you gain the benefit of rolling a 20 on it.",
        "Heroic Rally : At the start of each of your turns, you regain Hit Points equal to 5 plus your Constitution Modifier if you are Bloodied and have at least 1 Hit Point.",
      ]),
    },
  },
});
legacySubClassRefactor("fighter", "eldritch knight", {
  regExpSearch: /^(?=.*(fighter))(?=.*(eldritch))(?=.*(knight)).*$/i,
  subname: "Eldritch Knight",
  source: [["PHB2024", 96]],
  spellcastingFactor: 3,
  spellcastingAbility: 4,
  spellcastingList: {
    "class": "wizard",
    level: [0, 4],
  },
  spellcastingKnown: {
    cantrips: [0, 0, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
    spells: "list",
  },
  features: {
    "subclassfeature3": {
      name: "Spellcasting",
      source: [["PHB2024", 97]],
      minlevel: 3,
      additional: levels.map(function (n, idx) {
        var cantr = [0, 0, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3][idx];
        var splls = [0, 0, 3, 4, 4, 4, 5, 6, 6, 7, 8, 8, 9, 10, 10, 11, 11, 11, 12, 13][idx];
        return cantr + " cantrips \u0026 " + splls + " spells prepared";
      }),
      calcChanges: {
        spellCalc: [
          function (type, spellcasters, ability) {
            if (type === "prepare" && spellcasters.indexOf("fighter") !== -1) {
              var lvl = classes.known.fighter.level;
              var sArr = [0, 0, 0, 3, 4, 4, 4, 5, 6, 6, 7, 8, 8, 9, 10, 10, 11, 11, 11, 12, 13];
              return sArr[lvl] - Math.floor(lvl / 3) - Number(What("Int Mod"));
            }
          }
        ]
      },
      description: desc([
        "You have learned to cast spells. See chapter 7 for the rules on spellcasting. the information below details how you use those rules as an Eldritch Knight.",
        "Cantrips : You know two cantrips of your choice from the Wizard spell list (see that class's section for this list). Ray of Frost and Shocking Grasp are recommended. Whenever you gain a Fighter level, you can replace one of these cantrips with another cantrip of your choice from the Wizard spell list.",
        "When you reach Fighter level 10, you learn another Wizard cantrip of your choice.",
        "Spell Slots : The Eldritch Knight Spellcasting table shows how many spell slots you have to cast your level 1+ spells. You regain all expended slots when you finish a Long Rest.",
        "Prepared Spells of Level 1+ : You prepare the list of level 1+ spells that are available for you to cast with this feature. To start choose three level 1 spells from the Wizard spell list. Burning Hands, Jump, and Shield are recommended.",
        "The number of spells on your list increase as you gain Fighter levels, as shown in the Prepared Spells column of the Eldritch Knight Spellcasting table. Whenever that number increases, choose additional spells from the Wizard spell list until the number of spells on your list matches the number on the table. The chosen spells must be of a level fro which you have spell slots. For example, if you're a level 7 Fighter, your list of prepared spells can include five Wizard spells of levels 1 and 2 in any combination.",
        "Changing Your Prepared Spells : Whenever you gain a Fighter level, you can replace one spell on your list with another Wizard spell for which you have spell slots.",
        "Spellcasting Ability : Intelligence is your spellcasting ability for your Wizard spells.",
        "Spellcasting Focus : You can use an Arcane Focus as a Spellcasting Focus for your Wizards spells.",
      ]),
    },
    "subclassfeature3.1": {
      name: "War Bond",
      source: [["PHB2024", 98]],
      minlevel: 3,
      action: ["bonus action", "Summon Bonded Weapon"],
      description: desc([
        "You learn a ritual that creates a magical bond between yourself and one weapon. You perform the ritual over the course of 1 hour, which can be done during a Short Rest. The weapon must be within your reach throughout the ritual, at the conclusion of which you touch the weapon and forge the bond. The bond fails if another Fighter is bonded to the weapon or if the weapon is a magical item to which someone else is attuned.",
        "Once you have bonded a weapon to yourself, you can't be disarmed of that weapon unless you have the Incapacitated condition. If it is on the same plane of existence, you can summon that weapon as a Bonus action, causing it to teleport instantly to your hand.",
        "You can have up to two bonded weapons, but you can summon only one at a time with a Bonus Action. If you attempt to bond with a third weapon, you must break the bond with one of the other two.",
      ]),
    },
    "subclassfeature7": {
      name: "War Magic",
      source: [["PHB2024", 98]],
      minlevel: 7,
      description: desc([
        "When you take the Attack action on your turn, you can replace one of the attacks with a casting of one of your Wizard cantrips that has a casting time of an action.",
      ]),
    },
    "subclassfeature10": {
      name: "Eldritch Strike",
      source: [["PHB2024", 98]],
      minlevel: 10,
      description: desc([
        "You learn how to make your weapon strikes undercut a creature's ability to withstand your spells. When you hit a creature with an attack using a weapon, that creature has Disadvantage on the next saving throw it makes against a spell you cast before the end of your next turn.",
      ]),
    },
    "subclassfeature15": {
      name: "Arcane Charge",
      source: [["PHB2024", 98]],
      minlevel: 15,
      description: desc([
        "When you use your Action Surge, you can teleport up to 30 feet to an unoccupied space you can see. You can teleport before or after the additional action.",
      ]),
    },
    "subclassfeature18": {
      name: "Improved War Magic",
      source: [["PHB2024", 98]],
      minlevel: 18,
      description: desc([
        "When you take the Attack action on your turn, you can replace two of the attacks with a casting of one of your level 1 or level 2 Wizard spells that has a casting time of an action.",
      ]),
    },
  },
});
legacySubClassRefactor("fighter", "psi warrior", {
  regExpSearch: /^(?=.*(fighter))(?=.*(psi))(?=.*(warrior)).*$/i,
  subname: "Psi Warrior",
  source: [["PHB2024", 98]],
  features: {
    "subclassfeature3": {
      name: "Psionic Power",
      source: [["PHB2024", 98 - 99]],
      minlevel: 3,
      action: [["reaction", "Protective Field"], ["action", "Telekinetic Movement"]],
      limfeaname: "Telekinetic Movement",
      usages: 1,
      recovery: "short rest",
      additional: ["", "", "Psionic Energy Die 4 d6", "Psionic Energy Die 4 d6", "Psionic Energy Die 6 d8", "Psionic Energy Die 6 d8", "Psionic Energy Die 6 d8", "Psionic Energy Die 6 d8", "Psionic Energy Die 8 d8", "Psionic Energy Die 8 d8", "Psionic Energy Die 8 d10", "Psionic Energy Die 8 d10", "Psionic Energy Die 10 d10", "Psionic Energy Die 10 d10", "Psionic Energy Die 10 d10", "Psionic Energy Die 10 d10", "Psionic Energy Die 12 d12", "Psionic Energy Die 12 d12", "Psionic Energy Die 12 d12", "Psionic Energy Die 12 d12"],
      description: desc([
        "You harbor a wellspring of psionic energy within yourself. It is represented by your Psionic Energy Dice, which fuel powers you have from this subclass. The Psi Warrior Energy Dice table shows the die size and number of these dice you have when you reach certain Fighter levels.",
        "Any features in this subclass that use a Psionic Energy Die use only the dice from this subclass, some of your powers expend the Psionic Energy Die, as specified in a power's description, and you can't use a power if it requires you to use a die when all your Psionic Energy Dice are expended.",
        "You regain one of your expended Psionic Energy Dice when you finish a Short Rest, and you regain all of them when you finish a Long Rest.",
        "Protective Field : When you or another creature you can see within 30 feet of you takes damage, you can take a Reaction to expend one Psionic Energy Die, roll the die, and reduce the damage taken by the number rolled plus your Intelligence modifier (minimum reduction of 1), as you create a momentary shield of telekinetic force.",
        "Psionic Strike : You can propel your weapon with psionic force. Once on each of your turns, immediately after you hit a target within 30 feet of yourself with an attack and deal damage to it with a weapon, you can expend one Psionic Energy Die, rolling it and dealing Force damage to the target equal to the number rolled plus your Intelligence modifier.",
        "Telekinetic Movement : You can move an object or a creature with your mind. As a Magic action, choose one target you can see within 30 feet of yourself; the target must be a loose object that is Large or smaller or one willing creature other than you. You transport the target up to 30 feet to an unoccupied space you can see. Alternatively, if the target object is a Tiny object, you can transport it to or from your hand.",
        "Once you take this action, you can't do so again until you finish a Short or Long Rest unless you expend a Psionic Energy Die (no action required) to restore your use of it.",
      ]),
    },
    "subclassfeature7": {
      name: "Telekinetic Adept",
      source: [["PHB2024", 99]],
      minlevel: 7,
      limfeaname: "Psi-Powered Leap",
      usages: 1,
      recovery: "short rest",
      description: desc([
        "You have mastered new ways to use your telekinetic abilities, detailed below.",
        "Psi-Powered Leap : As a Bonus Action, you gain a Fly Speed equal to twice your Speed until the end of the current turn. Once you take this Bonus Action, you can't do so again until you finish a Short or Long Rest unless you expend a Psionic Energy Die (no action required) to restore your use of it.",
        "Telekinetic Thrust : When you deal damage to a target with your Psionic Strike, you can force the target to make a Strength saving throw (DC 8 plus your Intelligence modifier and Proficiency Bonus). On a failed save, you can give the target the Prone condition or transport it up to 10 feet horizontally.",
      ]),
    },
    "subclassfeature10": {
      name: "Guarded Mind",
      source: [["PHB2024", 99]],
      minlevel: 10,
      dmgres: ["Psychic"],
      description: desc([
        "You have Resistance to Psychic damage. Moreover, if you start your turn with the Charmed or Frightened condition, you can expend a Psionic Energy Die (no action required) and end every effect on yourself giving you those conditions.",
      ]),
    },
    "subclassfeature15": {
      name: "Bulwark of Force",
      source: [["PHB2024", 99]],
      minlevel: 15,
      action: "bonus action",
      usages: 1,
      recovery: "long rest",
      description: desc([
        "You can shield yourself and others with telekinetic force. As a Bonus Action, you can choose creatures including yourself, within 30 feet of you, up to a number of creatures equal to your Intelligence modifier (minimum of one creature). Each of the chosen creatures has Half Cover for 1 minute or until you have the Incapacitated condition.",
        "Once you use this feature, you can't do so again until you finish a Long Rest unless you expend a Psionic Energy Die (no action required) to restore your use of it.",
      ]),
    },
    "subclassfeature18": {
      name: "Telekinetic Master",
      source: [["PHB2024", 99]],
      minlevel: 18,
      usages: 1,
      recovery: "long rest",
      spellcastingBonus: [{
        name: "Telekinetic Master",
        spells: ["telekinesis"],
        selection: ["telekinesis"],
        times: 1,
        prepared: true,
      }],
      description: desc([
        "You always have the Telekinesis spell prepared. With this feature, you can cast it without a spell slot or components, and your spellcasting ability for it is Intelligence. On each of your turns while you maintain Concentration on it, including the turn when you cast it, you can make one attack with a weapon as a Bonus Action.",
        "Once you cast the spell with this feature, you can't do so again until you finish a Long Rest unless you expend a Psionic Energy Die (no action required) to restore your use of it.",
      ]),
    },
  },
});
legacyClassRefactor("monk", {
  regExpSearch: /monk/i,
  name: "Monk",
  source: [["PHB2024", 101]],
  primaryAbility: "Dexterity and Wisdom",
  prereqs: "Strength 13 or Dexterity 13",
  abilitySave: 5,
  improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
  die: 8,
  saves: ["Str", "Dex"],
  skillstxt: {
    primary: "Choose 2: Acrobatics, Athletics, History, Insight, Religion, or Stealth",
  },
  toolProfs: {
    primary: [["Artisan's Tools or Musical Instrument", 1]],
  },
  armorProfs: {
    primary: [false, false, false, false],
  },
  weaponProfs: {
    primary: [true, false, ["scimitar", "shortsword", "hand crossbow"]],
  },
  equipment: "Monk starting equipment:" +
    "\n \u2022 Spear;" +
    "\n \u2022 5 Daggers;" +
    "\n \u2022 Artisan's Tools or Musical Instrument;" +
    "\n \u2022 Explorer's Pack, and 11 gp;" +
    "\n\nAlternatively, choose 50 gp worth of starting equipment instead of the class's starting equipment.",
  subclasses: ["Monk Subclass", []],
  attacks: [1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
  features: {
    "martial arts": {
      name: "Martial Arts",
      source: [["PHB2024", 101]],
      minlevel: 1,
      action: [["bonus action", "Unarmed Strike"]],
      additional: levels.map(function (n) {
        return "1d" + (n < 5 ? 6 : n < 11 ? 8 : n < 17 ? 10 : 12);
      }),
      eval: function () {
        AddString('Extra.Notes', 'Monk features:\n\u25C6 If I wear armor/shield, I lose Unarmored Defense, Martial Arts, and Unarmored Movement');
        show3rdPageNotes();
      },
      removeeval: function () {
        RemoveString('Extra.Notes', 'Monk features:\n\u25C6 If I wear armor/shield, I lose Unarmored Defense, Martial Arts, and Unarmored Movement');
      },
      calcChanges: {
        atkAdd: [
          function (fields, v) {
            if (classes.known.monk && classes.known.monk.level && (v.theWea.monkweapon || v.baseWeaponName == "unarmed strike" || v.baseWeaponName == "shortsword" || v.baseWeaponName == "scimitar" || (v.isMeleeWeapon && (/simple/i).test(v.theWea.type) && !(/heavy|((^|[^+-]\b)2|\btwo).?hand(ed)?s?/i).test(fields.Description)))) {
              v.theWea.monkweapon = true;
              var aMonkDie = function (n) {
                return n < 5 ? 6 : n < 11 ? 8 : n < 17 ? 10 : 12;
              }(classes.known.monk.level);
              try {
                var curDie = eval_ish(fields.Damage_Die.replace('d', '*'));
              } catch (e) {
                var curDie = 'x';
              }
              if (isNaN(curDie) || curDie < aMonkDie) {
                fields.Damage_Die = '1d' + aMonkDie;
              }
              if (fields.Mod === 1 || fields.Mod === 2 || What(AbilityScores.abbreviations[fields.Mod - 1] + " Mod") < What(AbilityScores.abbreviations[v.StrDex - 1] + " Mod")) {
                fields.Mod = v.StrDex;
              }
            }
          },
          "I can use either Strength or Dexterity and my Martial Arts damage die in place of the normal damage die for any 'Monk Weapons', which include unarmed strike, shortsword, scimitar, and any simple melee weapon that is not two-handed or heavy.",
          5
        ]
      },
      description: desc([
        "Your practice of martial arts gives you mastery of combat styles that use your Unarmed Strikes and Monk weapons, which are the following.",
        "Simple Melee weapons and Martial Melee weapons that have the Light property",
        "You gain the following benefits while you are unarmed or wielding only Monk weapons and you aren't wearing armor or wielding a Shield",
        "Bonus Unarmed Stirke : You can make an Unarmed Strike as a Bonus Action.",
        "Martial Arts Die : You can roll 1d6 in place of the normal damage of your Unarmed Strike or Monk weapons. This die changes as you gain Monk levels as shown in the Martial Arts column of the Monk Features table.",
        "Dexterous Attacks : You can use your Dexterity modifier instead of your Strength modifier for the attack and damage rolls of your Unarmed Strikes and Monk weapons. In addition, when you use the Grapple or Shove options of your Unarmed Strike, you can use your Dexterity modifier instead of your Strength modifier to determine the save DC.",
      ]),
    },
    "unarmored defense": {
      name: "Unarmored Defense",
      source: [["PHB2024", 101]],
      minlevel: 1,
      armorOptions: [{
        regExpSearch: /justToAddToDropDownAndEffectWildShape/,
        name: "Unarmored Defense (Wis)",
        source: [["PHB2024", 101]],
        ac: "10+Wis",
        affectsWildShape: true,
        selectNow: true
      }],
      description: desc([
        "While you aren't wearing armor or wielding a Shield, your base Armor Class equals 10 plus your Dexterity and Wisdom Modifiers.",
      ]),
    },
    "monk's focus": {
      name: "Monk's Focus",
      source: [["PHB2024", 101 - 102]],
      minlevel: 2,
      limfeaname: "Focus Points",
      usages: levels.map(function (n) {
        return n < 2 ? "" : n;
      }),
      recovery: "short rest",
      description: desc([
        "Your focus and martial training allows you to harness a well of extraordinary energy within yourself. This energy is represented by Focus Points. Your Monk level determines the number of points you have, as shown in the Focus Points column of the Monk Features table.",
        "You can expend these points to enhance or fuel certain Monk features. You start knowing three such features; Flurry of Blows, Patient Defense, and Step of the Wind, each of which is detailed below.",
        "When you expend a Focus Point, it is unavailable until you finish a Short or Long Rest, at the end of which you regain all your expended points.",
        "Some features that use Focus Points require your target to make a saving throw. The save DC equals 8 plus your Wisdom modifier and Proficiency Bonus.",
      ]),
      "flurry of blows": {
        name: "Flurry of Blows",
        extraname: "Focus Feature",
        action: ["bonus action", "Flurry of Blows (1 FP)"],
        description: desc([
          "Flurry of Blows : You can expend 1 Focus point to make two Unarmed Strikes as a Bonus Action.",
          "At 10th Level : You can expend 1 Focus Point to use Flurry of Blows and make three Unarmed Strikes with it instead of two.",
        ]),
      },
      "patient defense": {
        name: "Patient Defense",
        extraname: "Focus Feature",
        action: [["bonus action", "Dash or Disengage"], ["bonus action", "Patient Defense (1 FP)"]],
        description: desc([
          "Patient Defense : You can take the Disengage action as a Bonus Action. Alternatively, you can expend 1 Focus Point to take both the Disengage and Dodge action as a Bonus Action",
          "At 10th Level : When you expend a Focus Point to use Patient Defense, you gain a number of Temporary Hit Points equal to two rolls of your Martial Arts die.",
        ]),
      },
      "step of the wind": {
        name: "Step of the Wind",
        extraname: "Focus Feature",
        action: ["bonus action", "Step of the Wind (1 FP)"],
        description: desc([
          "Step of the Wind : You can take the Dash action as a Bonus Action. Alternatively, you can expend 1 Focus Point to take both the Disengage and Dash action as a Bonus Action, and your jump distance is doubled for that turn.",
          "At 10th Level : When you expend a Focus Point to use Step of the Wind, you can choose a willing creature within 5 feet of yourself that is Large or smaller. You move the creature with you until the end of your turn. The creature's movement doesn't provoke Opportunity Attacks.",
        ]),
      },
      autoSelectExtrachoices: [{
        extrachoice: "flurry of blows"
      }, {
        extrachoice: "patient defense"
      }, {
        extrachoice: "step of the wind"
      }],
    },
    "unarmored movement": {
      name: "Unarmored Movement",
      source: [["PHB2024", 102]],
      minlevel: 2,
      additional: levels.map(function (n) {
        if (n < 2) return "";
        var spd = "+" + (n < 6 ? 10 : n < 10 ? 15 : n < 14 ? 20 : n < 18 ? 25 : 30) + " ft.";
        var xtr = n < 9 ? "" : "; Vertical surfaces and liquids";
        return spd + xtr;
      }),
      changeeval: function (v) {
        var monkSpd = '+' + (v[1] < 2 ? 0 : v[1] < 6 ? 10 : v[1] < 10 ? 15 : v[1] < 14 ? 20 : v[1] < 18 ? 25 : 30);
        SetProf('speed', monkSpd !== '+0', {allModes: monkSpd}, "Monk: Unarmored Movement");
      },
      description: desc([
        "Your speed increases by 10 feet while you aren't wearing armor or Wielding a Shield. This bonus increases when you reach certain Monk levels, as shown on the Monk Features table.",
      ]),
    },
    "uncanny metabolism": {
      name: "Uncanny Metabolism",
      source: [["PHB2024", 102]],
      minlevel: 2,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "When you roll initiative, you can regain all expended Focus Points. When you do so, roll your Martial Arts die and regain a number of Hit Points equal to your Monk level plus the number rolled.",
        "Once you use this feature, you can't use it again until you finish a Long Rest",
      ]),
    },
    "deflect attacks": {
      name: "Deflect Attacks",
      source: [["PHB2024", 102]],
      minlevel: 3,
      description: desc([
        "When an attack roll hits you and its damage includes Bludgeoning, Piercing, or Slashing damage. You can take a Reaction to reduce the attack's total damage against you. The reduction equals 1d10 plus your Dexterity modifier and Monk level.",
        "If you reduce the damage to 0, you can expend 1 Focus Point to redirect some of the attack's force. If you do so, choose a creature you can see within 5 feet of yourself if the attack was a melee attack or a creature you can see within 60 feet of yourself that isn't behind Total Cover if the attack was a ranged attack. That creature must succeed on a Dexterity saving throw or take damage equal to two rolls of your Martial Arts die plus your Dexterity modifier. The damage is the same type dealt by the attack.",
      ]),
    },
    "subclassfeature3": {
      name: "Monk Subclass",
      source: [["PHB2024", 103]],
      minlevel: 3,
      description: desc([
        "You gain a Monk subclass of your choice. The Warrior of Mercy, Warrior of Shadow, Warrior of the Elements, and Warrior of the Open Hand subclasses are detailed after this class's description. A subclass is a specialization that grants you features at certain Monk levels. For the rest of your career, you gain each of your subclass's features that are of your Monk level or lower.",
      ]),
    },
    "slow fall": {
      name: "Slow Fall",
      source: [["PHB2024", 103]],
      minlevel: 4,
      additional: levels.map(function (n) {
        return n < 4 ? "" : (n * 5) + " less falling damage";
      }),
      action: "reaction",
      description: desc([
        "You can take a Reaction when you fall to reduce any damage you take from the fall by an amount equal to five times your Monk level.",
      ]),
    },
    "extra attack": {
      name: "Extra Attack",
      source: [["PHB2024", 103]],
      minlevel: 5,
      description: desc([
        "You can attack twice instead of once whenever you take the Attack Action on your Turn.",
      ]),
    },
    "stunning strike": {
      name: "Stunning Strike",
      source: [["PHB2024", 103]],
      minlevel: 5,
      description: desc([
        "Once per turn when you hit a creature with a Monk weapon or an Unarmed Strike, you can expend 1 Focus Point to attempt a stunning strike. The target must make a Constitution saving throw. On a failed save, the target has the Stunned condition until the start of your next turn. On a successful save, the target's Speed is halved until the start of your next turn and the next attack roll made against the target before then has Advantage.",
      ]),
    },
    "empowered strikes": {
      name: "Empowered Strikes",
      source: [["PHB2024", 103]],
      minlevel: 6,
      description: desc([
        "Whenever you deal damage with your Unarmed Strikes it can deal your choice of Force damage or its normal damage type.",
      ]),
    },
    "evasion": {
      name: "Evasion",
      source: [["PHB2024", 103]],
      minlevel: 7,
      description: desc([
        "When you're subjected to an effect that allows you to make a Dexterity saving throw to take only half damage, you instead take no damage if you succeed on the saving throw and only half damage if you fail.",
        "You don't benefit from this feature if you have the Incapacitated condition",
      ]),
    },
    "acrobatic movement": {
      name: "Acrobatic Movement",
      source: [["PHB2024", 103]],
      minlevel: 9,
      description: desc([
        "While you aren't wearing armor or wielding a Shield you gain the ability to move along vertical surfaces and across liquids on you turn without falling during the movement.",
      ]),
    },
    "heightened focus": {
      name: "Heightened Focus",
      source: [["PHB2024", 103]],
      minlevel: 10,
      description: desc([
        "Your Flurry of Blows, Patient Defense, and Step of the Wind improve.",
      ]),
    },
    "self-restoration": {
      name: "Self-Restoration",
      source: [["PHB2024", 103]],
      minlevel: 10,
      description: desc([
        "Through sheer force of will, you can remove one of the following conditions from yourself at the end of each of your turns; Charmed, Frightened, or Poisoned.",
        "In addition, foregoing food and drink doesn't give you levels of Exhaustion",
      ]),
    },
    "deflect energy": {
      name: "Deflect Energy",
      source: [["PHB2024", 103]],
      minlevel: 13,
      description: desc([
        "You can now use your Deflect Attacks feature against attacks that deal any damage type, not just Bludgeoning, Piercing, or Slashing.",
      ]),
    },
    "disciplined survivor": {
      name: "Disciplined Survivor",
      source: [["PHB2024", 103]],
      minlevel: 14,
      additional: "1 ki point to reroll failed saving throw",
      saves: ["Str", "Dex", "Con", "Int", "Wis", "Cha"],
      description: desc([
        "Your physical and mental discipline grants you proficiency in all saving throws.",
        "Additionally, whenever you make a saving throw and fail, you can expend 1 Focus point to reroll it, and you must use the new roll.",
      ]),
    },
    "perfect focus": {
      name: "Perfect Focus",
      source: [["PHB2024", 103]],
      minlevel: 15,
      description: desc([
        "When you roll Initiative and don't use Uncanny Metabolism, you regain expended Focus Points until you have 4 if you have 3 or fewer.",
      ]),
    },
    "superior defense": {
      name: "Superior Defense",
      source: [["PHB2024", 103]],
      minlevel: 18,
      description: desc([
        "At the start of your turn, you can expend 3 Focus Points to bolster yourself against harm for 1 minute or until you have the Incapacitated condition. During that time, you have Resistance to all damage except Force damage.",
      ]),
    },
    "epic boon": {
      name: "Epic Boon",
      source: [["PHB2024", 103]],
      minlevel: 19,
      description: desc([
        "You gain an Epic Boon feat (see chapter 5) or another feat of your choice for which you qualify. Boon of Irresistible Offense is recommended.",
      ]),
    },
    "body and mind": {
      name: "Body and Mind",
      source: [["PHB2024", 103]],
      minlevel: 20,
      scores: [0, 4, 0, 0, 4, 0],
      scoresMaximum: [0, 25, 0, 0, 25, 0],
      description: desc([
        "You have developed your body and mind to new heights. Your Dexterity and Wisdom scores increase by 4 to a maximum of 25.",
      ]),
    },
  },
});
legacySubClassRefactor("monk", "mercy", {
  regExpSearch: /^(?=.*(monk))(?=.*(mercy)).*$/i,
  subname: "Warrior of Mercy",
  source: [["PHB2024", 104]],
  replaces: "way of mercy",
  features: {
    "subclassfeature3": {
      name: "Hand of Harm",
      source: [["PHB2024", 104]],
      minlevel: 3,
      description: desc([
        "Once per turn when you hit a creature with an Unarmed Strike and deal damage, you can expend 1 Focus Point to deal extra Necrotic damage equal to one roll of your Martial Arts die plus your Wisdom modifier.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Hand of Healing",
      source: [["PHB2024", 104]],
      minlevel: 3,
      action: "action",
      description: desc([
        "As a Magic action, you can expend 1 Focus Point to touch a creature and restore a number of Hit Points equal to a roll of your Martial Arts die plus your Wisdom modifier.",
        "When you use your Flurry of Blows, you can replace one of the Unarmed Strikes with a use of this feature without expending a Focus Points for the healing.",
      ]),
    },
    "subclassfeature3.2": {
      name: "Implements of Mercy",
      source: [["PHB2024", 104]],
      minlevel: 3,
      skills: ["Insight", "Medicine"],
      toolProfs: [["Herbalism Kit"]],
      description: desc([
        "You gain Proficiency in the Insight and Medicine skills and proficiency with the Herbalism Kit.",
      ]),
    },
    "subclassfeature6": {
      name: "Physician's Touch",
      source: [["PHB2024", 104]],
      minlevel: 6,
      description: desc([
        "Your Hand of Harm and Hand of Healing improve, as detailed below.",
        "Hand of Harm : When you use Hand of Harm on a Creature, you can also give that creature the Poisoned condition until the end of your next turn.",
        "Hand of Healing : When you use Hand of Healing you can also end one of the following conditions on the creature you heal; Blinded, Deafened, Paralyzed, Poisoned, or Stunned.",
      ]),
    },
    "subclassfeature11": {
      name: "Flurry of Healing and Harm",
      source: [["PHB2024", 104 - 105]],
      minlevel: 11,
      usages: "Wisdom modifier per ",
      usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
      recovery: "long rest",
      description: desc([
        "When you use Flurry of Blows, you can replace each of the Unarmed Strikes with a use of Hand of Healing without expending Focus Points for the healing.",
        "In addition, when you make an Unarmed Strike with Flurry of Blows and deal damage, you can use Hand of Harm with that strike without expending a Focus Point for Hand of Harm. You can still use Hand of Harm only once per turn.",
        "You can use this benefit a total number of times equal to your Wisdom modifier (minimum of once). You regain all expended uses when you finish a Long Rest.",
      ]),
    },
    "subclassfeature17": {
      name: "Hand of Ultimate Mercy",
      source: [["PHB2024", 105]],
      minlevel: 17,
      description: desc([
        "Your mastery of life energy opens the door to the ultimate mercy. As a Magic action, you can touch the corpse of a creature that dies within the past 24 hours and expend 5 Focus Points. The creature then returns to life with a number of Hit Points equal to 4d10 plus your Wisdom modifier. If the creature died with any of the following conditions, the creature revives with the conditions removed; Blinded, Deafened, Paralyzed, Poisoned, and Stunned.",
        "Once you use this feature, you can't use it again until you finish a Long Rest",
      ]),
    },
  },
});
legacySubClassRefactor("monk", "shadow", {
  regExpSearch: /^(?=.*(monk))(?=.*(shadow)).*$/i,
  subname: "Warrior of Shadow",
  source: [["PHB2024", 105]],
  replaces: "way of shadow",
  spellcastingAbility: 5,
  features: {
    "subclassfeature3": {
      name: "Shadow Arts",
      source: [["PHB2024", 105]],
      minlevel: 3,
      "darkness": {
        name: "Darkness",
        extraname: "Shadow Arts",
        source: [["PHB2024", 105]],
        spellcastingBonus: [{
          name: "Shadow Arts",
          spells: ["darkness"],
          selection: ["darkness"],
          times: 1,
          firstCol: 1,
        }],
        spellFirstColTitle: "FP",
        description: desc([
          "Darkness : You can expend 1 Focus Point to cast the Darkness spell without expending components. You can see within the spell's area when you cast it with this feature. While the spell persists, you can move its area of Darkness to a space within 60 feet of yourself at the start of each of your turns.",
        ])
      },
      autoSelectExtrachoices: [{
        extrachoice: "darkness"
      }],
      spellcastingBonus: [{
        name: "Shadow Arts",
        spells: ["minor illusion"],
        selection: ["minor illusion"],
        times: 1,
      }],
      description: desc([
        "You have learned to draw on the power of the Shadowfell, gaining the following benefits.",
        "Darkness : You can expend 1 Focus Point to cast the Darkness spell without expending components. You can see within the spell's area when you cast it with this feature. While the spell persists, you can move its area of Darkness to a space within 60 feet of yourself at the start of each of your turns.",
        "Darkvision : You gain Darkvision with a range of 60 feet. If you already have Darkvision, its range increases by 60 feet.",
        "Shadowy Figments : You know the Minor Illusion spell, Wisdom is your spellcasting ability for it.",
      ]),
    },
    "subclassfeature6": {
      name: "Shadow Step",
      source: [["PHB2024", 105]],
      minlevel: 6,
      action: "bonus action",
      description: desc([
        "While entirely within Dim Light or Darkness, you can use a Bonus Action to teleport up to 60 feet to an unoccupied space you can see that is also in Dim Light or Darkness. You then have Advantage on the next melee attack you make before the end of the current turn.",
      ]),
    },
    "subclassfeature11": {
      name: "Improved Shadow Step",
      source: [["PHB2024", 105]],
      minlevel: 11,
      description: desc([
        "You can draw on your Shadowfell connection to empower your teleportation. When you use your Shadow Step, you can expend 1 Focus point to remove the requirement that you must start and end in Dim Light or Darkness for that use of the feature. As part of this Bonus Action, you can make an Unarmed Strike immediately after you teleport.",
      ]),
    },
    "subclassfeature17": {
      name: "Cloak of Shadows",
      source: [["PHB2024", 105]],
      minlevel: 17,
      action: "action",
      description: desc([
        "As a Magic action while entirely within Dim Light or Darkness, you can expend 3 Focus Points to shroud yourself in shadows for 1 minute, until you have the Incapacitated condition, or until you end your turn in Bright Light. While shrouded by these shadows, you gain the following benefits.",
        "Invisibility : You have the Invisible condition",
        "Partially Incorporeal : You can move through occupied spaces as if they were Difficult Terrain. If you end your turn in such a space, you are shunted to the last unoccupied space you were in.",
        "Shadow Flurry : You can use your Flurry of Blows without expending any Focus Points",
      ]),
    },
  },
});
legacySubClassRefactor("monk", "elements", {
  regExpSearch: /^(?=.*(monk))(?=.*(elements)).*$/i,
  subname: "Warrior of the Elements",
  source: [["PHB2024", 106]],
  replaces: "way of the four elements",
  spellcastingAbility: 5,
  features: {
    "subclassfeature3": {
      name: "Elemental Attunement",
      source: [["PHB2024", 106]],
      minlevel: 3,
      description: desc([
        "At the start of your turn, you can expend 1 Focus Point to imbue yourself with elemental energy. The energy lasts for 10 minutes or until you have the Incapacitated condition. You gain the following benefits while this feature is active.",
        "Reach : When you make an Unarmed Strike, your reach is 10 feet greater than normal, as elemental energy extends from you.",
        "Elemental Strikes : Whenever you hit with your Unarmed Strikes, you can cause it to deal your choice of Acid, Cold, Fire, Lightning, or Thunder damage rather than its normal damage type. When you deal one of these types with it, you can also force the target to make a Strength saving throw. On a failed save, you can move the target up to 10 feet toward or away from you, as elemental energy swirls around it.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Manipulate Elements",
      source: [["PHB2024", 106]],
      minlevel: 3,
      spellcastingBonus: [{
        name: "Manipulate Elements",
        spells: ["elementalism"],
        selection: ["elementalism"],
        times: 1,
      }],
      description: desc([
        "You know the Elementalsm spell. Wisdom is your spellcasting ability for it.",
      ]),
    },
    "subclassfeature6": {
      name: "Elemental Burst",
      source: [["PHB2024", 106]],
      minlevel: 6,
      action: "action",
      description: desc([
        "As a Magic action, you can expend 2 Focus Points to cause elemental energy to burst in a 20-foot radius sphere centered on a point within 120 feet of yourself. Choose a damage type; Acid, Cold, Fire, Lightning, or Thunder.",
        "Each creature in the Sphere must make a Dexterity saving throw. On a failed save, a creature takes damage of the chosen type equal to three rolls of your Martial Arts die. On a successful save, a creature takes half as much damage.",
      ]),
    },
    "subclassfeature11": {
      name: "Stride of the Elements",
      source: [["PHB2024", 106]],
      minlevel: 11,
      description: desc([
        "While your Elemental Attunement is active, you also have a Fly and a Swim Speed equal to your Speed.",
      ]),
    },
    "subclassfeature17": {
      name: "Elemental Epitome",
      source: [["PHB2024", 106 - 107]],
      minlevel: 17,
      description: desc([
        "When your Elemental Attunement is active, you gain the following benefits.",
        "Damage Resistance : You gain Resistance to one of the following damage types of your choice; Acid, Cold, Fire, Lightning, or Thunder. At the start of each of your turns you can change this choice.",
        "Destructive Stride : When you use your Step of the Wind, your Speed increases by 20 feet until the end of the turn. For that duration, any creature of your choice takes damage equal to one roll of your Martial Arts die when you enter a space within 5 feet of it. The damage type is your choice of Acid, Cold, Fire, Lightning, or Thunder. A creature can take this damage only once per turn.",
        "Empowered Strikes : Once on each of your turns you can deal extra damage to a target equal to one roll of your Martial Arts die when you hit it with an Unarmed Strike. The extra damage is the same type dealt by that strike.",
      ]),
    },
  },
});
legacySubClassRefactor("monk", "open hand", {
  regExpSearch: /^(?=.*(monk))(?=.*(open))(?=.*(hand)).*$/i,
  subname: "Warrior of the Open Hand",
  source: [["PHB2024", 107]],
  replaces: "way of the open hand",
  features: {
    "subclassfeature3": {
      name: "Open Hand Technique",
      source: [["PHB2024", 107]],
      minlevel: 3,
      description: desc([
        "Whenever you hit a creature with an attack granted by your Flurry of Blows, you can impose one of the following effects on that target.",
        "Addle : The target can't make Opportunity Attacks until the start of its next turn.",
        "Push : The target must succeed on a Strength saving throw or be pushed up to 15 feet away from you.",
        "Topple : The target must succeed on a Dexterity saving throw or have the Prone condition",
      ]),
    },
    "subclassfeature6": {
      name: "Wholeness of Body",
      source: [["PHB2024", 107]],
      minlevel: 6,
      usages: "Wisdom modifier per ",
      usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
      recovery: "long rest",
      description: desc([
        "You gain the ability to heal yourself. As a Bonus Action, you can roll your Martial Arts die. You regain a number of Hit Points equal to the number rolled plus your Wisdom modifier (minimum of 1 Hit Point regained).",
        "You can use this feature a number of times equal to your Wisdom modifier (minimum of once), and you regain all expended uses when you finish a Long Rest",
      ]),
    },
    "subclassfeature11": {
      name: "Fleet Step",
      source: [["PHB2024", 107]],
      minlevel: 11,
      description: desc([
        "When you take a Bonus Action other than Step of the Wind, you can also use Step of the Wind immediately after that Bonus Action.",
      ]),
    },
    "subclassfeature17": {
      name: "Quivering Palm",
      source: [["PHB2024", 107]],
      minlevel: 17,
      description: desc([
        "You gain the ability to set up lethal vibrations in someone's body. When you hit a creature with an Unarmed Strike, you can expend 4 Focus Points to start these imperceptible vibrations, which last for a number of days equal to your Monk level. The vibrations are harmless unless you take an action to end them. Alternatively, when you take the Attack action on your turn, you can forgo one of these attacks to end the vibrations. To end them, you and the target must be on the same plane of existence. When you end them, the target must make a Constitution saving throw, taking 10d12 Force damage on a failed save or half as much damage on a successful one.",
        "You can have only one creature under the effect of this feature at a time. You can end the vibrations harmlessly (no action required).",
      ]),
    },
  },
});
legacyClassRefactor("paladin", {
  regExpSearch: /paladin/i,
  name: "Paladin",
  source: [["PHB2024", 109]],
  primaryAbility: "Strength or Charisma",
  prereqs: "Strength 13 or Dexterity 13",
  improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
  die: 10,
  saves: ["Wis", "Cha"],
  skillstxt: {
    primary: "Choose 2: Athletics, Insight, Intimidation, Medicine, Persuasion, or Religion.",
  },
  armorProfs: {
    primary: [true, true, true, true],
    secondary: [true, true, false, true],
  },
  weaponProfs: {
    primary: [true, true],
    secondary: [false, true],
  },
  equipment: "Paladin starting equipment:" +
    "\n \u2022 Chain Mail;" +
    "\n \u2022 Shield;" +
    "\n \u2022 Longsword;" +
    "\n \u2022 6 Javelins;" +
    "\n \u2022 Holy Symbol;" +
    "\n \u2022 Priest's Pack and 9 gp;" +
    "\n\nAlternatively, choose 150 gp worth of starting equipment instead of the class's starting equipment.",
  subclasses: ["Paladin Subclass", []],
  attacks: [1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
  spellcastingFactor: 2,
  spellcastingAbility: 6,
  spellcastingKnown: {
    spells: "list",
    prepared: true,
  },
  spellcastingFactorRoundupMulti: true,
  spellcastingTable: [[0, 0, 0, 0, 0, 0, 0, 0, 0]].concat(levels.map(function (n) {
    return defaultSpellTable[Math.ceil(n / 2)];
  })),
  features: {
    "lay on hands": {
      name: "Lay on Hands",
      source: [["PHB2024", 109]],
      action: "bonus action",
      usages: [5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100],
      recovery: "long rest",
      description: desc([
        "Your blessed touch can heal wounds. You have a pool of healing power that replenishes when you finish a Long Rest. With that pool, you can restore a total number of Hit Points equal to five times your Paladin level.",
        "As a Bonus Action, you can touch a creature (which could be yourself) and draw power from the pool of healing to restore a number of Hit Points to that creature, up to the maximum amount remaining in the pool.",
        "You can also expend 5 Hit Points from the pool of healing power to remove the Poisoned condition from the creature, those points don't also restore Hit Points to the creature.",
      ]),
    },
    "spellcasting": {
      name: "Spellcasting",
      source: [["PHB2024", 109 - 110]],
      additional: levels.map(function (n, idx) {
        var splls = [2, 3, 4, 5, 6, 6, 7, 7, 9, 9, 10, 10, 11, 11, 12, 12, 14, 14, 15, 15][idx];
        return splls + " spells prepared";
      }),
      calcChanges: {
        spellCalc: [
          function (type, spellcasters, ability) {
            if (type === "prepare" && spellcasters.indexOf("paladin") !== -1) {
              var lvl = classes.known.paladin.level;
              var sArr = [0, 2, 3, 5, 5, 7, 6, 8, 7, 10, 9, 11, 10, 12, 11, 13, 12, 15, 14, 16, 15];
              return sArr[lvl] - Math.ceil(lvl / 2) - Number(What("Cha Mod"));
            }
          }
        ]
      },
      description: desc([
        "You have learned to cast spells through prayer and meditation. See chapter 7 for the rules on spellcasting. The information below details how you use those rules with Paladin spells, which appear in the Paladin spell list later in the class's description.",
        "Spell Slots : The Paladin Features table shows how many spell slots you have to cast your level 1+ spells. You regain all expended slots when you finish a Long Rest.",
        "Prepared Spells of Level 1+ : You prepare the list of level 1+ spells that are available for you to cast with this feature. To start, choose two level 1 Paladin spells. Heroism and Searing Smite are recommended.",
        "The number of spells on your list increases as you gain Paladin levels, as shown in the Prepared Spells column of the Paladin Features table. Whenever that number increases, choose additional Paladin spells until the number of spells on your list matches the number in the Paladin Features table. The chosen spells must be of a level for which you have spell slots. For example, if you're a level 5 Paladin, your list of prepared spells can include six Paladin spells of level 1 or 2 in any combination.",
        "If another Paladin feature gives you spells that you always have prepared, those spells don't count against the number of spells you can prepare with this feature, but those spells otherwise count as Paladin spells for you.",
        "Changing your Prepared Spells : Whenever you finish a Long Rest, you can replace one spell on you list with another Paladin spell for which you have spell slots.",
        "Spellcasting Ability : Charisma is your spellcasting ability for your Paladin spells.",
        "Spellcasting Focus : You can use a Holy Symbol as a spellcasting focus for your Paladin spells.",
      ]),
    },
    "weapon mastery": {
      name: "Weapon Mastery",
      source: [["PHB2024", 110]],
      minlevel: 1,
      description: desc([
        "Your training with weapons allows you to use the mastery properties of two kinds of weapons of your choice with which you have proficiency, such as Longswords and Javelins.",
        "Whenever you finish a Long Rest, you can change the kinds of weapons you choose. For example, you could switch to suing the mastery properties of Halberds and Flails.",
      ]),
      additional: ["2 Weapon Masteries"],
      extraname: "Weapon Mastery",
      extrachoices: ["Club", "Dagger", "Greatclub", "Handaxe", "Javelin", "Light Hammer", "Mace", "Quarterstaff", "Sickle", "Spear", "Dart", "Light Crossbow", "Shortbow", "Sling", "Battleaxe", "Flail", "Glaive", "Greataxe", "Greatsword", "Halberd", "Lance", "Longsword", "Maul", "Morningstar", "Pike", "Rapier", "Scimitar", "Shortsword", "Trident", "Warhammer", "War Pick", "Whip", "Blowgun", "Hand Crossbow", "Heavy Crossbow", "Longbow", "Musket", "Pistol"],
      extraTimes: 2,
      "club": {
        name: "Club",
        description: desc([
          "You gain access to the Club's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "dagger": {
        name: "Dagger",
        description: desc([
          "You gain access to the Dagger's 'Nick' Mastery feature",
          "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
        ]),
      },
      "greatclub": {
        name: "Greatclub",
        description: desc([
          "You gain access to the Greatclub's 'Push' Mastery feature",
          "Push : If you hit a creature with this weapon, you can push the creature up to 10 feet straight away from yourself if it is Large or smaller.",
        ]),
      },
      "handaxe": {
        name: "Handaxe",
        description: desc([
          "You gain access to the Handaxe's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "javelin": {
        name: "Javelin",
        description: desc([
          "You gain access to the Javelin's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "light hammer": {
        name: "Light Hammer",
        description: desc([
          "You gain access to the Light Hammer's 'Nick' Mastery feature",
          "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
        ]),
      },
      "mace": {
        name: "Mace",
        description: desc([
          "You gain access to the Mace's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "quarterstaff": {
        name: "Quarterstaff",
        description: desc([
          "You gain access to the Quarterstaff's 'Topple' Mastery feature",
          "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        ]),
      },
      "sickle": {
        name: "Sickle",
        description: desc([
          "You gain access to the Sickle's 'Nick' Mastery feature",
          "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
        ]),
      },
      "spear": {
        name: "Spear",
        description: desc([
          "You gain access to the Spear's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "dart": {
        name: "Dart",
        description: desc([
          "You gain access to the Dart's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "light crossbow": {
        name: "Light Crossbow",
        description: desc([
          "You gain access to the Light Crossbow's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "shortbow": {
        name: "Shortbow",
        description: desc([
          "You gain access to the Shortbow's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "sling": {
        name: "Sling",
        description: desc([
          "You gain access to the Sling's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "battleaxe": {
        name: "Battleaxe",
        description: desc([
          "You gain access to the Battleaxe's 'Topple' Mastery feature",
          "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        ]),
      },
      "flail": {
        name: "Flail",
        description: desc([
          "You gain access to the Flail's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "glaive": {
        name: "Glaive",
        description: desc([
          "You gain access to the Glaive's 'Graze' Mastery feature",
          "Graze : If your attack roll with this weapon misses a creature, you can deal damage to that creature equal to the ability modifier you used to make the attack roll. This damage is the same type dealt by the weapon, and the damage can be increased only by increasing the ability modifier.",
        ]),
      },
      "greataxe": {
        name: "Greataxe",
        description: desc([
          "You gain access to the Greataxe's 'Cleave' Mastery feature",
          "Cleave : If you hit a creature with a melee attack roll using this weapon, you can make a melee attack roll with the weapon against a second creature within 5 feet of the first that is also within your reach. On a hit the second creature takes the weapon's damage, but don't add your ability modifier to that damage unless the modifier is negative. You can make this extra attack only once per turn.",
        ]),
      },
      "greatsword": {
        name: "Greatsword",
        description: desc([
          "You gain access to the Greatsword's 'Graze' Mastery feature",
          "Graze : If your attack roll with this weapon misses a creature, you can deal damage to that creature equal to the ability modifier you used to make the attack roll. This damage is the same type dealt by the weapon, and the damage can be increased only by increasing the ability modifier.",
        ]),
      },
      "halberd": {
        name: "Halberd",
        description: desc([
          "You gain access to the Halberd's 'Cleave' Mastery feature",
          "Cleave : If you hit a creature with a melee attack roll using this weapon, you can make a melee attack roll with the weapon against a second creature within 5 feet of the first that is also within your reach. On a hit the second creature takes the weapon's damage, but don't add your ability modifier to that damage unless the modifier is negative. You can make this extra attack only once per turn.",
        ]),
      },
      "lance": {
        name: "Lance",
        description: desc([
          "You gain access to the Lance's 'Topple' Mastery feature",
          "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        ]),
      },
      "longsword": {
        name: "Longsword",
        description: desc([
          "You gain access to the Longsword's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "maul": {
        name: "Maul",
        description: desc([
          "You gain access to the Maul's 'Topple' Mastery feature",
          "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        ]),
      },
      "morningstar": {
        name: "Morningstar",
        description: desc([
          "You gain access to the Morningstar's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "pike": {
        name: "Pike",
        description: desc([
          "You gain access to the Pike's 'Push' Mastery feature",
          "Push : If you hit a creature with this weapon, you can push the creature up to 10 feet straight away from yourself if it is Large or smaller.",
        ]),
      },
      "rapier": {
        name: "Rapier",
        description: desc([
          "You gain access to the Rapier's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "scimitar": {
        name: "Scimitar",
        description: desc([
          "You gain access to the Scimitar's 'Nick' Mastery feature",
          "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
        ]),
      },
      "shortsword": {
        name: "Shortsword",
        description: desc([
          "You gain access to the Shortsword's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "trident": {
        name: "Trident",
        description: desc([
          "You gain access to the Trident's 'Topple' Mastery feature",
          "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        ]),
      },
      "warhammer": {
        name: "Warhammer",
        description: desc([
          "You gain access to the Warhammer's 'Push' Mastery feature",
          "Push : If you hit a creature with this weapon, you can push the creature up to 10 feet straight away from yourself if it is Large or smaller.",
        ]),
      },
      "war pick": {
        name: "War Pick",
        description: desc([
          "You gain access to the War Pick's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "whip": {
        name: "Whip",
        description: desc([
          "You gain access to the Whip's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "blowgun": {
        name: "Blowgun",
        description: desc([
          "You gain access to the Blowgun's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "hand crossbow": {
        name: "Hand Crossbow",
        description: desc([
          "You gain access to the Hand Crossbow's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "heavy crossbow": {
        name: "Heavy Crossbow",
        description: desc([
          "You gain access to the Heavy Crossbow's 'Push' Mastery feature",
          "Push : If you hit a creature with this weapon, you can push the creature up to 10 feet straight away from yourself if it is Large or smaller.",
        ]),
      },
      "longbow": {
        name: "Longbow",
        description: desc([
          "You gain access to the Longbow's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "musket": {
        name: "Musket",
        description: desc([
          "You gain access to the Musket's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "pistol": {
        name: "Pistol",
        description: desc([
          "You gain access to the Pistol's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
    },
    "fighting style": {
      name: "Fighting Style",
      source: [["PHB2024", 91]],
      minlevel: 2,
      description: desc([
        "You can 'choose' between two features 'Fighting Style' or 'Blessed Warrior'.",
      ]),
      choices: ["Fighting Style", "Blessed Warrior"],
      "fighting style": {
        name: "Fighting Style",
        eval: function () {
          AddString('Feat Note 2', 'Fighting Style feat', '; ');
        },
        removeeval: function () {
          RemoveString('Feat Note 2', 'Fighting Style feat');
        },
        description: desc([
          "You gain a Fighting Style feat of your choice (see chapter 5 for feats).",
        ]),
      },
      "blessed warrior": {
        name: "Blessed Warrior",
        spellcastingBonus: [{
          name: "Blessed Warrior",
          "class": "cleric",
          level: [0, 0],
          times: 2,
        }],
        description: desc([
          "You learn two Cleric cantrips of your choice (see the Cleric class's section for the list of Cleric spells). Guidance and Sacred Flame are recommended. The chosen cantrips count as Paladin spells for you, and Charisma is your spellcasting ability for them. Whenever you gain a Paladin level, you can replace one of these cantrips with another Cleric cantrip.",
        ]),
      },
    },
    "paladin's smite": {
      name: "Paladin's Smite",
      source: [["PHB2024", 110]],
      minlevel: 2,
      usages: 1,
      recovery: "Long Rest",
      altResource: "SS 1+",
      spellcastingBonus: [{
        name: "Paladin's Smite",
        spells: ["divine smite"],
        selection: ["divine smite"],
        times: 1,
      }],
      description: desc([
        "You always have the Divine Smite spell prepared. In addition, you can cast it without expending a spell slot, but you must finish a Long Rest before you can cast it in this way again.",
      ]),
    },
    "channel divinity": {
      name: "Channel Divinity",
      source: [["PHB2024", 110 - 111]],
      action: ["bonus action", "Divine Sense"],
      minlevel: 3,
      usages: [0, 0, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
      description: desc([
        "You can channel divine energy directly from the Outer Planes, using it to fuel magical effects. You start with one such effect: Divine Sense, which is described below. Other Paladin features give additional Channel Divinity effect options. Each time you use this class's Channel Divinity, you choose which effect from the class to create.",
        "You can use this class's Channel Divinity twice. You regain one of its expended uses when you finish a Short Rest, and you regain all expended uses when you finish a Long Rest. You gain an additional use when you reach Paladin level 11.",
        "If a Channel Divinity effect requires a saving throw, the DC equals the spell save DC from this class's Spellcasting feature.",
        "Divine Sense : As a Bonus Action, you can open your awareness to detect Celestials, Fiends, and Undead. For the next 10 minutes or until you have the Incapacitated condition, you know the location of any creature of those types within 60 feet of yourself, and you know its creature type. Within the same radius, you also detect the presence of any place or object that has been consecrated or desecrated with the Hallow spell.",
      ]),
    },
    "subclassfeature3": {
      name: "Paladin Subclass",
      source: [["PHB2024", 111]],
      minlevel: 3,
      description: desc([
        "You gain a Paladin subclass of your choice. The Oath of Devotion, Oath of Glory, Oath of the Ancients, and Oath of Vengeance subclasses are detailed after this class's description. A subclass is a specialization that grants you features at certain Paladin levels. For the rest of your career, you gain each of your subclass's features that are of your Paladin level or lower.",
      ]),
    },
    "extra attack": {
      name: "Extra Attack",
      source: [["PHB2024", 111]],
      minlevel: 5,
      description: desc([
        "You can attack twice instead of once whenever you take the Attack Action on your Turn.",
      ]),
    },
    "faithful steed": {
      name: "Faithful Steed",
      source: [["PHB2024", 92]],
      minlevel: 5,
      usages: 1,
      recovery: "long rest",
      altResource: "SS 2+",
      spellcastingBonus: [{
        name: "Faithful Steed",
        spells: ["find steed"],
        selection: ["find steed"],
        times: 1,
      }],
      description: desc([
        "You can call on the aid of an otherworldly steed. You always have the Find Steed spell prepared.",
        "You can also cast the spell once without expending a spell slot, and you regain the ability to do so when you finish a Long Rest.",
      ]),
    },
    "aura of protection": {
      name: "Aura of Protection",
      source: [["PHB2024", 111]],
      minlevel: 6,
      description: desc([
        "You radiate a protective, unseeable aura in a 10-foot Emanation that originates from you. The aura is inactive while you have the Incapacitated condition.",
        "You and your allies in the aura gain a bonus to saving throws equal to your Charisma modifier (minimum bonus of +1).",
        "If another Paladin is present, a creature can benefit from only one Aura of Protection at a time, the creature chooses which aura while in them.",
      ]),
    },
    "abjure foes": {
      name: "Abjure Foes",
      source: [["PHB2024", 111]],
      minlevel: 9,
      action: "action",
      description: desc([
        "As a Magic action, you can expend one use of this class's Channel Divinity to overwhelm foes with awe. As you present your Holy Symbol or weapon you can target a number of creatures equal to your Charisma modifier (minimum of one creature) that you can see within 60 feet of yourself. Each target must succeed on a Wisdom saving throw or have the Frightened condition for 1 minute or until it takes any damage. While Frightened in this way a target can do only one of the following on its turns move, take an action, or take a Bonus Action.",
      ]),
    },
    "aura of courage": {
      name: "Aura of Courage",
      source: [["PHB2024", 111]],
      minlevel: 10,
      description: desc([
        "You and your allies have Immunity to the Frightened condition while in your Aura of Protection. If a Frightened ally enters the aura, that condition has no effect on that ally while there.",
      ]),
    },
    "radiant strikes": {
      name: "Radiant Strikes",
      source: [["PHB2024", 111]],
      minlevel: 11,
      description: desc([
        "Your strikes now carry supernatural power. When you hit a target with an attack roll using a Melee weapon or an Unarmed Strike, the target takes an extra 1d8 Radiant damage.",
      ]),
    },
    "restoring touch": {
      name: "Restoring Touch",
      source: [["PHB2024", 111]],
      minlevel: 14,
      description: desc([
        "When you use Lay on Hands on a creature, you can also remove one or more of the following conditions from the creature; Blinded, Charmed, Deafened, Frightened, Paralyzed, or Stunned. You must expend 5 Hit Points from the healing pool of Lay on Hands for each of these conditions you remove, those points don't also restore Hit Points to the creature.",
      ]),
    },
    "aura expansion": {
      name: "Aura Expansion",
      source: [["PHB2024", 111]],
      minlevel: 18,
      description: desc([
        "Your Aura of Protection is now a 30-foot Emanation.",
      ]),
    },
    "epic boon": {
      name: "Epic Boon",
      source: [["PHB2024", 92]],
      minlevel: 19,
      description: desc([
        "You gain an Epic Boon feat (see chapter 5) or another feat of your choice for which you qualify. Boon of Truesight is recommended.",
      ]),
    },
  },
});
legacySubClassRefactor("paladin", "devotion", {
  regExpSearch: /^(?=.*(paladin))(?=.*(devotion)).*$/i,
  subname: "Oath of Devotion",
  source: [["PHB2024", 113]],
  replaces: "oath of devotion",
  spellcastingExtra: ["protection from evil and good", "shield of faith", "aid", "zone of truth", "beacon of hope", "dispel magic", "freedom of movement", "guardian of faith", "commune", "flame strike"],
  features: {
    "subclassfeature3": {
      name: "Combat Superiority",
      source: [["PHB2024", 113]],
      minlevel: 3,
      action: "action",
      description: desc([
        "When you take the Attack action, you can expend one use of your Channel Divinity to imbue one Melee weapon that you are holding with positive energy. For 10 minutes or until you use this feature again, you add your Charisma modifier to attack rolls you make with that weapon (minimum bonus of +1), and each time you hit with it, you cause it to deal its normal damage type or Radiant damage.",
        "The weapon also emits Bright Light in a 20-foot radius and Dim Light 20 feet beyond that.",
        "You can end this effect early (no action required), This effect also ends if you aren't carrying the weapon.",
      ]),
    },
    "subclassfeature7": {
      name: "Aura of Devotion",
      source: [["PHB2024", 114]],
      minlevel: 7,
      description: desc([
        "You and your allies have Immunity to the Charmed condition in your Aura of Protection. If a Charmed ally enters the aura, that condition has no effect on that ally while there.",
      ]),
    },
    "subclassfeature15": {
      name: "Smite of Protection",
      source: [["PHB2024", 114]],
      minlevel: 15,
      description: desc([
        "Your magical smite now radiates protective energy. Whenever you cast Divine Smite, you and your allies have Half Cover while in your Aura of Protection. The aura has this benefit until the start of your next turn.",
      ]),
    },
    "subclassfeature20": {
      name: "Holy Nimbus",
      source: [["PHB2024", 114]],
      minlevel: 20,
      action: "bonus action",
      usages: 1,
      recovery: "long rest",
      altResource: "SS 5",
      description: desc([
        "As a Bonus Action, you can imbue your Aura of Protection with holy power, granting the benefits below for 10 minutes or until you end them (no action required). Once you use this feature you can't use it again until you finish a Long Rest. You can also restore your use of it by expending a level 5 spell slot (no action required).",
        "Holy Ward : You have Advantage on any saving throw you are forced to make by a Fiend or an Undead.",
        "Radiant Damage : Whenever an enemy starts its turn in the aura that creature takes Radiant damage equal to your Charisma modifier plus your Proficiency Bonus.",
        "Sunlight : The aura is filled with Bright Light that is sunlight.",
      ]),
    },
  },
});
legacySubClassRefactor("paladin", "glory", {
  regExpSearch: /^(?=.*(paladin))(?=.*(glory)).*$/i,
  subname: "Oath of Glory",
  source: [["PHB2024", 114]],
  replaces: "oath of glory",
  spellcastingExtra: ["guiding bolt", "heroism", "enhance ability", "magic weapon", "haste", "protection from energy", "compulsion", "freedom of movement", "legend lore", "yolande's regal presence"],
  features: {
    "subclassfeature3": {
      name: "Inspiring Smite",
      source: [["PHB2024", 114 - 115]],
      minlevel: 3,
      description: desc([
        "Immediately after you cast Divine Smite, you can expend one use of your Channel Divinity and distribute Temporary Hit Points to creatures of your choice within 30 feet of yourself, which can include you. The total number of Temporary Hit Points equals 2d8 plus your Paladin level divided among the chosen creatures however you like.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Peerless Athlete",
      source: [["PHB2024", 96]],
      minlevel: 3,
      description: desc([
        "As a Bonus Action, you can expend one use of your Channel Divinity to augment your athleticism. For 1 hour, you have Advantage on Strength (Athletics) and Dexterity (Acrobatics) checks, and the distance of your Long and High Jumps increase by 10 feet (this extra distance costs movement as normal).",
      ]),
    },
    "subclassfeature7": {
      name: "Aura of Alacrity",
      source: [["PHB2024", 115]],
      minlevel: 7,
      speed: {walk: "+10"},
      description: desc([
        "Your Speed increases by 10 feet.",
        "In addition, whenever an ally enters your Aura of Protection for the first time on a turn or starts their turn there, the ally's Speed increases by 10 feet until the end of their next turn.",
      ]),
    },
    "subclassfeature15": {
      name: "Glorious Defense",
      source: [["PHB2024", 115]],
      minlevel: 15,
      description: desc([
        "You can turn defense into a sudden strike. When you or another creature you can see within 10 feet of you is hit by an attack roll, you can take a Reaction to grant a bonus to the target's AC against that attack, potentially causing it to miss. The bonus equals your Charisma modifier (minimum of +1). If the attack misses, you can make one attack with a weapon against the attacker as part of this Reaction if the attacker is within your weapon's range.",
        "You can use this feature a number of times equal to your Charisma modifier (minimum of once), and you regain all expended uses when you finish a Long Rest.",
      ]),
    },
    "subclassfeature20": {
      name: "Living Legend",
      source: [["PHB2024", 115]],
      minlevel: 20,
      action: "bonus action",
      usages: 1,
      recovery: "long rest",
      altResource: "SS 5",
      description: desc([
        "You can empower yourself with the legends - whether true or exaggerated of - of your great deeds. As a Bonus Action, you gain the benefits below for 10 minutes. Once you use this feature, you can't use it again until you finish a Long Rest. You can also restore your use of it by expending a level 5 spell slot (no action required).",
        "Charismatic : You are blessed with an otherworldly presence and have Advantage on all Charisma checks.",
        "Saving Throw Reroll : If you fail a saving throw, you can take a Reaction to reroll it. You must use the new roll.",
        "Unerring Strike : Once on each of your turns when you make an attack roll with a weapon and miss you can cause the attack to hit instead.",
      ]),
    },
  },
});
legacySubClassRefactor("paladin", "ancients", {
  regExpSearch: /^(?=.*(paladin))(?=.*(ancients)).*$/i,
  subname: "Oath of the Ancients",
  source: [["PHB2024", 115]],
  replaces: "oath of the ancients",
  spellcastingExtra: ["ensnaring strike", "speak with animals", "misty step", "moonbeam", "plant growth", "protection from energy", "ice storm", "stoneskin", "commune with nature", "tree stride"],
  features: {
    "subclassfeature3": {
      name: "Nature's Wrath",
      source: [["PHB2024", 115]],
      minlevel: 3,
      description: desc([
        "As a Magic action, you can expend one use of your Channel Divinity to conjure spectral vines around nearby creatures. Each creature of your choice that you can see within 15 feet of yourself must succeed on a Strength saving throw or have the Restrained condition for 1 minute. A Restrained creature repeats the save at the end of each of its turns, ending the effect on itself on a success.",
      ]),
    },
    "subclassfeature7": {
      name: "Aura of Warding",
      source: [["PHB2024", 116]],
      minlevel: 7,
      dmgres: ["Psychic", "Radiant", "Necrotic"],
      description: desc([
        "Ancient magic lies so heavily upon you that it forms an eldritch ward, blunting energy from beyond the Material Plane; you and your allies have Resistance to Necrotic, Psychic, and Radiant damage while in your Aura of Protection.",
      ]),
    },
    "subclassfeature15": {
      name: "Undying Sentinel",
      source: [["PHB2024", 116]],
      minlevel: 15,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "When you are reduced to 0 Hit Points and not killed outright, you can drop to 1 Hit Point instead, and you regain a number of Hit Points equal to three times your Paladin level. Once you use this feature, you can't do so again until you finish a Long Rest.",
        "Additionally, you can't be aged magically, and you cease visibly aging.",
      ]),
    },
    "subclassfeature20": {
      name: "Elder Champion",
      source: [["PHB2024", 115]],
      minlevel: 20,
      description: desc([
        "As a Bonus Action, you can imbue your Aura of Protection with primal power, granting the benefits below for 1 minute or until you end them (no action required). Once you use this feature, you can't use it again until you finish a Long Rest. You can also restore your use of it by expending a level 5 spell slot (no action required).",
        "Diminish Defiance : Enemies in the aura have Disadvantage on saving throws against your spells and Channel Divinity options.",
        "Regenerate : At the start of each of your turns, you regain 10 Hit Points.",
        "Swift Spells : Whenever you cast a spell that has a casting time of an action, you can cast it using a Bonus Action instead.",
      ]),
    },
  },
});
legacySubClassRefactor("paladin", "Vengeance", {
  regExpSearch: /^(?=.*(paladin))(?=.*(vengeance)).*$/i,
  subname: "Oath of Vengeance",
  source: [["PHB2024", 116]],
  replaces: "oath of vengeance",
  spellcastingExtra: ["bane", "hunter's mark", "hold person", "misty step", "haste", "protection from energy", "banishment", "dimension door", "hold monster", "scrying"],
  features: {
    "subclassfeature3": {
      name: "Vow of Enmity",
      source: [["PHB2024", 117]],
      minlevel: 3,
      description: desc([
        "When you take the Attack action, you can expend one use of your Channel Divinity to utter a vow of enmity against a creature you can see within 30 feet of yourself. You have Advantage on attack rolls against the creature for 1 minute, or until you use this feature again.",
        "If the creature drops to 0 Hit Points before the vow ends, you can transfer the vow to a different creature within 30 feet of yourself (no action required).",
      ]),
    },
    "subclassfeature7": {
      name: "Relentless Avenger",
      source: [["PHB2024", 117]],
      minlevel: 7,
      description: desc([
        "Your supernatural focus helps you close off a foe's retreat. When you hit a creature with an Opportunity Attack, you can reduce the creature's Speed to 0 until the end of the current turn. You can ten move up to half your Speed as part of the same Reaction. This movement doesn't provoke Opportunity Attacks.",
      ]),
    },
    "subclassfeature15": {
      name: "Soul of Vengeance",
      source: [["PHB2024", 117]],
      minlevel: 15,
      action: "reaction",
      description: desc([
        "Immediately after a creature under the effect of your Vow of Enmity hits or misses with an attack roll, you can take a Reaction to make a melee attack against that creature if it's within range.",
      ]),
    },
    "subclassfeature20": {
      name: "Avenging Angel",
      source: [["PHB2024", 117]],
      minlevel: 20,
      action: "bonus action",
      usages: 1,
      recovery: "long rest",
      altResource: "SS 5",
      description: desc([
        "As a Bonus Action, you gain the benefits below for 10 minutes or you end them (no action required). Once you use this feature, you can't use it again until you finish a Long Rest. You can also restore your use of it by expending a level 5 spell slot (no action required).",
        "Flight : You sprout spectral wings on your back, you have a Fly speed of 60 feet, and can hover.",
        "Frightful Aura : Whenever an enemy starts its turn in your Aura of Protection, that creature must succeed on a Wisdom saving throw or have the Frightened condition for 1 minute or until it takes any damage. Attack rolls against the Frightened creature have Advantage",
      ]),
    },
  },
});
legacyClassRefactor("ranger", {
  regExpSearch: /ranger/i,
  name: "Ranger",
  source: [["PHB2024", 119]],
  primaryAbility: "Dexterity and Wisdom",
  prereqs: "Dexterity 13 or Wisdom 13",
  improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
  die: 10,
  saves: ["Str", "Dex"],
  skillstxt: {
    primary: "Choose 3: Animal Handling, Athletics, Insight, Investigation, Nature, Perception, Stealth, or Survival.",
    secondary: "Choose 1: Animal Handling, Athletics, Insight, Investigation, Nature, Perception, Stealth, or Survival.",
  },
  armorProfs: {
    primary: [true, true, false, true],
    secondary: [true, true, false, true],
  },
  weaponProfs: {
    primary: [true, true],
    secondary: [false, true],
  },
  equipment: "Ranger starting equipment:" +
    "\n \u2022 Studded Leather Armor;" +
    "\n \u2022 Scimitar;" +
    "\n \u2022 Shortsword;" +
    "\n \u2022 Longbow and Quiver of 20 Arrows;" +
    "\n \u2022 Druidic Focus (sprig of mistletoe);" +
    "\n \u2022 Explorer's Pack and 7 gp;" +
    "\n\nAlternatively, choose 150 gp worth of starting equipment instead of the class's starting equipment.",
  subclasses: ["Ranger Subclass", []],
  attacks: [1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
  spellcastingFactor: 2,
  spellcastingAbility: 5,
  spellcastingKnown: {
    spells: "list",
    prepared: true,
  },
  spellcastingFactorRoundupMulti: true,
  spellcastingTable: [[0, 0, 0, 0, 0, 0, 0, 0, 0]].concat(levels.map(function (n) {
    return defaultSpellTable[Math.ceil(n / 2)];
  })),
  spellcastingExtra : ["hunter's mark"],
  features: {
    "favored enemy": {
      name: "Favored Enemy",
      source: [["PHB2024", 119]],
      usages: [2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 6, 6, 6, 6],
      recovery: "long rest",
      altResource: "SS 1+",
      description: desc([
        "You always have the Hunter's Mark spell prepared. You can cast it twice without expending a spell slot, and you regain all expended uses of this ability when you finish a Long Rest.",
        "The number of times you can cast the spell without a spell slot increases when you reach certain Ranger levels, as shown in the Favored Enemy column of the Ranger Features table.",
      ]),
    },
    "spellcasting": {
      name: "Spellcasting",
      source: [["PHB2024", 119]],
      additional: levels.map(function (n, idx) {
        var splls = [2, 3, 4, 5, 6, 6, 7, 7, 9, 9, 10, 10, 11, 11, 12, 12, 14, 14, 15, 15][idx];
        return splls + " spells prepared";
      }),
      calcChanges: {
        spellCalc: [
          function (type, spellcasters, ability) {
            if (type === "prepare" && spellcasters.indexOf("ranger") !== -1) {
              var lvl = classes.known.ranger.level;
              var sArr = [0, 2, 3, 5, 5, 7, 6, 8, 7, 10, 9, 11, 10, 12, 11, 13, 12, 15, 14, 16, 15];
              return sArr[lvl] - Math.ceil(lvl / 2) - Number(What("Wis Mod"));
            }
          }
        ]
      },
      description: desc([
        "You have learned to channel the magical essence of nature to cast spells. See chapter 7 for the rules on spellcasting. The information below details how you use those rules with Ranger spells, which appear in the Ranger spell list later in the class's description.",
        "Spell Slots : The Ranger Features table shows how many spell slots you have to cast your level 1+ spells. You regain all expended slots when you finish a Long Rest.",
        "Prepared Spells of Level 1+ : You prepare the list of level 1+ spells that are available for you to cast with this feature. To start, choose two level 1 Ranger spells. Heroism and Searing Smite are recommended.",
        "The number of spells on your list increases as you gain Ranger levels, as shown in the Prepared Spells column of the Ranger Features table. Whenever that number increases, choose additional Ranger spells until the number of spells on your list matches the number in the Ranger Features table. The chosen spells must be of a level for which you have spell slots. For example, if you're a level 5 Ranger, your list of prepared spells can include six Ranger spells of level 1 or 2 in any combination.",
        "If another Ranger feature gives you spells that you always have prepared, those spells don't count against the number of spells you can prepare with this feature, but those spells otherwise count as Ranger spells for you.",
        "Changing your Prepared Spells : Whenever you finish a Long Rest, you can replace one spell on you list with another Ranger spell for which you have spell slots.",
        "Spellcasting Ability : Wisdom is your spellcasting ability for your Ranger spells.",
        "Spellcasting Focus : You can use a Druidic Focus as a spellcasting focus for your Ranger spells.",
      ]),
    },
    "weapon mastery": {
      name: "Weapon Mastery",
      source: [["PHB2024", 110]],
      minlevel: 1,
      description: desc([
        "Your training with weapons allows you to use the mastery properties of two kinds of weapons of your choice with which you have proficiency, such as Longbows and Shortswords.",
        "Whenever you finish a Long Rest, you can change the kinds of weapons you chose. For example, you could switch to using the mastery properties of Scimitars and Longswords.",
      ]),
      additional: ["2 Weapon Masteries"],
      extraname: "Weapon Mastery",
      extrachoices: ["Club", "Dagger", "Greatclub", "Handaxe", "Javelin", "Light Hammer", "Mace", "Quarterstaff", "Sickle", "Spear", "Dart", "Light Crossbow", "Shortbow", "Sling", "Battleaxe", "Flail", "Glaive", "Greataxe", "Greatsword", "Halberd", "Lance", "Longsword", "Maul", "Morningstar", "Pike", "Rapier", "Scimitar", "Shortsword", "Trident", "Warhammer", "War Pick", "Whip", "Blowgun", "Hand Crossbow", "Heavy Crossbow", "Longbow", "Musket", "Pistol"],
      extraTimes: 2,
      "club": {
        name: "Club",
        description: desc([
          "You gain access to the Club's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "dagger": {
        name: "Dagger",
        description: desc([
          "You gain access to the Dagger's 'Nick' Mastery feature",
          "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
        ]),
      },
      "greatclub": {
        name: "Greatclub",
        description: desc([
          "You gain access to the Greatclub's 'Push' Mastery feature",
          "Push : If you hit a creature with this weapon, you can push the creature up to 10 feet straight away from yourself if it is Large or smaller.",
        ]),
      },
      "handaxe": {
        name: "Handaxe",
        description: desc([
          "You gain access to the Handaxe's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "javelin": {
        name: "Javelin",
        description: desc([
          "You gain access to the Javelin's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "light hammer": {
        name: "Light Hammer",
        description: desc([
          "You gain access to the Light Hammer's 'Nick' Mastery feature",
          "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
        ]),
      },
      "mace": {
        name: "Mace",
        description: desc([
          "You gain access to the Mace's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "quarterstaff": {
        name: "Quarterstaff",
        description: desc([
          "You gain access to the Quarterstaff's 'Topple' Mastery feature",
          "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        ]),
      },
      "sickle": {
        name: "Sickle",
        description: desc([
          "You gain access to the Sickle's 'Nick' Mastery feature",
          "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
        ]),
      },
      "spear": {
        name: "Spear",
        description: desc([
          "You gain access to the Spear's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "dart": {
        name: "Dart",
        description: desc([
          "You gain access to the Dart's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "light crossbow": {
        name: "Light Crossbow",
        description: desc([
          "You gain access to the Light Crossbow's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "shortbow": {
        name: "Shortbow",
        description: desc([
          "You gain access to the Shortbow's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "sling": {
        name: "Sling",
        description: desc([
          "You gain access to the Sling's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "battleaxe": {
        name: "Battleaxe",
        description: desc([
          "You gain access to the Battleaxe's 'Topple' Mastery feature",
          "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        ]),
      },
      "flail": {
        name: "Flail",
        description: desc([
          "You gain access to the Flail's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "glaive": {
        name: "Glaive",
        description: desc([
          "You gain access to the Glaive's 'Graze' Mastery feature",
          "Graze : If your attack roll with this weapon misses a creature, you can deal damage to that creature equal to the ability modifier you used to make the attack roll. This damage is the same type dealt by the weapon, and the damage can be increased only by increasing the ability modifier.",
        ]),
      },
      "greataxe": {
        name: "Greataxe",
        description: desc([
          "You gain access to the Greataxe's 'Cleave' Mastery feature",
          "Cleave : If you hit a creature with a melee attack roll using this weapon, you can make a melee attack roll with the weapon against a second creature within 5 feet of the first that is also within your reach. On a hit the second creature takes the weapon's damage, but don't add your ability modifier to that damage unless the modifier is negative. You can make this extra attack only once per turn.",
        ]),
      },
      "greatsword": {
        name: "Greatsword",
        description: desc([
          "You gain access to the Greatsword's 'Graze' Mastery feature",
          "Graze : If your attack roll with this weapon misses a creature, you can deal damage to that creature equal to the ability modifier you used to make the attack roll. This damage is the same type dealt by the weapon, and the damage can be increased only by increasing the ability modifier.",
        ]),
      },
      "halberd": {
        name: "Halberd",
        description: desc([
          "You gain access to the Halberd's 'Cleave' Mastery feature",
          "Cleave : If you hit a creature with a melee attack roll using this weapon, you can make a melee attack roll with the weapon against a second creature within 5 feet of the first that is also within your reach. On a hit the second creature takes the weapon's damage, but don't add your ability modifier to that damage unless the modifier is negative. You can make this extra attack only once per turn.",
        ]),
      },
      "lance": {
        name: "Lance",
        description: desc([
          "You gain access to the Lance's 'Topple' Mastery feature",
          "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        ]),
      },
      "longsword": {
        name: "Longsword",
        description: desc([
          "You gain access to the Longsword's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "maul": {
        name: "Maul",
        description: desc([
          "You gain access to the Maul's 'Topple' Mastery feature",
          "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        ]),
      },
      "morningstar": {
        name: "Morningstar",
        description: desc([
          "You gain access to the Morningstar's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "pike": {
        name: "Pike",
        description: desc([
          "You gain access to the Pike's 'Push' Mastery feature",
          "Push : If you hit a creature with this weapon, you can push the creature up to 10 feet straight away from yourself if it is Large or smaller.",
        ]),
      },
      "rapier": {
        name: "Rapier",
        description: desc([
          "You gain access to the Rapier's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "scimitar": {
        name: "Scimitar",
        description: desc([
          "You gain access to the Scimitar's 'Nick' Mastery feature",
          "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
        ]),
      },
      "shortsword": {
        name: "Shortsword",
        description: desc([
          "You gain access to the Shortsword's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "trident": {
        name: "Trident",
        description: desc([
          "You gain access to the Trident's 'Topple' Mastery feature",
          "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        ]),
      },
      "warhammer": {
        name: "Warhammer",
        description: desc([
          "You gain access to the Warhammer's 'Push' Mastery feature",
          "Push : If you hit a creature with this weapon, you can push the creature up to 10 feet straight away from yourself if it is Large or smaller.",
        ]),
      },
      "war pick": {
        name: "War Pick",
        description: desc([
          "You gain access to the War Pick's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "whip": {
        name: "Whip",
        description: desc([
          "You gain access to the Whip's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "blowgun": {
        name: "Blowgun",
        description: desc([
          "You gain access to the Blowgun's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "hand crossbow": {
        name: "Hand Crossbow",
        description: desc([
          "You gain access to the Hand Crossbow's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "heavy crossbow": {
        name: "Heavy Crossbow",
        description: desc([
          "You gain access to the Heavy Crossbow's 'Push' Mastery feature",
          "Push : If you hit a creature with this weapon, you can push the creature up to 10 feet straight away from yourself if it is Large or smaller.",
        ]),
      },
      "longbow": {
        name: "Longbow",
        description: desc([
          "You gain access to the Longbow's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "musket": {
        name: "Musket",
        description: desc([
          "You gain access to the Musket's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "pistol": {
        name: "Pistol",
        description: desc([
          "You gain access to the Pistol's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
    },
    "expertise": function () {
      var a = {
        name: "Deft Explorer",
        source: [["PHB2024", 121]],
        minlevel: 2,
        description: "Choose two of your skill proficiencies with which you lack Expertise. You gain Expertise in those skills.",
        skillstxt: "Expertise with any two skill proficiencies.",
		languageProfs : 2,
        additional: levels.map(function (n) {
          return n < 2 ? "" : "with " + (n < 9 ? 1 : 3) + " skills";
        }),
        extraname: "Ranger Expertise",
        extrachoices: ["Acrobatics", "Animal Handling", "Arcana", "Athletics", "Deception", "History", "Insight", "Intimidation", "Investigation", "Medicine", "Nature", "Perception", "Performance", "Persuasion", "Religion", "Sleight of Hand", "Stealth", "Survival"],
        extraTimes: levels.map(function (n) {
          return n < 9 ? 1 : 3;
        })
      };
      for (var i = 0; i < a.extrachoices.length; i++) {
        var attr = a.extrachoices[i].toLowerCase();
        a[attr] = {
          name: a.extrachoices[i] + " Expertise",
          description: "",
          source: a.source,
          skills: [[a.extrachoices[i], "only"]],
          prereqeval: function (v) {
            return v.skillProfsLC.indexOf(v.choice) === -1 ? false : v.skillExpertiseLC.indexOf(v.choice) === -1 ? true : "markButDisable";
          }
        };
      }
      return a;
    }(),	
	"fighting style": {
      name: "Fighting Style",
      source: [["PHB2024", 120]],
      minlevel: 2,
      description: desc([
        "You can 'choose' between two features 'Fighting Style' or 'Druidic Warrior'.",
      ]),
      choices: ["Fighting Style", "Druidic Warrior"],
      "fighting style": {
        name: "Fighting Style",
        eval: function () {
          AddString('Feat Note 2', 'Fighting Style feat', '; ');
        },
        removeeval: function () {
          RemoveString('Feat Note 2', 'Fighting Style feat');
        },
        description: desc([
          "You gain a Fighting Style feat of your choice (see chapter 5 for feats).",
        ]),
      },
      "druidic warrior": {
        name: "Druidic Warrior",
        spellcastingBonus: [{
          name: "Druidic Warrior",
          "class": "druid",
          level: [0, 0],
          times: 2,
        }],
        description: desc([
          "You learn two Druid cantrips of your choice (see the Druid class's section for the list of Druid spells). Guidance and Starry Wisp are recommended. The chosen cantrips count as Ranger spells for you, and Wisdom is your spellcasting ability for them. Whenever you gain a Ranger level, you can replace one of these cantrips with another Druid cantrip.",
        ]),
      },
    },
    "subclassfeature3": {
      name: "Ranger Subclass",
      source: [["PHB2024", 111]],
      minlevel: 3,
      description: desc([
        "You gain a Ranger subclass of your choice. The Beast Master, Fey Wanderer, Gloom Stalker, and Hunter subclasses are detailed after this class's description. A subclass is a specialization that grants you features at certain Ranger levels. For the rest of your career, you gain each of your subclass's features that are of your Ranger level or lower.",
      ]),
    },
    "extra attack": {
      name: "Extra Attack",
      source: [["PHB2024", 120]],
      minlevel: 5,
      description: desc([
        "You can attack twice instead of once whenever you take the Attack Action on your Turn.",
      ]),
    },
    "roving": {
      name: "Roving",
      source: [["PHB2024", 121]],
      minlevel: 6,
      speed: {
        walk: "+5",
        climb: {spd: "walk", enc: "walk"},
        swim: {spd: "walk", enc: "walk"},
      },
      description: desc([
        "Your Speed increases by 10 feet while you aren't wearing Heavy armor. You also have a Climb Speed and a Swim Speed equal to your Speed.",
      ]),
    },
    "tireless": {
      name: "Tireless",
      source: [["PHB2024", 121]],
      minlevel: 10,
      action: ["action", "Temporary Hit Points"],
      usages: "Wisdom modifier per ",
      usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
      recovery: "long rest",
      description: desc([
        "Primal forces now help fuel you on your journeys, granting you the following benefits.",
        "Temporary Hit Points : As a Magic action, you can give yourself a number of Temporary Hit Points equal to 1d8 plus your Wisdom modifier (minimum of 1). You can use this action a number of times equal to your Wisdom modifier (minimum of once), and you regain all expended uses when you finish a Long Rest.",
        "Decrease Exhaustion : Whenever you finish a Short Rest, your Exhaustion level if any, decreases by 1.",
      ]),
    },
    "relentless hunter": {
      name: "Relentless Hunter",
      source: [["PHB2024", 121]],
      minlevel: 13,
      description: desc([
        "Taking damage can't break your Concentration on Hunter's Mark.",
      ]),
    },
    "nature's veil": {
      name: "Nature's Veil",
      source: [["PHB2024", 121]],
      minlevel: 14,
      action: "bonus action",
      usages: "Wisdom modifier per ",
      usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
      recovery: "long rest",
      description: desc([
        "You invoke spirits of nature to magically hide yourself. As a Bonus Action, you can give yourself the Invisible condition until the end of your next turn. You can use this feature a number of times equal to your Wisdom modifier (minimum of once), and you regain all expended uses when you finish a Long Rest.",
      ]),
    },
    "precise hunter": {
      name: "Precise Hunter",
      source: [["PHB2024", 121]],
      minlevel: 17,
      description: desc([
        "You have Advantage on attack rolls against the creature currently marked by your Hunter's Mark.",
      ]),
    },
    "feral senses": {
      name: "Feral Senses",
      source: [["PHB2024", 121]],
      minlevel: 18,
      vision: [["Blindsight", 30]],
      description: desc([
        "Your connection to the forces of nature grants you Blindsight with a range of 30 feet.",
      ]),
    },
    "epic boon": {
      name: "Epic Boon",
      source: [["PHB2024", 121]],
      minlevel: 19,
      description: desc([
        "You gain an Epic Boon feat (see chapter 5) or another feat of your choice for which you qualify. Boon of Dimensional Travel is recommended.",
      ]),
    },
    "foe slayer": {
      name: "Foe Slayer",
      source: [["PHB2024", 121]],
      minlevel: 20,
      description: desc([
        "The damage die of your Hunter's Mark is a d10 rather than a d6.",
      ]),
    },
  },
});
legacySubClassRefactor("ranger", "beast master", {
  regExpSearch: /^(?=.*(ranger))(?=.*(beast))(?=.*(master)).*$/i,
  subname: "Beast Master",
  source: [["PHB2024", 122]],
  features: {
    "subclassfeature3": {
      name: "Primal Companion",
      source: [["PHB2024", 122]],
      minlevel: 3,
      action: [["action", "Revive Companion"], ["bonus action", "Command Companion"]],
      description: desc([
        "You magically summon a primal beast, which draws strength from your bond with nature. Choose its stat block; Beast of the Land, Beast of the Sea, or Beast of the Sky. You also determine the kind of animal it is, choosing a kind appropriate for the stat block. Whatever beast you choose, it bears primal markings indicating its supernatural origin.",
        "The beast is Friendly to you and your allies and obeys your commands. It vanishes if you die.",
        "The Beast in Combat : In combat, the beast acts during your turn. It can move and use its Reaction on its own, but the only action it takes is the Doge action unless you take a Bonus Action to command it to take an action in its stat block or some other action. You can also sacrifice one of your attacks when you take the Attack action to command the beast to take the Beast's Strike action. If you have the Incapacitated condition, the beast acts on its own and isn't limited to the Dodge action.",
        "Restoring or Replacing the Beast : If the beast has died within the last hour, you can take a Magic action to touch it and expend a spell slot. The beast returns to life after 1 minute with all its Hit Points Restored.",
        "Whenever you finish a Long Rest, you can summon a different primal beast, which appears in an unoccupied space within 5 feet of you. You choose its stat block and appearance, if you already have a beast from this feature, the old one vanishes when the new one appears.",
      ]),
    },
    "subclassfeature7": {
      name: "Exceptional Training",
      source: [["PHB2024", 123]],
      minlevel: 7,
      description: desc([
        "When you take a Bonus Action to command your Primal Companion beast to take an action, you can also command it to take the Dash, Disengage, Dodge, or Help action using its Bonus Action.",
        "In addition, whenever it hits with an attack roll and deals damage, it can deal your choice of Force damage or its normal damage type.",
      ]),
    },
    "subclassfeature11": {
      name: "Bestial Fury",
      source: [["PHB2024", 123]],
      minlevel: 11,
      description: desc([
        "When you command your Primal Companion beast to take the Beast's Strike action, the beast can us it twice.",
        "In addition, the first time each turn it hits a creature under the effect of the Hunter's Mark spell, the beast deals extra Force damage equal to the bonus damage of that spell.",
      ]),
    },
    "subclassfeature15": {
      name: "Share Spells",
      source: [["PHB2024", 123]],
      minlevel: 15,
      description: desc([
        "When you cast a spell targeting yourself, you can also affect your Primal Companion beast with the spell if the beast is within 30 feet of you.",
      ]),
    },
  },
});
legacySubClassRefactor("ranger", "fey wanderer", {
  regExpSearch: /^(?=.*(ranger))(?=.*(fey))(?=.*(wanderer)).*$/i,
  subname: "Fey Wanderer",
  source: [["PHB2024", 124]],
  spellcastingExtra: ["charm person", "hunter's mark", "misty step", "summon fey", "dimension door", "mislead"],
  features: {
    "subclassfeature3": {
      name: "Dreadful Strikes",
      source: [["PHB2024", 124]],
      minlevel: 3,
      description: desc([
        "You can augment your weapon strikes with mind scarring magic drawn from the murky hollows of the Feywild. When you hit a creature with a weapon, you can deal an extra 1d4 Psychic damage to the target, which can take this extra damage only once per turn. The extra damage increases to 1d6 when you reach Ranger level 11.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Fey Wanderer Spells",
      source: [["PHB2024", 124]],
      minlevel: 3,
      description: desc([
        "When you reach a Ranger level specified in the Fey Wanderer Spells table, you thereafter always have the listed spells prepared.",
        "You also possess a fey blessing. Choose it from the Feywild Gifts table or determine it randomly",
      ]),
      toNotesPage: [{
        name: "Feywild Gifts",
        note: [
          "Illusory butterflies flutter around you while you take a Short or Long Rest",
          "Flowers bloom from your hair each dawn",
          "You faintly smell like cinnamon, lavender, nutmeg, or another comforting herb or spice",
          "Your shadow dances when no one is looking directly at it.",
          "Horns or antlers sprout from your head.",
          "Your skin and hair changes color each dawn",
        ]
      }],
    },
    "subclassfeature3.2": {
      name: "Otherworldly Glamour",
      source: [["PHB2024", 124 - 125]],
      minlevel: 3,
      skillstxt: "Choose 1 : Deception, Performance, or Persuasion",
      description: desc([
        "Whenever you make a Charisma check, you gain a bonus to the check equal to your Wisdom modifier (minimum of +1).",
        "You also gain proficiency in one of these skills of your choice Deception, Performance, or Persuasion.",
      ]),
    },
    "subclassfeature7": {
      name: "Beguiling Twist",
      source: [["PHB2024", 125]],
      minlevel: 7,
      action: "reaction",
      savetxt: {adv_vs: ["Charmed", "Frightened"]},
      description: desc([
        "The magic of the Feywild guards your mind. You have Advantage on saving throws to avoid or end the Charmed or Frightened condition.",
        "In addition, whenever you or a creature you can see within 120 feet of you succeeds on a saving throw to avoid or end the Charmed or Frightened condition, you can take a Reaction to force a different creature you can see within 120 feet of yourself to make a Wisdom save against your spell save DC. On a failed save, the target is Charmed or Frightened (your choice) for 1 minute. The target repeats the save at the end of each of its turns, ending the effect on itself on a success.",
      ]),
    },
    "subclassfeature11": {
      name: "Fey Reinforcements",
      source: [["PHB2024", 125]],
      minlevel: 11,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "You can cast Summon Fey without a Material component. You can also cast it once without a spell slot and you regain the ability to cast it in this way when you finish a Long Rest.",
        "Whenever you start casting the spell, you can modify it so that it doesn't require Concentration. If you do so, the spell's duration becomes 1 minute for that casting.",
      ]),
    },
    "subclassfeature15": {
      name: "Misty Wanderer",
      source: [["PHB2024", 15]],
      minlevel: 15,
      usages: "Wisdom modifier per ",
      usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
      recovery: "long rest",
      description: desc([
        "You can cast Misty Step without expending a spell slot. You can do so a number of times equal to your Wisdom modifier (minimum of once), and you regain all expended uses when you finish a Long Rest.",
        "In addition, whenever you cast Misty Step, you can bring along one willing creature you can see within 5 feet of yourself. That creature teleports to an unoccupied space of your choice within 5 feet of your destination space.",
      ]),
    },
  },
});
legacySubClassRefactor("ranger", "gloom stalker", {
  regExpSearch: /^(?=.*(ranger))(?=.*(gloom))(?=.*(stalker)).*$/i,
  subname: "Gloom Stalker",
  source: [["PHB2024", 125]],
  spellcastingExtra: ["disguise self", "hunter's mark", "rope trick", "fear", "greater invisibility", "seeming"],
  features: {
    "subclassfeature3": {
      name: "Dread Ambusher",
      source: [["PHB2024", 125]],
      minlevel: 3,
      addMod: [{
        type: "skill",
        field: "Init",
        mod: "Wis Mod",
        text: "I can add my Wisdom modifier to my initiative rolls."
      }],
      usages: "Wisdom modifier per ",
      usagescalc: "event.value = Math.max(1, What('Wis Mod'));",
      recovery: "long rest",
      description: desc([
        "You have mastered the art of creating fearsome ambushes, granting you the following benefits.",
        "Ambusher's Leap : At the start of you first turn of each combat, your Speed increases by 10 feet until the end of that turn.",
        "Dreadful Strike : When you attack a creature and hit it with a weapon, you can deal an extra 2d6 Psychic damage. You can use this benefit only once per turn, you can use it a number of times equal to your Wisdom modifier (minimum of once), and you regain all expended uses when you finish a Long Rest.",
        "Initiative Bonus : When you roll Initiative, you can add your Wisdom modifier to the roll.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Umbral Sight",
      source: [["PHB2024", 126]],
      minlevel: 3,
      vision: [["Darkvision", "fixed 60"], ["Darkvision", "+60"]],
      description: desc([
        "You gain Darkvision with a range of 60 feet. If you already have Darkvision when you gain this feature, its range increases by 60 feet.",
        "You are also adept at evading creatures that rely on Darkvision. While entirely in Darkness you have the Invisible condition to any creature that relies on Darkvision to see in that Darkness.",
      ]),
    },
    "subclassfeature7": {
      name: "Iron Mind",
      source: [["PHB2024", 126]],
      minlevel: 7,
      saves: ["Wis"],
      description: desc([
        "You have honed your ability to resist mind-altering powers. You gain proficiency in Wisdom saving throws. if you already have this proficiency, you instead gain proficiency in Intelligence or Charisma saving throws (your choice).",
      ]),
    },
    "subclassfeature11": {
      name: "Stalker's Flurry",
      source: [["PHB2024", 126]],
      minlevel: 11,
      description: desc([
        "The Psychic damage of your Dreadful Strikes becomes 2d8. In addition, when you use the Dreadful Strike effect of your Dread Ambusher feature, you can cause one of the following additional effects.",
        "Sudden Strike : You can make another attack with the same weapon against a different creature that is within 5 feet of the original target that is within the weapon's range.",
        "Mass Fear : The target and each creature within 10 feet of it must make a Wisdom saving throw against your spell save DC. On a failed save, a creature has the Frightened condition until the start of your next turn.",
      ]),
    },
    "subclassfeature15": {
      name: "Shadowy Dodge",
      source: [["PHB2024", 126]],
      minlevel: 15,
      action: "reaction",
      description: desc([
        "When a creature makes an attack roll against you you can take a Reaction to impose Disadvantage on that roll. Whether the attack hits or misses, you can then teleport up to 30 feet to an unoccupied space you can see.",
      ]),
    },
  },
});
legacySubClassRefactor("ranger", "hunter", {
  regExpSearch: /^(?=.*(ranger))(?=.*(hunter)).*$/i,
  subname: "Hunter",
  source: [["PHB2024", 127]],
  features: {
    "subclassfeature3": {
      name: "Hunter's Lore",
      source: [["PHB2024", 127]],
      minlevel: 3,
      description: desc([
        "You can call on the forces of nature to reveal certain strengths and weaknesses of your prey. While a creature is marked by your Hunter's Mark, you know whether that creature has any Immunities, Resistances, or Vulnerabilities, and if the creature has any, you know what they are.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Hunter's Prey",
      source: [["PHB2024", 127]],
      minlevel: 3,
      choices: ["Colossus Slayer", "Hoarde Breaker"],
      "colossus slayer": {
        name: "Colossus Slayer",
        description: desc([
          "Your tenacity can war down even the most resilient foes. When you hit a creature with a weapon, the weapon deals an extra 1d8 damage to the target if it's missing any of its Hit Points. You can deal this extra damage only once per turn. When you finish a Short or Long Rest, you can replace this feature with the 'Hoard Breaker' feature.",
        ]),
      },
      "hoarde breaker": {
        name: "Hoarde Breaker",
        description: desc([
          "Once on each of your turns when you make an attack with a weapon, you can make another attack with the same weapon against a different creature that is within 5 feet of the original target, that is within the weapon's range, and that you haven't attacked this turn. When you finish a Short or Long Rest, you can replace this feature with the 'Colossus Slayer' feature.",
        ]),
      },
      description: desc([
        "You gain one of the following feature options of your choice. Whenever you finish a Short or Long Rest, you can replace that chosen option with the other one.",
      ]),
    },
    "subclassfeature7": {
      name: "Defensive Tactics",
      source: [["PHB2024", 127]],
      minlevel: 7,
      choices: ["Escape the Hoarde", "Multiattack Defense"],
      "escape the hoarde": {
        name: "Escape the Hoarde",
        description: desc([
          "Opportunity Attacks have Disadvantage against you. When you finish a Short or Long Rest, you can replace this feature with the 'Multiattack Defense' feature.",
        ]),
      },
      "multiattack defense": {
        name: "Multiattack Defense",
        description: desc([
          "When a creature hits you with an attack roll, that creature had Disadvantage on all other attack rolls against you this turn. When you finish a Short or Long Rest, you can replace this feature with the 'Escape the Hoarde' feature.",
        ]),
      },
      description: desc([
        "You gain one of the following feature options of your choice. Whenever you finish a Short or Long Rest, you can replace that chosen option with the other one.",
      ]),
    },
    "subclassfeature11": {
      name: "Superior Hunter's Prey",
      source: [["PHB2024", 127]],
      minlevel: 11,
      description: desc([
        "Once per turn when you deal damage to a creature marked by your Hunter's mark, you can also deal that spell's extra damage to a different creature that you can see within 30 feet of the first creature.",
      ]),
    },
    "subclassfeature15": {
      name: "Superior Hunter's Defense",
      source: [["PHB2024", 127]],
      minlevel: 15,
      action: "reaction",
      description: desc([
        "When you take damage, you can take a Reaction to give yourself Resistance to that damage and any other damage of the same type until the end of the current turn.",
      ]),
    },
  },
});
legacyClassRefactor("rogue", {
  regExpSearch: /rogue/i,
  name: "Rogue",
  source: [["PHB2024", 101]],
  primaryAbility: "Dexterity",
  prereqs: "Dexterity 13",
  abilitySave: 2,
  improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
  die: 8,
  saves: ["Dex", "Int"],
  skillstxt: {
    primary: "Choose 4: Acrobatics, Athletics, Deception, Insight, Intimidation, Investigation, Perception, Persuasion, Sleight of Hand, or Stealth",
    secondary: "Choose 1: Acrobatics, Athletics, Deception, Insight, Intimidation, Investigation, Perception, Persuasion, Sleight of Hand, or Stealth",
  },
  toolProfs: {
    primary: [["Thieves' Tools"]],
    secondary: [["Thieves' Tools"]],
  },
  armorProfs: {
    primary: [true, false, false, false],
    secondary: [true, false, false, false],
  },
  weaponProfs: {
    primary: [true, false, ["scimitar", "shortsword", "hand crossbow", "rapier", "whip"]],
  },
  equipment: "Rogue starting equipment:" +
    "\n \u2022 Leather Armor;" +
    "\n \u2022 2 Daggers;" +
    "\n \u2022 Shortsword;" +
    "\n \u2022 Shortbow and a Quiver of 20 Arrows;" +
    "\n \u2022 Thieves' Tools;" +
    "\n \u2022 Burglar's Pack, and 8 gp;" +
    "\n\nAlternatively, choose 100 gp worth of starting equipment instead of the class's starting equipment.",
  subclasses: ["Rogue Subclass", []],
  attacks: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
  features: {
    "expertise": function () {
      var a = {
        name: "Expertise",
        source: [["PHB2024", 129]],
        minlevel: 1,
        description: "You gain Expertise (see the rules glossary) in two of your skill proficiencies of your choice. Sleight of Hand and Stealth are recommended if you have proficiency in them. At Rogue level 6, you gain Expertise in two more of your skill proficiencies of your choice.",
        skillstxt: "Expertise with any two skill proficiencies, and two more at 6th level",
        additional: levels.map(function (n) {
          return n < 1 ? "" : "with " + (n < 6 ? 2 : 4) + " skills";
        }),
        extraname: "Rogue Expertise",
        extrachoices: ["Acrobatics", "Animal Handling", "Arcana", "Athletics", "Deception", "History", "Insight", "Intimidation", "Investigation", "Medicine", "Nature", "Perception", "Performance", "Persuasion", "Religion", "Sleight of Hand", "Stealth", "Survival"],
        extraTimes: levels.map(function (n) {
          return n < 1 ? 0 : n < 6 ? 2 : 4;
        })
      };
      for (var i = 0; i < a.extrachoices.length; i++) {
        var attr = a.extrachoices[i].toLowerCase();
        a[attr] = {
          name: a.extrachoices[i] + " Expertise",
          description: "",
          source: a.source,
          skills: [[a.extrachoices[i], "only"]],
          prereqeval: function (v) {
            return v.skillProfsLC.indexOf(v.choice) === -1 ? false : v.skillExpertiseLC.indexOf(v.choice) === -1 ? true : "markButDisable";
          }
        };
      }
      return a;
    }(),
    "sneak attack": {
      name: "Sneak Attack",
      source: [["PHB2024", 101]],
      minlevel: 1,
      additional: ["1d6", "1d6", "2d6", "2d6", "3d6", "3d6", "4d6", "4d6", "5d6", "5d6", "6d6", "6d6", "7d6", "7d6", "8d6", "8d6", "9d6", "9d6", "10d6", "10d6"],
      description: desc([
        "You know how to strike subtly and exploit a foe's distraction. Once per turn, you can deal an extra 1d6 damage to one creature you hit with an attack roll if you have Advantage on the roll and the attack uses a Finesse or a Ranged weapon. The extra damage's type is the same as the weapon's type.",
        "You don't need Advantage on the attack roll if at least one of your allies is within 5 feet of the target, the ally doesn't have the Incapacitated condition, and you don't have Disadvantage on the roll.",
        "The extra damage increases as you gain Rogue levels, as shown in the Sneak Attack's column of the Rogue Features table.",
      ]),
    },
    "thieves' cant": {
      name: "Thieves' Cant",
      source: [["PHB2024", 129]],
      minlevel: 1,
      languageProfs: [["Thieves' Cant", 1]],
      description: desc([
        "You picked up various languages in the communities where you plied your roguish talents. You known Thieves' Cant and one other language of your choice, which you choose from the languages tables in chapter 2.",
      ]),
    },
    "weapon mastery": {
      name: "Weapon Mastery",
      source: [["PHB2024", 129]],
      minlevel: 1,
      description: desc([
        "Your training with weapons allows you to use the mastery properties of two kinds of weapons of your choice with which you have proficiency, such as Daggers and Shortbows. Whenever you finish a Long Rest, you can change the kinds of weapons you chose. For example, you could switch to using the mastery properties of Scimitars and Shortswords.",
      ]),
      additional: ["2 Weapon Masteries"],
      extraname: "Weapon Mastery",
      extrachoices: ["Club", "Dagger", "Greatclub", "Handaxe", "Javelin", "Light Hammer", "Mace", "Quarterstaff", "Sickle", "Spear", "Dart", "Light Crossbow", "Shortbow", "Sling", "Rapier", "Scimitar", "Shortsword", "Whip", "Hand Crossbow"],
      extraTimes: 2,
      "club": {
        name: "Club",
        description: desc([
          "You gain access to the Club's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "dagger": {
        name: "Dagger",
        description: desc([
          "You gain access to the Dagger's 'Nick' Mastery feature",
          "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
        ]),
      },
      "greatclub": {
        name: "Greatclub",
        description: desc([
          "You gain access to the Greatclub's 'Push' Mastery feature",
          "Push : If you hit a creature with this weapon, you can push the creature up to 10 feet straight away from yourself if it is Large or smaller.",
        ]),
      },
      "handaxe": {
        name: "Handaxe",
        description: desc([
          "You gain access to the Handaxe's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "javelin": {
        name: "Javelin",
        description: desc([
          "You gain access to the Javelin's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "light hammer": {
        name: "Light Hammer",
        description: desc([
          "You gain access to the Light Hammer's 'Nick' Mastery feature",
          "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
        ]),
      },
      "mace": {
        name: "Mace",
        description: desc([
          "You gain access to the Mace's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "quarterstaff": {
        name: "Quarterstaff",
        description: desc([
          "You gain access to the Quarterstaff's 'Topple' Mastery feature",
          "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
        ]),
      },
      "sickle": {
        name: "Sickle",
        description: desc([
          "You gain access to the Sickle's 'Nick' Mastery feature",
          "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
        ]),
      },
      "spear": {
        name: "Spear",
        description: desc([
          "You gain access to the Spear's 'Sap' Mastery feature",
          "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
        ]),
      },
      "dart": {
        name: "Dart",
        description: desc([
          "You gain access to the Dart's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "light crossbow": {
        name: "Light Crossbow",
        description: desc([
          "You gain access to the Light Crossbow's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "shortbow": {
        name: "Shortbow",
        description: desc([
          "You gain access to the Shortbow's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "sling": {
        name: "Sling",
        description: desc([
          "You gain access to the Sling's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "rapier": {
        name: "Rapier",
        description: desc([
          "You gain access to the Rapier's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "scimitar": {
        name: "Scimitar",
        description: desc([
          "You gain access to the Scimitar's 'Nick' Mastery feature",
          "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
        ]),
      },
      "shortsword": {
        name: "Shortsword",
        description: desc([
          "You gain access to the Shortsword's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
      "whip": {
        name: "Whip",
        description: desc([
          "You gain access to the Whip's 'Slow' Mastery feature",
          "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
        ]),
      },
      "hand crossbow": {
        name: "Hand Crossbow",
        description: desc([
          "You gain access to the Hand Crossbow's 'Vex' Mastery feature",
          "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
        ]),
      },
    },
    "cunning action": {
      name: "Cunning Action",
      source: [["PHB2024", 130]],
      minlevel: 2,
      action: [["bonus action", "Dash/Disengage/Hide"]],
      description: desc([
        "Your quick thinking and agility allows you to move and act quickly. On your turn, you can take one of the following actions as a Bonus Action; Dash, Disengage, or Hide.",
      ]),
    },
    "subclassfeature3": {
      name: "Rogue Subclass",
      source: [["PHB2024", 130]],
      minlevel: 3,
      description: desc([
        "You gain a Rogue subclass of your choice. The Arcane Trickster, Assassin, Soulknife, and Thief subclasses are detailed after this class's description. A subclass is a specialization that grants you features at certain Rogue levels. For the rest of your career, you gain each of your subclass's features that are of your Rogue level or lower.",
      ]),
    },
    "cunning strike": {
      name: "Cunning Strike",
      source: [["PHB2024", 130]],
      minlevel: 5,
      description: desc([
        "You've developed cunning ways to use your Sneak Attack. When you deal Sneak Attack damage, you can add one of the following Cunning Strike effects. Each effect has a die cost, which is the number of Sneak Attack damage dice you must forego to add the effect. You remove the die before rolling, and the effect occurs immediately after the attack's damage is dealt. Fore example if you add the Poison effect, remove 1d6 from the Sneak Attack's damage before rolling.",
        "If a cunning Strike effect requires a saving throw, the DC equals 8 plus your Dexterity modifier and Proficiency Bonus",
        "Poison (Cost 1d6) : You add a toxin to your strike, forcing the target to make a Constitution saving throw. On a failed save, the target has the Poisoned condition for 1 minute. At the end of each of its turns, the Poisoned target repeats the save, ending the effect on itself on a success.",
        "To use this effect, you must have a Poisoner's Kit on your person.",
        "Trip (Cost 1d6) : If the target is Large or smaller, it must succeed on a Dexterity saving throw or have the Prone condition.",
        "Withdraw (Cost 1d6) : Immediately after the attack, you move up to half your Speed without provoking Opportunity Attacks.",
      ]),
    },
    "uncanny dodge": {
      name: "Uncanny Dodge",
      source: [["PHB2024", 131]],
      minlevel: 5,
      action: "reaction",
      description: desc([
        "When an attacker that you can see hits you with an attack roll, you can take a Reaction to halve the attack's damage against you (round down).",
      ]),
    },
    "evasion": {
      name: "Evasion",
      source: [["PHB2024", 131]],
      minlevel: 7,
      description: desc([
        "You can nimbly dodge out of the way of certain dangers. When you're subjected to an effect that allows you to make a Dexterity saving throw to take only half damage, you instead take no damage if you succeed on the saving throw and only half damage if you fail. You can't use this feature if you have the Incapacitated condition.",
      ]),
    },
    "reliable talent": {
      name: "Reliable Talent",
      source: [["PHB2024", 131]],
      minlevel: 7,
      description: desc([
        "Whenever you make an ability check that uses one of your skill or tool proficiencies, you can treat a d20 roll of 9 or lower as a 10.",
      ]),
    },
    "improved cunning strike": {
      name: "Improved Cunning Strike",
      source: [["PHB2024", 131]],
      minlevel: 11,
      description: desc([
        "You can use up to two Cunning Strike effects, when you deal Sneak Attack damage, paying the die cost for each effect.",
      ]),
    },
    "devious strikes": {
      name: "Devious Strikes",
      source: [["PHB2024", 131]],
      minlevel: 14,
      description: desc([
        "You've practiced new ways to use your Sneak Attack deviously. The following effects are now among your Cunning Strike options.",
        "Dose (Cost 2d6) : The Target must succeed on a Constitution saving throw, or on its next turn, it can do only one of the following; move or take an action or a Bonus Action.",
        "Knock Out (Cost 6d6) : The target must succeed on a Constitution saving throw, or it has the Unconscious condition for 1 minute or until it takes any damage. The unconscious target repeats the save at the end of each of its turns, ending the effect on itself on a success.",
        "Obscure (Cost 3d6) : The target must succeed on a Dexterity saving throw, or it has the Blinded condition until the end of its next turn.",
      ]),
    },
    "slippery mind": {
      name: "Slippery Mind",
      source: [["PHB2024", 131]],
      minlevel: 15,
      saves: ["Wis", "Cha"],
      description: desc([
        "Your cunning mind is exceptionally difficult to control. You gain proficiency in Wisdom and Charisma saving throws.",
      ]),
    },
    "elusive": {
      name: "Elusive",
      source: [["PHB2024", 131]],
      minlevel: 18,
      description: desc([
        "You're so evasive that attackers rarely gain the upper hand against you. No attack roll can have Advantage against you unless you have the Incapacitated condition.",
      ]),
    },
    "epic boon": {
      name: "Epic Boon",
      source: [["PHB2024", 103]],
      minlevel: 19,
      description: desc([
        "You gain an Epic Boon feat (see chapter 5) or another feat of your choice for which you qualify. Boon of the Night Spirit is recommended.",
      ]),
    },
    "stroke of luck": {
      name: "Stroke of Luck",
      source: [["PHB2024", 131]],
      minlevel: 20,
      usages: 1,
      recovery: "short rest",
      description: desc([
        "You have a marvelous knack for succeeding when you need to, if you fail a D20 Test, you can turn the roll into a 20.",
        "Once you use this feature, you can't use it again until you finish a Short or Long Rest.",
      ]),
    },
  },
});
legacySubClassRefactor("rogue", "arcane trickster", {
  regExpSearch: /^(?=.*(rogue))(?=.*(arcane))(?=.*(trickster)).*$/i,
  subname: "Arcane Trickster",
  source: [["PHB2024", 132]],
  spellcastingFactor: 3,
  spellcastingAbility: 4,
  spellcastingList: {
    "class": "wizard",
    level: [0, 4],
  },
  spellcastingKnown: {
    cantrips: [0, 0, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
    spells: "list",
  },
  features: {
    "subclassfeature3": {
      name: "Spellcasting",
      source: [["PHB2024", 132 - 133]],
      minlevel: 3,
      additional: levels.map(function (n, idx) {
        var cantr = [0, 0, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3][idx];
        var splls = [0, 0, 3, 4, 4, 4, 5, 6, 6, 7, 8, 8, 9, 10, 10, 11, 11, 11, 12, 13][idx];
        return "Mage Hand \u0026 " + cantr + " cantrips \u0026 " + splls + " spells prepared";
      }),
      calcChanges: {
        spellCalc: [
          function (type, spellcasters, ability) {
            if (type === "prepare" && spellcasters.indexOf("rogue") !== -1) {
              var lvl = classes.known.rogue.level;
              var sArr = [0, 0, 0, 3, 4, 4, 4, 5, 6, 6, 7, 8, 8, 9, 10, 10, 11, 11, 11, 12, 13];
              return sArr[lvl] - Math.floor(lvl / 3) - Number(What("Int Mod"));
            }
          }
        ]
      },
      description: desc([
        "You have learned to cast spells. See chapter 7 for the rules on spellcasting. the information below details how you use those rules as an Arcane Trickster.",
        "Cantrips : You know three cantrips Mage Hand and two others of your choice from the Wizard spell list (see that class's section for this list). Mind Sliver and Minor Illusion are recommended.",
        "Whenever you gain a Rogue level, you can replace one of these cantrips with another cantrip of your choice from the Wizard spell list.",
        "When you reach Rogue level 10, you learn another Wizard cantrip of your choice.",
        "Spell Slots : The Arcane Trickster Spellcasting table shows how many spell slots you have to cast your level 1+ spells. You regain all expended slots when you finish a Long Rest.",
        "Prepared Spells of Level 1+ : You prepare the list of level 1+ spells that are available for you to cast with this feature. To start choose three level 1 spells from the Wizard spell list. Burning Hands, Jump, and Shield are recommended.",
        "The number of spells on your list increase as you gain Rogue levels, as shown in the Prepared Spells column of the Arcane Trickster Spellcasting table. Whenever that number increases, choose additional spells from the Wizard spell list until the number of spells on your list matches the number on the table. The chosen spells must be of a level from which you have spell slots. For example, if you're a level 7 Rogue, your list of prepared spells can include five Wizard spells of levels 1 and 2 in any combination.",
        "Changing Your Prepared Spells : Whenever you gain a Rogue level, you can replace one spell on your list with another Wizard spell for which you have spell slots.",
        "Spellcasting Ability : Intelligence is your spellcasting ability for your Wizard spells.",
        "Spellcasting Focus : You can use an Arcane Focus as a Spellcasting Focus for your Wizards spells.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Mage Hand Legerdemain",
      source: [["PHB2024", 133]],
      minlevel: 3,
      action: ["bonus action", "Cast Mage Hand"],
      description: desc([
        "When you cast Mage Hand, you can cast it as a Bonus Action, and you can make the spectral hand Invisible. You can control the hand as a Bonus Action, and through it, you can make Dexterity (Sleight of Hand) checks.",
      ]),
    },
    "subclassfeature9": {
      name: "Magical Ambush",
      source: [["PHB2024", 133]],
      minlevel: 9,
      description: desc([
        "If you have the Invisible condition when you cast a spell on a creature, it has Disadvantage on any saving throw it makes against the spell on the same turn.",
      ]),
    },
    "subclassfeature13": {
      name: "Versatile Trickster",
      source: [["PHB2024", 133]],
      minlevel: 13,
      description: desc([
        "You gain the ability to distract targets with your Mage Hand. When you use the Trip option of your Cunning Strike on a creature, you can also use that option on another creature within 5 feet of the spectral hand.",
      ]),
    },
    "subclassfeature17": {
      name: "Spell Thief",
      source: [["PHB2024", 133]],
      minlevel: 17,
      description: desc([
        "You gain the ability to magically steal the knowledge of how to cast a spell from another spellcaster.",
        "Immediately after a creature casts a spell that targets you or includes you in its area of effect, you can take a Reaction to force the creature to make an Intelligence saving throw. The DC equals your spell save DC. On a failed save, you negate the spell's effect against you, and you steal the knowledge of the spell if it is at least level 1 and of a level you can cast (it doesn't need to be a Wizard spell). For the next 8 hours, you have the spell prepared. The creature can't cast it until the 8 hours have passed.",
        "Once you steal a spell with this feature, you can't use this feature again until you finish a Long Rest.",
      ]),
    },
  },
});
legacySubClassRefactor("rogue", "assassin", {
  regExpSearch: /^(?=.*(rogue))(?=.*(assassin)).*$/i,
  subname: "Assassin",
  source: [["PHB2024", 105]],
  features: {
    "subclassfeature3": {
      name: "Assassinate",
      source: [["PHB2024", 134]],
      minlevel: 3,
      description: desc([
        "You're adept at ambushing a target, granting you the following benefits.",
        "Initiative : You have Advantage on Initiative rolls.",
        "Surprising Strikes : During the first round of each combat, you have Advantage on attack rolls against any creature that hasn't taken a turn. If your Sneak Attack hits any target during that round, the target takes extra damage of the weapon's type equal to your Rogue level",
      ]),
    },
    "subclassfeature3.1": {
      name: "Assassin's Tools",
      source: [["PHB2024", 134]],
      minlevel: 3,
      toolProfs: [["Disguise Kit"], ["Poisoner's Kit"]],
      description: desc([
        "You gain a Disguise Kit and a Poisoner's Kit, and you have proficiency with them.",
      ]),
    },
    "subclassfeature9": {
      name: "Infiltration Expertise",
      source: [["PHB2024", 134]],
      minlevel: 9,
      description: desc([
        "You are expert at the following techniques that add your infiltrations.",
        "Masterful Mimicry : You can unerringly mimic another person's speech, handwriting or both if you have spent at least 1 hour studying them.",
        "Roving Aim : Your Speed isn't reduced to 0 by using Steady Aim",
      ]),
    },
    "subclassfeature13": {
      name: "Envenom Weapons",
      source: [["PHB2024", 134]],
      minlevel: 13,
      description: desc([
        "When you use the Poison option of your Cunning Strike, the target also takes 2d6 Poison damage whenever it fails the saving throw. This damage ignores Resistance to Poison Damage.",
      ]),
    },
    "subclassfeature17": {
      name: "Death Strike",
      source: [["PHB2024", 134]],
      minlevel: 17,
      description: desc([
        "When you hit with your Sneak Attack on the first round of a combat, the target must succeed on a Constitution saving throw (DC 8 plus your Dexterity modifier and Proficiency Bonus), or the attack's damage is doubled against the target.",
      ]),
    },
  },
});
legacySubClassRefactor("rogue", "soulknife", {
  regExpSearch: /^(?=.*(rogue))(?=.*(soulknife)).*$/i,
  subname: "Soulknife",
  source: [["PHB2024", 135]],
  features: {
    "subclassfeature3": {
      name: "Psionic Power",
      source: [["PHB2024", 135]],
      minlevel: 3,
      additional: ["", "", "Psionic Energy Die 4 d6", "Psionic Energy Die 4 d6", "Psionic Energy Die 6 d8", "Psionic Energy Die 6 d8", "Psionic Energy Die 6 d8", "Psionic Energy Die 6 d8", "Psionic Energy Die 8 d8", "Psionic Energy Die 8 d8", "Psionic Energy Die 8 d10", "Psionic Energy Die 8 d10", "Psionic Energy Die 10 d10", "Psionic Energy Die 10 d10", "Psionic Energy Die 10 d10", "Psionic Energy Die 10 d10", "Psionic Energy Die 12 d12", "Psionic Energy Die 12 d12", "Psionic Energy Die 12 d12", "Psionic Energy Die 12 d12"],
      description: desc([
        "You harbor a wellspring of psionic energy within yourself. It is represented by your Psionic Energy Dice, which fuel certain powers you have from this subclass. The Soulknife Energy Dice table shows the number of these dice you have when you reach certain Rogue levels, and the table shows the die size.",
        "Any features in this subclass that use a Psionic Energy Die use only the dice from this subclass. Some of your powers expend a Psionic Energy Die, as specified in a power's description, and you can't use a power if it requires you to use a die when your Psionic Energy Dice are all expended.",
        "You regain one of your expended Psionic Energy Dice when you finish a Short Rest, and you regain all of them when you finish a Long Rest.",
        "Psi-Bolstered Knack : If you fail an ability check using a skill or tool with which you have proficiency, you can roll one Psionic Energy Die and add the number rolled to the check, potentially turning failure into success. The die is expended only if the roll then succeeds.",
        "Psychic Whispers : You can establish telepathic communication between yourself and others. As a Magic action, choose one or more creatures you can see, up to a number of creatures equal to your Proficiency Bonus, and then roll one Psionic Energy Die. For a number of hours equal to the number rolled, the chosen creatures can speak telepathically with you, and you can speak telepathically with them. TO send or receive a message (no action required) you and the other creature must be within 1 mile of each other. A creature can end the telepathic connection at any time (no action required).",
        "The first time you use this power after each Long Rest, you don't expend the Psionic Energy Die. All other times you use the power, you expend the die.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Psychic Blades",
      source: [["PHB2024", 136]],
      minlevel: 3,
      action: [["bonus action", "Psychic Blade (after Attack action)"]],
      description: desc([
        "You can manifest shimmering blades of psychic energy. Whenever you take the Attack action or make an Opportunity Attack, you can manifest a Psychic Blade in your free hand and make the attack with that blade. The magic blade has the following traits;",
        "Weapon Category : Simple Melee",
        "Damage on a Hit : 1d6 Psychic plus the ability modifier used for the attack roll.",
        "Properties : Finesse, Thrown (range 60/120 feet)",
        "Mastery : Vex (you can use this property, and it doesn't count against the number of properties you can use with Weapon Mastery).",
        "The blade vanishes immediately after it hits or misses its target, and it leaves no mark if it deals damage.",
        "After you attack with the blade on your turns, you can make a melee or ranged attack with a second psychic blade as a Bonus Action on the same turn if your other hand is free to create it. The damage die of this bonus attack is 1d4 instead of 1d6."
      ]),
      weaponOptions: [{
        regExpSearch: /^(?=.*psychic)(?=.*blade).*$/i,
        name: "Psychic Blade",
        source: [["PHB2024", 136]],
        ability: 2,
        type: "Simple",
        damage: [1, 6, "psychic"],
        range: "Melee, 60/120 ft.",
        description: "Finesse, Thrown, Vex; Bonus action: 1d4 instead of 1d6",
        abilitytodamage: true,
        selectNow: true
      }]
    },
    "subclassfeature9": {
      name: "Soul Blades",
      source: [["PHB2024", 136]],
      minlevel: 9,
      description: desc([
        "You can now use the following powers with your Psychic Blades.",
        "Homing Strikes : If you make an attack roll with your Psychic Blade and miss the target, you can roll one Psionic Energy Die and add the number rolled to the attack roll, if this causes the attack to hit the die is expended.",
        "Psychic Teleportation : As a Bonus Action, you manifest a Psychic Blade, expend one Psionic Energy Die and roll it, and throw the blade at an unoccupied space you can see up to a number of feet away equal to 10 times the number rolled. You then teleport to that space, and the blade vanishes.",
      ]),
    },
    "subclassfeature13": {
      name: "Psychic Veil",
      source: [["PHB2024", 136]],
      minlevel: 13,
      usages: 1,
      recovery: "long rest",
      altResource: "1 PsiD",
      description: desc([
        "You can weave a veil of psychic static to mask yourself. As a Magic action, you gain the Invisible condition for 1 hour or until you dismiss this effect (no action required). The invisibility ends early immediately after you deal damage to a creature or you force a creature to make a saving throw.",
        "Once you use this feature you can't do so again until you finish a Long Rest unless you expend a Psionic Energy Die (no action required) to restore your use of it.",
      ]),
    },
    "subclassfeature17": {
      name: "Rend Mind",
      source: [["PHB2024", 136]],
      minlevel: 17,
      usages: 1,
      recovery: "long rest",
      altResource: "3 PsiD",
      description: desc([
        "You can sweep your Psychic Blades through a creature's mind. When you use your Psychic Blades to deal Sneak Attack damage to a creature, you can force that target to make a Wisdom saving throw (DC 8 plus your Dexterity modifier. and Proficiency Bonus). If the save fails, the target has the Stunned condition for 1 minute. The Stunned target repeats the save at the end of each of its turns, ending the effect on itself on a success.",
        "Once you use this feature, you can't do so again until you finish a Long Rest unless you expend three Psionic Energy Dice (no action required to restore your use of it.",
      ]),
    },
  },
});
legacySubClassRefactor("rogue", "thief", {
  regExpSearch: /^(?=.*(rogue))(?=.*(thief)).*$/i,
  subname: "Thief",
  source: [["PHB2024", 137]],
  features: {
    "subclassfeature3": {
      name: "Fast Hands",
      source: [["PHB2024", 137]],
      minlevel: 3,
      action: ["bonus action", "Pick Lock/Disarm Trap/Utilize Item/Activate Magic Item"],
      description: desc([
        "As a Bonus Action you can do one of the following.",
        "Sleight of Hand : Make a Dexterity (Sleight of Hand) check to pick a lock or disarm a trap with Thieves' Tools or to pick a pocket.",
        "Use an Object : Take the Utilize action, or take the Magic action to use a magic item that requires that action.",
      ]),
    },
    "subclassfeature6": {
      name: "Second-Story Work",
      source: [["PHB2024", 137]],
      minlevel: 3,
      speed: {climb: {spd: "walk", enc: "walk"}},
      description: desc([
        "You've trained to get into especially hard-to-reach places, granting you these benefits.",
        "Climber : You gain a Climb Speed equal to your Speed.",
        "Jumper : You can determine your jump distance using your Dexterity rather than your Strength.",
      ]),
    },
    "subclassfeature9": {
      name: "Supreme Sneak",
      source: [["PHB2024", 137]],
      minlevel: 9,
      description: desc([
        "You gain the following Cunning Strike option.",
        "Stealth Attack (Cost 1d6) : If you have the Hide action's invisible condition, this attack doesn't end that condition on you if you end the turn behind Three-Quarters Cover or Total Cover.",
      ]),
    },
    "subclassfeature13": {
      name: "Use Magic Device",
      source: [["PHB2024", 137]],
      minlevel: 13,
      description: desc([
        "You've learned how to maximize use of magic items, granting you the following benefits.",
        "Attunement : You can attune to up to four magic items at once.",
        "Charges : Whenever you use a magic item property that expends charges, roll 1d6. On a roll of 6, you use the property without expending the charges.",
        "Scrolls. You can use any Spell Scroll, using Intelligence as your spellcasting ability for the spell. If the spell is a cantrip or a level 1 spell, you can cast it reliably, if the scroll contains a higher-level spell, you must first succeed on an Intelligence (Arcana) check (DC 10 plus the spell's level). On a successful check, you cast the spell from the scroll. On a failed check, the scroll disintegrates.",
      ]),
    },
    "subclassfeature17": {
      name: "Thief's Reflexes",
      source: [["PHB2024", 137]],
      minlevel: 17,
      description: desc([
        "You are adept at laying ambushes and quickly escaping danger. You can take two turns during the first round of any combat. You take your first turn at your normal Initiative and your second turn at your Initiative minus 10.",
      ]),
    },
  },
});
legacyClassRefactor("sorcerer", {
  regExpSearch: /sorcerer/i,
  name: "Sorcerer",
  source: [["PHB2024", 139]],
  primaryAbility: ["Charisma"],
  abilitySave: 6,
  prereqs: "Charisma 13",
  improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
  die: 6,
  saves: ["Con", "Cha"],
  skillstxt: {
    primary: "Choose 2: Arcana, Deception, Insight, Intimidation, Persuasion, or Religion",
  },
  armorProfs: {
    primary: [false, false, false, false],
    secondary: [false, false, false, false],
  },
  weaponProfs: {
    primary: [true, false],
    secondary: [false, false],
  },
  equipment: "Sorcerer starting equipment:" +
    "\n \u2022 A Spear;" +
    "\n \u2022 2 Daggers;" +
    "\n \u2022 An Arcane Focus (crystal);" +
    "\n \u2022 A Dungeoneer's Pack, and 28 gp." +
    "\n\nAlternatively, choose 50 gp worth of starting equipment instead of the class's starting equipment.",
  subclasses: ["Sorcerer Subclass", []],
  attacks: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
  spellcastingAbility: 6,
  spellcastingFactor: 1,
  spellcastingKnown: {
    cantrips: [4, 4, 4, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6],
    spells: "list",
    prepared: true,
  },
  features: {
    "spellcasting": {
      name: "Spellcasting",
      source: [["PHB2024", 139 - 140]],
      minlevel: 1,
      additional: levels.map(function (n, idx) {
        var cantr = [4, 4, 4, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6][idx];
        var splls = [2, 4, 6, 7, 9, 10, 11, 12, 14, 15, 16, 16, 17, 17, 18, 18, 19, 20, 21, 22][idx];
        return cantr + " cantrips \u0026 " + splls + " spells prepared";
      }),
      calcChanges: {
        spellCalc: [
          function (type, spellcasters, ability) {
            if (type === "prepare" && spellcasters.indexOf("sorcerer") !== -1) {
              var lvl = classes.known.sorcerer.level;
              var sArr = [0, 2, 4, 6, 7, 9, 10, 11, 12, 14, 15, 16, 16, 17, 17, 18, 18, 19, 20, 21, 22];
              return sArr[lvl] - lvl - Number(What("Cha Mod"));
            }
          }
        ]
      },
      description: desc([
        "Drawing from your innate magic, you can cast spells. See chapter 7 for the rules on spellcasting. The information below details how you use those rules with Sorcerer spells, which appear in the Sorcerer spell list later in the class's description.",
        "Cantrips : You know four cantrips of your choice from the Sorcerer spell list. Light, Prestidigitation, Shocking Grasp, and Sorcerous Burst are recommended.",
        "Whenever you gain a Sorcerer level, you can replace one of your cantrips with another cantrip of your choice from the Sorcerer spell list.",
        "When you reach Sorcerer levels 4 and 10, you learn another cantrip of your choice from the Sorcerer spell list, as shown in the Cantrips column of the Sorcerer Features table.",
        "Spell Slots : The Sorcerer Features table shows how many spell slots you have to cast your level 1+ spells. You regain all expended slots when you finish a Long Rest.",
        "Prepared Spells of Level 1+ : You prepare the list of level 1+ spells that are available for you to cast with this feature. To start, choose two level 1 spells from the Sorcerer spell list. Burning Hands and Detect Magic are recommended.",
        "The number of spells on your list increases as you gain Sorcerer levels, as shown in the Prepared Spells column of the Sorcerer Features table. Whenever that number increases, choose additional spells from the Sorcerer spell list until the number of spells on your list matches the number on the table. The chosen spells must be of a level for which you have spell slots. For example, if you're a level 3 Sorcerer, your list of prepared spells can include six spells of levels 1 and 2 in any combination",
        "If another Sorcerer feature gives you spells that you always have prepared, those spells don't count against the number of spells you can prepare with this feature, but those spells otherwise count as Sorcerer spells for you.",
        "Changing Your Prepared Spells : Whenever you gain a Sorcerer level, you can replace one spell on your list with another Sorcerer spell of which you have spell slots.",
        "Spellcasting Ability : Charisma is your spellcasting ability for your Bard Spells",
        "Spellcasting Focus : You can use an Arcane Focus as a Spellcasting Focus for your Sorcerer spells.",
      ]),
    },
    "innate sorcery": {
      name: "Innate Sorcery",
      source: [["PHB2024", 140]],
      minlevel: 1,
      action: "bonus action",
      usages: 2,
      recovery: "long rest",
      description: desc([
        "An event in your past left an indelible mark on you, infusing you with simmering magic. As a Bonus Action you can unleash that magic for 1 minute during which you gain the following benefits.",
        "The Spell save DC of your Sorcerer spells increases by 1.",
        "You have Advantage on the attack rolls of Sorcerer spells you cast.",
        "You can use this feature twice, and you regain all expended uses of it when you finish a Long Rest.",
      ]),
    },
    "font of magic": {
      name: "Font of Magic",
      source: [["PHB2024", 140]],
      minlevel: 2,
      limfeaname: "Sorcery Points",
      usages: [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
      recovery: "long rest",
      description: desc([
        "You can tap into the wellspring of magic within yourself. This wellspring is represented by Sorcery Points, which allow you to create a variety of magical effects.",
        "You have 2 Sorcery Points, and you gain more as you reach higher levels, as shown in the Sorcery Points column of the Sorcerer Features table. You can't have more Sorcery Points than the number shown in the table for your level. You regain all expended Sorcery Points when you finish a Long Rest.",
        "You can use your Sorcery Points to fuel the options below, along with other features, such as Metamagic, that uses those points.",
        "Converting Spell Slots to Sorcery Points : You can expend a spell slot to gain a number of Sorcery Points equal to the slot's level (no action required).",
        "Creating Spell Slots : As a Bonus Action, you can transform unexpended Sorcery Points into one spell slot. The Creating Spell Slots table shows the cost of creating a spell slot of a given level, and it lists the minimum Sorcerer level you must be to create a slot. You can create a spell slot no higher then level 5.",
        "Any spell slot you create with this feature vanishes when you finish a Long Rest.",
      ]),
      toNotesPage: [{
        name: "Creating Spell Slots",
        note: [
          "Spell Slot Level	Sorcery Point Cost	Min. Sorcerer Level",
          "		1					2					2			",
          "		2					3					3			",
          "		3					5					5			",
          "		4					6					7			",
          "		5					7					9			",
        ],
      }],
    },
    "metamagic": {
      name: "Metamagic",
      source: [["PHB2024", 141]],
      minlevel: 2,
      extraname: "Metamagic Options",
      extrachoices: ["Careful Spell", "Distant Spell", "Empowered Spell", "Extended Spell", "Heightened Spell", "Quickened Spell", "Seeking Spell", "Subtle Spell", "Transmuted Spell", "Twinned Spell"],
      extraTimes: [0, 2, 2, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 6, 6, 6, 6],
      description: desc([
        "Because your magic flows from within, you can alter your spells to suit your needs, you gain two Metamagic options of your choice from 'Metamagic Options' later in this class's description. You use the chosen options to temporarily modify spells you cast. To use an option, you must spend the number of Sorcery Points that it costs.",
        "You can use only one Metamagic option on a spell when yo cast it unless otherwise noted in one of those options.",
        "Whenever you gain a Sorcerer level, you ca replace one of your Metamagic options with one you don't know. You gain two more options at Sorcerer level 10 and two more at Sorcerer level 17.",
      ]),
      "careful spell": {
        name: "Careful Spell",
        description: desc([
          "[1 Sorcery Point] When you cast a spell that forces other creatures to make a saving throw, you can protect some of those creatures from the spell's full force. To do so, spend 1 Sorcery Point and choose a number of those creatures up to your Charisma modifier (minimum of one creature). A chosen creature automatically succeeds on its saving throw against the spell, and it takes no damage if it would normally take half damage on a successful save.",
        ]),
      },
      "distant spell": {
        name: "Distant Spell",
        description: desc([
          "[1 Sorcery Point] When you cast a spell that has a range of at least 5 feet, you can spend 1 Sorcery Point to double the spell's range. Or when you cast a spell that has a range of Touch, you can spend 1 Sorcery Point to make the spell's range 30 feet.",
        ]),
      },
      "empowered spell": {
        name: "Empowered Spell",
        description: desc([
          "[1 Sorcery Point] When you roll damage for a spell, you can spend 1 Sorcery Point to reroll a number of the damage dice up to your Charisma modifier (minimum of one). and you must use the new rolls.",
          "You can use Empowered Spell even if you've already used a different Metamagic option during the casting of the spell.",
        ])
      },
      "extended spell": {
        name: "Extended Spell",
        description: desc([
          "[1 Sorcery Point] When you cast a spell that has a duration of 1 minute or longer, you can spend 1 Sorcery Point to double its duration to a maximum duration of 24 hours.",
          "If the affected spell requires Concentration, you have Advantage on any saving throw you make to maintain Concentration.",
        ]),
      },
      "heightened spell": {
        name: "Heightened Spell",
        description: desc([
          "[2 Sorcery Points] When you cast a spell that forces a creature to make a saving throw, you can spend 2 Sorcery Points to give one target of the spell Disadvantage on saves against the spell.",
        ]),
      },
      "quickened spell": {
        name: "Quickened Spell",
        description: desc([
          "[2 Sorcery Points] When you cast a spell that has a casting time of an action, you can spend 2 Sorcery Points to change the casting time to a Bonus Action for this casting, you can't modify a spell in this way if you've already cast a level 1+ spell on the current turn, nor can you cast a level 1+ spell on this turn after modifying a spell in this way.",
        ]),
      },
      "seeking spell": {
        name: "Seeking Spell",
        description: desc([
          "[1 Sorcery Point] If you make an attack roll for a spell and miss, you can spend 1 Sorcery Point to reroll the d20, and you must use the new roll.",
          "You can use Seeking Spell even if you've already used a different Metamagic option during the casting of the spell.",
        ]),
      },
      "subtle spell": {
        name: "Subtle Spell",
        description: desc([
          "[1 Sorcery Point] When you cast a spell, you can spend 1 Sorcery Point to cast it without any Verbal, Somatic, or Material components, except Material Components that are consumed by the spell or that have a cost specified in the spell.",
        ]),
      },
      "transmuted spell": {
        name: "Transmuted Spell",
        description: desc([
          "[1 Sorcery Point] When you cast a spell that deals a type of damage from the following list, you can spend 1 Sorcery Point to change that damage type to one of the other listed types; Acid, Cold, Fire, Lightning, Poison, Thunder.",
        ]),
      },
      "twinned spell": {
        name: "Twinned Spell",
        description: desc([
          "[1 Sorcery Point] When you cast a spell, such as Charm Person, that can be cast with a higher level spell slot to target an additional creature, you can spend 1 Sorcery Point to increase the spell's effective level by 1.",
        ]),
      }
    },
    "subclassfeature3": {
      name: "Sorcerer Subclass",
      source: [["PHB2024", 141]],
      minlevel: 3,
      description: desc([
        "You gain a Sorcerer subclass of your choice. The Aberrant Sorcery, Clockwork Sorcery, Draconic Sorcery, and Wild Magic Sorcery subclasses are detailed after this class's description. A subclass is a specialization that grants you features at certain Sorcerer levels. For the rest of your career, you gain each of your subclass's features that are of your Sorcerer level or lower.",
      ]),
    },
    "sorcerous restoration": {
      name: "Sorcerous Restoration",
      source: [["PHB2024", 141]],
      minlevel: 5,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "When you finish a Short Rest, you can regain expended Sorcery Points, but no more than a number equal to half your Sorcerer level (round down).",
        "Once you use this feature, you can't do so again until you finish a Long Rest",
      ]),
    },
    "sorcery incarnate": {
      name: "Sorcery Incarnate",
      source: [["PHB2024", 141]],
      minlevel: 7,
      description: desc([
        "If you have no uses of Innate Sorcery left, you can use it if you spend 2 Sorcery Points when you take the Bonus Action to activate it.",
        "In addition, while your Innate Sorcery feature is active, you can use up to two of your Metamagic options on each spell you cast.",
      ]),
    },
    "epic boon": {
      name: "Epic Boon",
      source: [["PHB2024", 141]],
      minlevel: 19,
      description: desc([
        "You gain an Epic Boon feat (see chapter 5) or another feat of your choice for which you qualify. Boon of Dimensional Travel is recommended.",
      ]),
    },
    "arcane apotheosis": {
      name: "Arcane Apotheosis",
      source: [["PHB2024", 141]],
      minlevel: 20,
      description: desc([
        "While you Innate Sorcery feature is active, you can use one Metamagic option on each of your turns without spending Sorcery Points to do so.",
      ]),
    },
  },
});
legacySubClassRefactor("sorcerer", "aberrant", {
  regExpSearch: /^(?=.*(sorcerer))(?=.*(aberrant)).*$/i,
  subname: "Aberrant Sorcery",
  source: [["PHB2024", 145]],
  replaces: "aberrant mind",
  spellcastingExtra: ["arms of hadar", "calm emotions", "detect thoughts", "dissonant whispers", "mind sliver", "hunger of hadar", "sending", "evard's black tentacles", "summon aberration", "rary's telepathic bond", "telekinesis"],
  features: {
    "subclassfeature3": {
      name: "Telepathic Speech",
      source: [["PHB2024", 145]],
      minlevel: 3,
      action: "bonus action",
      description: desc([
        "You can form a telepathic connection between your mind and the mind of another. As a Bonus Action choose one creature you can see within 30 feet of yourself. You and the chosen creature can communicate telepathically with each other while the two of you are within a number of miles of each other equal to your Charisma modifier (minimum of 1 mile). To understand each other, you each must mentally use a language the other knows.",
        "The telepathic connection lasts for a number of minutes equal to your Sorcerer level. It ends early if you use this ability to form a connection with a different creature.",
      ]),
    },
    "subclassfeature6": {
      name: "Psionic Sorcery",
      source: [["PHB2024", 146]],
      minlevel: 6,
      description: desc([
        "When you cast any level 1+ spell from your Psionic Spells feature, you can cast it by expending a spell slot as normal or by spending a number of Sorcery Points equal to the spell's level. If you cast the spell using Sorcery Points, it requires no Verbal or Somatic components, and it requires no Material components unless the are consumed by the spell or have a cost specified in it.",
      ]),
    },
    "subclassfeature6.1": {
      name: "Psychic Defense",
      source: [["PHB2024", 146]],
      minlevel: 6,
      dmgres: "Psychic",
      savetxt: {adv_vs: ["Charmed", "Frightened"]},
      description: desc([
        "You have Resistance to Psychic damage, and you have Advantage on saving throws to avoid or end the Charmed or Frightened condition.",
      ]),
    },
    "subclassfeature14": {
      name: "Revelation in Flesh",
      source: [["PHB2024", 146]],
      minlevel: 14,
      action: "bonus action",
      description: desc([
        "You can unleash the aberrant truth hidden within yourself. As a Bonus Action, you can spend 1 Sorcery Point or more to magically alter your body for 10 minutes. For each Sorcery Point you spend, you gain one of the following benefits of your choice, the effects of which last until the alteration ends.",
        "Aquatic Adaptation : You gain a Swim Speed equal to twice your Speed, and you can breathe underwater. Gills grow from your neck or flare behind your ears, and your fingers become webbed or you grow wriggling cilia.",
        "Glistening Flight : You gain a Fly Speed equal to your Speed, and you can hover. As you fly, your skin glistens with mucus or otherworldly light.",
        "See the Invisible : You can see any Invisible creature within 60 feet of yourself that isn't behind Total Cover. Your eyes also turn black or become writhing sensory tendrils.",
        "Wormlike Movement : Your body, along with any equipment you are wearing or carrying, becomes slimy and pliable. You can move through any space as narrow as 1 inch, and you can spend 5 feet of movement to escape from nonmagical restraints or the Grappled condition.",
      ]),
    },
    "subclassfeature18": {
      name: "Warping Implosion",
      source: [["PHB2024", 146]],
      minlevel: 18,
      action: "action",
      usages: 1,
      recovery: "long rest",
      altResource: "5 SP",
      description: desc([
        "You can unleash a space-warping anomaly. As a Magic action, you teleport to an unoccupied space you can see within 120 feet of yourself. Immediately after you disappear, each creature within 30 feet of the space you left must make a Strength saving throw against your spell save DC. On a failed save a creature takes 3d10 Force damage, and is pulled straight toward the space you left, ending in the unoccupied space as close to your former space as possible. On a successful save, the creature takes half as much damage only.",
        "Once you use this feature, you can't do so again until you finish a Long Rest unless you spend 5 sorcery Points (no action required) to restore your uses of it.",
      ]),
    },
  },
});
legacySubClassRefactor("sorcerer", "clockwork", {
  regExpSearch: /^(?=.*(sorcerer))(?=.*(clockwork)).*$/i,
  subname: "Clockwork Sorcery",
  source: [["PHB2024", 146]],
  replaces: "clockwork soul",
  spellcastingExtra: ["aid", "alarm", "lesser restoration", "protection from evil and good", "dispel magic", "protection from energy", "freedom of movement", "summon construct", "greater restoration", "wall of force"],
  features: {
    "subclassfeature3": {
      name: "Clockwork Spells",
      source: [["PHB2024", 146]],
      minlevel: 3,
      description: desc([
        "In addition, consult the Manifestation of Order table and choose or randomly determine a way you connect to order manifests while you are casting any of your Sorcerer spells.",
      ]),
      toNotesPage: [{
        name: "Manifestations of Order",
        note: [
          "1		Spectral cog wheels hover behind you.",
          "2		The hands of a clock spin in your eyes.",
          "3		Your skin glows with a brassy sheen.",
          "4		Floating equations and geometric objects overlay your body",
          "5 		Your Spellcasting Focus temporarily takes the form of a Tiny clockwork mechanism.",
          "6		The ticking of gears or ringing of a clock can be heard by you and those affected by your magic.",
        ],
      }],
    },
    "subclassfeature3.1": {
      name: "Restore Balance",
      source: [["PHB2024", 146]],
      minlevel: 3,
      usages: "Charisma modifier per ",
      usagescalc: "event.value = Math.max(1, What('Cha Mod'));",
      recovery: "long rest",
      description: desc([
        "Your connection to the plane of absolute order allows you t equalize chaotic moments. When a creature you can see within 60 feet of yourself is about to roll a d20 with Advantage or Disadvantage, you can take a Reaction to prevent the roll from being affected by Advantage and Disadvantage.",
        "You can use this feature a number of times equal to your Charisma modifier (minimum of once), and you regain all expended uses when you finish a Long Rest",
      ]),
    },
    "subclassfeature6": {
      name: "Bastion of Law",
      source: [["PHB2024", 147]],
      minlevel: 6,
      action: ["action", "Bastion of Law 1-5 SP"],
      description: desc([
        "You can tap into the grand equation of existence to imbue a creature with a shimmering shield of order. As a Magic action, you can expend 1 to 5 Sorcery Points to create a magical ward around yourself or another creature you can see within 30 feet of yourself. The ward is represented by a number of d8s equal to the number of Sorcery Points spent to create it. When the warded creature takes damage it can expend a number of those dice, roll them and reduce the damage taken by the total rolled on those dice.",
        "The ward lasts until you finish a Long Rest or until you use this feature again.",
      ]),
    },
    "subclassfeature14": {
      name: "Trance of Order",
      source: [["PHB2024", 147]],
      minlevel: 14,
      action: "bonus action",
      usages: 1,
      recovery: "long rest",
      altResource: "5 SP",
      description: desc([
        "You gain the ability to align your consciousness with the endless calculations of Mechanus. As a Bonus Action, you can enter this state for 1 minute. For the duration attack rolls against you can't benefit from Advantage, and whenever you make a D20 Test, you can treat a roll of 9 or lower on the D20 as a 10.",
        "Once you use this feature, you can't use it again until you finish a Long Rest unless you spend 5 Sorcery Points (no action required) to restore your use of it.",
      ]),
    },
    "subclassfeature18": {
      name: "Clockwork Cavalcade",
      source: [["PHB2024", 147]],
      minlevel: 18,
      action: "action",
      usages: 1,
      recovery: "long rest",
      altResource: "7 SP",
      description: desc([
        "You momentarily summon spirits of order to expunge disorder around you. As a Magic action, you summon the spirits in a 30-foot Cube originating from you. The spirits look like modrons or other Constructs of your choice. The spirits are intangible and invulnerable, and they create the effects below within the Cube before vanishing, Once you use this action, you cant use it again until you finish a Long Rest unless you spend 7 Sorcery Points (no action required) to restore your use of it.",
        "Heal : The spirits restore up to 100 Hit Points divided as you choose among any number of creatures of your choice in the Cube.",
        "Repair : Any damaged objects entirely in the Cube are repaired instantly.",
        "Dispel : Every spell of level 6 or lower ends n creatures and objects of your choice in the Cube.",
      ]),
    },
  },
});
legacySubClassRefactor("sorcerer", "draconic", {
  regExpSearch: /^(?=.*(sorcerer))(?=.*(draconic)).*$/i,
  subname: "Draconic Sorcery",
  source: [["PHB2024", 148]],
  replaces: "draconic bloodline",
  spellcastingExtra: ["alter self", "chromatic orb", "command", "dragon's breath", "fear", "fly", "arcane eye", "charm monster", "legend lore", "summon dragon"],
  features: {
    "subclassfeature3": {
      name: "Draconic Resilience",
      source: [["PHB2024", 148]],
      minlevel: 3,
      armorOptions: [{
        regExpSearch: /justToAddToDropDownAndEffectWildShape/,
        name: "Unarmored Defense (Cha)",
        source: [["PHB2024", 148]],
        ac: "10+Cha",
        affectsWildShape: true,
        selectNow: true
      }],
      calcChanges: {
        hp: function (totalHD, HDobj, prefix) {
          if (classes.known.sorcerer) {
            return [classes.known.sorcerer.level, "Draconic Resilience (Sorcerer)"];
          }
        },
      },
      description: desc([
        "The magic in your body manifests physical traits of your draconic gift. Your Hit Point maximum increases by 3, and it increases by 1 whenever you gain another Sorcerer level.",
        "Parts of you are also covered in dragon-like scales. While you aren't wearing armor, your base Armor Class equals 10 plus your Dexterity and Charisma modifiers.",
      ]),
    },
    "subclassfeature6": {
      name: "Elemental Affinity",
      source: [["PHB2024", 148]],
      minlevel: 6,
      description: desc([
        "Your draconic magic has an affinity with a damage type associated with dragons. Choose one of those types; Acid, Cold, Fire, Lightning, or Poison.",
        "You have Resistance to that damage type, and when you cast a spell that deals damage of that type, you can add your Charisma modifier to one damage roll of that spell.",
      ]),
      choices: ["Acid Affinity", "Cold Affinity", "Fire Affinity", "Lightning Affinity", "Poison Affinity"],
      "acid affinity": {
        name: "Acid Affinity",
        dmgres: "Acid",
        description: "Thanks to your Draconic association you gain resistance to Acid damage and any spells you cast that deal Acid damage gain a bonus to damage equal to your Charisma modifier, which can be applied to one damage roll of that spell.",
      },
      "cold affinity": {
        name: "Cold Affinity",
        dmgres: "Cold",
        description: "Thanks to your Draconic association you gain resistance to Cold damage and any spells you cast that deal Cold damage gain a bonus to damage equal to your Charisma modifier, which can be applied to one damage roll of that spell.",
      },
      "fire affinity": {
        name: "Fire Affinity",
        dmgres: "Fire",
        description: "Thanks to your Draconic association you gain resistance to Fire damage and any spells you cast that deal Fire damage gain a bonus to damage equal to your Charisma modifier, which can be applied to one damage roll of that spell.",
      },
      "lightning affinity": {
        name: "Lightning Affinity",
        dmgres: "Lightning",
        description: "Thanks to your Draconic association you gain resistance to Lightning damage and any spells you cast that deal Lightning damage gain a bonus to damage equal to your Charisma modifier, which can be applied to one damage roll of that spell.",
      },
      "poison affinity": {
        name: "Poison Affinity",
        dmgres: "Poison",
        description: "Thanks to your Draconic association you gain resistance to Poison damage and any spells you cast that deal Poison damage gain a bonus to damage equal to your Charisma modifier, which can be applied to one damage roll of that spell.",
      },
    },
    "subclassfeature14": {
      name: "Dragon Wings",
      source: [["PHB2024", 148]],
      minlevel: 14,
      action: "bonus action",
      usages: 1,
      recovery: "long rest",
      altResource: "3 SP",
      description: desc([
        "As a Bonus Action, you can cause draconic wings to appear on your back. The wings last for 1 hour or until you dismiss them (no action required). For the duration, you have a Fly Speed of 60 feet.",
        "Once you use this feature, you can't use it again until you finish a Long Rest unless you spend 3 Sorcery Points (no action required) to restore your use of it.",
      ]),
    },
    "subclassfeature18": {
      name: "Dragon Companion",
      source: [["PHB2024", 149]],
      minlevel: 18,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "You can cast Summon Dragon without a Material component. You can also cast it once without a spell slot, you regain the ability to cast it in this way when you finish a Long Rest.",
        "Whenever you start casting the spell, you can modify it so that it doesn't require Concentration. If you do so the spell's duration becomes 1 minute for that casting.",
      ]),
    },
  },
});
legacySubClassRefactor("sorcerer", "wild magic", {
  regExpSearch: /^(?=.*(sorcerer))(?=.*(wild ))(?=.*(magic)).*$/i,
  subname: "Wild Magic Sorcery",
  source: [["PHB2024", 149]],
  replaces: "aberrant mind",
  features: {
    "subclassfeature3": {
      name: "Wild Magic Surge",
      source: [["PHB2024", 149]],
      minlevel: 3,
      description: desc([
        "Your spellcasting can unleash surges of untamed magic. Once per turn, you can roll 1d20 immediately after you cast a Sorcerer spell with a spell slot. If you roll a 20, roll on the Wild Magic Surge table to create a magical effect.",
        "If the magical effect is a spell, it is to wild to be affected by your Metamagic.",
      ]),
      toNotesPage: [{
        name: "Wild Magic Surge",
        note: [
          "1d100 : Effect",
          "01-04 : Roll on this table at the start of each of your turns for the next minute, ignoring this result on subsequent rolls.",
          "05-08 : A creature that is Friendly toward you appears in a random unoccupied space within 60 feet of you. The creature is under the DM's control and disappears 1 minute later. Roll 1d4 to determine the creature, on a 1. a Modron Duodrone appears, on a 2. a Flumph appears, on a 3. a Modrone Monodrone appears, on a 4. a Unicorn appears. See the Monster Manual for the creature's stat block.",
          "09-12 : For the next minute, you regain 5 Hit Points at the start of each of your turns.",
          "13-16 : Creatures have Disadvantage on saving throws against the next spell you cast in the next minute that involves a saving throw.",
          "17-20 : You are subjected to an effect that lasts for 1 minute unless its description says otherwise. Roll 1d8 to determine the effect, on a 1. you're surrounded by faint, ethereal music only you and creatures within 5 feet of you can hear, on a 2. your size increases by one size category, on a 3. you grow a long beard made of feathers that remains until you sneeze at which point the feathers explode from your face and vanish, on a 4. you must shout when you speak, on a 5. illusory butterflies flutter in the air within 10 feet of you, on a 6. an eye appears on your forehead granting you advantage on Wisdom (Perception) checks, on a 7. Pink bubbles float out of your mouth whenever you speak, on an 8. your skin turns a vibrant shade of blue for 24 hours or until the effect is ended by a Remove Curse spell.",
          "21-24 : For the next minute, all your spells with a casting time of an action have a casting time of a Bonus Action.",
          "25-28 : You are transported to the Astral Plane until the end of your next turn. You then return to the space you previously occupied or the nearest unoccupied space if that space is occupied.",
          "29-32 : The next time you cast a spell that deals damage within the next minute, don't roll the spell's damage dice for the damage, instead use the highest number possible for each damage die.",
          "33-36 : You have Resistance to all damage for the next minute.",
          "37-40 : You turn into a potted plant until the start of your next turn. While you're a plant, you have the Incapacitated condition and have Vulnerability to all damage. If you drop to 0 Hit Points, your pot breaks, and your form reverts.",
          "41-44 : For the next minute you can teleport up to 20 feet as a Bonus Action on each of your turns.",
          "45-48 : You and up to three creatures you choose within 30 feet of you have the invisible condition for 1 minute. This invisibility ends on a creature immediately after it makes an attack roll, deals damage, or casts a spell.",
          "49-52 : A spectral shield hovers near you for the next minute, granting you a +2 bonus to AC and immunity to Magic Missile.",
          "53-56 : You can take one extra action on this turn.",
          "57-60 : You cast a random spell, if the spell normally requires Concentration it doesn't require Concentration in this case the spell lasts for its full duration. Roll 1d10 to determine the spell; on a 1. Confusion, on a 2. Fireball, on a 3. Fog Cloud, on a 4. Fly (cast on a random creature within 60 feet of you), on a 5 Grease, on a 6. Levitate (cast on yourself), on a 7. Magic Missile (cast as a level 5 spell), on an 8. Mirror Image, on a 9. Polymorph (cast on yourself), and if you fail the saving throw you turn into a Goat (see appendix B), on a 10. See Invisibility.",
          "61-64 : For the next minute, any flammable, non-magical object you touch that isn't being worn or carried by another creature bursts into flame, takes 1d4 Fire damage, and is burning.",
          "65-68 : If you die within the next hour, you immediately revive as if by the Reincarnate spell.",
          "69-72 : You have the Frightened condition until the end of your next turn. The DM determines the source of your fear.",
          "73-76 : You teleport up to 60 feet to an unoccupied space you can see.",
          "77-80 : A random creature within 60 feet of you has the poisoned condition for 1d4 hours.",
          "81-84 : You radiate Bright Light in a 30-foot radius for the next minute. Any creature that ends its turn within 5 feet of you has the Blinded condition until the end of its next turn.",
          "85-88 : Up to three creatures of your choice that you can see within 30 feet of you take 1d10 Necrotic damage, you regain Hit Points equal to the sum of the Necrotic damage dealt.",
          "89-92 : Up to three creatures of your choice you can see within 30 feet of you take 4d10 Lightning damage.",
          "93-96 : You and all creatures within 30 feet of you have Vulnerability to Piercing damage for the next minute.",
          "97-00 : Roll 1d6; On a 1. you regain 2d10 Hit Points, on a 2. one ally of your choice within 300 feet of you regains 2d10 Hit Points, on a 3. you regain your lowest-level expended spell slot, on a 4. one ally of your choice within 300 feet of you regains their lowest-level expended spell slot, on a 5. you regain all your expended Sorcery Points, on a 6. all the effects of row 17-20 affect you simultaneously.",
        ],
      }],
    },
    "subclassfeature3.1": {
      name: "Tides of Chaos",
      source: [["PHB2024", 149]],
      minlevel: 3,
      usages: 1,
      recovery: "long rest",
      altResource: "Cast a Leveled Spell",
      description: desc([
        "You can manipulate chaos itself to give yourself Advantage on one D20 Test before you roll the d20. Once you do so, you must cast a Sorcerer spell with a spell slot or finish a Long Rest before you can use this feature again.",
        "If you do cast a Sorcerer spell with a spell slot before you finish a Long Rest, you automatically roll on the Wild Magic Surge table.",
      ]),
    },
    "subclassfeature6": {
      name: "Bend Luck",
      source: [["PHB2024", 149]],
      minlevel: 6,
      action: "reaction",
      description: desc([
        "You have the ability to twist fate using your wild magic, Immediately after another creature you can see rolls the d20 for a D20 Test, you can take a Reaction and spend 1 Sorcery Point to roll 1d4 and apply the number rolled as a bonus or penalty (your choice) to the d20 roll.",
      ]),
    },
    "subclassfeature14": {
      name: "Controlled Chaos",
      source: [["PHB2024", 149]],
      minlevel: 14,
      description: desc([
        "You gain a modicum of control over the surges of your wild magic. Whenever you roll on the Wild Magic Surge table, you can roll twice and use either number.",
      ]),
    },
    "subclassfeature18": {
      name: "Tamed Surge",
      source: [["PHB2024", 150]],
      minlevel: 18,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "Immediately after you cast a Sorcerer spell with a spell slot, you can create an effect of your choice from the Wild Magic Surge table instead of rolling on the Table. You can choose any effect in the table except for the final row, and if the chosen effect involves a roll you must make it.",
        "Once you use this feature, you can't do so again until you finish a Long Rest.",
      ]),
    },
  },
});
legacyClassRefactor("warlock", {
  regExpSearch: /warlock/i,
  name: "Warlock",
  source: [["PHB2024", 153]],
  primaryAbility: ["Charisma"],
  abilitySave: 6,
  prereqs: "Charisma 13",
  improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
  die: 8,
  saves: ["Con", "Cha"],
  skillstxt: {
    primary: "Choose 2:Arcana, Deception, History, Intimidation, Investigation, Nature, or Religion",
  },
  armorProfs: {
    primary: [true, false, false, false],
    secondary: [true, false, false, false],
  },
  weaponProfs: {
    primary: [true, false],
    secondary: [false, false],
  },
  equipment: "Warlock starting equipment:" +
    "\n \u2022 Leather Armor;" +
    "\n \u2022 Sickle;" +
    "\n \u2022 2 Daggers;" +
    "\n \u2022 An Arcane Focus (orb);" +
    "\n \u2022 A Book (Occult Lore);" +
    "\n \u2022 A Scholar's Pack, and 15 gp." +
    "\n\nAlternatively, choose 100 gp worth of starting equipment instead of the class's starting equipment.",
  subclasses: ["Warlock Subclass", []],
  attacks: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
  spellcastingAbility: 6,
  spellcastingFactor: "warlock1",
  spellcastingKnown: {
    cantrips: [2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
    spells: "list",
    prepared: true,
  },
  features: {
    "eldritch invocations": {
      name: "Eldritch Invocations",
      source: [["PHB2024", 153]],
      minlevel: 1,
      description: desc([
        "You have unearthed Eldritch Invocations, pieces of forbidden knowledge that imbue you with an abiding magical ability or other lessons. You gain one invocation of your choice, such as Pact of the Tome. Invocations are described in the 'Eldritch Invocations Options' section later in this class's description.",
        "Prerequisites : If an invocation has a prerequisite, you must meet it to learn that invocation. For example, if an invocation requires you to be a level 5+ Warlock, you can select the invocation once you reach Warlock level 5.",
        "Replacing and Gaining Invocations : Whenever you gain a Warlock level, you can replace one of your invocations with another one for which you qualify. You can't replace an invocation if it's a prerequisite for another invocation that you have.",
        "When you gain certain Warlock levels, you gain more invocations of your choice, as shown in the Invocations column of the Warlock Features table.",
        "You can't pick the same invocation more than once unless it's description says otherwise.",
      ]),
      extraname: "Eldritch Invocation Options",
      extrachoices: ["Agonizing Blast [Chill Touch] (2+)", "Agonizing Blast [Eldritch Blast] (2+)", "Agonizing Blast [Mind Sliver] (2+)", "Agonizing Blast [Poison Spray] (2+)", "Armor of Shadows", "Ascendant Step (5+)", "Devil's Sight (2+)", "Devouring Blade (PoB, 12+)", "Eldritch Mind", "Eldritch Smite (PoB, 5+)", "Eldritch Spear [Eldritch Blast] (2+)", "Eldritch Spear [Mind Sliver] (2+)", "Eldritch Spear [Poison Spray] (2+)", "Fiendish Vigor (2+)", "Gaze of Two Minds (5+)", "Gift of the Depths (5+)", "Gift of the Protectors (PoT, 9+)", "Investment of the Chain Master (PoC, 5+)", "Lessons of the First Ones (2+)", "Lifedrinker (PoB, 9+)", "Mask of Many Faces (2+)", "Master of Myriad Forms (5+)", "Misty Visions (2+)", "One with Shadows (5+)", "Otherworldly Leap (2+)", "Pact of the Blade", "Pact of the Chain", "Pact of the Tome", "Repelling Blast [Chill Touch] (2+)", "Repelling Blast [Eldritch Blast] (2+)", "Repelling Blast [Poison Spray] (2+)", "Thirsting Blade (PoB, 5+)", "Visions of Distant Realms (9+)", "Whispers of the Grave (7+)", "Witch Sight (15+)"],
      extraTimes: [1, 3, 3, 3, 5, 5, 6, 6, 7, 7, 7, 8, 8, 8, 9, 9, 9, 10, 10, 10],

      "agonizing blast [chill touch] (2+)": {
        name: "Agonizing Blast [Chill Touch] (2+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 2 && isSpellUsed('chill touch', true);
        },
        submenu: "[improves Damaging Cantrips]",
        calcChanges: {
          atkCalc: [
            function (fields, v, output) {
              if (v.baseWeaponName == 'chill touch') output.extraDmg += What('Cha Mod');
            },
            "I add my Charisma modifier to the damage of my Chill Touch cantrip."
          ],
          spellAdd: [
            function (spellKey, spellObj, spName) {
              if (spellKey == "chill touch") {
                spellObj.description = spellObj.description.replace("1d10 Necrotic dmg", "1d10+" + What("Cha Mod") + " Necrotic dmg");
                return true;
              }
            },
            "I add my Charisma modifier to the damage of my Chill Touch cantrip."
          ]
        },
        description: desc([
          "You add your Charisma modifier to the damage of your Chill Touch Cantrip.",
        ]),
      },
      "agonizing blast [eldritch blast] (2+)": {
        name: "Agonizing Blast [Eldritch Blast] (2+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 2 && isSpellUsed('eldritch blast', true);
        },
        submenu: "[improves Damaging Cantrips]",
        calcChanges: {
          atkCalc: [
            function (fields, v, output) {
              if (v.baseWeaponName == 'eldritch blast') output.extraDmg += What('Cha Mod');
            },
            "I add my Charisma modifier to the damage of each bolt of my Eldritch Blast cantrip."
          ],
          spellAdd: [
            function (spellKey, spellObj, spName) {
              if (spellKey == "eldritch blast") {
                spellObj.description = spellObj.description.replace("1d10 Force damage", "1d10+" + What("Cha Mod") + " Force dmg");
                return true;
              }
            },
            "I add my Charisma modifier to the damage of each bolt of my Eldritch Blast cantrip."
          ]
        },
        description: desc([
          "You add your Charisma modifier to the damage of your Eldritch Blast Cantrip.",
        ]),
      },
      "agonizing blast [mind sliver] (2+)": {
        name: "Agonizing Blast [Mind Sliver] (2+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 2 && isSpellUsed('mind sliver', true);
        },
        submenu: "[improves Damaging Cantrips]",
        calcChanges: {
          atkCalc: [
            function (fields, v, output) {
              if (v.baseWeaponName == 'mind sliver') output.extraDmg += What('Cha Mod');
            },
            "I add my Charisma modifier to the damage of my Mind Sliver cantrip."
          ],
          spellAdd: [
            function (spellKey, spellObj, spName) {
              if (spellKey == "mind sliver") {
                spellObj.description = spellObj.description.replace("1d6 Psychic dmg", "1d6+" + What("Cha Mod") + " Psychic dmg");
                return true;
              }
            },
            "I add my Charisma modifier to the damage of my Mind Sliver cantrip."
          ]
        },
        description: desc([
          "You add your Charisma modifier to the damage of your Mind Sliver Cantrip.",
        ]),
      },
      "agonizing blast [poison spray] (2+)": {
        name: "Agonizing Blast [Poison Spray] (2+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 2 && isSpellUsed('poison spray', true);
        },
        submenu: "[improves Damaging Cantrips]",
        calcChanges: {
          atkCalc: [
            function (fields, v, output) {
              if (v.baseWeaponName == 'poison spray') output.extraDmg += What('Cha Mod');
            },
            "I add my Charisma modifier to the damage of my Poison Spray cantrip."
          ],
          spellAdd: [
            function (spellKey, spellObj, spName) {
              if (spellKey == "poison spray") {
                spellObj.description = spellObj.description.replace("1d12 Poison dmg", "1d12+" + What("Cha Mod") + " Poison dmg");
                return true;
              }
            },
            "I add my Charisma modifier to the damage of my Poison Spray cantrip."
          ]
        },
        description: desc([
          "You add your Charisma modifier to the damage of your Poison Spray Cantrip.",
        ]),
      },
      "armor of shadows": {
        name: "Armor of Shadows",
        spellcastingBonus: [{
          name: "Armor of Shadows",
          spells: ["mage armor"],
          selection: ["mage armor"],
          times: 1,
          firstCol: "atwill",
        }],
        description: desc([
          "You can cast Mage Armor on yourself without expending a spell slot.",
        ]),
      },
      "ascendant step (5+)": {
        name: "Ascendant Step (5+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 5;
        },
        submenu: "[Warlock Level 5+]",
        spellcastingBonus: [{
          name: "Ascendant Step",
          spells: ["levitate"],
          selection: ["levitate"],
          times: 1,
          firstCol: "atwill",
        }],
        description: desc([
          "You can cast Levitate on yourself without expending a spell slot.",
        ]),
      },
      "devil's sight (2+)": {
        name: "Devil's Sight (2+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 2;
        },
        submenu: "[Warlock Level 2+]",
        vision: [["Devil's Sight", 120]],
        description: desc([
          "You can see normally in Dim Light and Darkness both magical and non-magical - within 120 feet of yourself.",
        ]),
      },
      "devouring blade (pob, 12+)": {
        name: "Devouring Blade (PoB, 12+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 12 && GetFeatureChoice("classes", "warlock", "eldritch invocations", true).indexOf("thirsting blade (pob, 5+)") !== -1;
        },
        submenu: "[Improves Pact of the Blade]",
        action: ["action", "Pact Weapon (3 attacks per action)"],
        description: desc([
          "The Extra Attack of your Thirsting Blade invocation confers two extra attacks rather than one.",
        ]),
      },
      "eldritch mind": {
        name: "Eldritch Mind",
        savetxt: {adv_vs: "Constitution (Concentration) Checks"},
        description: desc([
          "You have Advantage on Constitution saving throws that you make to maintain Concentration",
        ]),
      },
      "eldritch smite (pob, 5+)": {
        name: "Eldritch Smite (PoB, 5+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 5 && GetFeatureChoice("classes", "warlock", "eldritch invocations", true).indexOf("pact of the blade") !== -1;
        },
        submenu: "[Improves Pact of the Blade]",
        description: desc([
          "Once per turn when you hit a creature with your pact weapon, you can expend a Pact Magic spell slot to deal an extra 1d8 Force damage to the target, plus another 1d8 per level of the spell slot, and you can give the target the Prone condition if it is Huge or smaller.",
        ]),
      },
      "eldritch spear [eldritch blast] (2+)": {
        name: "Eldritch Spear [Eldritch Blast] (2+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 2 && isSpellUsed('eldritch blast', true);
        },
        submenu: "[improves Damaging Cantrips]",
        calcChanges: {
          atkAdd: [
            function (fields, v) {
              if (v.baseWeaponName == 'eldritch blast') fields.Range = 120 + 30 * classes.known.warlock.level * (v.rangeM ? v.rangeM : 1) + ' ft.';
            },
            "My Eldritch Blast cantrip has an increased range of (30 times my Warlock level) ft..",
            50
          ],
          spellAdd: [
            function (spellKey, spellObj, spName) {
              if (spellKey == 'eldritch blast') {
                spellObj.range = 120 + 30 * classes.known.warlock.level + ' ft.';
                if (What("Unit System") === "metric") spellObj.range = ConvertToMetric(spellObj.range, 0.5);
              }
            },
            "My Eldritch Blast cantrip has a range of (30 times my Warlock level) ft..",
            50
          ]
        },
        description: desc([
          "Your Eldritch Blast cantrip has a range of (30 times your Warlock level) ft..",
        ]),
      },
      "eldritch spear [mind sliver] (2+)": {
        name: "Eldritch Spear [Mind Sliver] (2+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 2 && isSpellUsed('mind sliver', true);
        },
        submenu: "[improves Damaging Cantrips]",
        calcChanges: {
          atkAdd: [
            function (fields, v) {
              if (v.baseWeaponName == 'mind sliver') fields.Range = 60 + 30 * classes.known.warlock.level * (v.rangeM ? v.rangeM : 1) + ' ft.';
            },
            "My Mind Sliver cantrip has an increased range of (30 times my Warlock level) ft..",
            50
          ],
          spellAdd: [
            function (spellKey, spellObj, spName) {
              if (spellKey == 'mind sliver') {
                spellObj.range = 30 * classes.known.warlock.level + ' ft.';
                if (What("Unit System") === "metric") spellObj.range = ConvertToMetric(spellObj.range, 0.5);
              }
            },
            "My Mind Sliver cantrip has a range of (30 times my Warlock level) ft..",
            50
          ]
        },
        description: desc([
          "Your Mind Sliver cantrip has a range of (30 times your Warlock level) ft..",
        ]),
      },
      "eldritch spear [poison spray] (2+)": {
        name: "Eldritch Spear [Poison Spray] (2+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 2 && isSpellUsed('poison spray', true);
        },
        submenu: "[improves Damaging Cantrips]",
        calcChanges: {
          atkAdd: [
            function (fields, v) {
              if (v.baseWeaponName == 'poison spray') fields.Range = 30 + 30 * classes.known.warlock.level * (v.rangeM ? v.rangeM : 1) + ' ft.';
            },
            "My Poison Spray cantrip has a range of (30 times my Warlock level) ft..",
            50
          ],
          spellAdd: [
            function (spellKey, spellObj, spName) {
              if (spellKey == 'poison spray') {
                spellObj.range = 30 + 30 * classes.known.warlock.level + ' ft.';
                if (What("Unit System") === "metric") spellObj.range = ConvertToMetric(spellObj.range, 0.5);
              }
            },
            "My Poison Spray cantrip has an increased range of (30 times my Warlock level) ft..",
            50
          ]
        },
        description: desc([
          "Your Poison Spray cantrip has a range of (30 times your Warlock level) ft..",
        ]),
      },
      "fiendish vigor (2+)": {
        name: "Fiendish Vigor (2+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 2;
        },
        submenu: "[Warlock Level 2+]",
        spellcastingBonus: [{
          name: "Fiendish Vigor",
          spells: ["false life"],
          selection: ["false life"],
          times: 1,
          firstCol: "atwill",
        }],
        description: desc([
          "You can cast False Life on yourself without expending a spell slot. When you cast the spell with this feature, you don't roll the die for the Temporary Hit Points; you automatically get the highest number on the die.",
        ]),
      },
      "gaze of two minds (5+)": {
        name: "Gaze of Two Minds (5+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 5;
        },
        submenu: "[Warlock Level 5+]",
        action: ["bonus action", "Gaze of Two Minds (Create/Maintain)"],
        description: desc([
          "You can use a Bonus Action to touch a willing creature and perceive through its senses until the end of your next turn. As long as the creature is on the same plane of existence as you, you can take a Bonus Action on subsequent turns to maintain this connection, extending the duration until the end of your next turn. The connection ends if you don't maintain it in this way.",
          "While perceiving through the other creature's senses, you benefit from any special senses possessed by that creature, and you can cast spells as if you were in your space or the other creature's space if the two of you are within 60 feet of each other.",
        ]),
      },
      "gift of the depths (5+)": {
        name: "Gift of the Depths (5+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 5;
        },
        submenu: "[Warlock Level 5+]",
        speed: {swim: {spd: "walk", enc: "walk"}},
        description: desc([
          "You can breathe underwater, and you gain a Swim Speed equal to your Speed.",
          "You can also cast Water Breathing once without expending a spell slot. You regain the ability to cast it in this way again when you finish a Long Rest.",
        ]),
      },
      "gift of the protectors (pot, 9+)": {
        name: "Gift of the Protectors (PoT, 9+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 9 && GetFeatureChoice("classes", "warlock", "eldritch invocations", true).indexOf("pact of the tome") !== -1;
        },
        submenu: "[Improves Pact of the Tome]",
        description: desc([
          "A new page appears in your Book of Shadows when you conjure it. With your permission, a creature can take an action to write its name on that pace, which can contain a number of names equal to your Charisma modifier (minimum of one name).",
          "When any creature whose name is on the page is reduced to 0 Hit Points but not killed outright, the creature magically drops to 1 Hit Point instead. Once this magic is triggered, no creature can benefit from it until you finish a Long Rest.",
          "As a Magic action, you can erase a name on the page by touching it.",
        ]),
      },
      "investment of the chain master (poc, 5+)": {
        name: "Investment of the Chain Master (PoC, 5+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 5 && GetFeatureChoice("classes", "warlock", "eldritch invocations", true).indexOf("pact of the chain") !== -1;
        },
        submenu: "[Improves Pact of the Chain]",
        description: desc([
          "When you cast Find Familiar, you infuse the summoned familiar with a measure of your eldritch power, granting the creature the following benefits.",
          "Aerial or Aquatic : The familiar gains either a Fly or a Swim speed (your choice) of 40 feet.",
          "Quick Attack : As a Bonus Action, you can command the familiar to take the Attack action.",
          "Necrotic or Radiant Damage : Whenever the familiar deals Bludgeoning, Piercing, or Slashing damage, you can make it deal Necrotic or Radiant damage instead.",
          "Your Save DC : If the familiar forces a creature to make a saving throw, it uses your spell save DC.",
          "Resistance : When the familiar takes damage, you can take a Reaction to grant it Resistance against that damage.",
        ]),
      },
      "lessons of the first ones (2+)": {
        name: "Lessons of the First Ones (2+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 2;
        },
        submenu: "[Warlock Level 2+]",
        eval: function () {
          AddString('Feat Note 1', 'Lessons of the First Ones (Origin)');
        },
        removeeval: function () {
          RemoveString('Feat Note 1', 'Lessons of the First Ones (Origin)');
        },
        description: desc([
          "You have received knowledge from an elder entity of the multiverse, allowing you to gain one Origin feat of your choice (see chapter 5).",
          "Repeatable : You can gain this invocation more than once. Each time you do so, choose a different Origin feat.",
        ]),
      },
      "lifedrinker (pob, 9+)": {
        name: "Lifedrinker (PoB, 9+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 9 && GetFeatureChoice("classes", "warlock", "eldritch invocations", true).indexOf("pact of the blade") !== -1;
        },
        submenu: "[Improves Pact of the Blade]",
        calcChanges: {
          atkAdd: [
            function (fields, v) {
              if (v.pactWeapon) fields.Description += (fields.Description ? '; ' : '') + '+1d6 necrotic, psychic, or radiant damage';
            },
            "I add 1d6 to the damage of my Pact Weapons. However, it won't say in the damage box that this added damage is of the necrotic, psychic, or radiant type, as it can only display a single damage type."
          ],
        },
        description: desc([
          "Once per turn when you hit a creature with your pact weapon, you can deal an extra 1d6 Necrotic, Psychic, or Radiant damage (your choice) to the creature, and you can expend one of your Hit Point Dice to roll it and regain a number of Hit Points equal to the roll plus your Constitution modifier (minimum of 1 Hit Point).",
        ]),
      },
      "mask of many faces (2+)": {
        name: "Mask of Many Faces (2+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 2;
        },
        submenu: "[Warlock Level 2+]",
        spellcastingBonus: [{
          name: "Mask of Many Faces",
          spells: ["disguise self"],
          selection: ["disguise self"],
          times: 1,
          firstCol: "atwill",
        }],
        description: desc([
          "You can cast Disguise Self on yourself without expending a spell slot.",
        ]),
      },
      "master of myriad forms (5+)": {
        name: "Master of Myriad Forms (5+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 5;
        },
        submenu: "[Warlock Level 5+]",
        spellcastingBonus: [{
          name: "Master of Myriad Forms",
          spells: ["alter self"],
          selection: ["alter self"],
          times: 1,
          firstCol: "atwill",
        }],
        description: desc([
          "You can cast Alter Self on yourself without expending a spell slot.",
        ]),
      },
      "misty visions (2+)": {
        name: "Misty Visions (2+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 2;
        },
        submenu: "[Warlock Level 2+]",
        spellcastingBonus: [{
          name: "Misty Visions",
          spells: ["silent image"],
          selection: ["silent image"],
          times: 1,
          firstCol: "atwill",
        }],
        description: desc([
          "You can cast Silent Image on yourself without expending a spell slot.",
        ]),
      },
      "one with shadows (5+)": {
        name: "One with Shadows (5+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 5;
        },
        submenu: "[Warlock Level 5+]",
        spellcastingBonus: [{
          name: "One with Shadows",
          spells: ["invisibility"],
          selection: ["invisibility"],
          times: 1,
          firstCol: "atwill",
        }],
        description: desc([
          "While you're in an area of Dim Light or Darkness, you can cast Invisibility on yourself without expending a spell slot.",
        ]),
      },
      "otherworldly leap (2+)": {
        name: "Otherworldly Leap (2+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 2;
        },
        submenu: "[Warlock Level 2+]",
        spellcastingBonus: [{
          name: "Otherworldly Leap",
          spells: ["jump"],
          selection: ["jump"],
          times: 1,
          firstCol: "atwill",
        }],
        description: desc([
          "You can cast Jump on yourself without expending a spell slot.",
        ]),
      },
      "pact of the blade": {
        name: "Pact of the Blade",
        submenu: "[Pact Boons]",
        action: ["bonus action", "Conjure Pact Weapon"],
        calcChanges: {
          atkCalc: [
            function (fields, v, output) {
              if (v.theWea.pactWeapon || ((v.isMeleeWeapon || v.theWea.isMagicWeapon || v.thisWeapon[1]) && (/\bpact\b/i).test(v.WeaponTextName))) {
                v.pactWeapon = true;
              }
            }, "",
            90
          ],
          atkAdd: [
            function (fields, v) {
              if (v.pactWeapon || v.theWea.pactWeapon || ((v.isMeleeWeapon || v.theWea.isMagicWeapon || v.thisWeapon[1]) && (/\bpact\b/i).test(v.WeaponTextName))) {
                v.pactWeapon = true;
                fields.Proficiency = true;
                if (!v.theWea.isMagicWeapon && !v.thisWeapon[1] && !(/counts as( a)? magical/i).test(fields.Description)) fields.Description += (fields.Description ? '; ' : '') + 'Counts as magical';
              }
            },
            "If I include the word 'Pact' in a melee or magic weapon's name, it gets treated as my Pact Weapon.",
            290
          ]
        },
        description: desc([
          "As a Bonus Action, you can conjure a pact weapon in your hand - a Simple or Martial Melee weapon of your choice with which you bond - or create a bond with a magic weapon you touch, you can't bond with a magic weapon if someone else is attuned to it or another Warlock is bonded with it. Until the bond ends, you have proficiency with the weapon and you can use it as a Spellcasting Focus.",
          "Whenever you attack with the bonded weapon, you can use your Charisma modifier for the attack and damage rolls instead of using Strength or Dexterity; and you can cause the weapon to deal Necrotic, Psychic, or Radiant damage or its normal damage type.",
          "Your bond with this weapon ends if you use this feature's Bonus Action again, if the weapon is more than 5 feet away from you for 1 minute or more, or If you die. A conjured weapon disappears hen the bond ends.",
        ]),
      },
      "pact of the chain": {
        name: "Pact of the Chain",
        submenu: "[Pact Boons]",
        spellcastingBonus: [{
          name: "Pact of the Chain",
          spells: ["find familiar"],
          selection: ["find familiar"],
          times: 1,
          firstCol: "atwill",
        }],
        description: desc([
          "You learn the Find Familiar spell and can cast it as a Magic action without expending a spell slot.",
          "When you cast the spell, you choose one of the normal forms for your familiar or one of the following special forms; Imp, Pseudodragon, Quasit, Skeleton, Slaad Tadpole, Sphinx of Wonder, Sprite, or Venomous Snake (see appendix B for the familiar's stat block).",
          "Additionally, when you take the Attack action, you can forgo one of your own attacks to allow your familiar to make one attack of its own with its Reaction",
        ]),
      },
      "pact of the tome": {
        name: "Pact of the Tome",
        submenu: "[Pact Boons]",
        spellcastingBonus: [{
          name: "Pact of the Tome",
          "class": "any",
          level: [0, 0],
          times: 3,
        }, {
          name: "Pact of the Tome",
          "class": "any",
          level: [1, 1],
          times: 2,
          ritual: true,
        }],
        description: desc([
          "Stitching together strands of shadow, you conjure forth a boo in your hand at the end of a Short or Long Rest. This Book of Shadows (you determine its appearance) contains eldritch magic that only you can access, granting you the benefits below. The book disappears if you conjure another book with this feature or if you die.",
          "Cantrips and Rituals : When the book appears, choose three cantrips, and choose two level 1 spells that have the Ritual tag. The spells can be from any class's spell list, and they must be spells you don't already have prepared. While the book is on your person, you have the chosen spells prepared, and they function as Warlock spells for you.",
          "Spellcasting Focus : You can use the book as a Spellcasting Focus.",
        ]),
      },
      "repelling blast [chill touch] (2+)": {
        name: "Repelling Blast [Chill Touch] (2+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 2 && isSpellUsed('chill touch', true);
        },
        submenu: "[improves Damaging Cantrips]",
        calcChanges: {
          atkAdd: [
            function (fields, v) {
              if (v.baseWeaponName == 'chill touch') fields.Description += '; Target pushed back 10 ft.';
            },
            "When you hit a Large or smaller creature with Chill Touch, you can push the creature up to 10 feet straight away from you.",
            51
          ],
          spellAdd: [
            function (spellKey, spellObj, spName) {
              if (spellKey == 'chill touch') {
                spellObj.description = "Melee spell attack for 1d10 Necrotic dmg \u0026 push 10 ft.; can't regain HP; +1d10 at CL 5, 11, and 17";
                spellObj.descriptionShorter = "Melee spell attack for 1d10 Necrotic dmg \u0026 push 10 ft.; can't regain HP; +1d10 at CL 5/11/17";
                spellObj.descriptionCantripDie = "Melee spell attack for `CD`d10 Necrotic dmg \u0026 push 10 ft.; can't regain HP";
              }
            },
            "When you hit a Large or smaller creature with Chill Touch, you can push the creature up to 10 feet straight away from you.",
            51
          ]
        },
        description: desc([
          "When you hit a Large or smaller creature with Chill Touch, you can push the creature up to 10 feet straight away from you.",
        ]),
      },
      "repelling blast [eldritch blast] (2+)": {
        name: "Repelling Blast [Eldritch Blast] (2+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 2 && isSpellUsed('eldritch blast', true);
        },
        submenu: "[improves Damaging Cantrips]",
        calcChanges: {
          atkAdd: [
            function (fields, v) {
              if (v.baseWeaponName == 'eldritch blast') fields.Description += '; Target pushed back 10 ft.';
            },
            "When you hit a Large or smaller creature with Eldritch Blast, you can push the creature up to 10 feet straight away from you.",
            51
          ],
          spellAdd: [
            function (spellKey, spellObj, spName) {
              if (spellKey == 'eldritch blast') {
                spellObj.description = "Spell attack beam 1d10 Force damage \u0026 push 10 ft.; beams can be combined; +1 beam at CL5,11,17";
                spellObj.descriptionShorter = "Spell atk beam 1d10 Force damage \u0026 push 10 ft.; can combine beams; +1 beam at CL5,11,17";
                spellObj.descriptionCantripDie = "Spell atk for `CD` beam(s), each 1d10 Force damage \u0026 push 10 ft.; can combine/split beams";
              }
            },
            "When you hit a Large or smaller creature with Eldritch Blast, you can push the creature up to 10 feet straight away from you.",
            51
          ]
        },
        description: desc([
          "When you hit a Large or smaller creature with Eldritch Blast, you can push the creature up to 10 feet straight away from you.",
        ]),
      },
      "repelling blast [poison spray] (2+)": {
        name: "Repelling Blast [Poison Spray] (2+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 2 && isSpellUsed('poison spray', true);
        },
        submenu: "[improves Damaging Cantrips]",
        calcChanges: {
          atkAdd: [
            function (fields, v) {
              if (v.baseWeaponName == 'poison spray') fields.Description += '; Target pushed back 10 ft.';
            },
            "When you hit a Large or smaller creature with Poison Spray, you can push the creature up to 10 feet straight away from you.",
            51
          ],
          spellAdd: [
            function (spellKey, spellObj, spName) {
              if (spellKey == 'poison spray') {
                spellObj.description = "Spell attack for 1d12 Poison dmg \u0026 push 10 ft.; +1d12 at CL 5, 11, and 17";
                spellObj.descriptionCantripDie = "Spell attack for `CD`d12 Poison dmg \u0026 push 10 ft.";
              }
            },
            "When you hit a Large or smaller creature with Poison Spray, you can push the creature up to 10 feet straight away from you.",
            51
          ]
        },
        description: desc([
          "When you hit a Large or smaller creature with Poison Spray, you can push the creature up to 10 feet straight away from you.",
        ]),
      },
      "thirsting blade (pob, 5+)": {
        name: "Thirsting Blade (PoB, 5+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 5 && GetFeatureChoice("classes", "warlock", "eldritch invocations", true).indexOf("pact of the blade") !== -1;
        },
        submenu: "[Improves Pact of the Blade]",
        action: ["action", "Pact Weapon (2 attacks per action)"],
        description: desc([
          "You gain the Extra Attack feature for your pact weapon only. With that feature, you can attack twice with the weapon instead of once when you take the Attack action on your turn.",
        ]),
      },
      "visions of distant realms (9+)": {
        name: "Visions of Distant Realms (9+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 9;
        },
        submenu: "[Warlock Level 9+]",
        spellcastingBonus: [{
          name: "Visions of Distant Realms",
          spells: ["arcane eye"],
          selection: ["arcane eye"],
          times: 1,
          firstCol: "atwill",
        }],
        description: desc([
          "You can cast Arcane Eye without expending a spell slot.",
        ]),
      },
      "whispers of the grave (7+)": {
        name: "Whispers of the Grave (7+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 7;
        },
        submenu: "[Warlock Level 7+]",
        spellcastingBonus: [{
          name: "Whispers of the Grave",
          spells: ["speak with dead"],
          selection: ["speak with dead"],
          times: 1,
          firstCol: "atwill",
        }],
        description: desc([
          "You can cast Speak with Dead without expending a spell slot.",
        ]),
      },
      "witch sight (15+)": {
        name: "Witch Sight (15+)",
        prereqeval: function (v) {
          return classes.known.warlock.level >= 15;
        },
        submenu: "[Warlock Level 15+]",
        vision: [["Truesight", 30]],
        description: desc([
          "You have Truesight with a range of 30 feet.",
        ]),
      },
    },
    "pact magic": {
      name: "Pact Magic",
      source: [["PHB2024", 153 - 154]],
      minlevel: 1,
      additional: levels.map(function (n, idx) {
        var cantr = [2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4][idx];
        var splls = [2, 3, 4, 5, 6, 7, 8, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 15][idx];
        return cantr + " cantrips \u0026 " + splls + " spells prepared";
      }),
      calcChanges: {
        spellCalc: [
          function (type, spellcasters, ability) {
            if (type === "prepare" && spellcasters.indexOf("warlock") !== -1) {
              var lvl = classes.known.warlock.level;
              var sArr = [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 15];
              return sArr[lvl] - lvl - Number(What("Cha Mod"));
            }
          }
        ]
      },
      description: desc([
        "Through occult ceremony, you have formed a pact with a mysterious entity to gain magical powers. The entity is a voice in the shadows - its identity unclear - but its boon to you is concrete; the ability to cast spells. See chapter 7 for the rules on spellcasting. The information below details how you use those rules with Warlock spells, which appear in the Warlock spell list later in the class's description.",
        "Cantrips : You know two Warlock cantrips of your choice, Eldritch Blast and Prestidigitation are recommended. Whenever you gain a Warlock level, you can replace one of your cantrips from this feature with another Warlock cantrip of your choice.",
        "When you reach Warlock levels 4 and 10, you learn another Warlock cantrip of your choice, as shown in the Cantrips column of the Warlock Features table.",
        "Spell Slots : The Warlock Features table shows how many spell slots you have to cast your Warlock spells of levels 1-5. The table also shows the level of those slots, all of which are the same level. You regain all expended Pact Magic spell slots when you finish a Short or Long Rest.",
        "For example, when you're a Level 5 Warlock, you have two level 3 spell slots. To cast the level 1 spell Witch Bolt, you must expend one of those slots, and you cast it as a level 3 spell.",
        "Prepared Spells of Level 1+ : You prepare the list of level 1+ spells that are available for you to cast with this feature. To start, choose two level 1 Warlock spells. Charm Person and Hex are recommended.",
        "The number of spells on your list increases as you gain Warlock levels, as shown in the Prepared Spells column of the Warlock Features table. Whenever that number increases, choose additional Warlock spells until the number of spells on your list matches the number in the table. The chosen spells must be of a level no higher than what's shown in the table's Slot Level column for your level. When you reach level 6, for example, you learn a new Warlock spell, which can be of levels 1-3.",
        "If another Warlock feature gives you spells that you always have prepared, those spells don't count against the number of spells you can prepare with this feature, but those spells otherwise count as Warlock spells for you.",
        "Changing your Prepared Spells : Whenever you gain a Warlock level, you can replace one spell on your list with another Warlock spell of an eligible level.",
        "Spellcasting Ability : Charisma is the spellcasting ability for your Warlock spells.",
        "Spellcasting Focus : You can use an Arcane Focus as a Spellcasting Focus for your Warlock spells.",
      ]),
    },
    "magical cunning": {
      name: "Magical Cunning",
      source: [["PHB2024", 154]],
      minlevel: 2,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "You can perform an esoteric rite for 1 minute. At the end of it, you regain expended Pact Magic spell slots, but no more than a number equal to half your maximum (round up). Once you use this feature, you can't do so again until you finish a Long Rest.",
      ]),
    },
    "subclassfeature3": {
      name: "Warlock Subclass",
      source: [["PHB2024", 154]],
      minlevel: 3,
      description: desc([
        "You gain a Warlock subclass of your choice. The Archfey Patron, Celestial Patron, Fiend Patron, and Great Old One Patron subclasses are detailed after this class's description. A subclass is a specialization that grants you features at certain Warlock levels. For the rest of your career, you gain each of your subclass's features that are of your Warlock level or lower.",
      ]),
    },
    "contact patron": {
      name: "Contact Patron",
      source: [["PHB2024", 155]],
      minlevel: 9,
      usages: 1,
      recovery: "long rest",
      spellcastingBonus: [{
        name: "Contact Patron",
        spells: ["contact other plane"],
        selection: ["contact other plane"],
        times: 1,
        firstCol: "oncelr",
      }],
      description: desc([
        "In the past, you usually contacted your patron through intermediaries. Now you can communicate directly, you always have the Contact Other Plane spell prepared. With this feature, you can cast the spell without expending a spell slot to contact your patron, and you automatically succeed on the spell's saving throw.",
        "Once you use this feature, you can't do so again until you finish a Long Rest.",
      ]),
    },
    "mystic arcanum": {
      name: "Mystic Arcanum",
      source: [["PHB2024", 155]],
      minlevel: 11,
      spellcastingBonus: [{
        name: "Mystic Arcanum (level 6)",
        "class": "warlock",
        level: [6, 6],
        times: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        firstCol: "oncelr",
      }, {
        name: "Mystic Arcanum (level 7)",
        "class": "warlock",
        level: [7, 7],
        times: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1],
        firstCol: "oncelr",
      }, {
        name: "Mystic Arcanum (level 8)",
        "class": "warlock",
        level: [8, 8],
        times: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1],
        firstCol: "oncelr",
      }, {
        name: "Mystic Arcanum (level 9)",
        "class": "warlock",
        level: [9, 9],
        times: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1],
        firstCol: "oncelr",
      }],
      description: desc([
        "Your patron grants you a magical secret called an arcanum. Choose one level 6 Warlock spell as this arcanum.",
        "You can cast your arcanum spell once without expending a spell slot, and you must finish a Long Rest before you can cast it in this way again.",
        "As shown in the Warlock Features table, you gain another Warlock spell of your choice that can be cast in this way when you reach Warlock levels 13 (level 7 spell), 15 (level 8 spell), 17 (level 9 spell) You regain all uses of your Mystic Arcanum when you finish a Long Rest.",
        "Whenever you gain a Warlock level, you can replace one of your arcanum spells with another Warlock spell of the same level.",
      ]),
    },
    "epic boon": {
      name: "Epic Boon",
      source: [["PHB2024", 155]],
      minlevel: 19,
      description: desc([
        "You gain an Epic Boon feat (see chapter 5) or another feat of your choice for which you qualify. Boon of Fate is recommended.",
      ]),
    },
    "eldritch master": {
      name: "Eldritch Master",
      source: [["PHB2024", 55]],
      minlevel: 20,
      description: desc([
        "When you use your Magical Cunning feature, you regain all your expended Pact Magic spell slots.",
      ]),
    },
  },
});
legacySubClassRefactor("warlock", "the archfey", {
  regExpSearch: /^(?=.*(warlock))(?=.*(archfey)).*$/i,
  subname: "Archfey Patron",
  source: [["PHB2024", 159]],
  spellcastingExtra: ["calm emotions", "faerie fire", "misty step", "phantasmal force", "sleep", "blink", "plant growth", "dominate beast", "greater invisibility", "dominate person", "seeming"],
  features: {
    "subclassfeature3": {
      name: "Steps of the Fey",
      source: [["PHB2024", 159]],
      minlevel: 3,
      usages: "Charisma modifier per ",
      usagescalc: "event.value = Math.max(1, What('Cha Mod'));",
      recovery: "long rest",
      description: desc([
        "Your patron grants you the ability to move between the boundaries of the planes. You can cast Misty Step without expending a spell slot a number of times equal to your Charisma modifier (minimum of once), and you regain all expended uses when you finish a Long Rest.",
        "In addition, whenever you cast that spell, you can choose one of the following additional effects.",
        "Refreshing Step : Immediately after you teleport, you or one creature you can see within 10 feet of yourself gains 1d10 Temporary Hit Points.",
        "Taunting Step : Creatures within 5 feet of the space you left must succeed on a Wisdom saving throw against your spell save DC or have Disadvantage on attack rolls against creatures other than you until the start of your next turn.",

      ]),
    },
    "subclassfeature6": {
      name: "Misty Escape",
      source: [["PHB2024", 159]],
      minlevel: 6,
      description: desc([
        "You can cast Misty Step as a Reaction in response to taking damage.",
        "In addition, the following effects are now among your Steps of the Fey options.",
        "Disappearing Step : You have the Invisible condition until the start of your next turn or until immediately after you make an attack roll, deal damage, or cast a spell.",
        "Dreadful Step : Creatures within 5 feet of the space you left or the space you appear in (your choice) must succeed on a Wisdom saving throw against your spell save DC or take 2d10 Psychic damage.",
      ]),
    },
    "subclassfeature10": {
      name: "Beguiling Defenses",
      source: [["PHB2024", 159]],
      minlevel: 10,
      savetxt: {immune: ["Charmed"]},
      usages: 1,
      recovery: "long rest",
      altResource: "SS",
      description: desc([
        "Your patron teaches you how to guard your mind and body. You are immune to the Charmed condition.",
        "In addition, immediately after a creature you can see hits you with an attack roll, you can take a Reaction to reduce the damage you take by half (round down), and you can force the attacker to make a Wisdom saving throw against your spell save DC. On a failed save, the attacker takes Psychic damage equal to the damage you take. Once you use this reaction, you can't use it again until you finish a Long Rest unless you expend a Pact magic spell slot (no action required) to restore your use of it.",
      ]),
    },
    "subclassfeature14": {
      name: "Bewitching Magic",
      source: [["PHB2024", 160]],
      minlevel: 14,
      description: desc([
        "Your patron grants you the ability to wave your magic with teleportation. Immediately after you cast an Enchantment or Illusion spell using an action and a spell slot, you can cast Misty Step as part of the same action and without expending a spell slot.",
      ]),
    },
  },
});
legacySubClassRefactor("warlock", "the celestial", {
  regExpSearch: /^(?=.*(warlock))(?=.*(celestial)).*$/i,
  subname: "Celestial Patron",
  source: [["PHB2024", 160]],
  spellcastingExtra: ["aid", "cure wounds", "guiding bolt", "lesser restoration", "light", "sacred flame", "daylight", "revivify", "guardian of faith", "wall of fire", "greater restoration", "summon celestial"],
  features: {
    "subclassfeature3": {
      name: "Healing Light",
      source: [["PHB2024", 160]],
      minlevel: 3,
      limfeaname: "Healing Light (d6s)",
      usages: [0, 0, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21],
      recovery: "long rest",
      additional: "Max dice per use = Charisma Modifier",
      description: desc([
        "You gain the ability to channel celestial energy to heal wounds. You have a pool of d6s to fuel this healing. The number of dice in the pool equals 1 plus your Warlock level.",
        "As a Bonus Action, you can heal yourself or one creature you can see within 60 feet of yourself, expending dice from the pool. The maximum number of dice you can expend at once equals your Charisma modifier (minimum of one die). Roll the dice you expend, and restore a number of Hit Points equal to the roll's total. Your pool regains all expended dice when you finish a Long Rest",
      ]),
    },
    "subclassfeature6": {
      name: "Radiant Soul",
      source: [["PHB2024", 160]],
      minlevel: 6,
      dmgres: ["Radiant"],
      description: desc([
        "Your link to your patron allows you to serve as a conduit for radiant energy. You have Resistance to Radiant damage. Once per turn, when a spell you cast deals Radiant or Fire damage, you can add your Charisma modifier to the spell's damage against one of the spell's targets.",
      ]),
    },
    "subclassfeature10": {
      name: "Celestial Resilience",
      source: [["PHB2024", 161]],
      minlevel: 10,
      description: desc([
        "You gain Temporary Hit Points whenever you use your Magical Cunning feature or finish a Short or Long Rest. These Temporary Hit Points equal your Warlock level plus your Charisma modifier. Additionally, choose up to five creatures you can see when you gain the points. Those creatures each gain Temporary Hit Points equal to half your Warlock level plus your Charisma modifier.",
      ]),
    },
    "subclassfeature14": {
      name: "Searing Vengeance",
      source: [["PHB2024", 161]],
      minlevel: 14,
      description: desc([
        "When you or an ally within 60 feet of you is about to make a Death Saving Throw, you can unleash radiant energy to save the creature. The creature regains Hit Points equal to half its Hit Point maximum and can end the Prone condition on itself. Each creature of your choice that is within 30 feet of the creature takes Radiant damage equal to 2d8 plus your Charisma modifier, and each has the Blinded condition until the end of the current turn.",
        "Once you use this feature, you can't use it again until you finish a Long Rest",
      ]),
    },
  },
});
legacySubClassRefactor("warlock", "the fiend", {
  regExpSearch: /^(?=.*(warlock))(?=.*(fiend)).*$/i,
  subname: "Fiend Patron",
  source: [["PHB2024", 161]],
  spellcastingExtra: ["burning hands", "command", "scorching ray", "suggestion", "fireball", "stinking cloud", "fire shield", "wall of fire", "geas", "insect plague"],
  features: {
    "subclassfeature3": {
      name: "Dark One's Blessing",
      source: [["PHB2024", 161]],
      minlevel: 3,
      description: desc([
        "When you reduce an enemy to 0 Hit Points, you gain Temporary Hit Points equal to your Charisma modifier plus your Warlock level (minimum of 1 Temporary Hit Point). You also gain this benefit if someone else reduces an enemy within 10 feet of you to 0 Hit Points.",
      ]),
    },
    "subclassfeature6": {
      name: "Dark One's Own Luck",
      source: [["PHB2024", 162]],
      minlevel: 6,
      usages: "Charisma modifier per ",
      usagescalc: "event.value = Math.max(1, What('Cha Mod'));",
      recovery: "long rest",
      description: desc([
        "You can call on your fiendish patron to alter fate in your favor. When you make an ability check, or a saving throw, you can use this feature to add 1d10 to your roll. You can do so after seeing the roll but before any of the roll's effects occur.",
        "You can use this feature a number of times equal to your Charisma modifier (minimum of once), but you can use it no more than once per roll. You regain all expended uses when you finish a Long Rest.",
      ]),
    },
    "subclassfeature10": {
      name: "Fiendish Resilience",
      source: [["PHB2024", 162]],
      minlevel: 10,
      description: desc([
        "Choose one damage type, other than Force, whenever you finish a Short or Long Rest. You have Resistance to that damage type until you choose a different one with this feature.",
      ]),
    },
    "subclassfeature14": {
      name: "Hurl Through Hell",
      source: [["PHB2024", 162]],
      minlevel: 14,
      usages: 1,
      recovery: "long rest",
      altResource: "SS",
      description: desc([
        "Once per turn when you hit a creature with an attack roll, you can try to instantly transport the target through the Lower Planes. The target must succeed on a Charisma saving throw against your spell save DC, or the target disappears and hurtles through a nightmare landscape. The target takes 8d10 Psychic damage if it isn't a Fiend, and it has the Incapacitated condition until the end of your next turn, when it returns to the space it previously occupied or the nearest unoccupied space.",
        "Once you use this feature, you can't use it again until you finish a Long Rest unless you expend a Pact Magic spell slot (no action required) to restore your use of it.",
      ]),
    },
  },
});
legacySubClassRefactor("warlock", "the great old one", {
  regExpSearch: /^(?=.*(warlock))(?=.*(great old one)).*$/i,
  subname: "Great Old One Patron",
  source: [["PHB2024", 162]],
  spellcastingExtra: ["detect thoughts", "dissonant whispers", "phantasmal force", "tasha's hideous laughter", "clairvoyance", "hunger of hadar", "confusion", "summon aberration", "modify memory", "telekinesis"],
  features: {
    "subclassfeature3": {
      name: "Awakened Mind",
      source: [["PHB2024", 162]],
      minlevel: 3,
      description: desc([
        "You can form a telepathic connection between your mind and the mind of another. As a Bonus Action, choose one creature you can see within 30 feet of yourself. You and the chosen creature can communicate telepathically with each other while the two of you are within a number of miles of each other equal to your Charisma modifier (minimum of 1 mile). To understand each other, you each must mentally use a language the other knows.",
        "The telepathic connection lasts for a number of minutes equal to your Warlock level. It ends early if you use this feature to connect with a different creature.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Psychic Spells",
      source: [["PHB2024", 163]],
      minlevel: 3,
      description: desc([
        "When you cast a Warlock spell that deals damage, you can change its damage type to Psychic. In addition, when you cast a Warlock spell that is an Enchantment or Illusion you can do so without Verbal or Somatic components.",
      ]),
    },
    "subclassfeature6": {
      name: "Clairvoyant Combatant",
      source: [["PHB2024", 163]],
      minlevel: 6,
      usages: 1,
      recovery: "short rest",
      altResource: "SS",
      description: desc([
        "When you form a telepathic bond with a creature using your Awakened Mind, you can force that creature to make a Wisdom saving throw against your spell save DC. On a failed save, the creature has Disadvantage on attack rolls against you, and you have Advantage on attack rolls against that creature for the duration of the bond.",
        "Once you use this feature, you can't use it again until you finish a Short or Long Rest unless you expend a Pact Magic spell slot (no action required) to restore your use of it.",
      ]),
    },
    "subclassfeature10": {
      name: "Eldritch Hex",
      source: [["PHB2024", 163]],
      minlevel: 10,
      spellcastingBonus: [{
        name: "Eldritch Hex",
        spells: ["hex"],
        selection: ["hex"],
        times: 1,
      }],
      description: desc([
        "Your alien patron grants you a powerful curse. You always have the Hex spell prepared. When you cast Hex and choose an ability, the target also has Disadvantage on saving throws of the chosen ability for the duration of the spell.",
      ]),
    },
    "subclassfeature10.1": {
      name: "Thought Shield",
      source: [["PHB2024", 163]],
      minlevel: 10,
      dmgres: ["Psychic"],
      description: desc([
        "Your thoughts can't be read by telepathy or other means unless you allow it. You also have Resistance to Psychic damage, and whenever a creature deals Psychic damage to you, that creature takes the same amount of damage that you take.",
      ]),
    },
    "subclassfeature14": {
      name: "Create Thrall",
      source: [["PHB2024", 163]],
      minlevel: 14,
      description: desc([
        "When you cast Summon Aberration, you can modify it so that it doesn't require Concentration. If you do so, the spell's duration becomes 1 minute fr that casting, and when summoned the Aberration has a number of Temporary Hit Points equal to your Warlock level plus your Charisma modifier.",
        "In addition, the first time each turn the Aberration hits a creature under the effect of your Hex, the Aberration deals extra Psychic damage to the target equal to the bonus damage of that spell.",
      ]),
    },
  },
});
legacyClassRefactor("wizard", {
  regExpSearch: /wizard/i,
  name: "Wizard",
  source: [["PHB2024", 165]],
  primaryAbility: ["Intelligence"],
  abilitySave: 4,
  prereqs: "Intelligence 13",
  improvements: [0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5],
  die: 6,
  saves: ["Int", "Wis"],
  skillstxt: {
    primary: "Choose 2: Arcana, History, Insight, Investigation, Medicine, Nature, or Religion",
  },
  weaponProfs: {
    primary: [true, false],
  },
  equipment: "Wizard starting equipment:" +
    "\n \u2022 2 Daggers;" +
    "\n \u2022 An Arcane Focus (Quarterstaff);" +
    "\n \u2022 A Robe;" +
    "\n \u2022 A Spellbook;" +
    "\n \u2022 A Scholar's Pack, and 5 gp." +
    "\n\nAlternatively, choose 55 gp worth of starting equipment instead of the class's starting equipment.",
  subclasses: ["Wizard Subclass", []],
  attacks: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
  spellcastingAbility: 4,
  spellcastingFactor: 1,
  spellcastingKnown: {
    cantrips: [3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5],
    spells: "book",
    prepared: true,
  },
  features: {
    "spellcasting": {
      name: "Spellcasting",
      source: [["PHB2024", 165 - 166]],
      minlevel: 1,
      additional: levels.map(function (n, idx) {
        var cantr = [3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5][idx];
        var splls = [4, 5, 6, 7, 9, 10, 11, 12, 14, 15, 16, 16, 17, 18, 19, 21, 22, 23, 24, 25][idx];
        return cantr + " cantrips \u0026 " + splls + " spells prepared";
      }),
      calcChanges: {
        spellCalc: [
          function (type, spellcasters, ability) {
            if (type === "prepare" && spellcasters.indexOf("wizard") !== -1) {
              var lvl = classes.known.wizard.level;
              var sArr = [0, 4, 5, 6, 7, 9, 10, 11, 12, 14, 15, 16, 16, 17, 18, 19, 21, 22, 23, 24, 25];
              return sArr[lvl] - lvl - Number(What("Int Mod"));
            }
          }
        ]
      },
      description: desc([
        "As a student of arcane magic, you have learned to cast spells. See chapter 7 for the rules on spellcasting. The information below details how you use those rules with Wizard spells, which appear in the Wizard spell list later in the class's description.",
        "Cantrips : You know three cantrips of your choice from the Wizard spell list. Light, Mage Hand, and Ray of Frost are recommended.",
        "Whenever you finish a Long Rest, you can replace one of your cantrips with another cantrip of your choice from the Wizard spell list.",
        "When you reach Wizard levels 4 and 10, you learn another cantrip of your choice from the Wizard spell list, as shown in the Cantrips column of the Wizard Features table.",
        "Spellbook : Your wizardly apprenticeship culminated in the creation of a unique book, your spellbook. It is a Tiny object that weighs 3 pounds, contains 100 pages, and can be read only by you or someone casting Identify. You determine the book's appearance and materials, such as a gilt-edged tome or a collection of vellum bound with twine.",
        "The book contains the level 1+ spells you know, it starts with six level 1 Wizard spells of your choice. Detect Magic, Feather Fall, Mage Armor, Magic Missile, Sleep, and Thunderwave are recommended.",
        "Whenever you gain a Wizard level after 1, add two Wizard spells of your choice to your spellbook. Each of these spells must be of a level for which you have spell slots, as shown in the Wizard Features table. The spells are the culmination of arcane research you do regularly.",
        "Spell Slots : The Wizard Features table shows how many spell slots you have to cast your level 1+ spells. You regain all expended slots when you finish a Long Rest.",
        "Prepared Spells of Level 1+ : You prepare the list of level 1+ spells that are available for you to cast with this feature. To start, choose four spells from your spellbook. The chosen spells must be of a level for which you have spell slots.",
        "The number of spells on your list increases as you gain Wizard levels, as shown in the Prepared Spells column of the Wizard Features table. Whenever that number increases, choose additional spells from the Wizard spell list until the number of spells on your list matches the number on the table. The chosen spells must be of a level for which you have spell slots. For example, if you're a level 3 Wizard, your list of prepared spells can include six spells of levels 1 and 2 in any combination",
        "If another Wizard feature gives you spells that you always have prepared, those spells don't count against the number of spells you can prepare with this feature, but those spells otherwise count as Wizard spells for you.",
        "Changing Your Prepared Spells : Whenever you finish a Long Rest, you can change your list of prepared spells, replacing any of the spells there with spells from your spellbook.",
        "Spellcasting Ability : Intelligence is your spellcasting ability for your Wizard Spells",
        "Spellcasting Focus : You can use an Arcane Focus as a Spellcasting Focus for your Wizard spells.",
      ]),
      toNotesPage: [{
        name: "Expanding and Replacing a Spellbook",
        note: [
          "The spells you add to your spellbook as you gain levels reflect your ongoing magical research, but you might find other spells during your adventures that you can add to the book. You could discover a Wizard spell on a Spell Scroll for example, and then copy it into your spellbook.",
          "Copying a Spell into the Book : When you find a level 1+ Wizard spell, you can copy it into your spellbook if it is of a level you can prepare and if you have time to copy it. For each level of the spell, the transcription takes 2 hours and costs 50 gp. Afterward you can prepare the spell like the other spells in your spellbook.",
          "Copying the Book : You can copy a spell from your spellbook into another book. This is like copying a new spell into your spellbook but faster, since you already know how to cast the spell. You need spend only 1 hour and 10 gp for each level of the copied spell.",
          "If you lose your spellbook, you can use the same procedure to transcribe be the Wizard spells that you have prepared into a new spellbook. Filling out the remainder of the new book requires you to find new spells to do so. For this reason, many wizards keep a backup spellbook",
        ],
      }],
    },
    "ritual adept": {
      name: "Ritual Adept",
      source: [["PHB2024", 166]],
      minlevel: 1,
      description: desc([
        "You can cast any spell as a Ritual if that spell has the Ritual tag and the spell is in your spellbook. You needn't have the spell prepared, but you must read from the book to cast a spell in this way.",
      ]),
    },
    "arcane recovery": {
      name: "Arcane Recovery",
      source: [["PHB2024", 166]],
      minlevel: 1,
      additional: levels.map(function (n) {
        var lvls = Math.ceil(n / 2);
        return lvls + " level" + (lvls > 1 ? "s" : "") + " of spell slots";
      }),
      description: desc([
        "You can regain some of your magical energy by studying you spellbook. When you finish a Short Rest, you can choose expended spell slots to recover. The spell slots can have a combined level equal to no more than half your Wizard level (round up), and none of the slots can be level 6 or higher. For example, if you're a level 4 Wizard, you can recover up to two levels' worth of spell slots, regaining either one level 2 spell slots or two level 1 spell slots.",
        "Once you use this feature, you can't do so again until you finish a Long Rest.",
      ]),
    },
    "scholar": function () {
      var a = {
        name: "Scholar",
        source: [["PHB2024", 166]],
        minlevel: 2,
        description: "While studying magic, you also specialized in another field of study. Choose one of the following skills in which you have proficiency; Arcana, History, Investigation, Medicine, Nature, or Religion. You have Expertise in the chosen skill.",
        skillstxt: "You gain Expertise in one skill; Arcana, History, Investigation, Medicine, Nature, or Religion",
        additional: levels.map(function (n) {
          return n < 2 ? "" : "with " + (n < 2 ? 0 : 1) + " skill";
        }),
        extraname: "Scholar Expertise",
        extrachoices: ["Arcana", "History", "Investigation", "Medicine", "Nature", "Religion"],
        extraTimes: levels.map(function (n) {
          return n < 2 ? 0 : 1;
        })
      };
      for (var i = 0; i < a.extrachoices.length; i++) {
        var attr = a.extrachoices[i].toLowerCase();
        a[attr] = {
          name: a.extrachoices[i] + " Expertise",
          description: "",
          source: a.source,
          skills: [[a.extrachoices[i], "only"]],
          prereqeval: function (v) {
            return v.skillProfsLC.indexOf(v.choice) === -1 ? false : v.skillExpertiseLC.indexOf(v.choice) === -1 ? true : "markButDisable";
          }
        };
      }
      return a;
    }(),
    "subclassfeature3": {
      name: "Wizard Subclass",
      source: [["PHB2024", 167]],
      minlevel: 3,
      description: desc([
        "You gain a Wizard subclass of your choice. The Abjurer, Diviner, Evoker, and Illusionist subclasses are detailed after this class's description. A subclass is a specialization that grants you features at certain Wizard levels. For the rest of your career, you gain each of your subclass's features that are of your Wizard level or lower.",
      ]),
    },
    "memorize spell": {
      name: "Memorize Spell",
      source: [["PHB2024", 167]],
      minlevel: 5,
      description: desc([
        "Whenever you finish a Short Rest, you can study your spellbook and replace one of the level 1+ Wizard spells you have prepared for your Spellcasting feature with another level 1+ spell from the book.",
      ]),
    },
    "spell mastery": {
      name: "Spell Mastery",
      source: [["PHB2024", 167]],
      minlevel: 18,
      description: desc([
        "You have achieved such mastery over certain spells that you can cast them at will. Choose a level 1 and a level 2 spell in your spellbook that have a casting time of an action. You always have those spells prepared, and you can cast them at their lowest level without expending a spell slot. To cast either spell at a higher level, you must expend a spell slot.",
        "Whenever you finish a Long Res, you can study your spellbook and replace one of those spells with an eligible spell of the same level from the book.",
      ]),
    },
    "epic boon": {
      name: "Epic Boon",
      source: [["PHB2024", 167]],
      minlevel: 19,
      description: desc([
        "You gain an Epic Boon feat (see chapter 5) or another feat of your choice for which you qualify. Boon of Spell Recall is recommended.",
      ]),
    },
    "signature spells": {
      name: "Signature Spell",
      source: [["PHB2024", 167]],
      minlevel: 20,
      description: desc([
        "Choose two level 3 spells in your spellbook as your signature spells. You always have these spells prepared, and you can cast each of them once at level 3 without expending a spell slot. When you do so, you can't cast them in this way again until you finish a Short or Long Rest. To cast either spell at a higher level, you must expend a spell slot.",
      ]),
    },
  },
});
legacySubClassRefactor("wizard", "abjurer", {
  regExpSearch: /^(?=.*(wizard))(?=.*(abjurer)).*$/i,
  subname: "Abjurer",
  source: [["PHB2024", 172]],
  replaces: "abjuration",
  features: {
    "subclassfeature3": {
      name: "Abjuration Savant",
      source: [["PHB2024", 172]],
      minlevel: 3,
      spellcastingBonus: [{
        name: "Abjuration Savant",
        "class": "wizard",
        school: "Abjur",
        level: [1, 2],
        times: 2,
      }],
      description: desc([
        "Choose two Wizard spells from the Abjuration school, each of which must be no higher than level 2, and add them to your spellbook for free.",
        "In addition, whenever you gain access to a new level of spell slots in this class, you can add one Wizard spell from the Abjuration school to your spellbook for free. The chosen spell must be of a level for which you have spell slots.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Arcane Ward",
      source: [["PHB2024", 172]],
      minlevel: 3,
      description: desc([
        "You can weave magic around yourself for protection. When you cast an Abjuration spell with a spell slot, you can simultaneously use a strand of the spell's magic to create a magical ward on yourself that lasts until you finish a Long Rest. The ward has a Hit Point maximum equal to twice your Wizard level plus your Intelligence modifier. Whenever you take damage, the ward takes the damage instead, and if you have any Resistances or Vulnerabilities, apply them before reducing the ward's Hit Points. If the damage reduces the ward to 0 Hit Points, you take any remaining damage. When the ward has 0 Hit Points, it can't absorb damage but its magic remains.",
        "Whenever you cast an Abjuration spell with a spell slot the ward regains a number of Hit Points equal to twice the level of the spell slot. Alternatively, as a Bonus Action, you can expend a spell slot, and the ward regains a number of Hit Points equal to twice the level of the spell slot expended.",
        "Once you create the ward, you can't create it again until you finish a Long Rest.",
      ]),
    },
    "subclassfeature6": {
      name: "Projected Ward",
      source: [["PHB2024", 172 - 173]],
      minlevel: 6,
      description: desc([
        "When a creature that you can see within 30 feet of yourself takes damage, you can take a Reaction to cause your Arcane Ward to absorb that damage. If this damage reduces the ward to 0 Hit Points, the warded creature takes any remaining damage. If that creature has any Resistances or Vulnerabilities, apply them before reducing the ward's Hit Points.",
      ]),
    },
    "subclassfeature10": {
      name: "Spell Breaker",
      source: [["PHB2024", 173]],
      minlevel: 10,
      spellcastingBonus: [{
        name: "Spell Breaker",
        spells: ["counterspell", "dispel magic"],
        selection: ["counterspell", "dispel magic"],
        times: 2,
      }],
      description: desc([
        "You always have the Counterspell and Dispel Magic spells prepared. In addition, you can cast Dispel Magic as a Bonus Action, and you can add your Proficiency Bonus to its ability check.",
        "When you cast either spell with a spell slot, that slot isn't expended if the spell fails to stop a spell.",
      ]),
    },
    "subclassfeature14": {
      name: "Spell Resistance",
      source: [["PHB2024", 173]],
      minlevel: 14,
      savetxt: [{
        adv_vs: ["saving throws against spells"],
        text: "Resistance to the damage of spells",
      }],
      description: desc([
        "You have Advantage on saving throws against spells, and you have Resistance to the damage of spells.",
      ]),
    },
  },
});
legacySubClassRefactor("wizard", "diviner", {
  regExpSearch: /^(?=.*(wizard))(?=.*(diviner)).*$/i,
  subname: "Diviner",
  source: [["PHB2024", 173]],
  replaces: "divination",
  features: {
    "subclassfeature3": {
      name: "Divination Savant",
      source: [["PHB2024", 173]],
      minlevel: 3,
      spellcastingBonus: [{
        name: "Divination Savant",
        "class": "wizard",
        school: "Div",
        level: [1, 2],
        times: 2,
      }],
      description: desc([
        "Choose two Wizard spells from the Divination school, each of which must be no higher than level 2, and add them to your spellbook for free.",
        "In addition, whenever you gain access to a new level of spell slots in this class, you can add one Wizard spell from the Divination school to your spellbook for free. The chosen spell must be of a level for which you have spell slots.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Portent",
      source: [["PHB2024", 173]],
      minlevel: 3,
      additional: levels.map(function (n) {
        return n < 2 ? "" : (n < 14 ? 2 : 3) + "d20 after a long rest";
      }),
      description: desc([
        "Glimpses of the future begin to press on your awareness. Whenever you finish a Long Rest, roll two d20s and record the numbers rolled. You can replace any D20 Test made by you or a creature that you can see with one of these foretelling rolls. You must choose to do so before the roll, and you can replace a roll in this way only once per turn.",
        "Each foretelling roll can be used only once. When you finish Long Rest, you lose any unused foretelling rolls.",
      ]),
    },
    "subclassfeature6": {
      name: "Expert Divination",
      source: [["PHB2024", 173]],
      minlevel: 6,
      description: desc([
        "Casting Divination spells comes so easily to you that it expends only a fraction of your spellcasting efforts, When you cast a spell using a level 2+ spell slot, you regain one expended spell slot. The slot you regain must be of a level lower than the slot you expended and can't be higher than level 5.",
      ]),
    },
    "subclassfeature10": {
      name: "The Third Eye",
      source: [["PHB2024", 173]],
      minlevel: 10,
      action: "bonus action",
      usages: 1,
      recovery: "short rest",
      description: desc([
        "You can increase your powers of perception. As a Bonus Action, choose one of the following benefits, which lasts until you start a Short or Long Rest. You can't use this feature again until you finish a Short or Long Rest.",
        "Darkvision : You gain Darkvision with a range of 120 feet.",
        "Greater Comprehension : You can read any language.",
        "See Invisibility : You can cast See Invisibility without expending a spell slot.",
      ]),
    },
    "subclassfeature14": {
      name: "Greater Portent",
      source: [["PHB2024", 173]],
      minlevel: 14,
      description: desc([
        "The visions in your dreams intensify and paint a more accurate picture in your mind of what is to come. Roll three d20s for your Portent feature rather than two.",
      ]),
    },
  },
});
legacySubClassRefactor("wizard", "evoker", {
  regExpSearch: /^(?=.*(wizard))(?=.*(evoker)).*$/i,
  subname: "Evoker",
  source: [["PHB2024", 174]],
  replaces: "evocation",
  features: {
    "subclassfeature3": {
      name: "Evocation Savant",
      source: [["PHB2024", 174]],
      minlevel: 3,
      spellcastingBonus: [{
        name: "Evocation Savant",
        "class": "wizard",
        school: "Evoc",
        level: [1, 2],
        times: 2,
      }],
      description: desc([
        "Choose two Wizard spells from the Evocation school, each of which must be no higher than level 2, and add them to your spellbook for free.",
        "In addition, whenever you gain access to a new level of spell slots in this class, you can add one Wizard spell from the Evocation school to your spellbook for free. The chosen spell must be of a level for which you have spell slots.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Potent Cantrip",
      source: [["PHB2024", 174]],
      minlevel: 3,
      description: desc([
        "Your damaging cantrips affect even creatures that avoid the brunt of the effect. When you cast a cantrip at a creature and you miss with the attack roll or the target succeeds on a saving throw against the cantrip, the target takes half the cantrip's damage (if any) but suffers no additional effect from the cantrip.",
      ]),
    },
    "subclassfeature6": {
      name: "Sculpt Spell",
      source: [["PHB2024", 174]],
      minlevel: 6,
      description: desc([
        "You can create pockets of relative safety within the effect of your evocations. When you cast an Evocation spell that affects other creatures that you can see, you can choose a number of them equal to 1 plus the spell's level. The chosen creatures automatically succeed on their saving throws against the spell, and they take no damage if they would normally take half damage on a successful save.",
      ]),
    },
    "subclassfeature10": {
      name: "Empowered Evocation",
      source: [["PHB2024", 174]],
      minlevel: 10,
      description: desc([
        "Whenever you cast a Wizard spell from the Evocation school, you can add your Intelligence modifier to one damage roll of that spell.",
      ]),
    },
    "subclassfeature14": {
      name: "Overchannel",
      source: [["PHB2024", 174]],
      minlevel: 14,
      description: desc([
        "You can increase the power of your spells. When you cast a Wizard spell with a spell slot of level 1-5 that deals damage, you can deal maximum damage with that spell on the turn you cast it.",
        "The first time you do so, you suffer no adverse effect. If you use this feature again before a Long Rest, you take 2d12 Necrotic damage for each level of the spell slot immediately after you cast it. This damage ignores Resistance and Immunity.",
        "Each time you use this feature again before finish a Long Rest, the Necrotic damage per spell level increases by 1d12.",
      ]),
    },
  },
});
legacySubClassRefactor("wizard", "illusionist", {
  regExpSearch: /^(?=.*(wizard))(?=.*(illusionist)).*$/i,
  subname: "Illusionist",
  source: [["PHB2024", 175]],
  replaces: "illusion",
  features: {
    "subclassfeature3": {
      name: "Illusion Savant",
      source: [["PHB2024", 175]],
      minlevel: 3,
      spellcastingBonus: [{
        name: "Illusion Savant",
        "class": "wizard",
        school: "Illus",
        level: [1, 2],
        times: 2,
      }],
      description: desc([
        "Choose two Wizard spells from the Illusion school, each of which must be no higher than level 2, and add them to your spellbook for free.",
        "In addition, whenever you gain access to a new level of spell slots in this class, you can add one Wizard spell from the Illusion school to your spellbook for free. The chosen spell must be of a level for which you have spell slots.",
      ]),
    },
    "subclassfeature3.1": {
      name: "Improved Illusion",
      source: [["PHB2024", 175]],
      minlevel: 3,
      spellcastingBonus: [{
        name: "Improved Illusion",
        spells: ["minor illusion"],
        selection: ["minor illusion"],
        times: 1,
      }],
      description: desc([
        "You can cast Illusion spells without providing Verbal components, and if an Illusion spell you cast has a range of 10+ feet, the range increases by 60 feet.",
        "You also know the Minor Illusion cantrip. If you already know it, you learn a different Wizard cantrip of your choice. The cantrip doesn't count against your number of cantrips known. You can create both a sound and an image with a single casting of Minor Illusion, and you can cast it as a Bonus Action.",
      ]),
    },
    "subclassfeature6": {
      name: "Phantasmal Creatures",
      source: [["PHB2024", 175]],
      minlevel: 6,
      spellcastingBonus: [{
        name: "Phantasmal Creatures",
        spells: ["summon beast", "summon fey"],
        selection: ["summon beast", "summon fey"],
        times: 2,
        firstCol: "oncelr",
      }],
      description: desc([
        "You always have the Summon Beast and Summon Fey spells prepared. Whenever you cast either spell, you can change its school to Illusion, which cause the summoned creature to appear spectral. You can cast the Illusion version of each spell without expending a spell slot, but casting it without a slot halves the creature's Hit Points. Once you cast either spell without a spell slot, you must finish a Long Rest before you can cast the spell in that way again.",
      ]),
    },
    "subclassfeature10": {
      name: "Illusory Self",
      source: [["PHB2024", 175]],
      minlevel: 10,
      action: "reaction",
      usages: 1,
      recovery: "short rest",
      altResource: "SS 2+",
      description: desc([
        "When a creature hits you with an attack roll, you can take a Reaction to interpose an illusory duplicate of yourself between the attacker and yourself. The attack automatically misses you, then the illusion dissipates.",
        "Once you use this feature, you can't use it again until you finish a Short or Long Rest. You can also restore your use of it by expending a Level 2+ spell slot (no action required).",
      ]),
    },
    "subclassfeature14": {
      name: "Illusory Reality",
      source: [["PHB2024", 175]],
      minlevel: 14,
      action: "bonus action",
      description: desc([
        "You have learned to weave shadow magic into your illusions to give them a semi-reality. When you cast an illusion spell with a spell slot, you can choose one inanimate, nonmagical object that is part of the illusion and make that object real. You can do this on your turn as a Bonus Action while the spell is ongoing. The object remains real for 1 minute, during which it can't deal damage or give any conditions. For example, you can create an illusion of a bridge over a chasm and then make it real and cross it.",
      ]),
    },
  },
});
//Backgrounds
BackgroundList["acolyte"] = {
  regExpSearch: /^(?=.*acolyte).*$/i,
  name: "Acolyte",
  source: [["PHB2024", 178]],
  scorestxt: ["+2 and +1 -or- +1 to each from Intelligence, Wisdom, and Charisma"],
  skills: ["Insight", "Religion"],
  gold: 8,
  equipleft: [
    ["Book (prayers)", "", 5],
    ["Parchment, sheets of", 10, ""],
    ["Robes", "", 4],
  ],
  equipright: [
    ["Calligrapher's Supplies", "", 5],
    ["Holy symbol", "", 1],
    ["Belt pouch (with coins)", "", 1],
  ],
  feature: "Magic Initiate (Cleric) [Origin]",
  trait: [
    "You devoted yourself to service in a temple, either nestled in a town or secluded in a sacred grove. There you performed rites in honor of a god or pantheon. You served under a priest and studied religion. Thanks to your priest's instruction and your own devotion, you also learned how to channel a modicum of divine power in service to your place of worship and the people who prayed there."
  ],
};
BackgroundList["artisan"] = {
  regExpSearch: /^(?=.*artisan).*$/i,
  name: "Artisan",
  source: [["PHB2024", 178]],
  scorestxt: ["+2 and +1 -or- +1 to each from Strength, Dexterity, and Intelligence"],
  skills: ["Investigation", "Persuasion"],
  toolProfs: [["Artisan's tools", 1]],
  gold: 32,
  equipright: [
    ["Traveler's Clothes", "", 4],
    ["Artisan's Tools", "", 5],
    ["Belt pouch (with coins)", 2, 1],
  ],
  feature: "Crafter [Origin]",
  trait: [
    "You began mopping floors and scrubbing counters in an artisan's workshop for a few coppers per day as soon as you were strong enough to carry a bucket. When you were old enough to apprentice, you learned to create basic crafts of your own, as well as how to sweet talk the occasional demanding customer. Your trade has also given you a keen eye for detail."
  ],
};
BackgroundList["charlatan"] = {
  regExpSearch: /^(?=.*charlatan).*$/i,
  name: "Charlatan",
  source: [["PHB2024", 179]],
  scorestxt: ["+2 and +1 -or- +1 to each from Dexterity, Constitution, and Charisma"],
  skills: ["Deception", "Sleight of Hand"],
  toolProfs: [["Forgery Kit"]],
  gold: 15,
  equipright: [
    ["Fine Clothes", "", 4],
    ["Costume", "", 1],
  ],
  equipleft: [
    ["Forgery Kit", "", 5],
  ],
  feature: "Skilled [Origin]",
  trait: [
    "Once you were old enough to order an ale, you soon had a favorite stool in every tavern within ten miles of where you were born. As you traveled the circuit from public house to watering hole, you learned to prey on unfortunates who were in the market for a comforting lie or two - perhaps a sham potion or forged ancestry records."
  ],
};
BackgroundList["criminal"] = {
  regExpSearch: /^(?=.*criminal).*$/i,
  name: "Criminal",
  source: [["PHB2024", 179]],
  scorestxt: ["+2 and +1 -or- +1 to each from Dexterity, Constitution, and Intelligence"],
  skills: ["Sleight of Hand", "Stealth"],
  toolProfs: [["Thieves' Tools"]],
  gold: 16,
  equipright: [
    ["Traveler's Clothes", "", 4],
    ["Dagger", 2, 1],
    ["Belt pouch (with coins)", 2, 1],
  ],
  equipleft: [
    ["Crowbar", "", ""],
    ["Thieves' Tools", "", ""],
  ],
  feature: "Alert [Origin]",
  trait: [
    "You eked out a living in dark alleyways, cutting purses or burgling shops. Perhaps you were part of a small gang of like-minded wrongdoers who looked out for each other. Or maybe you were a lone wolf, fending for yourself against the local thieves' guild and more fearsome lawbreakers."
  ],
};
BackgroundList["entertainer"] = {
  regExpSearch: /^(?=.*entertainer).*$/i,
  name: "Entertainer",
  source: [["PHB2024", 180]],
  scorestxt: ["+2 and +1 -or- +1 to each from Strength, Dexterity, and Charisma"],
  skills: ["Acrobatics", "Performance"],
  toolProfs: [["Musical Instrument", 1]],
  gold: 11,
  equipright: [
    ["Traveler's Clothes", "", 4],
    ["Costumes", 2, 1],
    ["Belt pouch (with coins)", 1, 1],
  ],
  equipleft: [
    ["Mirror", "", ""],
    ["Perfume", "", ""],
    ["Musical Instrument", "", ""],
  ],
  feature: "Musician [Origin]",
  trait: [
    "You spent much of your youth following roving fairs and carnivals, performing odd jobs for musicians and acrobats in exchange for lessons. You may have learned how to walk a tightrope, how to play a lute in a distinct style, or how to recite poetry with impeccable diction. To this day, you thrive on applause and long for the stage."
  ],
};
BackgroundList["farmer"] = {
  regExpSearch: /^(?=.*farmer).*$/i,
  name: "Farmer",
  source: [["PHB2024", 180]],
  scorestxt: ["+2 and +1 -or- +1 to each from Strength, Constitution, and Wisdom"],
  skills: ["Animal Handling", "Nature"],
  toolProfs: [["Carpenter's Tools"]],
  gold: 30,
  equipright: [
    ["Traveler's Clothes", "", 4],
    ["Sickle", "", 1],
    ["Belt pouch (with coins)", 1, 1],
  ],
  equipleft: [
    ["Iron Pot", "", ""],
    ["Shovel", "", ""],
    ["Healer's Kit", "", ""],
    ["Carpenter's Tools", "", ""],
  ],
  feature: "Tough [Origin]",
  trait: [
    "You grew up close to the land. Years tending animals and cultivating the earth rewarded you with patience and good health. You have a keen appreciation for nature's bounty alongside a healthy respect for nature's wrath."
  ],
};
BackgroundList["guard"] = {
  regExpSearch: /^(?=.*guard).*$/i,
  name: "Guard",
  source: [["PHB2024", 181]],
  scorestxt: ["+2 and +1 -or- +1 to each from Strength, Intelligence, and Wisdom"],
  skills: ["Athletics", "Perception"],
  toolProfs: [["Gaming Set", 1]],
  gold: 12,
  equipright: [
    ["Traveler's Clothes", "", 4],
    ["Spear", "", 1],
    ["Light Crossbow", "", ""],
    ["Bolt(s)", 20, ""],
    ["Quiver", "", ""],
    ["Belt pouch (with coins)", 1, 1],
  ],
  equipleft: [
    ["Manacles", "", ""],
    ["Hooded Lantern", "", ""],
    ["Gaming Set", "", ""],
  ],
  feature: "Alert [Origin]",
  trait: [
    "Your feet ache when you remember the countless hours you spent at your post in the tower. You were trained to keep one eye looking outside the wall watching for marauders sweeping from the nearby forest, and your other eye looking inside the wall searching for cut purses and troublemakers."
  ],
};
BackgroundList["guide"] = {
  regExpSearch: /^(?=.*guide).*$/i,
  name: "Guide",
  source: [["PHB2024", 181]],
  scorestxt: ["+2 and +1 -or- +1 to each from Dexterity, Constitution, and Wisdom"],
  skills: ["Stealth", "Survival"],
  toolProfs: [["Cartographer's Tools"]],
  gold: 3,
  equipright: [
    ["Traveler's Clothes", "", 4],
    ["Shortbow", "", 1],
    ["Arrow(s)", 20, ""],
    ["Quiver", "", ""],
    ["Belt pouch (with coins)", 1, 1],
  ],
  equipleft: [
    ["Bedroll", "", ""],
    ["Tent", "", ""],
    ["Cartographer's Tools", "", ""],
  ],
  feature: "Magic Initiate (Druid) [Origin]",
  trait: [
    "You came of age outdoors, far from settled lands. Your home was anywhere you chose to spread your bedroll. There are wonders in the wilderness - strange monsters, pristine forests and streams, overgrown ruins of great halls once trod by giants - and you learned to fend for yourself as you explored them. From time to time, you guided friendly nature priests who instructed you in the fundamentals of channeling the magic of the wild."
  ],
};
BackgroundList["hermit"] = {
  regExpSearch: /^(?=.*hermit).*$/i,
  name: "Hermit",
  source: [["PHB2024", 182]],
  scorestxt: ["+2 and +1 -or- +1 to each from Constitution, Wisdom, and Charisma"],
  skills: ["Medicine", "Religion"],
  toolProfs: [["Herbalism Kit"]],
  gold: 16,
  equipright: [
    ["Traveler's Clothes", "", 4],
    ["Quarterstaff", "", 1],
    ["Book (philosophy)", "", 5],
    ["Belt pouch (with coins)", 1, 1],
  ],
  equipleft: [
    ["Bedroll", "", ""],
    ["Lamp Oil", 3, ""],
    ["Herbalism Kit", "", ""],
  ],
  feature: "Healer [Origin]",
  trait: [
    "You spent your early years secluded in a hut or monastery located well beyond the outskirts of the nearest settlement. In those days, your only companions were the creatures of the forest and those who would occasionally visit to bring news of the outside world and supplies. The solitude allowed you to spend many hours pondering the mysteries of creation."
  ],
};
BackgroundList["merchant"] = {
  regExpSearch: /^(?=.*merchant).*$/i,
  name: "Merchant",
  source: [["PHB2024", 182]],
  scorestxt: ["+2 and +1 -or- +1 to each from Constitution, Intelligence, and Charisma"],
  skills: ["Animal Handling", "Persuasion"],
  toolProfs: [["Navigator's Tools"]],
  gold: 22,
  equipright: [
    ["Traveler's Clothes", "", 4],
    ["Belt pouch (with coins)", 2, 1],
  ],
  equipleft: [
    ["Navigator's Tools", "", ""],
  ],
  feature: "Lucky [Origin]",
  trait: [
    "You were apprenticed to a trader, caravan master, or shopkeeper, learning the fundamentals of commerce. You traveled broadly, and you earned a living by buying and selling the raw materials artisans need to practice their craft or finished works from such crafters. You might have transported goods from one place to another (by ship, wagon, or caravan) or bought them from traveling traders and sold them in your own shop."
  ],
};
BackgroundList["noble"] = {
  regExpSearch: /^(?=.*noble).*$/i,
  name: "Noble",
  source: [["PHB2024", 183]],
  scorestxt: ["+2 and +1 -or- +1 to each from Strength, Intelligence, and Charisma"],
  skills: ["History", "Persuasion"],
  toolProfs: [["Gaming Set", 1]],
  gold: 29,
  equipright: [
    ["Fine Clothes", "", 4],
    ["Belt pouch (with coins)", 2, 1],
  ],
  equipleft: [
    ["Gaming Set", "", ""],
    ["Perfume", "", ""],
  ],
  feature: "Skilled [Origin]",
  trait: [
    "You were raised in a castle, surrounded by wealth, power, and privilege. Your family of minor aristocrats ensured that you received a first-class education, some of which you appreciated and some of which you resented. Your time in the castle, especially the many hours you spent observing your family at court, also taught you a great deal about leadership."
  ],
};
BackgroundList["sage"] = {
  regExpSearch: /^(?=.*sage).*$/i,
  name: "Sage",
  source: [["PHB2024", 183]],
  scorestxt: ["+2 and +1 -or- +1 to each from Constitution, Intelligence, and Wisdom"],
  skills: ["Arcana", "History"],
  toolProfs: [["Calligrapher's Supplies"]],
  gold: 8,
  equipright: [
    ["Robes", "", 4],
    ["Quarterstaff", "", 1],
    ["Book (history)", "", 5],
    ["Belt pouch (with coins)", 1, 1],
  ],
  equipleft: [
    ["Parchment, Sheets of", 8, ""],
    ["Calligrapher's Supplies", "", ""],
  ],
  feature: "Magic Initiate (Wizard) [Origin]",
  trait: [
    "You spent your formative years traveling between manors and monasteries, performing various odd jobs and services in exchange for access to their libraries. You whiled away may a long evening studying books and scrolls, learning the lore of the multiverse - even the rudiments of magic - and your mind yearns for more."
  ],
};
BackgroundList["sailor"] = {
  regExpSearch: /^(?=.*sailor).*$/i,
  name: "Sailor",
  source: [["PHB2024", 184]],
  scorestxt: ["+2 and +1 -or- +1 to each from Strength, Dexterity, and Wisdom"],
  skills: ["Acrobatics", "Perception"],
  toolProfs: [["Navigator's Tools"]],
  gold: 20,
  equipright: [
    ["Traveler's Clothes", "", 4],
    ["Belt pouch (with coins)", 2, 1],
    ["Dagger", "", 1],
  ],
  equipleft: [
    ["Navigator's Tools", "", ""],
    ["Rope, Feet of", "", ""],
  ],
  feature: "Tavern Brawler [Origin]",
  trait: [
    "You lived as a seafarer, wind at your back and decks swaying beneath your feet. You've perched on bar stools in more ports of call than you can remember, faced mighty storm, and swapped stories with folk who live beneath the waves."
  ],
};
BackgroundList["scribe"] = {
  regExpSearch: /^(?=.*scribe).*$/i,
  name: "Scribe",
  source: [["PHB2024", 184]],
  scorestxt: ["+2 and +1 -or- +1 to each from Dexterity, Intelligence, and Wisdom"],
  skills: ["Investigation", "Perception"],
  toolProfs: [["Calligrapher's Tools"]],
  gold: 23,
  equipright: [
    ["Fine Clothes", "", 4],
    ["Belt pouch (with coins)", 2, 1],
  ],
  equipleft: [
    ["Calligrapher's Supplies", "", ""],
    ["Lamp Oil, Flasks of", 3, ""],
    ["Parchment, Sheets of", 12, ""],
  ],
  feature: "Skilled [Origin]",
  trait: [
    "You spent formative years in a scriptorium, a monastery dedicated to the preservation of knowledge, or a government agency, where you learned to write with a clear hand and produce finely written texts. Perhaps you scribed government documents or copied tomes of literature, You might have some skill as a writer of poetry, narrative, or scholarly research. Above all, you have a careful attention to detail, helping you avoid introducing mistakes to the documents you copy and create."
  ],
};
BackgroundList["soldier"] = {
  regExpSearch: /^(?=.*soldier).*$/i,
  name: "Soldier",
  source: [["PHB2024", 185]],
  scorestxt: ["+2 and +1 -or- +1 to each from Strength, Dexterity, and Constitution"],
  skills: ["Athletics", "Intimidation"],
  toolProfs: [["Gaming Set", 1]],
  gold: 14,
  equipright: [
    ["Traveler's Clothes", "", 4],
    ["Belt pouch (with coins)", 2, 1],
    ["Spear", "", 1],
    ["Shortbow", "", ""],
    ["Arrow(s)", 20, ""],
    ["Quiver", "", ""],
  ],
  equipleft: [
    ["Gaming Set", "", ""],
    ["Healer's kit", "", ""],
  ],
  feature: "Savage Attacker [Origin]",
  trait: [
    "You began training for war as soon as you reached adulthood and carry precious few memories of life before you took up arms. Battle is in your blood. Sometimes you catch yourself reflexively performing the basic fighting exercises you learned first. Eventually, you put that training to use on the battlefield, protecting the realm by waging war."
  ],
};
BackgroundList["wayfarer"] = {
  regExpSearch: /^(?=.*wayfarer).*$/i,
  name: "Wayfarer",
  source: [["PHB2024", 185]],
  scorestxt: ["+2 and +1 -or- +1 to each from Dexterity, Wisdom, and Charisma"],
  skills: ["Insight", "Stealth"],
  toolProfs: [["Thieves' Tools"]],
  gold: 16,
  equipright: [
    ["Traveler's Clothes", "", 4],
    ["Belt pouch (with coins)", 2, 1],
    ["Dagger", 2, 1],
  ],
  equipleft: [
    ["Thieves' Tools", "", ""],
    ["Gaming Set", "", ""],
    ["Bedroll", "", ""],
  ],
  feature: "Lucky [Origin]",
  trait: [
    "You grew up on the streets surrounded by similarly ill-fated castoffs, a few of them friends and a few of them rivals. You slept where you could and did odd jobs for food. At times, when the hunger became unbearable, you resorted to theft. Still you never lost your pride and never abandoned hope. Fate is not finished with you."
  ],
};
BackgroundFeatureList["magic initiate (cleric) [origin]"] = {
  description: desc([
    "You devoted yourself to service in a temple, either nestled in a town or secluded in a sacred grove. There you performed rites in honor of a god or pantheon. You served under a priest and studied religion. Thanks to your priest's instruction and your own devotion, you also learned how to channel a modicum of divine power in service to your place of worship and the people who prayed there. I gain the Magic Initiate (Cleric) feat.",
  ]),
  source: [["PHB2024", 178]],
  eval: function () {
    AddFeat("Magic Initiate (Cleric) [Origin]");
  },
  removeeval: function () {
    RemoveFeat("Magic Initiate (Cleric) [Origin]");
  }
};
BackgroundFeatureList["crafter [origin]"] = {
  description: desc([
    "You began mopping floors and scrubbing counters in an artisan's workshop for a few coppers per day as soon as you were strong enough to carry a bucket. When you were old enough to apprentice, you learned to create basic crafts of your own, as well as how to sweet talk the occasional demanding customer. Your trade has also given you a keen eye for detail. I gain the Crafter feat.",
  ]),
  source: [["PHB2024", 178]],
  eval: function () {
    AddFeat("Crafter [Origin]");
  },
  removeeval: function () {
    RemoveFeat("Crafter [Origin]");
  }
};
BackgroundFeatureList["skilled [origin]"] = {
  description: desc([
    "Once you were old enough to order an ale, you soon had a favorite stool in every tavern within ten miles of where you were born. As you traveled the circuit from public house to watering hole, you learned to prey on unfortunates who were in the market for a comforting lie or two - perhaps a sham potion or forged ancestry records./You were raised in a castle, surrounded by wealth, power, and privilege. Your family of minor aristocrats ensured that you received a first-class education, some of which you appreciated and some of which you resented. Your time in the castle, especially the many hours you spent observing your family at court, also taught you a great deal about leadership./You spent formative years in a scriptorium, a monastery dedicated to the preservation of knowledge, or a government agency, where you learned to write with a clear hand and produce finely written texts. Perhaps you scribed government documents or copied tomes of literature, You might have some skill as a writer of poetry, narrative, or scholarly research. Above all, you have a careful attention to detail, helping you avoid introducing mistakes to the documents you copy and create. I gain the Skilled feat.",
  ]),
  source: [["PHB2024", 179]],
  eval: function () {
    AddFeat("Skilled [Origin]");
  },
  removeeval: function () {
    RemoveFeat("Skilled [Origin]");
  }
};
BackgroundFeatureList["alert [origin]"] = {
  description: desc([
    "You eked out a living in dark alleyways, cutting purses or burgling shops. Perhaps you were part of a small gang of like-minded wrongdoers who looked out for each other. Or maybe you were a lone wolf, fending for yourself against the local thieves' guild and more fearsome lawbreakers./Your feet ache when you remember the countless hours you spent at your post in the tower. You were trained to keep one eye looking outside the wall watching for marauders sweeping from the nearby forest, and your other eye looking inside the wall searching for cut purses and troublemakers. I gain the Alert feat.",
  ]),
  source: [["PHB2024", 179]],
  eval: function () {
    AddFeat("Alert [Origin]");
  },
  removeeval: function () {
    RemoveFeat("Alert [Origin]");
  }
};
BackgroundFeatureList["musician [origin]"] = {
  description: desc([
    "You spent much of your youth following roving fairs and carnivals, performing odd jobs for musicians and acrobats in exchange for lessons. You may have learned how to walk a tightrope, how to play a lute in a distinct style, or how to recite poetry with impeccable diction. To this day, you thrive on applause and long for the stage. I gain the Musician feat.",
  ]),
  source: [["PHB2024", 180]],
  eval: function () {
    AddFeat("Musician [Origin]");
  },
  removeeval: function () {
    RemoveFeat("Musician [Origin]");
  }
};
BackgroundFeatureList["tough [origin]"] = {
  description: desc([
    "You grew up close to the land. Years tending animals and cultivating the earth rewarded you with patience and good health. You have a keen appreciation for nature's bounty alongside a healthy respect for nature's wrath. I gain the Tough feat.",
  ]),
  source: [["PHB2024", 180]],
  eval: function () {
    AddFeat("Tough [Origin]");
  },
  removeeval: function () {
    RemoveFeat("Tough [Origin]");
  }
};
BackgroundFeatureList["magic initiate (druid) [origin]"] = {
  description: desc([
    "You came of age outdoors, far from settled lands. Your home was anywhere you chose to spread your bedroll. There are wonders in the wilderness - strange monsters, pristine forests and streams, overgrown ruins of great halls once trod by giants - and you learned to fend for yourself as you explored them. From time to time, you guided friendly nature priests who instructed you in the fundamentals of channeling the magic of the wild. I gain the Magic Initiate (Druid) feat.",
  ]),
  source: [["PHB2024", 181]],
  eval: function () {
    AddFeat("Magic Initiate (Druid) [Origin]");
  },
  removeeval: function () {
    RemoveFeat("Magic Initiate (Druid) [Origin]");
  }
};
BackgroundFeatureList["healer [origin]"] = {
  description: desc([
    "You spent your early years secluded in a hut or monastery located well beyond the outskirts of the nearest settlement. In those days, your only companions were the creatures of the forest and those who would occasionally visit to bring news of the outside world and supplies. The solitude allowed you to spend many hours pondering the mysteries of creation. I gain the Healer feat.",
  ]),
  source: [["PHB2024", 182]],
  eval: function () {
    AddFeat("Healer [Origin]");
  },
  removeeval: function () {
    RemoveFeat("Healer [Origin]");
  }
};
BackgroundFeatureList["lucky [origin["] = {
  description: desc([
    "You were apprenticed to a trader, caravan master, or shopkeeper, learning the fundamentals of commerce. You traveled broadly, and you earned a living by buying and selling the raw materials artisans need to practice their craft or finished works from such crafters. You might have transported goods from one place to another (by ship, wagon, or caravan) or bought them from traveling traders and sold them in your own shop./You grew up on the streets surrounded by similarly ill-fated castoffs, a few of them friends and a few of them rivals. You slept where you could and did odd jobs for food. At times, when the hunger became unbearable, you resorted to theft. Still you never lost your pride and never abandoned hope. Fate is not finished with you. I gain the Lucky feat.",
  ]),
  source: [["PHB2024", 182]],
  eval: function () {
    AddFeat("Lucky [Origin]");
  },
  removeeval: function () {
    RemoveFeat("Lucky [Origin]");
  }
};
BackgroundFeatureList["magic initiate (wizard) [origin]"] = {
  description: desc([
    "You spent your formative years traveling between manors and monasteries, performing various odd jobs and services in exchange for access to their libraries. You whiled away may a long evening studying books and scrolls, learning the lore of the multiverse - even the rudiments of magic - and your mind yearns for more. I gain the Magic Initiate (Wizard) feat.",
  ]),
  source: [["PHB2024", 183]],
  eval: function () {
    AddFeat("Magic Initiate (Wizard) [Origin]");
  },
  removeeval: function () {
    RemoveFeat("Magic Initiate (Wizard) [Origin]");
  }
};
BackgroundFeatureList["tavern brawler [origin]"] = {
  description: desc([
    "You lived as a seafarer, wind at your back and decks swaying beneath your feet. You've perched on bar stools in more ports of call than you can remember, faced mighty storm, and swapped stories with folk who live beneath the waves. I gain the Tavern Brawler feat.",
  ]),
  source: [["PHB2024", 184]],
  eval: function () {
    AddFeat("Tavern Brawler [Origin]");
  },
  removeeval: function () {
    RemoveFeat("Tavern Brawler [Origin]");
  }
};
BackgroundFeatureList["savage attacker [origin]"] = {
  description: desc([
    "You began raining for war as soon as you reached adulthood and carry precious few memories of life before you took up arms. Battle is in your blood. Sometimes you catch yourself reflexively performing the basic fighting exercises you learned first. Eventually, you put that training to use on the battlefield, protecting the realm by waging war. I gain the Savage Attacker feat.",
  ]),
  source: [["PHB2024", 185]],
  eval: function () {
    AddFeat("Savage Attacker [Origin]");
  },
  removeeval: function () {
    RemoveFeat("Savage Attacker [Origin]");
  }
};
//Species
RaceList["aasimar"] = {
  regExpSearch: /^(?=.*aasimar).*$/i,
  name: "Aasimar",
  sortname: "Aasimar",
  source: [["PHB2024", 186]],
  plural: "Aasimar",
  size: [3, 4],
  speed: {walk: {spd: 30, enc: 20}},
  languageProfs: ["Common", 2],
  vision: [["Darkvision", 60]],
  dmgres: ["Necrotic", "Radiant"],
  age: " reach maturity their in late teens and live about 160 years",
  height: " are about 2-4 or 4-7 feet tall",
  features: {
    "healing hands": {
      name: "Healing Hands",
      minlevel: 1,
      limfeaname: "Healing Hands",
      usages: 1,
      recovery: "long rest",
      action: "action",
      description: desc([
        "As a Magic action, you touch a creature and roll a number of d4s equal to your Proficiency Bonus. The creature regains a number of Hit Points equal to the total rolled. Once you use this trait, you can't use it again until you finish a Long Rest.",
      ]),
    },
    "celestial revelation": {
      name: "Celestial Revelation",
      limfeaname: "Celestial Revelation",
      minlevel: 3,
      usages: 1,
      recovery: "long rest",
      action: [["bonus action", "Celestial Revelation"]],
      description: desc([
        "When you reach character level 3, you can transform as a Bonus Action using one of the options below (See Notes Page) (choose the option each time you transform). That transformation lasts for 1 minute or until you end it (no action required). Once you transform, you can't do so again until you finish a Long Rest. Once on each of your turns before the transformation ends, you can deal extra damage to one target when you deal damage to it with an attack or a spell. The extra damage equals your Proficiency Bonus, and the extra damage's type is either Necrotic for Necrotic Shroud or Radiant for Heavenly Wings and Inner Radiance.",
      ]),
      toNotesPage: [{
        name: "Celestial Revelation",
        note: [
          "Heavenly Wings : Two spectral wings sprout from your back temporarily. Until the transformation ends, you have a Fly Speed equal to your Speed.",
          "Inner Radiance : Searing light temporarily radiates from your eyes and mouth. For the duration, you shed Bright Light in a 10-foot radius and Dim Light for an additional 10 feet, and at the end of each of your turns, each creature within 10 feet of you takes Radiant damage equal to your Proficiency Bonus",
          "Necrotic Shroud : Your eyes briefly become pools of darkness, and flightless wings sprout from your back temporarily. Creatures other than your allies within 10 feet of you must succeed on a Charisma saving throw (DC 8 plus your Charisma modifier and Proficiency Bonus) or have the Frightened condition until the end of your next turn",
        ],
      }],
    },
  },
  spellcastingAbility: 6,
  spellcastingBonus: [{
    name: "Light Bearer",
    spells: ["light"],
    selection: ["light"],
    times: 1,
  }],
  trait: "Aasimar (Small or Medium Humanoid)\n\nCelestial Resistance : You have Resistance to Necrotic and Radiant damage.\n\nDarkvision : You have Darkvision within a range of 60 feet.\n\nHealing Hands : As a Magic action, you touch a creature and roll a number of d4s equal to your Proficiency Bonus. The creature regains a number of Hit Points equal to the total rolled. Once you use this trait, you can't use it again until you finish a Long Rest.\n\nLight Bearer : You know the Light cantrip. Charisma is your spellcasting ability for it.\n\nCelestial Revelation : When you reach character level 3, you can transform as a Bonus Action using one of the options below (See Notes Page) (choose the option each time you transform). That transformation lasts for 1 minute or until you end it (no action required). Once you transform, you can't do so again until you finish a Long Rest. Once on each of your turns before the transformation ends, you can deal extra damage to one target when you deal damage to it with an attack or a spell. The extra damage equals your Proficiency Bonus, and the extra damage's type is either Necrotic for Necrotic Shroud or Radiant for Heavenly Wings and Inner Radiance.",
};
RaceList["dragonborn"] = {
  regExpSearch: /dragonborn/i,
  name: "Dragonborn",
  source: [["PHB2024", 187]],
  plural: "Dragonborn",
  size: 3,
  speed: {
    walk: {spd: 30, enc: 20}
  },
  languageProfs: ["Common", 2],
  weaponOptions: [{
    regExpSearch: /^(?=.*breath)(?=.*weapon).*$/i,
    name: "Breath weapon",
    source: [["PHB2024", 187]],
    ability: 3,
    type: "Natural",
    damage: [1, 10, "fire"],
    range: "15-ft. cone/30-ft. line",
    description: "Hits all in area; Dex save, success - half damage; Usable only once per short rest",
    abilitytodamage: false,
    dc: true,
    dbBreathWeapon: true,
    selectNow: true
  }],
  age: " reach maturity in late teens and live about 80 years",
  height: " are about 5 - 7 feet tall",
  heightMetric: " are about 1,5 - 2,1 metres tall",
  trait: "Dragonborn (Medium Humanoid)\n\nDraconic Ancestry: Your lineage stems from a dragon progenitor. Choose the kind of dragon from the Draconic Ancestors table. Your choice affects your Breath Weapon and Damage Resistance trait as well as your appearance.\n\n",
  features: {
    "draconic ancestry": {
      name: "Draconic Ancestry",
      limfeaname: "Breath Weapon",
      minlevel: 1,
      usages: "Proficiency bonus per ",
      usagescalc: "event.value = How('Proficiency Bonus');",
      additional: levels.map(function (n) {
        return (n < 5 ? 1 : n < 11 ? 2 : n < 17 ? 3 : 4) + 'd10';
      }),
      recovery: "long rest",
      action: [["action"]],
      calcChanges: {
        atkAdd: [
          function (fields, v) {
            if (v.theWea.dbBreathWeapon && CurrentRace.known === 'dragonborn') {
              fields.Damage_Die = (CurrentRace.level < 5 ? 1 : CurrentRace.level < 11 ? 2 : CurrentRace.level < 17 ? 3 : 4) + 'd10';
              if (CurrentRace.variant) {
                fields.Damage_Type = CurrentRace.dmgres[0];
              }
            }
          },
          "",
          1
        ]
      }
    },
    "draconic flight": {
      name: "Draconic Flight",
      source: [["PHB2024", 187]],
      minlevel: 5,
      action: ["bonus action"],
      usages: "Proficiency bonus per ",
      usagescalc: "event.value = How('Proficiency Bonus');",
      recovery: "long rest",
      description: desc([
        "When you reach character level 5, you can channel draconic magic to give yourself temporary flight. As a Bonus Action, you sprout spectral wings on your back that last for 10 minutes or until you retract the wings (no action required) or have the incapacitated condition. During that time you have a Fly Speed equal to your Speed. Your wings appear to be made of the same energy as your Breath Weapon. Once you use this trait, you can't use it again until you finish a Long Rest",
      ]),
    },
  },
  variants: ["black", "blue", "brass", "bronze", "copper", "gold", "green", "red", "silver", "white"]
};
RaceSubList["dragonborn-black"] = {
  regExpSearch: /black/i,
  name: "Black Dragonborn",
  trait: "Black Dragonborn (Medium Humanoid)\n\nAcid Breath Weapon : When you take the Attack action on your turn, you can replace one of your attacks with an exhalation of magical energy in either a 15-foot Cone or a 30-foot Line that is 5 feet wide (choose the shape each time). Each creature in that area must make a Dexterity saving throw (DC 8 plus your Constitution modifier and Proficiency Bonus. It does 1d10 Acid damage, half as much damage on a successful save. The damage increases to 2d10 at level 5, 3d10 at level 11, and 4d10 at level 17. You can use this Breath Weapon a number of times equal to your Proficiency Bonus, and you regain all expended uses when you finish a Long Rest.\n\nDamage Resistance : You have Resistance to Acid Damage\n\nDarkvision : You have Darkvision with a range of 60 feet.\n\nDraconic Flight : When you reach character level 5, you can channel draconic magic to give yourself temporary flight. As a Bonus Action, you sprout spectral wings on your back that last for 10 minutes or until you retract the wings (no action required) or have the incapacitated condition. During that time you have a Fly Speed equal to your Speed. Your wings appear to be made of Acid. Once you use this trait, you can't use it again until you finish a Long Rest.",
  dmgres: ["Acid"],
};
RaceSubList["dragonborn-blue"] = {
  regExpSearch: /^(?=.*dragonborn)(?=.*blue).*$/i,
  name: "Blue Dragonborn",
  sortname: "Dragonborn, Blue",
  trait: "Blue Dragonborn (Medium Humanoid)\n\nLightning Breath Weapon : When you take the Attack action on your turn, you can replace one of your attacks with an exhalation of magical energy in either a 15-foot Cone or a 30-foot Line that is 5 feet wide (choose the shape each time). Each creature in that area must make a Dexterity saving throw (DC 8 plus your Constitution modifier and Proficiency Bonus. It does 1d10 Lightning damage, half as much damage on a successful save. The damage increases to 2d10 at level 5, 3d10 at level 11, and 4d10 at level 17. You can use this Breath Weapon a number of times equal to your Proficiency Bonus, and you regain all expended uses when you finish a Long Rest.\n\nDamage Resistance : You have Resistance to Lightning Damage\n\nDarkvision : You have Darkvision with a range of 60 feet.\n\nDraconic Flight : When you reach character level 5, you can channel draconic magic to give yourself temporary flight. As a Bonus Action, you sprout spectral wings on your back that last for 10 minutes or until you retract the wings (no action required) or have the incapacitated condition. During that time you have a Fly Speed equal to your Speed. Your wings appear to be made of Lightning. Once you use this trait, you can't use it again until you finish a Long Rest.",
  dmgres: ["Lightning"]
};
RaceSubList["dragonborn-brass"] = {
  regExpSearch: /^(?=.*dragonborn)(?=.*brass).*$/i,
  name: "Brass Dragonborn",
  sortname: "Dragonborn, Brass",
  trait: "Brass Dragonborn (Medium Humanoid)\n\nFire Breath Weapon : When you take the Attack action on your turn, you can replace one of your attacks with an exhalation of magical energy in either a 15-foot Cone or a 30-foot Line that is 5 feet wide (choose the shape each time). Each creature in that area must make a Dexterity saving throw (DC 8 plus your Constitution modifier and Proficiency Bonus. It does 1d10 Fire damage, half as much damage on a successful save. The damage increases to 2d10 at level 5, 3d10 at level 11, and 4d10 at level 17. You can use this Breath Weapon a number of times equal to your Proficiency Bonus, and you regain all expended uses when you finish a Long Rest.\n\nDamage Resistance : You have Resistance to Fire Damage\n\nDarkvision : You have Darkvision with a range of 60 feet.\n\nDraconic Flight : When you reach character level 5, you can channel draconic magic to give yourself temporary flight. As a Bonus Action, you sprout spectral wings on your back that last for 10 minutes or until you retract the wings (no action required) or have the incapacitated condition. During that time you have a Fly Speed equal to your Speed. Your wings appear to be made of Fire. Once you use this trait, you can't use it again until you finish a Long Rest.",
  dmgres: ["Fire"]
};
RaceSubList["dragonborn-bronze"] = {
  regExpSearch: /^(?=.*dragonborn)(?=.*bronze).*$/i,
  name: "Bronze Dragonborn",
  sortname: "Dragonborn, Bronze",
  trait: "Bronze Dragonborn (Medium Humanoid)\n\nLightning Breath Weapon : When you take the Attack action on your turn, you can replace one of your attacks with an exhalation of magical energy in either a 15-foot Cone or a 30-foot Line that is 5 feet wide (choose the shape each time). Each creature in that area must make a Dexterity saving throw (DC 8 plus your Constitution modifier and Proficiency Bonus. It does 1d10 Lightning damage, half as much damage on a successful save. The damage increases to 2d10 at level 5, 3d10 at level 11, and 4d10 at level 17. You can use this Breath Weapon a number of times equal to your Proficiency Bonus, and you regain all expended uses when you finish a Long Rest.\n\nDamage Resistance : You have Resistance to Lightning Damage\n\nDarkvision : You have Darkvision with a range of 60 feet.\n\nDraconic Flight : When you reach character level 5, you can channel draconic magic to give yourself temporary flight. As a Bonus Action, you sprout spectral wings on your back that last for 10 minutes or until you retract the wings (no action required) or have the incapacitated condition. During that time you have a Fly Speed equal to your Speed. Your wings appear to be made of Lightning. Once you use this trait, you can't use it again until you finish a Long Rest.",
  dmgres: ["Lightning"]
};
RaceSubList["dragonborn-copper"] = {
  regExpSearch: /^(?=.*dragonborn)(?=.*copper).*$/i,
  name: "Copper Dragonborn",
  sortname: "Dragonborn, Copper",
  trait: "Copper Dragonborn (Medium Humanoid)\n\nAcid Breath Weapon : When you take the Attack action on your turn, you can replace one of your attacks with an exhalation of magical energy in either a 15-foot Cone or a 30-foot Line that is 5 feet wide (choose the shape each time). Each creature in that area must make a Dexterity saving throw (DC 8 plus your Constitution modifier and Proficiency Bonus. It does 1d10 Acid damage, half as much damage on a successful save. The damage increases to 2d10 at level 5, 3d10 at level 11, and 4d10 at level 17. You can use this Breath Weapon a number of times equal to your Proficiency Bonus, and you regain all expended uses when you finish a Long Rest.\n\nDamage Resistance : You have Resistance to Acid Damage\n\nDarkvision : You have Darkvision with a range of 60 feet.\n\nDraconic Flight : When you reach character level 5, you can channel draconic magic to give yourself temporary flight. As a Bonus Action, you sprout spectral wings on your back that last for 10 minutes or until you retract the wings (no action required) or have the incapacitated condition. During that time you have a Fly Speed equal to your Speed. Your wings appear to be made of Acid. Once you use this trait, you can't use it again until you finish a Long Rest.",
  dmgres: ["Acid"]
};
RaceSubList["dragonborn-gold"] = {
  regExpSearch: /^(?=.*dragonborn)(?=.*gold).*$/i,
  name: "Gold Dragonborn",
  sortname: "Dragonborn, Gold",
  trait: "Gold Dragonborn (Medium Humanoid)\n\nFire Breath Weapon : When you take the Attack action on your turn, you can replace one of your attacks with an exhalation of magical energy in either a 15-foot Cone or a 30-foot Line that is 5 feet wide (choose the shape each time). Each creature in that area must make a Dexterity saving throw (DC 8 plus your Constitution modifier and Proficiency Bonus. It does 1d10 Fire damage, half as much damage on a successful save. The damage increases to 2d10 at level 5, 3d10 at level 11, and 4d10 at level 17. You can use this Breath Weapon a number of times equal to your Proficiency Bonus, and you regain all expended uses when you finish a Long Rest.\n\nDamage Resistance : You have Resistance to Fire Damage\n\nDarkvision : You have Darkvision with a range of 60 feet.\n\nDraconic Flight : When you reach character level 5, you can channel draconic magic to give yourself temporary flight. As a Bonus Action, you sprout spectral wings on your back that last for 10 minutes or until you retract the wings (no action required) or have the incapacitated condition. During that time you have a Fly Speed equal to your Speed. Your wings appear to be made of Fire. Once you use this trait, you can't use it again until you finish a Long Rest.",
  dmgres: ["Fire"]
};
RaceSubList["dragonborn-green"] = {
  regExpSearch: /^(?=.*dragonborn)(?=.*green).*$/i,
  name: "Green Dragonborn",
  sortname: "Dragonborn, Green",
  trait: "Green Dragonborn (Medium Humanoid)\n\nPoison Breath Weapon : When you take the Attack action on your turn, you can replace one of your attacks with an exhalation of magical energy in either a 15-foot Cone or a 30-foot Line that is 5 feet wide (choose the shape each time). Each creature in that area must make a Dexterity saving throw (DC 8 plus your Constitution modifier and Proficiency Bonus. It does 1d10 Poison damage, half as much damage on a successful save. The damage increases to 2d10 at level 5, 3d10 at level 11, and 4d10 at level 17. You can use this Breath Weapon a number of times equal to your Proficiency Bonus, and you regain all expended uses when you finish a Long Rest.\n\nDamage Resistance : You have Resistance to Poison Damage\n\nDarkvision : You have Darkvision with a range of 60 feet.\n\nDraconic Flight : When you reach character level 5, you can channel draconic magic to give yourself temporary flight. As a Bonus Action, you sprout spectral wings on your back that last for 10 minutes or until you retract the wings (no action required) or have the incapacitated condition. During that time you have a Fly Speed equal to your Speed. Your wings appear to be made of Poison. Once you use this trait, you can't use it again until you finish a Long Rest.",
  dmgres: ["Poison"]
};
RaceSubList["dragonborn-red"] = {
  regExpSearch: /^(?=.*dragonborn)(?=.*red).*$/i,
  name: "Red Dragonborn",
  sortname: "Dragonborn, Red",
  trait: "Red Dragonborn (Medium Humanoid)\n\nFire Breath Weapon : When you take the Attack action on your turn, you can replace one of your attacks with an exhalation of magical energy in either a 15-foot Cone or a 30-foot Line that is 5 feet wide (choose the shape each time). Each creature in that area must make a Dexterity saving throw (DC 8 plus your Constitution modifier and Proficiency Bonus. It does 1d10 Fire damage, half as much damage on a successful save. The damage increases to 2d10 at level 5, 3d10 at level 11, and 4d10 at level 17. You can use this Breath Weapon a number of times equal to your Proficiency Bonus, and you regain all expended uses when you finish a Long Rest.\n\nDamage Resistance : You have Resistance to Fire Damage\n\nDarkvision : You have Darkvision with a range of 60 feet.\n\nDraconic Flight : When you reach character level 5, you can channel draconic magic to give yourself temporary flight. As a Bonus Action, you sprout spectral wings on your back that last for 10 minutes or until you retract the wings (no action required) or have the incapacitated condition. During that time you have a Fly Speed equal to your Speed. Your wings appear to be made of Fire. Once you use this trait, you can't use it again until you finish a Long Rest.",
  dmgres: ["Fire"]
};
RaceSubList["dragonborn-silver"] = {
  regExpSearch: /^(?=.*dragonborn)(?=.*silver).*$/i,
  name: "Silver Dragonborn",
  sortname: "Dragonborn, Silver",
  trait: "Silver Dragonborn (Medium Humanoid)\n\nCold Breath Weapon : When you take the Attack action on your turn, you can replace one of your attacks with an exhalation of magical energy in either a 15-foot Cone or a 30-foot Line that is 5 feet wide (choose the shape each time). Each creature in that area must make a Dexterity saving throw (DC 8 plus your Constitution modifier and Proficiency Bonus. It does 1d10 Cold damage, half as much damage on a successful save. The damage increases to 2d10 at level 5, 3d10 at level 11, and 4d10 at level 17. You can use this Breath Weapon a number of times equal to your Proficiency Bonus, and you regain all expended uses when you finish a Long Rest.\n\nDamage Resistance : You have Resistance to Cold Damage\n\nDarkvision : You have Darkvision with a range of 60 feet.\n\nDraconic Flight : When you reach character level 5, you can channel draconic magic to give yourself temporary flight. As a Bonus Action, you sprout spectral wings on your back that last for 10 minutes or until you retract the wings (no action required) or have the incapacitated condition. During that time you have a Fly Speed equal to your Speed. Your wings appear to be made of Ice. Once you use this trait, you can't use it again until you finish a Long Rest.",
  dmgres: ["Cold"]
};
RaceSubList["dragonborn-white"] = {
  regExpSearch: /^(?=.*dragonborn)(?=.*white).*$/i,
  name: "White Dragonborn",
  sortname: "Dragonborn, White",
  trait: "White Dragonborn (Medium Humanoid)\n\nCold Breath Weapon : When you take the Attack action on your turn, you can replace one of your attacks with an exhalation of magical energy in either a 15-foot Cone or a 30-foot Line that is 5 feet wide (choose the shape each time). Each creature in that area must make a Dexterity saving throw (DC 8 plus your Constitution modifier and Proficiency Bonus. It does 1d10 Cold damage, half as much damage on a successful save. The damage increases to 2d10 at level 5, 3d10 at level 11, and 4d10 at level 17. You can use this Breath Weapon a number of times equal to your Proficiency Bonus, and you regain all expended uses when you finish a Long Rest.\n\nDamage Resistance : You have Resistance to Cold Damage\n\nDarkvision : You have Darkvision with a range of 60 feet.\n\nDraconic Flight : When you reach character level 5, you can channel draconic magic to give yourself temporary flight. As a Bonus Action, you sprout spectral wings on your back that last for 10 minutes or until you retract the wings (no action required) or have the incapacitated condition. During that time you have a Fly Speed equal to your Speed. Your wings appear to be made of Ice. Once you use this trait, you can't use it again until you finish a Long Rest.",
  dmgres: ["Cold"]
};
RaceList["dwarf"] = {
  regExpSearch: /^(?=.*dwarf).*$/i,
  name: "Dwarf",
  sortname: "Dwarf",
  source: [["PHB2024", 188]],
  plural: "Dwarves",
  size: 3,
  speed: {walk: {spd: 30, enc: 20}},
  languageProfs: ["Common", 2],
  vision: [["Darkvision", 120], ["Tremorsense", 60]],
  savetxt: {adv_vs: ["avoiding or ending the Poisoned condition"]},
  dmgres: ["Poison"],
  age: " reach maturity in early 20s and live about 350 years",
  height: " are about 4-5 feet tall",
  calcChanges: {
    hp: function (totalHD) {
      return [totalHD, "Dwarven Toughness"];
    }
  },
  features: {
    "stonecunning": {
      name: "Stonecunning",
      limfeaname: "Stonecunning",
      minlevel: 1,
      usages: "Proficiency bonus per ",
      usagescalc: "event.value = How('Proficiency Bonus');",
      recovery: "long rest",
      action: [["bonus action", "Tremorsense"]],
      description: desc([
        "As a Bonus Action, you gain Tremorsense with a range of 60 feet for 10 minutes. You must be on a stone surface or touching a stone surface to use this Tremorsense. The stone can be natural or worked. You can use this Bonus Action a number of times equal to your Proficiency Bonus, and you regain all expended uses when you finish a Long Rest.",
      ]),
    },
  },
  trait: "Dwarf (Medium Humanoid)\n\nDarkvision : You have Darkvision with a range of 120 feet.\n\nDwarven Resilience : You have Resistance to Poison damage. You also have Advantage on saving throws you make to avoid or end the Poisoned condition.\n\nDwarven Toughness : Your Hit Point maximum increases by 1, and it increases by 1 again whenever you gain a level.\n\nStonecunning : As a Bonus Action, you gain Tremorsense with a range of 60 feet for 10 minutes. You must be on a stone surface or touching a stone surface to use this Tremorsense. The stone can be natural or worked. You can use this Bonus Action a number of times equal to your Proficiency Bonus, and you regain all expended uses when you finish a Long Rest.",
};
RaceList["elf"] = {
  regExpSearch: /^(?=.*elf).*$/i,
  name: "Elf",
  sortname: "Elf",
  source: [["PHB2024", 190]],
  plural: "Elves",
  size: 3,
  speed: {walk: {spd: 30, enc: 20}},
  languageProfs: ["Common", 2],
  vision: [["Darkvision", 60]],
  savetxt: {adv_vs: ["avoiding or ending the Charmed condition"]},
  skillstxt: "Choose one between Insight, Perception, or Survival",
  age: " reach maturity in early 20s and live about 750 years",
  height: " are about 5-6 feet tall",
  trait: "Elf (Medium Humanoid)\n\nDarkvision : You have Darkvision with a range of 60 feet.\n\nElven Lineage : You are part of a lineage that grants you supernatural abilities. Choose a lineage from the Elven Lineages table. You gain the level 1 benefit of that lineage. When you reach character levels 3 and 5, you learn a higher-level spell, as shown on the table. You always have that spell prepared. You can cast it once without a spell slot, and you regain the ability to cast it in that way when you finish a Long Rest. You can also cast the spell using any spell slots you have of the appropriate level. Intelligence,Wisdom, or Charisma is your spellcasting ability for the spells you cast with this trait. (Choose the ability when you select the lineage).\n\nFey Ancestry : You have Advantage on saving throws you make to avoid or end the Charmed condition.\n\nKeen Senses : You have proficiency in the Insight, Perception, or Survival skill.\n\nTrance : You don't need to sleep, and magic can't put you to sleep. You can finish a Long Rest in 4 hours if you spend those hours in a trance like meditation, during which you retain consciousness.",
  variants: ["dark", "high", "wood"]
};
RaceSubList["elf-dark"] = {
  regExpSearch: /^(?=.*elf)(?=.*dark).*$/i,
  name: "Dark Elf",
  sortname: "Drow",
  vision: [["Darkvision", 120]],
  spellcastingAbility: [4, 5, 6],
  spellcastingBonus: [{
    name: "Drow Lineage",
    spells: ["dancing lights"],
    selection: ["dancing lights"],
    times: 1,
    firstCol: "atwill",
  }],
  trait: "Drow (Medium Humanoid)\n\nDarkvision : You have Darkvision with a range of 120 feet.\n\nDrow Lineage : You are part of a lineage that grants you supernatural abilities. You gain the Dancing Lights cantrip. When you reach character level 3 you learn the Faerie Fire spell, and when you reach character level 5 you learn the Darkness spell. You always have that spell prepared. You can cast it once without a spell slot, and you regain the ability to cast it in that way when you finish a Long Rest. You can also cast the spell using any spell slots you have of the appropriate level. Intelligence,Wisdom, or Charisma is your spellcasting ability for the spells you cast with this trait. (Choose the ability when you select the lineage).\n\nFey Ancestry : You have Advantage on saving throws you make to avoid or end the Charmed condition.\n\nKeen Senses : You have proficiency in the Insight, Perception, or Survival skill.\n\nTrance : You don't need to sleep, and magic can't put you to sleep. You can finish a Long Rest in 4 hours if you spend those hours in a trance like meditation, during which you retain consciousness.",
  features: {
    "drow lineage3": {
      name: "Faerie Fire",
      minlevel: 3,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "When you reach character level 3 you learn the Faerie Fire spell.",
      ]),
      spellcastingBonus: [{
        name: "Drow Lineage",
        spells: ["faerie fire"],
        selection: ["faerie fire"],
        times: 1,
        firstCol: "oncelr",
      }],
    },
    "drow lineage5": {
      name: "Darkness",
      minlevel: 5,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "When you reach character level 5 you learn the Darkness spell.",
      ]),
      spellcastingBonus: [{
        name: "Drow Lineage",
        spells: ["darkness"],
        selection: ["darkness"],
        times: 1,
        firstCol: "oncelr",
      }],
    },
  },
};
RaceSubList["elf-high"] = {
  regExpSearch: /^(?=.*elf)(?=.*high).*$/i,
  name: "High Elf",
  sortname: "High Elf",
  spellcastingAbility: [4, 5, 6],
  spellcastingBonus: [{
    name: "High Elf Lineage",
    "class": ["wizard"],
    spells: ["prestidigitation", 1],
    selection: ["prestidigitation", 1],
    level: [0, 0],
    times: 1,
    firstCol: "atwill",
  }],
  trait: "High Elf (Medium Humanoid)\n\nDarkvision : You have Darkvision with a range of 60 feet.\n\nHigh Elf Lineage : You are part of a lineage that grants you supernatural abilities. You gain the Prestidigitation cantrip. Whenever you finish a Long Rest, you can replace that cantrip with a different cantrip from the Wizard spell list. When you reach character level 3 you learn the Detect Magic spell, and when you reach character level 5 you learn the Misty Step spell. You always have that spell prepared. You can cast it once without a spell slot, and you regain the ability to cast it in that way when you finish a Long Rest. You can also cast the spell using any spell slots you have of the appropriate level. Intelligence,Wisdom, or Charisma is your spellcasting ability for the spells you cast with this trait. (Choose the ability when you select the lineage).\n\nFey Ancestry : You have Advantage on saving throws you make to avoid or end the Charmed condition.\n\nKeen Senses : You have proficiency in the Insight, Perception, or Survival skill.\n\nTrance : You don't need to sleep, and magic can't put you to sleep. You can finish a Long Rest in 4 hours if you spend those hours in a trance like meditation, during which you retain consciousness.",
  features: {
    "high elf lineage3": {
      name: "Detect Magic",
      minlevel: 3,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "When you reach character level 3 you learn the Detect Magic spell.",
      ]),
      spellcastingBonus: [{
        name: "High Elf Lineage",
        spells: ["detect magic"],
        selection: ["detect magic"],
        times: 1,
        firstCol: "oncelr",
      }],
    },
    "high elf lineage5": {
      name: "Misty Step",
      minlevel: 5,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "When you reach character level 5 you learn the Misty Step spell.",
      ]),
      spellcastingBonus: [{
        name: "High Elf Lineage",
        spells: ["misty step"],
        selection: ["misty step"],
        times: 1,
        firstCol: "oncelr",
      }],
    },
  },
};
RaceSubList["elf-wood"] = {
  regExpSearch: /^(?=.*elf)(?=.*wood).*$/i,
  name: "Wood Elf",
  sortname: "Wood Elf",
  speed: {walk: {spd: 35, enc: 25}},
  spellcastingAbility: [4, 5, 6],
  spellcastingBonus: [{
    name: "Wood Elf Lineage",
    spells: ["druidcraft"],
    selection: ["druidcraft"],
    times: 1,
    firstCol: "atwill",
  }],
  trait: "Wood Elf (Medium Humanoid)\n\nDarkvision : You have Darkvision with a range of 60 feet.\n\nWood Elf Lineage : You are part of a lineage that grants you supernatural abilities. You gain the Druidcraft cantrip. When you reach character level 3 you learn the Longstrider spell, and when you reach character level 5 you learn the Pass without Trace spell. You always have that spell prepared. You can cast it once without a spell slot, and you regain the ability to cast it in that way when you finish a Long Rest. You can also cast the spell using any spell slots you have of the appropriate level. Intelligence,Wisdom, or Charisma is your spellcasting ability for the spells you cast with this trait. (Choose the ability when you select the lineage).\n\nFey Ancestry : You have Advantage on saving throws you make to avoid or end the Charmed condition.\n\nKeen Senses : You have proficiency in the Insight, Perception, or Survival skill.\n\nTrance : You don't need to sleep, and magic can't put you to sleep. You can finish a Long Rest in 4 hours if you spend those hours in a trance like meditation, during which you retain consciousness.",
  features: {
    "wood elf lineage3": {
      name: "Longstrider",
      minlevel: 3,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "When you reach character level 3 you learn the Longstrider spell.",
      ]),
      spellcastingBonus: [{
        name: "Wood Elf Lineage",
        spells: ["longstrider"],
        selection: ["longstrider"],
        times: 1,
        firstCol: "oncelr",
      }],
    },
    "wood elf lineage5": {
      name: "Pass without Trace",
      minlevel: 5,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "When you reach character level 5 you learn the Pass without Trace spell.",
      ]),
      spellcastingBonus: [{
        name: "Wood Elf Lineage",
        spells: ["pass without trace"],
        selection: ["pass without trace"],
        times: 1,
        firstCol: "oncelr",
      }],
    },
  },
};
RaceList["gnome"] = {
  regExpSearch: /^(?=.*gnome).*$/i,
  name: "Gnome",
  sortname: "Gnome",
  source: [["PHB2024", 191]],
  plural: "Gnomes",
  size: 4,
  speed: {walk: {spd: 30, enc: 20}},
  languageProfs: ["Common", 2],
  vision: [["Darkvision", 60]],
  age: " reach maturity in early 20s and live about 425 years",
  height: " are about 3-4 feet tall",
  trait: "Forest Gnome (Small Humanoid)\n\nDarkvision : You have Darkvision with a range of 60 feet.\n\nGnomish Lineage : You are part of a lineage that grants you supernatural abilities. Choose Choose one of the following options, whichever one you choose Intelligence, Wisdom, or Charisma is your spellcasting ability for the spells you cast with this trait (choose the ability when you select the lineage).\n\nGnomish Cunning : You have Advantage on Intelligence, Wisdom, and Charisma saving throws.",
  variants: ["forest", "rock"]
};
RaceSubList["gnome-forest"] = {
  regExpSearch: /^(?=.*gnome)(?=.*forest).*$/i,
  name: "Forest Gnome",
  sortname: "Gnome, Forest",
  vision: [["Darkvision", 60]],
  spellcastingAbility: [4, 5, 6],
  spellcastingBonus: [{
    name: "Forest Gnome Lineage",
    spells: ["minor illusion"],
    selection: ["minor illusion"],
    times: 1,
    firstCol: "atwill",
  }],
  trait: "Gnome (Small Humanoid)\n\nDarkvision : You have Darkvision with a range of 60 feet.\n\nForest Gnome Lineage : You know the Minor Illusion cantrip. You also always have the Speak with Animals spell prepared. You can cast it without a spell slot a number of times equal to your Proficiency Bonus and you regain all expended uses when you finish a Long Rest. You can also use any spell slots you have to cast the spell.\n\nGnomish Cunning : You have Advantage on Intelligence, Wisdom, and Charisma saving throws.",
  features: {
    "forest gnome lineage": {
      name: "Forest Gnome Lineage",
      minlevel: 3,
      usages: "Proficiency bonus per ",
      usagescalc: "event.value = How('Proficiency Bonus');",
      recovery: "long rest",
      description: desc([
        "You always have the Speak with Animals spell prepared. You can cast it without a spell slot a number of times equal to your Proficiency Bonus and you regain all expended uses when you finish a Long Rest.",
      ]),
      spellcastingBonus: [{
        name: "Forest Gnome Lineage",
        spells: ["speak with animals"],
        selection: ["speak with animals"],
        times: 1,
        firstCol: "PB",
      }],
    },
  },
};
RaceSubList["gnome-rock"] = {
  regExpSearch: /^(?=.*gnome)(?=.*rock).*$/i,
  name: "Rock Gnome",
  sortname: "Gnome, Rock",
  vision: [["Darkvision", 60]],
  spellcastingAbility: [4, 5, 6],
  spellcastingBonus: [{
    name: "Forest Gnome Lineage",
    spells: ["mending", "prestidigitation"],
    selection: ["mending", "prestidigitation"],
    times: 2,
    firstCol: "atwill",
  }],
  trait: "Rock Gnome (Small Humanoid)\n\nDarkvision : You have Darkvision with a range of 60 feet.\n\nRock Gnome Lineage : You know the Mending and Prestidigitation cantrips. In addition, you can spend 10 minutes casting Prestidigitation to create a Tiny clockwork device (AC 5, 1 HP), such as a toy, fire starter, or music box. When you create the device, you determine its function by choosing one effect from Prestidigitation; the device produces that effect whenever you or another creature takes a Bonus Action to activate it with a touch. If the chosen effect has options for the device when you create it. For example, if you choose the spell's ignite extinguish effect, you determine whether the device ignites or extinguishes fire; the device doesn't do both. You can have three such devices in existence at a time, and each falls apart 8 hours after its creation or when you dismantle it with a touch as a Utilize action.\n\nGnomish Cunning : You have Advantage on Intelligence, Wisdom, and Charisma saving throws.",
  features: {
    "rock gnome lineage": {
      name: "Clockwork Devices",
      minlevel: 1,
      usages: "3",
      recovery: "long rest",
      action: ["bonus action", "Clockwork Device (Use)"],
      description: desc([
        "You know the Mending and Prestidigitation cantrips. In addition, you can spend 10 minutes casting Prestidigitation to create a Tiny clockwork device (AC 5, 1 HP), such as a toy, fire starter, or music box. When you create the device, you determine its function by choosing one effect from Prestidigitation; the device produces that effect whenever you or another creature takes a Bonus Action to activate it with a touch. If the chosen effect has options for the device when you create it. For example, if you choose the spell's ignite extinguish effect, you determine whether the device ignites or extinguishes fire; the device doesn't do both. You can have three such devices in existence at a time, and each falls apart 8 hours after its creation or when you dismantle it with a touch as a Utilize action.",
      ]),
    },
  },
};
RaceList["goliath"] = {
  regExpSearch: /^(?=.*goliath).*$/i,
  name: "Goliath",
  sortname: "Goliath",
  source: [["PHB2024", 192]],
  plural: "Goliaths",
  size: 3,
  speed: {walk: {spd: 35, enc: 25}},
  languageProfs: ["Common", 2],
  savetxt: {adv_vs: ["ending the Grappled condition"]},
  age: " reach maturity in late teens and live about 80 years",
  height: " are about 7-8 feet tall",
  trait: "Goliath (Medium Humanoid)\n\nLarge Form : Starting at 5th level, you can change your size to Large as Bonus Action if you're in a big enough space. This transformation lasts for 10 minutes or until you end it (no action required). For that duration, you have Advantage on Strength checks, and your Speed increases by 10 feet. Once you use this trait, you can't use it again until you finish a Long Rest.\n\nPowerful Build : You have Advantage on any saving throw you make to end the Grappled condition. You also count as one size larger when determining your carrying capacity.",
  carryingCapacity: 2,
  variants: ["cloud", "fire", "frost", "hill", "stone", "storm"]
};
RaceSubList["goliath-cloud"] = {
  regExpSearch: /^(?=.*goliath)(?=.*cloud).*$/i,
  name: "Cloud Goliath",
  sortname: "Goliath, Cloud",
  trait: "Cloud Goliath (Medium Humanoid)\n\nGiant Ancestry (Cloud's Jaunt (Cloud Giant)) : As a Bonus Action you magically teleport up to 30 feet to an unoccupied space you can see.\n\nLarge Form : Starting at 5th level, you can change your size to Large as Bonus Action if you're in a big enough space. This transformation lasts for 10 minutes or until you end it (no action required). For that duration, you have Advantage on Strength checks, and your Speed increases by 10 feet. Once you use this trait, you can't use it again until you finish a Long Rest.\n\nPowerful Build : You have Advantage on any saving throw you make to end the Grappled condition. You also count as one size larger when determining your carrying capacity.",
  carryingCapacity: 2,
  features: {
    "cloud's jaunt": {
      name: "Cloud's Jaunt",
      limfeaname: "Cloud's Jaunt",
      minlevel: 1,
      usages: "Proficiency bonus per ",
      usagescalc: "event.value = How('Proficiency Bonus');",
      recovery: "long rest",
      action: [["bonus action", ""]],
      description: desc([
        "As a Bonus Action you magically teleport up to 30 feet to an unoccupied space you can see.",
      ]),
    },
    "large form": {
      name: "Large Form",
      limfeaname: "Large Form",
      minlevel: 5,
      usages: 1,
      recovery: "long rest",
      action: [["bonus action", "Large Form"]],
      description: desc([
        "Starting at 5th level, you can change your size to Large as Bonus Action if you're in a big enough space. This transformation lasts for 10 minutes or until you end it (no action required). For that duration, you have Advantage on Strength checks, and your Speed increases by 10 feet. Once you use this trait, you can't use it again until you finish a Long Rest.",
      ]),
    },
  },
};
RaceSubList["goliath-fire"] = {
  regExpSearch: /^(?=.*goliath)(?=.*fire).*$/i,
  name: "Fire Goliath",
  sortname: "Goliath, Fire",
  trait: "Fire Goliath (Medium Humanoid)\n\nGiant Ancestry (Fire's Burn (Fire Giant)) : When you hit a target with an attack roll and deal damage to it, you can also deal 1d10 Fire damage to that target.\n\nLarge Form : Starting at 5th level, you can change your size to Large as Bonus Action if you're in a big enough space. This transformation lasts for 10 minutes or until you end it (no action required). For that duration, you have Advantage on Strength checks, and your Speed increases by 10 feet. Once you use this trait, you can't use it again until you finish a Long Rest.\n\nPowerful Build : You have Advantage on any saving throw you make to end the Grappled condition. You also count as one size larger when determining your carrying capacity.",
  carryingCapacity: 2,
  features: {
    "fire's burn": {
      name: "Fire's Burn",
      limfeaname: "Fire's Burn",
      minlevel: 1,
      usages: "Proficiency bonus per ",
      usagescalc: "event.value = How('Proficiency Bonus');",
      recovery: "long rest",
      action: [["action", "Fire's Burn (When you hit a target w/ Atk Roll)"]],
      description: desc([
        "When you hit a target with an attack roll and deal damage to it, you can also deal 1d10 Fire damage to that target.",
      ]),
    },
    "large form": {
      name: "Large Form",
      limfeaname: "Large Form",
      minlevel: 5,
      usages: 1,
      recovery: "long rest",
      action: [["bonus action", "Large Form"]],
      description: desc([
        "Starting at 5th level, you can change your size to Large as Bonus Action if you're in a big enough space. This transformation lasts for 10 minutes or until you end it (no action required). For that duration, you have Advantage on Strength checks, and your Speed increases by 10 feet. Once you use this trait, you can't use it again until you finish a Long Rest.",
      ]),
    },
  },
};
RaceSubList["goliath-frost"] = {
  regExpSearch: /^(?=.*goliath)(?=.*frost).*$/i,
  name: "Frost Goliath",
  sortname: "Goliath, Frost",
  trait: "Frost Goliath (Medium Humanoid)\n\nGiant Ancestry (Frost's Chill (Frost Giant)) : When you hit a target with an attack roll and deal damage to it, you can also deal 1d6 Cold damage to that target and reduce its Speed by 10 feet until the start of your next turn.\n\nLarge Form : Starting at 5th level, you can change your size to Large as Bonus Action if you're in a big enough space. This transformation lasts for 10 minutes or until you end it (no action required). For that duration, you have Advantage on Strength checks, and your Speed increases by 10 feet. Once you use this trait, you can't use it again until you finish a Long Rest.\n\nPowerful Build : You have Advantage on any saving throw you make to end the Grappled condition. You also count as one size larger when determining your carrying capacity.",
  carryingCapacity: 2,
  features: {
    "frost's chill": {
      name: "Frost's Chill",
      limfeaname: "Frost's Chill",
      minlevel: 1,
      usages: "Proficiency bonus per ",
      usagescalc: "event.value = How('Proficiency Bonus');",
      recovery: "long rest",
      action: [["action", "Frost's Chill(When you hit a target w/ Atk Roll)"]],
      description: desc([
        "When you hit a target with an attack roll and deal damage to it, you can also deal 1d6 Cold damage to that target and reduce its Speed by 10 feet until the start of your next turn.",
      ]),
    },
    "large form": {
      name: "Large Form",
      limfeaname: "Large Form",
      minlevel: 5,
      usages: 1,
      recovery: "long rest",
      action: [["bonus action", "Large Form"]],
      description: desc([
        "Starting at 5th level, you can change your size to Large as Bonus Action if you're in a big enough space. This transformation lasts for 10 minutes or until you end it (no action required). For that duration, you have Advantage on Strength checks, and your Speed increases by 10 feet. Once you use this trait, you can't use it again until you finish a Long Rest.",
      ]),
    },
  },
};
RaceSubList["goliath-hill"] = {
  regExpSearch: /^(?=.*goliath)(?=.*hill).*$/i,
  name: "Hill Goliath",
  sortname: "Goliath, Hill",
  trait: "Hill Goliath (Medium Humanoid)\n\nGiant Ancestry (Hill's Tumble (Hill Giant)) : When you hit a Large or smaller creature with an Attack Roll and deal damage to it, you can give that target the Prone condition.\n\nLarge Form : Starting at 5th level, you can change your size to Large as Bonus Action if you're in a big enough space. This transformation lasts for 10 minutes or until you end it (no action required). For that duration, you have Advantage on Strength checks, and your Speed increases by 10 feet. Once you use this trait, you can't use it again until you finish a Long Rest.\n\nPowerful Build : You have Advantage on any saving throw you make to end the Grappled condition. You also count as one size larger when determining your carrying capacity.",
  carryingCapacity: 2,
  features: {
    "hill's tumble": {
      name: "Hill's Tumble",
      limfeaname: "Hill's Tumble",
      minlevel: 1,
      usages: "Proficiency bonus per ",
      usagescalc: "event.value = How('Proficiency Bonus');",
      recovery: "long rest",
      action: [["action", "Hill's Tumble (When you hit Large or smaller crea w/ atk roll)"]],
      description: desc([
        "When you hit a Large or smaller creature with an Attack Roll and deal damage to it, you can give that target the Prone condition.",
      ]),
    },
    "large form": {
      name: "Large Form",
      limfeaname: "Large Form",
      minlevel: 5,
      usages: 1,
      recovery: "long rest",
      action: [["bonus action", "Large Form"]],
      description: desc([
        "Starting at 5th level, you can change your size to Large as Bonus Action if you're in a big enough space. This transformation lasts for 10 minutes or until you end it (no action required). For that duration, you have Advantage on Strength checks, and your Speed increases by 10 feet. Once you use this trait, you can't use it again until you finish a Long Rest.",
      ]),
    },
  },
};
RaceSubList["goliath-stone"] = {
  regExpSearch: /^(?=.*goliath)(?=.*stone).*$/i,
  name: "Stone Goliath",
  sortname: "Goliath, Stone",
  trait: "Stone Goliath (Medium Humanoid)\n\nGiant Ancestry (Stone's Endurance (Stone Giant)) : When you take damage, you can take a Reaction to roll 1d12. Add your Constitution modifier to the number rolled and reduce the damage by that total.\n\nLarge Form : Starting at 5th level, you can change your size to Large as Bonus Action if you're in a big enough space. This transformation lasts for 10 minutes or until you end it (no action required). For that duration, you have Advantage on Strength checks, and your Speed increases by 10 feet. Once you use this trait, you can't use it again until you finish a Long Rest.\n\nPowerful Build : You have Advantage on any saving throw you make to end the Grappled condition. You also count as one size larger when determining your carrying capacity.",
  carryingCapacity: 2,
  features: {
    "stone's endurance": {
      name: "Stone's Endurance",
      limfeaname: "Stone's Endurance",
      minlevel: 1,
      usages: "Proficiency bonus per ",
      usagescalc: "event.value = How('Proficiency Bonus');",
      recovery: "long rest",
      action: [["reaction", "Stone's Endurance(When you take Dmg)"]],
      description: desc([
        "When you take damage, you can take a Reaction to roll 1d12. Add your Constitution modifier to the number rolled and reduce the damage by that total.",
      ]),
    },
    "large form": {
      name: "Large Form",
      limfeaname: "Large Form",
      minlevel: 5,
      usages: 1,
      recovery: "long rest",
      action: [["bonus action", "Large Form"]],
      description: desc([
        "Starting at 5th level, you can change your size to Large as Bonus Action if you're in a big enough space. This transformation lasts for 10 minutes or until you end it (no action required). For that duration, you have Advantage on Strength checks, and your Speed increases by 10 feet. Once you use this trait, you can't use it again until you finish a Long Rest.",
      ]),
    },
  },
};
RaceSubList["goliath-storm"] = {
  regExpSearch: /^(?=.*goliath)(?=.*storm).*$/i,
  name: "Storm Goliath",
  sortname: "Goliath, Storm",
  trait: "Storm Goliath (Medium Humanoid)\n\nGiant Ancestry (Storm's Thunder (Storm Giant)) : When you take damage from a creature within 60 feet of you, you can take a Reaction to deal 1d8 Thunder damage to that creature.\n\nLarge Form : Starting at 5th level, you can change your size to Large as Bonus Action if you're in a big enough space. This transformation lasts for 10 minutes or until you end it (no action required). For that duration, you have Advantage on Strength checks, and your Speed increases by 10 feet. Once you use this trait, you can't use it again until you finish a Long Rest.\n\nPowerful Build : You have Advantage on any saving throw you make to end the Grappled condition. You also count as one size larger when determining your carrying capacity.",
  carryingCapacity: 2,
  features: {
    "storm's thunder": {
      name: "Storm's Thunder",
      limfeaname: "Storm's Thunder",
      minlevel: 1,
      usages: "Proficiency bonus per ",
      usagescalc: "event.value = How('Proficiency Bonus');",
      recovery: "long rest",
      action: [["reaction", "Storm's Thunder (When take Dmg from Crea W/I 60 ft.)"]],
      description: desc([
        "When you take damage from a creature within 60 feet of you, you can take a Reaction to deal 1d8 Thunder damage to that creature.",
      ]),
    },
    "large form": {
      name: "Large Form",
      limfeaname: "Large Form",
      minlevel: 5,
      usages: 1,
      recovery: "long rest",
      action: [["bonus action", "Large Form"]],
      description: desc([
        "Starting at 5th level, you can change your size to Large as Bonus Action if you're in a big enough space. This transformation lasts for 10 minutes or until you end it (no action required). For that duration, you have Advantage on Strength checks, and your Speed increases by 10 feet. Once you use this trait, you can't use it again until you finish a Long Rest.",
      ]),
    },
  },
};
RaceList["halfling"] = {
  regExpSearch: /^(?=.*halfling).*$/i,
  name: "Halfling",
  sortname: "Halfling",
  source: [["PHB2024", 193]],
  plural: "Halflings",
  size: 4,
  speed: {walk: {spd: 30, enc: 20}},
  languageProfs: ["Common", 2],
  savetxt: {adv_vs: ["avoiding or ending the Frightened condition"]},
  age: " reach maturity in late teens and live about 150 years",
  height: " are about 2-3 feet tall",
  trait: "Halfling (Small Humanoid)\n\nBrave : You have Advantage on saving throws you make to avoid or end the Frightened condition.\n\nHalfling Nimbleness : You can move through the space of any creature that is a size larger than you, but you can't stop in the same space.\n\nLuck : When you roll a 1 on the d20 of a D20 Test, you can reroll the die, and you must use the new roll.\n\nNaturally Stealthy : You can take the Hide action even when you are obscured only by a creature that is at least one size larger than you.",
};
RaceList["human"] = {
  regExpSearch: /^(?=.*human).*$/i,
  name: "Human",
  sortname: "Human",
  source: [["PHB2024", 194]],
  plural: "Humans",
  size: [3, 4],
  speed: {walk: {spd: 30, enc: 20}},
  languageProfs: ["Common", 2],
  skillstxt: "Choose any one skill",
  age: " reach maturity in late teens and live about 80 years",
  height: " are about 2-4 or 4-7 feet tall",
  trait: "Human (Small or Medium Humanoid)\n\nResourceful : You gain Heroic Inspiration whenever you finish a Long Rest.\n\nSkillful : you gain proficiency in one skill of your choice.\n\nVersatile : You gain an Origin feat of your choice (see chapter 5). Skilled is recommended.",
  eval: function () {
    AddString('Feat Note 1', 'Human bonus feat', '; ');
  },
  removeeval: function () {
    RemoveString('Feat Note 1', 'Human bonus feat');
  },
};
RaceList["orc"] = {
  regExpSearch: /^(?=.*orc).*$/i,
  name: "Orc",
  sortname: "Orc",
  source: [["PHB2024", 195]],
  plural: "Orcs",
  size: 3,
  speed: {walk: {spd: 35, enc: 25}},
  languageProfs: ["Common", 2],
  vision: [["Darkvision", 120]],
  age: " reach maturity in late teens and live about 80 years",
  height: " are about 6-7 feet tall",
  trait: "Orc (Medium Humanoid)\n\nAdrenaline Rush : You can take the Dash action as a Bonus Action. When you do so, you gain a number of Temporary Hit Points equal to your Proficiency Bonus. You can use this trait a number of times equal to your Proficiency Bonus, and you regain all expended uses when you finish a Short or Long Rest.\n\nDarkvision : You have Darkvision within a range of 120 feet.\n\nRelentless Endurance : When you are reduced to 0 Hit Points but not killed outright, you can drop t 1 Hit Point instead. Once you use this trait, you can't do so again until you finish a Long Rest.",
  features: {
    "adrenaline rush": {
      name: "Adrenaline Rush",
      limfeaname: "Adrenaline Rush",
      minlevel: 1,
      usages: "Proficiency bonus per ",
      usagescalc: "event.value = How('Proficiency Bonus');",
      recovery: "short rest",
      action: [["bonus action", "Dash"]],
      description: desc([
        "You can take the Dash action as a Bonus Action. When you do so, you gain a number of Temporary Hit Points equal to your Proficiency Bonus. You can use this trait a number of times equal to your Proficiency Bonus, and you regain all expended uses when you finish a Short or Long Rest.",
      ]),
    },
    "relentless endurance": {
      name: "Relentless Endurance",
      limfeaname: "Relentless Endurance",
      minlevel: 1,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "When you are reduced to 0 Hit Points but not killed outright, you can drop t 1 Hit Point instead. Once you use this trait, you can't do so again until you finish a Long Rest.",
      ]),
    },
  },
};
RaceList["tiefling"] = {
  regExpSearch: /^(?=.*tiefling).*$/i,
  name: "Tiefling",
  sortname: "Tiefling",
  source: [["PHB2024", 197]],
  plural: "Tieflings",
  size: [3, 4],
  speed: {walk: {spd: 30, enc: 20}},
  languageProfs: ["Common", 2],
  vision: [["Darkvision", 60]],
  age: " reach maturity in late teens and live about 80 years",
  height: " are about 6-7 feet tall",
  spellcastingAbility: [4, 5, 6],
  spellcastingBonus: [{
    name: "Otherworldly Presence",
    spells: ["thaumaturgy"],
    selection: ["thaumaturgy"],
    times: 1,
    firstCol: "atwill",
  }],
  trait: "Tiefling (Small or Medium Humanoid)\n\nDarkvision : You have Darkvision within a range of 60 feet.\n\nFiendish Legacy : You are the recipient of a legacy that grants you supernatural abilities. Choose a legacy from the Fiendish Legacies table. You gain the level 1 benefit of the chose legacy. When you reach character levels 3 and 5, you learn a higher-level spell, as shown on the table. You always have that spell prepared. You can cast it once without a spell slot, and you regain the ability to cast it in that way when you finish a Long Rest. You can also cast the spell using any spell slots you have of the appropriate level. Intelligence, Wisdom, or Charisma is your spellcasting ability for the spells you cast with this trait (choose the ability when you select the legacy).\n\nOtherworldly Presence : You know the Thaumaturgy cantrip. When you cast it with this trait, the spell uses the same spellcasting ability you use for your Fiendish Legacy trait.",
  variants: ["abyssal", "chthonic", "infernal"]
};
RaceSubList["tiefling-abyssal"] = {
  regExpSearch: /^(?=.*tiefling)(?=.*abyssal).*$/i,
  name: "Abyssal Tiefling",
  sortname: "Tiefling, Abyssal",
  plural: "Tieflings",
  vision: [["Darkvision", 60]],
  dmgres: ["Poison"],
  spellcastingAbility: [4, 5, 6],
  spellcastingBonus: [{
    name: "Abyssal Lineage",
    spells: ["thaumaturgy", "poison spray"],
    selection: ["thaumaturgy", "poison spray"],
    times: 2,
    firstCol: "atwill",
  }],
  trait: "Abyssal Tiefling (Small or Medium Humanoid)\n\nDarkvision : You have Darkvision within a range of 60 feet.\n\nFiendish Legacy : You are part of a lineage that grants you supernatural abilities. You gain the Poison Spray cantrip. When you reach character level 3 you learn the Ray of Sickness spell, and when you reach character level 5 you learn the Hold Person spell. You always have that spell prepared. You can cast it once without a spell slot, and you regain the ability to cast it in that way when you finish a Long Rest. You can also cast the spell using any spell slots you have of the appropriate level. Intelligence,Wisdom, or Charisma is your spellcasting ability for the spells you cast with this trait. (Choose the ability when you select the lineage).\n\nOtherworldly Presence : You know the Thaumaturgy cantrip. When you cast it with this trait, the spell uses the same spellcasting ability you use for your Fiendish Legacy trait.",
  features: {
    "abyssal lineage3": {
      name: "Ray of Sickness",
      minlevel: 3,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "When you reach character level 3 you learn the Ray of Sickness spell.",
      ]),
      spellcastingBonus: [{
        name: "Abyssal Lineage",
        spells: ["ray of sickness"],
        selection: ["ray of sickness"],
        times: 1,
        firstCol: "oncelr",
      }],
    },
    "abyssal lineage5": {
      name: "Hold Person",
      minlevel: 5,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "When you reach character level 5 you learn the Hold Person spell.",
      ]),
      spellcastingBonus: [{
        name: "Abyssal Lineage",
        spells: ["hold person"],
        selection: ["hold person"],
        times: 1,
        firstCol: "oncelr",
      }],
    },
  },
};
RaceSubList["tiefling-chthonic"] = {
  regExpSearch: /^(?=.*tiefling)(?=.*chthonic).*$/i,
  name: "Chthonic Tiefling",
  sortname: "Tiefling, Chthonic",
  plural: "Tieflings",
  vision: [["Darkvision", 60]],
  dmgres: ["Necrotic"],
  spellcastingAbility: [4, 5, 6],
  spellcastingBonus: [{
    name: "Chthonic Lineage",
    spells: ["thaumaturgy", "chill touch"],
    selection: ["thaumaturgy", "chill touch"],
    times: 2,
    firstCol: "atwill",
  }],
  trait: "Chthonic Tiefling (Small or Medium Humanoid)\n\nDarkvision : You have Darkvision within a range of 60 feet.\n\nFiendish Legacy : You are part of a lineage that grants you supernatural abilities. You gain the Chill Touch cantrip. When you reach character level 3 you learn the False Life spell, and when you reach character level 5 you learn the Ray of Enfeeblement spell. You always have that spell prepared. You can cast it once without a spell slot, and you regain the ability to cast it in that way when you finish a Long Rest. You can also cast the spell using any spell slots you have of the appropriate level. Intelligence,Wisdom, or Charisma is your spellcasting ability for the spells you cast with this trait. (Choose the ability when you select the lineage).\n\nOtherworldly Presence : You know the Thaumaturgy cantrip. When you cast it with this trait, the spell uses the same spellcasting ability you use for your Fiendish Legacy trait.",
  features: {
    "chthonic lineage3": {
      name: "False Life",
      minlevel: 3,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "When you reach character level 3 you learn the False Life spell.",
      ]),
      spellcastingBonus: [{
        name: "Chthonic Lineage",
        spells: ["false life"],
        selection: ["false life"],
        times: 1,
        firstCol: "oncelr",
      }],
    },
    "chthonic lineage5": {
      name: "Ray of Enfeeblement",
      minlevel: 5,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "When you reach character level 5 you learn the Ray of Enfeeblement spell.",
      ]),
      spellcastingBonus: [{
        name: "Chthonic Lineage",
        spells: ["ray of enfeeblement"],
        selection: ["ray of enfeeblement"],
        times: 1,
        firstCol: "oncelr",
      }],
    },
  },
};
RaceSubList["tiefling-infernal"] = {
  regExpSearch: /^(?=.*tiefling)(?=.*infernal).*$/i,
  name: "Infernal Tiefling",
  sortname: "Tiefling, Infernal",
  plural: "Tieflings",
  vision: [["Darkvision", 60]],
  dmgres: ["Fire"],
  spellcastingAbility: [4, 5, 6],
  spellcastingBonus: [{
    name: "Infernal Lineage",
    spells: ["thaumaturgy", "fire bolt"],
    selection: ["thaumaturgy", "fire bolt"],
    times: 2,
    firstCol: "atwill",
  }],
  trait: "Infernal Tiefling (Small or Medium Humanoid)\n\nDarkvision : You have Darkvision within a range of 60 feet.\n\nFiendish Legacy : You are part of a lineage that grants you supernatural abilities. You gain the Fire Bolt cantrip. When you reach character level 3 you learn the Hellish Rebuke spell, and when you reach character level 5 you learn the Darkness spell. You always have that spell prepared. You can cast it once without a spell slot, and you regain the ability to cast it in that way when you finish a Long Rest. You can also cast the spell using any spell slots you have of the appropriate level. Intelligence,Wisdom, or Charisma is your spellcasting ability for the spells you cast with this trait. (Choose the ability when you select the lineage).\n\nOtherworldly Presence : You know the Thaumaturgy cantrip. When you cast it with this trait, the spell uses the same spellcasting ability you use for your Fiendish Legacy trait.",
  features: {
    "infernal lineage3": {
      name: "Hellish Rebuke",
      minlevel: 3,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "When you reach character level 3 you learn the Hellish Rebuke spell.",
      ]),
      spellcastingBonus: [{
        name: "Infernal Lineage",
        spells: ["hellish rebuke"],
        selection: ["hellish rebuke"],
        times: 1,
        firstCol: "oncelr",
      }],
    },
    "infernal lineage5": {
      name: "Darkness",
      minlevel: 5,
      usages: 1,
      recovery: "long rest",
      description: desc([
        "When you reach character level 5 you learn the Darkness spell.",
      ]),
      spellcastingBonus: [{
        name: "Infernal Lineage",
        spells: ["darkness"],
        selection: ["darkness"],
        times: 1,
        firstCol: "oncelr",
      }],
    },
  },
};
//Origin Feats
FeatsList["alert [origin]"] = {
  name: "Alert [Origin]",
  source: [["PHB2024", 200]],
  regExpSearch: /^(?=.*alert).*$/i,
  skillstxt: ["You gain Proficiency in three skills or tools of your choice"],
  addMod: [{type: "skill", field: "Init", mod: "prof", text: "I can add my Proficiency Bonus to initiative rolls."}],
  description: desc([
    "You add your Prof Bonus to Initiative rolls. You may swap Initiative with one willing creature as long as that creature does not have the Incapacitated condition.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "When you roll Initiative, you can add your Proficiency Bonus to the roll.",
    "Immediately after you roll Initiative, you can swap your Initiative with the Initiative of one willing ally in the same combat. You can't make this swap if you or the ally has the Incapacitated condition.",
  ]),
};
FeatsList["crafter [origin]"] = {
  name: "Crafter [Origin]",
  source: [["PHB2024", 200]],
  regExpSearch: /^(?=.*crafter).*$/i,
  toolProfs: [["Artisan's tools", 3]],
  description: desc([
    "You gain proficiency in three Fast Craft Artisan Tools of choice and can use them to Fast Craft during a long rest, (see Notes Page for details),the fast crafted item lasts until your next long rest. You received a 20% discount on non-magical objects.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits.",
    "You gain proficiency with three different Artisan's Tools of your choice from the Fast Crafting table. (See Notes Page for details)",
    "Whenever you buy a nonmagical item, you receive a 20 percent discount on it.",
    "When you finish a Long Rest, you can craft one piece of gear from the Fast Crafting table, provided you have the Artisan's Tools associated with that item and have proficiency with those tools. The item last until you finish another Long Rest, at which point the item falls apart.",
  ]),
  toNotesPage: [{
    name: "Fast Crafting",
    note: [
      "Artisan's tools & Associated Crafted Gear",
      "Carpenter's Tools : Ladder, Torch",
      "Leatherworker's Tools : Case, Pouch",
      "Mason's Tools : Block and Tackle",
      "Potter's Tools : Jug, lamp",
      "Smith's Tools : Ball Bearings, Bucket, Caltrops, Grappling Hook, Iron Pot",
      "Tinker's Tools : Bell, Shovel, Tinder Box",
      "Weaver's Tools : Basket, Rope, Net, Tent",
      "Woodcarver's Tools : Club, Greatclub, Quarterstaff",
    ],
  }],
};
FeatsList["healer [origin]"] = {
  name: "Healer [Origin]",
  source: [["PHB2024", 201]],
  regExpSearch: /^(?=.*healer).*$/i,
  action: [["action", "Battle Medic"]],
  description: desc([
    "You can use a Healer's Kit as an action to allow 1 creature within 5ft of you to roll a Hit Die and regain HP equal to the roll plus your Prof Bonus, and when you roll a 1 on the die to heal using a spell or this feat you can reroll, but must use the new roll.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits.",
    "Battle Medic : If you have a Healer's Kit, you can expend one use of it and tend to a creature within 5 feet of yourself as a Utilize action. That creature can expend one of its Hit Point Dice, and you then roll that die. The creature regains a number of Hit Points equal to the roll plus your Proficiency Bonus",
    "Healing Rerolls : Whenever you roll a die to determine the number of Hit Points you restore with a spell or with this feat's Battle Medic benefit, you can reroll the die if it rolls a 1, and you must use the new roll.",
  ]),
};
FeatsList["lucky [origin]"] = {
  name: "Lucky [Origin]",
  source: [["PHB2024", 201]],
  regExpSearch: /^(?=.*lucky).*$/i,
  limfeaname: "Luck Points",
  usages: "Proficiency bonus per ",
  usagescalc: "event.value = How('Proficiency Bonus');",
  recovery: "long rest",
  description: desc([
    "You gain a number of Luck Points equal to your Prof Bonus and can use them to give yourself Advantage on a D20 Test, or to give a creature who rolls a d20 for an attack roll against Disadvantage on that roll.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits.",
    "Luck Point : You have a number of Luck Points equal to your Proficiency Bonus and can spend the points on the benefits below. You regain your expended Luck Points when you finish a Long Rest.",
    "Advantage : When you roll a d20 for a D20 Test, you can spend 1 Luck Point to give yourself Advantage on the roll.",
    "Disadvantage : When a creature rolls a d20 for an attack roll against you, you can spend 1 Luck Point to impose Disadvantage on that roll.",
  ]),
};
FeatsList["magic initiate (cleric) [origin]"] = {
  name: "Magic Initiate (Cleric) [Origin]",
  source: [["PHB2024", 201]],
  regExpSearch: /^(?=.*magic)(?=.*initiate)(?=.*cleric).*$/i,
  spellcastingAbility: [4, 5, 6],
  spellcastingBonus: [{
    name: "Magic Initiate Cantrips",
    "class": "cleric",
    level: [0, 0],
    times: 2,
    firstCol: "atwill",
  }, {
    name: "Magic Initiate 1st-Level",
    "class": "cleric",
    level: [1, 1],
    times: 1,
    firstCol: "oncelr",
  }],
  description: desc([
    "You gain 2 Cantrips, and 1 1st level spell of choice from the Cleric spell list, you may swap any one of these spells with another from the Cleric spell list when you gain a level, you may cast the 1st-level spell once without using a spell slot before a long rest, otherwise you may cast it using any spell slots you have.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits.",
    "Two Cantrips of your choice from the Cleric spell list. Intelligence, Wisdom, or Charisma is your spellcasting ability for this feat's spells (choose when you select this feat.)",
    "Choose a level 1 spell from the Cleric spell list, You always have that spell prepared. You can cast it once without a spell slot, and you regain the ability to cast it in that way when you finish a Long Rest. You can also cast the spell using any spell slots you have.",
    "Whenever you gain a new level, you can replace one of the spells you chose from this feat with a different spell of the same level from the Cleric spell list.",
    "You can take this feat more than once, but must choose either the Druid spell list, or Wizard spell list.",
  ]),
};
FeatsList["magic initiate (druid) [origin]"] = {
  name: "Magic Initiate (Druid) [Origin]",
  source: [["PHB2024", 201]],
  regExpSearch: /^(?=.*magic)(?=.*initiate)(?=.*druid).*$/i,
  spellcastingAbility: [4, 5, 6],
  spellcastingBonus: [{
    name: "Magic Initiate Cantrips",
    "class": "druid",
    level: [0, 0],
    times: 2,
    firstCol: "atwill",
  }, {
    name: "Magic Initiate 1st-Level",
    "class": "druid",
    level: [1, 1],
    times: 1,
    firstCol: "oncelr",
  }],
  description: desc([
    "You gain 2 Cantrips, and 1 1st level spell of choice from the Druid spell list, you may swap any one of these spells with another from the Druid spell list when you gain a level, you may cast the 1st-level spell once without using a spell slot before a long rest, otherwise you may cast it using any spell slots you have.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits.",
    "Two Cantrips of your choice from the Druid spell list. Intelligence, Wisdom, or Charisma is your spellcasting ability for this feat's spells (choose when you select this feat.)",
    "Choose a level 1 spell from the Druid spell list, You always have that spell prepared. You can cast it once without a spell slot, and you regain the ability to cast it in that way when you finish a Long Rest. You can also cast the spell using any spell slots you have.",
    "Whenever you gain a new level, you can replace one of the spells you chose from this feat with a different spell of the same level from the Druid spell list.",
    "You can take this feat more than once, but must choose either the Cleric spell list, or Wizard spell list.",
  ]),
};
FeatsList["magic initiate (wizard) [origin]"] = {
  name: "Magic Initiate (Wizard) [Origin]",
  source: [["PHB2024", 201]],
  regExpSearch: /^(?=.*magic)(?=.*initiate)(?=.*wizard).*$/i,
  spellcastingAbility: [4, 5, 6],
  spellcastingBonus: [{
    name: "Magic Initiate Cantrips",
    "class": "wizard",
    level: [0, 0],
    times: 2,
    firstCol: "atwill",
  }, {
    name: "Magic Initiate 1st-Level",
    "class": "wizard",
    level: [1, 1],
    times: 1,
    firstCol: "oncelr",
  }],
  description: desc([
    "You gain 2 Cantrips, and 1 1st level spell of choice from the Wizard spell list, you may swap any one of these spells with another from the Wizard spell list when you gain a level, you may cast the 1st-level spell once without using a spell slot before a long rest, otherwise you may cast it using any spell slots you have.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits.",
    "Two Cantrips of your choice from the Wizard spell list. Intelligence, Wisdom, or Charisma is your spellcasting ability for this feat's spells (choose when you select this feat.)",
    "Choose a level 1 spell from the Wizard spell list, You always have that spell prepared. You can cast it once without a spell slot, and you regain the ability to cast it in that way when you finish a Long Rest. You can also cast the spell using any spell slots you have.",
    "Whenever you gain a new level, you can replace one of the spells you chose from this feat with a different spell of the same level from the Wizard spell list.",
    "You can take this feat more than once, but must choose either the Cleric spell list, or Druid spell list.",
  ]),
};
FeatsList["musician [origin]"] = {
  name: "Musician [Origin]",
  source: [["PHB2024", 201]],
  regExpSearch: /^(?=.*musician).*$/i,
  toolProfs: [["Musical Instrument", 3]],
  description: desc([
    "You gain proficiency in 3 Musical Instruments and at the end of a Short or Long Rest you can play a song to give a number of allies up to your Prof Bonus Heroic Inspiration.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "You gain proficiency with three Musical Instruments of your choice.",
    "As you finish a Short or Long Rest, you can play a song on a Musical Instrument with which you have proficiency and give Heroic Inspiration to allies who hear the song. The number of allies you can affect in this way equals your Proficiency Bonus.",
  ]),
};
FeatsList["savage attacker [origin]"] = {
  name: "Savage Attacker [Origin]",
  source: [["PHB2024", 201]],
  regExpSearch: /^(?=.*savage)(?=.*attacker).*$/i,
  description: desc([
    "You've trained to deal particularly damaging strikes. Once per turn when you hit a target with a weapon, you can roll the weapon's damage dice twice and use either roll against the target.",
  ]),
  descriptionFull: desc([
    "You've trained to deal particularly damaging strikes. Once per turn when you hit a target with a weapon, you can roll the weapon's damage dice twice and use either roll against the target.",
  ]),
};
FeatsList["skilled [origin]"] = {
  name: "Skilled [Origin]",
  source: [["PHB2024", 201]],
  regExpSearch: /^(?=.*skilled).*$/i,
  skillstxt: ["You gain Proficiency in three skills or tools of your choice"],
  description: desc([
    "You gain Proficiency in three skills or tools of your choice",
  ]),
  descriptionFull: desc([
    "You gain proficiency in any combination of three skills or tools of your choice",
    "you can take this feat more than once.",
  ]),
};
FeatsList["tavern brawler [origin]"] = {
  name: "Tavern Brawler [Origin]",
  source: [["PHB2024", 202]],
  regExpSearch: /^(?=.*tavern)(?=.*brawler).*$/i,
  weaponProfs: [false, false, ["Improvised weapons"]],
  calcChanges: {
    atkAdd: [
      function (fields, v) {
        if (v.baseWeaponName == "unarmed strike" || (/improvised/i).test(v.WeaponName + v.baseWeaponName) || (/improvised weapon/i).test(v.theWea.type)) {
          fields.Proficiency = true;
          if (v.isMeleeWeapon) fields.Description += (fields.Description ? '; ' : '') + 'On a hit, can deal damage and Push target 5 ft..';
        }
        if (v.baseWeaponName == "unarmed strike" && fields.Damage_Die == 1) {
          fields.Damage_Die = '1d4';
        }
      },
      "My unarmed strikes deal 1d4 damage instead of 1.\n \u2022 As part of the Attack action on my turn, I can deal damage and push the target 5ft away from me."
    ]
  },
  description: desc([
    "Your Unarmed Strikes deal 1d4 instead of normal damage and as part of the attack action you can push a target 5 feet as well as deal damage. When you roll a 1 on the damage die you can reroll, but must use the new roll.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits.",
    "Enhanced Unarmed Strike : When you hit with your Unarmed Strike and deal damage, you can deal Bludgeoning damage equal to 1d4 plus your Strength modifier instead of the normal damage of an Unarmed Strike.",
    "Damage Rerolls : Whenever you roll a damage die for your Unarmed Strike, you can reroll the die if it rolls a 1, and you must use the new roll.",
    "Improvised Weaponry : You have proficiency with improvised weapons.",
    "Push : When you hit a creature with an Unarmed Strike as part of the Attack action on your turn, you can deal damage to the target and also push it 5 feet away from you. You can use this benefit only once per turn.",
  ]),
};
FeatsList["tough [origin]"] = {
  name: "Tough [Origin]",
  source: [["PHB2024", 202]],
  regExpSearch: /^(?=.*tough).*$/i,
  calcChanges: {
    hp: function (totalHD) {
      return [totalHD * 2, '\n + ' + totalHD + ' \xD7 2 from the Tough feat (' + (totalHD * 2) + ')', true];
    }
  },
  description: desc([
    "Your Hit Point maximum increases by an amount equal to twice your character level when you gain this feat. Whenever you gain a character level thereafter, your Hit Point maximum increases by an additional 2 Hit Points.",
  ]),
  descriptionFull: desc([
    "Your Hit Point maximum increases by an amount equal to twice your character level when you gain this feat. Whenever you gain a character level thereafter, your Hit Point maximum increases by an additional 2 Hit Points.",
  ]),
};
//General Feats
FeatsList["actor"] = {
  name: "Actor",
  source: [["PHB2024", 202]],
  regExpSearch: /^(?=.*actor).*$/i,
  scores: [0, 0, 0, 0, 0, 1],
  description: desc([
    "+1 Cha, Adv Cha (Deception or Performance) checks to impersonate a person real or fiction. able to mimic the sounds of others DC 8 + Cha + PB Insight check to determine mimicry",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Charisma score by 1 to a maximum of 20.",
    "Impersonation : While you're disguised as a real or fictional person, you have Advantage on Charisma (Deception or Performance) checks to convince others that you are that person.",
    "Mimicry : You can mimic sounds of other creatures, including speech. A creature that hears the mimicry must succeed on a Wisdom (Insight) check to determine the effect is faked (DC 8 plus your Charisma modifier and Proficiency Bonus).",
  ]),
  prerequisite: "Level 4 and Charisma 13 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && What('Cha') >= 13;
  },
};
FeatsList["athlete"] = {
  name: "Athlete",
  source: [["PHB2024", 202]],
  regExpSearch: /^(?=.*athlete).*$/i,
  speed: {climb: {spd: "walk", enc: "walk"}},
  description: desc([
    "+1 Str or Dex, gain a climb speed equal to speed, can right self from prone using only 5 ft. of movement, can make running long or high jump after only 5 feet of movement.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Strength or Dexterity score by 1 to a maximum of 20.",
    "Climb Speed : You gain a Climb Speed equal to your Speed.",
    "Hop Up : When you have the Prone condition, you can right yourself with only 5 feet of movement.",
    "Jumping : You can make a running Long or High Jump after moving only 5 feet.",
  ]),
  choices: ["Strength", "Dexterity"],
  "strength": {
    description: "Gain a climb speed equal to speed, can right self from prone using only 5 ft. of movement, can make running long or high jump after only 5 feet of movement. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    description: "Gain a climb speed equal to speed, can right self from prone using only 5 ft. of movement, can make running long or high jump after only 5 feet of movement. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
  },
  prerequisite: "Level 4 and Strength or Dexterity 13 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && What('Str') >= 13 || What('Dex') >= 13;
  },
};
FeatsList["charger"] = {
  name: "Charger",
  source: [["PHB2024", 202]],
  regExpSearch: /^(?=.*charger).*$/i,
  scorestxt: "Your Strength or Dexterity score increases by 1, to a maximum of 20.",
  description: desc([
    "+1 Str or Dex, when you take the Dash action your base speed increases by 10 ft. for that action, and if you move at least 10 ft. in a straight line towards an enemy and attack as part of the Attack action you may either deal an additional 1d8 damage or push the target 10 feet away.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Strength or Dexterity score by 1 to a maximum of 20.",
    "Improved Dash : When you take the Dash action, your Speed increases by 10 feet for that action.",
    "Charge Attack : If you move at least 10 feet in a strait line toward a target immediately before hitting it with a melee attack roll as part of the Attack action, choose one of the following effects: gin a 1d8 bonus to the attack's damage roll, or push the target up to 10 feet away if it is no more than one size larger than you. You can use this benefit only once on each of your turns.",
  ]),
  choices: ["Strength", "Dexterity"],
  "strength": {
    description: "When you take the Dash action your base speed increases by 10 ft. for that action, and if you move at least 10 ft. in a straight line towards an enemy and attack as part of the Attack action you may either deal an additional 1d8 damage or push the target 10 feet away. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    description: "When you take the Dash action your base speed increases by 10 ft. for that action, and if you move at least 10 ft. in a straight line towards an enemy and attack as part of the Attack action you may either deal an additional 1d8 damage or push the target 10 feet away. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
  },
  prerequisite: "Level 4 and Strength or Dexterity 13 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && What('Str') >= 13 || What('Dex') >= 13;
  },
};
FeatsList["chef"] = {
  name: "Chef",
  source: [["PHB2024", 202]],
  regExpSearch: /^(?=.*chef).*$/i,
  scorestxt: "Your Constitution or Wisdom score increases by 1, to a maximum of 20.",
  toolProfs: [["Cook's Utensils"]],
  description: desc([
    "+1 Con or Wis, gain proficiency in Cook's Utensils, as part of a short rest, you can cook special food for 4+PB creatures if they eat it and spend at least 1 Hit Die, they regain an additional 1d8 hit points. After an hour or during a long rest, you can make PB special treats that if eaten as a bonus action can grant a number of temp HP equal to your PB.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Constitution or Wisdom score by 1 to a maximum of 20.",
    "Cook's Utensils : You gain proficiency with Cook's Utensils if you don't already have it.",
    "Replenishing Meal : As part of a Short Rest, you can cook special food if you have ingredients and Cook's Utensils on hand, You can prepare enough of this food for a number of creatures equal to 4 plus your Proficiency Bonus. At the end of the Short Rest, any creature who eats the food and spends one or more Hit Dice to regain Hit Points regains an extra 1d8 Hit Points.",
    "Bolstering Treats : With 1 hour of work or when you finish a Long Rest, you can cook a number of treats equal to your Proficiency Bonus if you have ingredients and Cook's Utensils on hand. These special treats last 8 hours after being made. A creature can use a Bonus Action to eat one of those treats to gain a number of Temporary Hit Points equal to your Proficiency Bonus.",
  ]),
  choices: ["Constitution", "Wisdom"],
  "constitution": {
    description: "Gain proficiency in Cook's Utensils, as part of a short rest, you can cook special food for 4+PB creatures if they eat it and spend at least 1 Hit Die, they regain an additional 1d8 hit points. After an hour or during a long rest, you can make PB special treats that if eaten as a bonus action can grant a number of temp HP equal to your PB. [+1 Constitution]",
    scores: [0, 0, 1, 0, 0, 0],
  },
  "wisdom": {
    description: "Gain proficiency in Cook's Utensils, as part of a short rest, you can cook special food for 4+PB creatures if they eat it and spend at least 1 Hit Die, they regain an additional 1d8 hit points. After an hour or during a long rest, you can make PB special treats that if eaten as a bonus action can grant a number of temp HP equal to your PB. [+1 Wisdom]",
    scores: [0, 0, 0, 0, 1, 0],
  },
  prerequisite: "Level 4 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4;
  },
};
FeatsList["crossbow expert"] = {
  name: "Crossbow Expert",
  source: [["PHB2024", 203]],
  regExpSearch: /^(?=.*crossbow)(?=.*expert).*$/i,
  scores: [0, 1, 0, 0, 0, 0],
  description: desc([
    "+1 Dex, You ignore the Loading property of crossbows, firing at an enemy within 5 feet does not impose disadvantage, and you can make an off-hand attack with a crossbow that has the light property and add your Dex modifier to the damage of the attack.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Dexterity score by 1 to a maximum of 20.",
    "Ignore Loading : You ignore the Loading property of the Hand Crossbow, Heavy Crossbow, and Light Crossbow (all called crossbows elsewhere in this feat). If you're holding one of them, you can load a piece of ammunition into it even if you lack a free hand.",
    "Firing in Melee : Being within 5 feet of an enemy doesn't impose Disadvantage on your attack rolls with crossbows.",
    "Dual Wielding : When you make the extra attack of the Light property, you can add your ability modifier to the damage of the extra attack if that attack is with a crossbow that has the Light property and you aren't already adding that modifier to the damage.",
  ]),
  prerequisite: "Level 4 and Dexterity 13 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && What('Dex') >= 13;
  },
};
FeatsList["crusher"] = {
  name: "Crusher",
  source: [["PHB2024", 203]],
  regExpSearch: /^(?=.*crusher).*$/i,
  description: desc([
    "+1 Str or Con, 1/turn when you hit a crea. with Blud. dmg you can push 5ft to unoccupied space if crea. is 1 size larger than you or smaller, when you land a critical hit with Blud. dmg atks against that crea. have Adv. until the start of your next turn.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Strength or Constitution score by 1 to a maximum of 20.",
    "Push : Once per turn, when you hit a creature with an attack that deals Bludgeoning damage, you can move it 5 feet to an unoccupied space if the target is no more than one size larger than you.",
    "Enhanced Critical : When you score a Critical Hit that deals Bludgeoning damage to a creature, attack rolls against that creature have Advantage until the start of your next turn.",
  ]),
  choices: ["Strength", "Constitution"],
  "strength": {
    description: "1/turn when you hit a crea. with Blud. dmg you can push 5ft to unoccupied space if crea. is 1 size larger than you or smaller, when you land a critical hit with Blud. dmg atks against that crea. have Adv. until the start of your next turn. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
  },
  "constitution": {
    description: "1/turn when you hit a crea. with Blud. dmg you can push 5ft to unoccupied space if crea. is 1 size larger than you or smaller, when you land a critical hit with Blud. dmg atks against that crea. have Adv. until the start of your next turn. [+1 Constitution]",
    scores: [0, 0, 1, 0, 0, 0],
  },
  prerequisite: "Level 4 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4;
  },
};
FeatsList["defensive duelist"] = {
  name: "Defensive Duelist",
  source: [["PHB2024", 203]],
  regExpSearch: /^(?=.*defensive)(?=.*duelist).*$/i,
  scores: [0, 1, 0, 0, 0, 0],
  action: ["reaction", "Parry"],
  description: desc([
    "+1 Dex, If you're holding a Finesse weapon and another creature hits you with a melee attack, you can take a Reaction to add your Proficiency Bonus to your Armor Class, potentially causing the attack to miss you. You gain this bonus to your AC against melee attacks until the start of your next turn.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Dexterity score by 1 to a maximum of 20.",
    "Parry : If you're holding a Finesse weapon and another creature hits you with a melee attack, you can take a Reaction to add your Proficiency Bonus to your Armor Class, potentially causing the attack to miss you. You gain this bonus to your AC against melee attacks until the start of your next turn.",
  ]),
  prerequisite: "Level 4 and Dexterity 13 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && What('Dex') >= 13;
  },
};
FeatsList["dual wielder"] = {
  name: "Dual Wielder",
  source: [["PHB2024", 203]],
  regExpSearch: /^(?=.*dual)(?=.*wielder).*$/i,
  scorestxt: "Your Strength or Dexterity score increases by 1, to a maximum of 20.",
  speed: {climb: {spd: "walk", enc: "walk"}},
  description: desc([
    "+1 Str or Dex, If you take the attack action with a weapon that has the light property, you can make an off-hand attack with another weapon that doesn't have the Two-Handed property, you do not add the modifier to this atk, unless it is negative, you can also draw and stow 2 non-Two-Handed weapons at a time.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Strength or Dexterity score by 1 to a maximum of 20.",
    "Enhanced Dual Wielding : When you take the Attack action on your turn and attack with a weapon that has the Light property, you can make one extra attack as a Bonus Action later on the same turn with a different weapon, which must be a Melee weapon that lacks the Two-Handed property. You don't add your ability modifier to the extra attack's damage unless the modifier is negative.",
    "Quick Draw : You can draw or stow two weapons that lack the Two-Handed property when you would normally be able to draw or stow only one.",
  ]),
  choices: ["Strength", "Dexterity"],
  "strength": {
    description: "If you take the attack action with a weapon that has the light property, you can make an off-hand attack with another weapon that doesn't have the Two-Handed property, you do not add the modifier to this atk, unless it is negative, you can also draw and stow 2 non-Two-Handed weapons at a time. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    description: "If you take the attack action with a weapon that has the light property, you can make an off-hand attack with another weapon that doesn't have the Two-Handed property, you do not add the modifier to this atk, unless it is negative, you can also draw and stow 2 non-Two-Handed weapons at a time. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
  },
  prerequisite: "Level 4 and Strength or Dexterity 13 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && What('Str') >= 13 || What('Dex') >= 13;
  },
};
FeatsList["durable"] = {
  name: "Durable",
  source: [["PHB2024", 203]],
  regExpSearch: /^(?=.*crusher).*$/i,
  scores: [0, 0, 1, 0, 0, 0],
  savetxt: {adv_vs: ["Death Saving Throws"]},
  action: [["bonus action", "Speedy Recovery"]],
  description: desc([
    "+1 Con, Adv vs Death Saves, Bonus Action to expend 1 Hit Die to regain HP equal to the roll.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Constitution score by 1 to a maximum of 20.",
    "Defy Death : You have Advantage on Death Saving Throws.",
    "Speedy Recovery : As a Bonus Action, you can expend one of your Hit Point Dice, roll the die, and regain a number of Hit Points equal to the roll.",
  ]),
  prerequisite: "Level 4 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4;
  },
};
FeatsList["elemental adept"] = {
  name: "Elemental Adept",
  source: [["PHB2024", 203]],
  regExpSearch: /^(?=.*elemental)(?=.*adept).*$/i,
  scorestxt: "Your Intelligence, Wisdom, or Charisma score increases by 1, to a maximum of 20.",
  description: desc([
    "+1 Int, Wis, or Cha, Choose one of the damage types: acid, cold, fire, lightning, or thunder. Spells I cast ignore resistance to damage from this damage type. For any spell I cast that deals this damage type, I can treat any 1 on a damage die as a 2.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits.",
    "Ability Score Increase : Increase your Intelligence, Wisdom, or Charisma score by 1, to a maximum of 20.",
    "Energy Mastery : Choose one of the following damage types; Acid, Cold, Fire, Lightning, or Thunder. Spells you cast ignore Resistance to damage of the chosen type. In addition when you roll damage for a spell you cast that deals damage of that type you can treat any 1 on the damage die as a 2.",
    "Repeatable : You can take this feat more than once, but you must choose a different damage type each time for Energy Mastery.",
  ]),
  prerequisite: "Level 4 and The Spellcasting or Pact Magic Feature",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && v.isSpellcaster;
  },
  allowDuplicates: true,
  choices: ["acid", "cold", "fire", "lightning", "thunder"],
  "acid": {
    description: "+1 Int, Wis, or Cha, Spells I cast ignore resistance to acid damage. For any spell I cast that deals acid damage, I can treat any 1 on a damage die as a 2."
  },
  "cold": {
    description: "+1 Int, Wis, or Cha, Spells I cast ignore resistance to cold damage. For any spell I cast that deals cold damage, I can treat any 1 on a damage die as a 2."
  },
  "fire": {
    description: "+1 Int, Wis, or Cha, Spells I cast ignore resistance to fire damage. For any spell I cast that deals fire damage, I can treat any 1 on a damage die as a 2."
  },
  "lightning": {
    description: "+1 Int, Wis, or Cha, Spells I cast ignore resistance to lightning damage. For any spell I cast that deals lightning damage, I can treat any 1 on a damage die as a 2."
  },
  "thunder": {
    description: "+1 Int, Wis, or Cha, Spells I cast ignore resistance to thunder damage. For any spell I cast that deals thunder damage, I can treat any 1 on a damage die as a 2."
  },
};
FeatsList["fey-touched"] = {
  name: "Fey-Touched",
  source: [["PHB2024", 203]],
  regExpSearch: /^(?=.*fey)(?=.*touched).*$/i,
  spellcastingBonus: [{
    name: "Misty Step",
    spells: ["misty step"],
    selection: ["misty step"],
    firstCol: "oncelr"
  }, {
    name: "1st-level Ench/Div spell",
    'class': "any",
    school: ["Ench", "Div"],
    level: [1, 1],
    firstCol: "oncelr"
  }],
  spellcastingAbility: 4,
  allowUpCasting: true,
  choices: ["Intelligence", "Wisdom", "Charisma"],
  "intelligence": {
    description: "I learn Misty Step and one 1st level divination or enchantment spell. I can cast each once per long rest at their lowest level without expending a spell slot, and can cast them " + (typePF ? "by expending" : "with") + " a spell slot as normal. Intelligence is my spellcasting ability for these spells. [+1 Intelligence]",
    spellcastingAbility: 4,
    scores: [0, 0, 0, 1, 0, 0]
  },
  "wisdom": {
    description: "I learn Misty Step and one 1st level divination or enchantment spell. I can cast each once per long rest at their lowest level without expending a spell slot, and can cast them by expending a spell slot as normal. Wisdom is my spellcasting ability for these spells. [+1 Wisdom]",
    spellcastingAbility: 5,
    scores: [0, 0, 0, 0, 1, 0]
  },
  "charisma": {
    description: "I learn Misty Step and one 1st level divination or enchantment spell. I can cast each once per long rest at their lowest level without expending a spell slot, and can cast them by expending a spell slot as normal. Charisma is my spellcasting ability for these spells. [+1 Charisma]",
    spellcastingAbility: 6,
    scores: [0, 0, 0, 0, 0, 1]
  },
  description: desc([
    "+1 Int, Wis, or Cha, You learn the Misty Step and one other 1st-level spell from the Divination or Enchantment school.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Intelligence, Wisdom, or Charisma score by 1, to a maximum of 20.",
    "Fey Magic : Choose one level 1 spell from the Divination or Enchantment school of magic. You always have that spell and the Misty Step spell prepared. You can cast each of these spells without expending a spell slot. Once you cast either spell in this way, you can't cast that spell in this way again until you finish a Long Rest. You can also cast these spells using spell slots you have of the appropriate level. The spells' spellcasting ability is the ability increased by this feat.",
  ]),
  prerequisite: "Level 4 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4;
  },
};
FeatsList["grappler"] = {
  name: "Grappler",
  source: [["PHB2024", 202]],
  regExpSearch: /^(?=.*grappler).*$/i,
  description: desc([
    "+1 Str or Dex, When you make an Unarmed Strike, you may deal damage and grapple the target, you have advantage on attack rolls made to grapple a target and can move your normal speed with a grappled target as long as they are your size or smaller.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Strength or Dexterity score by 1 to a maximum of 20.",
    "Punch and Grab : When you hit a creature with an Unarmed Strike as part of the Attack action on your turn, you can use both the Damage and the Grapple option. You can use this benefit only once per turn.",
    "Attack Advantage : You have Advantage on attack rolls against a creature Grappled by you.",
    "Fast Wrestler : Your Speed isn't halved when you move a creature Grappled by you if the creature is your size or smaller.",
  ]),
  choices: ["Strength", "Dexterity"],
  "strength": {
    description: "When you make an Unarmed Strike, you may deal damage and grapple the target, you have advantage on attack rolls made to grapple a target and can move your normal speed with a grappled target as long as they are your size or smaller. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    description: "When you make an Unarmed Strike, you may deal damage and grapple the target, you have advantage on attack rolls made to grapple a target and can move your normal speed with a grappled target as long as they are your size or smaller. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
  },
  prerequisite: "Level 4 and Strength or Dexterity 13 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && What('Str') >= 13 || What('Dex') >= 13;
  },
};
FeatsList["great weapon master"] = {
  name: "Great Weapon Master",
  source: [["PHB2024", 203]],
  regExpSearch: /^(?=.*great)(?=.*weapon)(?=.*master).*$/i,
  scores: [1, 0, 0, 0, 0, 0],
  description: desc([
    "+1 Str, When you hit with a weapon that has the Heavy property, you can deal extra damage equal to your Prof Bonus, and if you score a Crit. and reduce a creature to 0 HP you may make another attack with the same weapon as a Bonus Action.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Strength score by 1 to a maximum of 20.",
    "Heavy Weapon Master : When you hit a creature with a weapon that has the Heavy property as part of the Attack action on your turn, you can cause the weapon to deal extra damage to the target. The extra damage equals your Proficiency Bonus.",
    "Hew : Immediately after you score a Critical Hit with a Melee weapon or reduce a creature to 0 Hit Points with one, you can make one attack with the same weapon as a Bonus Action",
  ]),
  calcChanges: {
    atkCalc: [
      function (fields, v, output) {
        if (v.isMeleeWeapon && (/heavy/i).test(fields.Description) && (/\bgwm\b|power.{0,3}attack|great.{0,3}weapon.{0,3}master/i).test(v.WeaponText)) {
          output.extraDmg += Math.max(Number(What("Prof")), 1);
        }
      },
      "If I include the words 'Power Attack', 'Great Weapon Master', or just 'GWM' in a heavy melee weapon's name or description, the calculation will put add + Proficiency Bonus on its Damage."
    ]
  },
  prerequisite: "Level 4 and Strength 13 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && What('Str') >= 13;
  },
};
FeatsList["heavily armored"] = {
  name: "Heavily Armored",
  source: [["PHB2024", 204]],
  regExpSearch: /^(?=.*heavily)(?=.*armored).*$/i,
  choices: ["Strength", "Constitution"],
  "strength": {
    description: "You gain training with Heavy armor. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
  },
  "constitution": {
    description: "You gain training with Heavy armor. [+1 Constitution]",
    scores: [0, 0, 1, 0, 0, 0],
  },
  description: desc([
    "+1 Dex/Con, You gain training with Heavy armor.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Strength or Constitution score by 1 to a maximum of 20.",
    "Armor Training : You gain training with Heavy armor.",
  ]),
  prerequisite: "Level 4 and Medium Armor training",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && v.mediumArmorProf;
  },
};
FeatsList["heavy armor master"] = {
  name: "Heavy Armor Master",
  source: [["PHB2024", 204]],
  regExpSearch: /^(?=.*heavy)(?=.*armor)(?=.*master).*$/i,
  choices: ["Strength", "Constitution"],
  "strength": {
    description: "You take your Prof Bonus less damage when hit with any Blud./Slash./Pierc. dmg while wearing Heavy armor. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
  },
  "constitution": {
    description: "You take your Prof Bonus less damage when hit with any Blud./Slash./Pierc. dmg while wearing Heavy armor. [+1 Constitution]",
    scores: [0, 0, 1, 0, 0, 0],
  },
  description: desc([
    "+1 Dex/Con, You take your Prof Bonus less damage when hit with any Blud./Slash./Pierc. dmg while wearing Heavy armor.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Strength or Constitution score by 1 to a maximum of 20.",
    "Damage Reduction : When you're hit by an attack while you're wearing Heavy armor, any Bludgeoning, Piercing, and Slashing damage dealt to you by that attack is reduced by an amount equal to your Proficiency Bonus.",
  ]),
  prerequisite: "Level 4 and Heavy Armor training",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && v.heavyArmorProf;
  },
};
FeatsList["inspiring leader"] = {
  name: "Inspiring Leader",
  source: [["PHB2024", 204]],
  regExpSearch: /^(?=.*inspiring)(?=.*leader).*$/i,
  description: desc([
    "+1 Wis or Cha, After a rest you can give a performance that grants up to 6 allies (can include yourself) Temp HP = your Character level + Wis/Cha.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Wisdom or Charisma score by 1 to a maximum of 20.",
    "Bolstering Performance : When you finish a Short or Long Rest, you and give an inspiring performance; a speech, song, or dance. When you do so, choose up to six allies (which can include yourself) within 30 feet of yourself who witness the performance. The chosen creatures each gain Temporary Hit Points equal to your character level plus the modifier of the ability you increased with this feat.",
  ]),
  choices: ["Wisdom", "Charisma"],
  "wisdom": {
    description: "After a rest you can give a performance that grants up to 6 allies (can include yourself) Temp HP = your Character level + Wis. [+1 Wisdom]",
    scores: [0, 0, 0, 0, 1, 0],
  },
  "charisma": {
    description: "After a rest you can give a performance that grants up to 6 allies (can include yourself) Temp HP = your Character level + Wis. [+1 Charisma]",
    scores: [0, 0, 0, 0, 0, 1],
  },
  prerequisite: "Level 4 and Wisdom or Charisma 13 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && What('Wis') >= 13 || What('Cha') >= 13;
  },
};
FeatsList["keen mind"] = {
  name: "Keen Mind",
  source: [["PHB2024", 205]],
  regExpSearch: /^(?=.*keen)(?=.*mind).*$/i,
  scores: [0, 0, 0, 1, 0, 0],
  action: ["bonus action", "Study"],
  skillstxt: "Choose 1 : Arcana, History, Investigation, Nature or Religion. You gain Proficiency in the chosen skill, if you are already proficient you gain Expertise.",
  description: desc([
    "+1 Int, You gain proficiency or expertise (if you already have proficiency) in one of the Intelligence skills, and can take the Study action as a Bonus Action.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Intelligence score by 1 to a maximum of 20.",
    "Lore Knowledge : Choose one of the following skills; Arcana, History, Investigation, Nature, or Religion. If you lack proficiency in the chosen skill, you gain proficiency in it, if you already have proficiency in it, you gain Expertise in it.",
    "Quick Study : You can take the Study action as a Bonus Action",
  ]),
  prerequisite: "Level 4 and Intelligence 13 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && What('Int') >= 13;
  },
};
FeatsList["lightly armored"] = {
  name: "Lightly Armored",
  source: [["PHB2024", 205]],
  regExpSearch: /^(?=.*lightly)(?=.*armored).*$/i,
  armorProfs: [true, false, false, true],
  description: desc([
    "+1 Str/Dex, You gain training with Light armor and Shields.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Strength or Dexterity score by 1 to a maximum of 20.",
    "Armor Training : You gain training with Light armor and Shields.",
  ]),
  choices: ["Strength", "Dexterity"],
  "strength": {
    description: "You gain training with Light armor and Shields. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    description: "You gain training with Light armor and Shields. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
  },

  prerequisite: "Level 4",
  prereqeval: function (v) {
    return v.characterLevel >= 4;
  },
};
FeatsList["mage slayer"] = {
  name: "Mage Slayer",
  source: [["PHB2024", 205]],
  regExpSearch: /^(?=.*mage)(?=.*slayer).*$/i,
  limfeaname: "Guarded Mind",
  usages: 1,
  recovery: "short rest",
  description: desc([
    "+1 Str/Dex, You gain training with Light armor and Shields.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Strength or Dexterity score by 1 to a maximum of 20.",
    "Concentration Breaker : When you deal damage a creature that is concentrating, It has Disadvantage on the saving throw to maintain Concentration.",
    "Guarded Mind : If you fail an Intelligence, a Wisdom, or a Charisma saving throw, you can cause yourself to succeed instead. Once you use this benefit you can't use it again until you finish a Short or Long Rest.",
  ]),
  choices: ["Strength", "Dexterity"],
  "strength": {
    description: "You gain training with Light armor and Shields. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    description: "You gain training with Light armor and Shields. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
  },
  prerequisite: "Level 4",
  prereqeval: function (v) {
    return v.characterLevel >= 4;
  },
};
FeatsList["martial weapon training"] = {
  name: "Martial Weapon Training",
  source: [["PHB2024", 205]],
  regExpSearch: /^(?=.*martial)(?=.*weapon)(?=.*training).*$/i,
  description: desc([
    "+1 Str/Dex, You gain proficiency with Martial weapons.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Strength or Dexterity score by 1 to a maximum of 20.",
    "Weapon Proficiency : You gain proficiency with Martial weapons.",
  ]),
  choices: ["Strength", "Dexterity"],
  "strength": {
    description: "You gain proficiency with Martial weapons. [+1 Strength]",
    weaponProfs: [false, true],
    scores: [1, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    description: "You gain proficiency with Martial weapons. [+1 Dexterity]",
    weaponProfs: [false, true],
    scores: [0, 1, 0, 0, 0, 0],
  },
  prerequisite: "Level 4",
  prereqeval: function (v) {
    return v.characterLevel >= 4;
  },
};
FeatsList["medium armor master"] = {
  name: "Medium Armor Master",
  source: [["PHB2024", 205]],
  regExpSearch: /^(?=.*medium)(?=.*armor)(?=.*master).*$/i,
  choices: ["Strength", "Dexterity"],
  "strength": {
    description: "You can add 3 while wearing medium armor if you have a Dex of 16+, instead of 2. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    description: "You can add 3 while wearing medium armor if you have a Dex of 16+, instead of 2. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
  },
  description: desc([
    "+1 Dex/Con, You can add 3 while wearing medium armor if you have a Dex of 16+, instead of 2.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Strength or Constitution score by 1 to a maximum of 20.",
    "Dexterous Wearer. While you're wearing Medium armor, you can add 3, rather than 2, to your AC if you have a Dexterity score of 16 or higher.",
  ]),
  prerequisite: "Level 4 and Medium Armor training",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && v.mediumArmorProf;
  },
};
FeatsList["moderately armored"] = {
  name: "Moderately Armored",
  source: [["PHB2024", 205]],
  regExpSearch: /^(?=.*moderately)(?=.*armored).*$/i,
  choices: ["Strength", "Dexterity"],
  "strength": {
    description: "You gain training with Medium armor. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
    armorProfs: [false, true, false, false],
  },
  "dexterity": {
    description: "You gain training with Medium armor. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
    armorProfs: [false, true, false, false],
  },
  description: desc([
    "+1 Str/Dex, You gain training with Medium armor.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Strength or Constitution score by 1 to a maximum of 20.",
    "Armor Training : You gain training with Medium armor.",
  ]),
  prerequisite: "Level 4 and Medium Armor training",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && v.lightArmorProf;
  },
};
FeatsList["mounted combatant"] = {
  name: "Mounted Combatant",
  source: [["PHB2024", 205]],
  regExpSearch: /^(?=.*mounted)(?=.*combatant).*$/i,
  choices: ["Strength", "Dexterity", "Wisdom"],
  "strength": {
    description: "You have adv on atk rolls while mounted against non mounted combatants within 5 feet that are smaller than your mount, Mounts who succeed dex saves take no damage instead of half, when an attack hits your mount you can have the attack hit you instead if your don't have the Incap condition. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    description: "You have adv on atk rolls while mounted against non mounted combatants within 5 feet that are smaller than your mount, Mounts who succeed dex saves take no damage instead of half, when an attack hits your mount you can have the attack hit you instead if your don't have the Incap condition. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
  },
  "wisdom": {
    description: "You have adv on atk rolls while mounted against non mounted combatants within 5 feet that are smaller than your mount, Mounts who succeed dex saves take no damage instead of half, when an attack hits your mount you can have the attack hit you instead if your don't have the Incap condition. [+1 Wisdom]",
    scores: [0, 0, 0, 0, 1, 0],
  },
  description: desc([
    "+1 Str/Dex/Wis, You have adv on atk rolls while mounted against non mounted combatants within 5 feet that are smaller than your mount, Mounts who succeed dex saves take no damage instead of half, when an attack hits your mount you can have the attack hit you instead if your don't have the Incap condition.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Strength, Dexterity, Wisdom score by 1 to a maximum of 20.",
    "Mounted Strike : While mounted, you have Advantage on attack rolls against any unmounted creature within 5 feet of your mount that is at least one size smaller than the mount.",
    "Leap Aside : If you mount is subjected to an effect that allows it to make a Dexterity saving throw to take only half damage, it instead takes no damage if it succeeds on the saving throw and only half damage if it fails. For your mount to gain this benefit, you must be riding it, and neither of you can have the Incapacitated condition.",
    "Veer : While mounted, you can force an attack that hits your mount to hit your instead if you don't have the Incapacitated.",
  ]),
  prerequisite: "Level 4",
  prereqeval: function (v) {
    return v.characterLevel >= 4;
  },
};
FeatsList["observant"] = {
  name: "Observant",
  source: [["PHB2024", 205]],
  regExpSearch: /^(?=.*observant).*$/i,
  skillstxt: "Choose 1 : Insight, Investigation, or Perception. You gain Proficiency in the chosen skill, if you are already proficient you gain Expertise.",
  action: ["bonus action", "Search"],
  choices: ["Intelligence", "Wisdom"],
  "intelligence": {
    description: "You gain proficiency or expertise (if you already have proficiency) in one of the following skills Insight, Investigation, or Perception, and can take the Search action as a Bonus Action. [+1 Intelligence]",
    scores: [0, 0, 0, 1, 0, 0],
  },
  "wisdom": {
    description: "You gain proficiency or expertise (if you already have proficiency) in one of the following skills Insight, Investigation, or Perception, and can take the Search action as a Bonus Action. [+1 Wisdom]",
    scores: [0, 0, 0, 0, 1, 0],
  },
  description: desc([
    "+1 Int/Wis, You gain proficiency or expertise (if you already have proficiency) in one of the following skills Insight, Investigation, or Perception, and can take the Search action as a Bonus Action.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Intelligence or Wisdom score by 1 to a maximum of 20.",
    "Keen Observer : Choose one of the following skills; Insight, Investigation, or Perception. If you lack proficiency with the chosen skill, you gain proficiency in it, and if you already have proficiency in it, you gain Expertise in it.",
    "Quick Search : You can take the Search action as a Bonus Action.",
  ]),
  prerequisite: "Level 4 and Medium Armor training",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && What('Int') >= 13 || What('Wis') >= 13;
  },
};
FeatsList["piercer"] = {
  name: "Piercer",
  source: [["PHB2024", 206]],
  regExpSearch: /^(?=.*piercer).*$/i,
  description: desc([
    "+1 Str/Dex, When you hit a creature with an atk roll with a pierc. dmg weapon you can reroll one of the atk dmg dice, on a Crit you deal one additional dmg die.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Strength or Dexterity score by 1 to a maximum of 20.",
    "Puncture : Once per turn, when you hit a creature with an attack that deals Piercing damage, you can reroll one of the attack's damage dice, and you must use the new roll.",
    "Enhanced Critical : When you score a Critical Hit that deals Piercing damage to a creature, you can roll one additional damage die when determining the extra Piercing damage the target takes.",
  ]),
  choices: ["Strength", "Dexterity"],
  "strength": {
    description: "When you hit a creature with an atk roll with a pierc. dmg weapon you can reroll one of the atk dmg dice, on a Crit you deal one additional dmg die. [+1 Strength]",
    weaponProfs: [false, true],
    scores: [1, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    description: "When you hit a creature with an atk roll with a pierc. dmg weapon you can reroll one of the atk dmg dice, on a Crit you deal one additional dmg die. [+1 Dexterity]",
    weaponProfs: [false, true],
    scores: [0, 1, 0, 0, 0, 0],
  },
  prerequisite: "Level 4",
  prereqeval: function (v) {
    return v.characterLevel >= 4;
  },
};
FeatsList["poisoner"] = {
  name: "Poisoner",
  source: [["PHB2024", 206]],
  regExpSearch: /^(?=.*poisoner).*$/i,
  toolProfs: [["Poisoner's Kit"]],
  description: desc([
    "+1 Dex/Int, Your poison ignores Poison Resistance, You gain Prof with the Poisoner's Kit and can apply poison to a weapon or piece of ammo as a Bonus Action when you hit with an atk, target makes a Con save or take 2d8 Poison dmg and be Poisoned. DC=8+Dex-or-Int+Prof",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Dexterity or Intelligence score by 1 to a maximum of 20.",
    "Potent Poison : When you make a damage roll that deals Poison damage, it ignores Resistance to Poison damage.",
    "Brew Poison : You gain proficiency with the Poisoner's Kit. With 1 hour of work using such a kit and expending 50 GP worth of materials, you can creature a number of poison doses equal to your Proficiency Bonus. As a Bonus Action, you can apply a poison dose to a weapon or piece of ammunition. Once applied, the poison retains its potency for 1 minute or until you hit with the poisoned item, whichever is shorter. When a creature takes damage from the poisoned item, that creature must succeed on a Constitution saving throw (DC 8 plus the modifier of the ability increased by this feat and your Proficiency Bonus) or take 2d8 Poison damage and have the Poisoned condition until the end of your next turn.",
  ]),
  choices: ["Dexterity", "Intelligence"],
  "dexterity": {
    description: "Your poison ignores Poison Resistance, You gain Prof with the Poisoner's Kit and can apply poison to a weapon or piece of ammo as a Bonus Action when you hit with an atk, target makes a Con save or take 2d8 Poison dmg and be Poisoned. DC=8+Dex+Prof [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
  },
  "intelligence": {
    description: "Your poison ignores Poison Resistance, You gain Prof with the Poisoner's Kit and can apply poison to a weapon or piece of ammo as a Bonus Action when you hit with an atk, target makes a Con save or take 2d8 Poison dmg and be Poisoned. DC=8+Int+Prof [+1 Intelligence]",
    scores: [0, 0, 0, 1, 0, 0],
  },
  prerequisite: "Level 4",
  prereqeval: function (v) {
    return v.characterLevel >= 4;
  },
};
FeatsList["polearm master"] = {
  name: "Polearm Master",
  source: [["PHB2024", 206]],
  regExpSearch: /^(?=.*polearm)(?=.*master).*$/i,
  weaponOptions: [{
    regExpSearch: /^(?=.*(polearm|(glaive|guandao|bisento|naginata)|(halberd|\bji\b|kamayari)|(quarterstaff|\bstaff\b|\bbo\b)|(spear|qiang|\byaris?\b)))(?=.*butt)(?=.*end).*$/i,
    name: "Polearm Butt End",
    source: [["PHB2024", 206]],
    ability: 1,
    type: "polearm butt end",
    damage: [1, 4, "bludgeoning"],
    range: "Melee",
    description: "As bonus action after Attack action with only a glaive, halberd, spear, or quarterstaff",
    abilitytodamage: true,
    selectNow: true
  }],
  action: ['bonus action', 'Butt End Attack (after attack with polearm)'],
  weaponProfs: [false, false, ["polearm butt end"]],
  choices: ["Strength", "Dexterity"],
  "strength": {
    description: "As a Bns Action when you take the Atk Action, with a Quarterstaff, Spear, or weapon with the Heavy and Reach properties, you can strike with the opposite end of the weapon dealing 1d4 blud. dmg. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    description: "As a Bns Action when you take the Atk Action, with a Quarterstaff, Spear, or weapon with the Heavy and Reach properties, you can strike with the opposite end of the weapon dealing 1d4 blud. dmg. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
  },
  description: desc([
    "+1 Str/+1 Dex, As a Bns Action when you take the Atk Action, with a Quarterstaff, Spear, or weapon with the Heavy and Reach properties, you can strike with the opposite end of the weapon dealing 1d4 blud. dmg.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Strength or Dexterity score by 1 to a maximum of 20.",
    "Pole Strike : Immediately after you take the Attack action and attack with a Quarterstaff, a Spear, or a weapon that has the Heavy and Reach properties, you can use a Bonus Action to make a melee attack with the opposite end of the weapon. The weapon deals Bludgeoning, and the weapon damage die for this is a d4.",
    "Reactive Strike : While you're holding a Quarterstaff, a Spear, or a weapon that has the Heavy and Reach properties, you can take a Reaction to make one melee attack against a creature that enters the reach you have with that weapon.",
  ]),
  prerequisite: "Level 4 and Strength 13 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && What('Str') >= 13 || What('Dex') >= 13;
  },
};
FeatsList["resilient"] = {
  name: "Resilient",
  source: [["PHB2024", 206]],
  regExpSearch: /^(?=.*resilient).*$/i,
  descriptionFull: "Choose one ability in which you lack saving throw proficiency. You gain the following benefits:\n \u2022 Increase the chosen ability score by 1, to a maximum of 20.\n \u2022 You gain proficiency in saving throws using the chosen ability.",
  description: "Select an ability score using the square button on this feat line. I gain proficiency with the saving throw of that ability score and a +1 added to it.",
  choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
  "strength": {
    description: "I gain proficiency with Strength saving throws. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
    saves: ["Str"]
  },
  "dexterity": {
    description: "I gain proficiency with Dexterity saving throws. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
    saves: ["Dex"]
  },
  "constitution": {
    description: "I gain proficiency with Constitution saving throws. [+1 Constitution]",
    scores: [0, 0, 1, 0, 0, 0],
    saves: ["Con"]
  },
  "intelligence": {
    description: "I gain proficiency with Intelligence saving throws. [+1 Intelligence]",
    scores: [0, 0, 0, 1, 0, 0],
    saves: ["Int"]
  },
  "wisdom": {
    description: "I gain proficiency with Wisdom saving throws. [+1 Wisdom]",
    scores: [0, 0, 0, 0, 1, 0],
    saves: ["Wis"]
  },
  "charisma": {
    description: "I gain proficiency with Charisma saving throws. [+1 Charisma]",
    scores: [0, 0, 0, 0, 0, 1],
    saves: ["Cha"]
  },
  prerequisite: "Level 4",
  prereqeval: function (v) {
    return v.characterLevel >= 4;
  },
};
FeatsList["ritual caster"] = {
  name: "Ritual Caster",
  source: [["PHB2024", 206 - 207]],
  regExpSearch: /^(?=.*ritual)(?=.*caster).*$/i,
  descriptionFull: "You gain the following benefits.\n Ability Score Increase. Increase your Intelligence, Wisdom, or Charisma by 1, to a maximum of 20.\n Ritual Spells. Choose a number of level 1 spells equal to your Proficiency Bonus that have the Ritual tag. You always have those spells prepared, and you can cast them with any spell slots you have. The spells' spellcasting ability is the ability increased by this feat. Whenever your Proficiency Bonus increased hereafter, you can add an additional level 1 spell with the Ritual tag to the spells always prepared with this feature.\n Quick Ritual. With this benefit, you can cast a Ritual spell that you have prepared using its regular casting time rather than the extended time for a Ritual. Doing so doesn't required a spell slot. Once you cast the spell in this way, you can't use this benefit again until you finish a Long Rest.",
  description: "Ritual Spells. Prof. Bonus 1st level Ritual spells, do not count against the spells you can have prepared. Quick Ritual. Once per Long Rest can cast a ritual with normal casting time.",
  prerequisite: "Intelligence, Wisdom, or Charisma 13 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && What('Int') >= 13 || What('Wis') >= 13 || What('Cha') >= 13;
  },
  choices: ["Intelligence", "Wisdom", "Charisma"],
  "intelligence": {
    description: "Ritual Spells. Prof. Bonus 1st level Ritual spells, do not count against the spells you can have prepared. Quick Ritual. Once per Long Rest can cast a ritual with normal casting time. [+1 Intelligence]",
    scores: [0, 0, 0, 1, 0, 0],
  },
  "wisdom": {
    description: "Ritual Spells. Prof. Bonus 1st level Ritual spells, do not count against the spells you can have prepared. Quick Ritual. Once per Long Rest can cast a ritual with normal casting time. [+1 Wisdom]",
    scores: [0, 0, 0, 0, 1, 0],
  },
  "charisma": {
    description: "Ritual Spells. Prof. Bonus 1st level Ritual spells, do not count against the spells you can have prepared. Quick Ritual. Once per Long Rest can cast a ritual with normal casting time. [+1 Charisma]",
    scores: [0, 0, 0, 0, 0, 1],
  },
};
FeatsList["sentinel"] = {
  name: "Sentinel",
  source: [["PHB2024", 207]],
  regExpSearch: /^(?=.*sentinel).*$/i,
  choices: ["Strength", "Dexterity"],
  "strength": {
    description: "Reac. when crea w/i 5ft takes Disengage action or hits another target other than you, you can make an Opportunity Attack. When you make an Opportunity Attack against a crea. it's Speed becomes 0 for the rest of the current turn. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    description: "Reac. when crea w/i 5ft takes Disengage action or hits another target other than you, you can make an Opportunity Attack. When you make an Opportunity Attack against a crea. it's Speed becomes 0 for the rest of the current turn. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
  },
  description: desc([
    "+1 Str/+1 Dex, Reac. when crea w/i 5ft takes Disengage action or hits another target other than you, you can make an Opportunity Attack. When you make an Opportunity Attack against a crea. it's Speed becomes 0 for the rest of the current turn.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Strength or Dexterity score by 1 to a maximum of 20.",
    "Guardian : Immediately after a creature within 5 feet of you takes the Disengage action or hits a target other than you with an attack, you can make an Opportunity Attack against that creature.",
    "Halt : When you hit a creature with an Opportunity Attack, the creature's Speed becomes 0 for the rest of the current turn.",
  ]),
  action: ["reaction", " (after Disengage/attack on ally)"],
  prerequisite: "Level 4 and Strength or Dexterity 13 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && What('Str') >= 13 || What('Dex') >= 13;
  },
};
FeatsList["shadow-touched"] = {
  name: "Shadow-Touched",
  source: [["PHB2024", 207]],
  regExpSearch: /^(?=.*shadow)(?=.*touched).*$/i,
  spellcastingBonus: [{
    name: "Invisibility",
    spells: ["invisibility"],
    selection: ["invisibility"],
    firstCol: "oncelr"
  }, {
    name: "1st-level Illus/Necro spell",
    'class': "any",
    school: ["Illus", "Necro"],
    level: [1, 1],
    firstCol: "oncelr"
  }],
  spellcastingAbility: 4,
  allowUpCasting: true,
  choices: ["Intelligence", "Wisdom", "Charisma"],
  "intelligence": {
    description: "I learn Invisibility and one 1st level Illusion or Necromancy spell. I can cast each once per long rest at their lowest level without expending a spell slot, and can cast them by expending a spell slot as normal. Charisma is my spellcasting ability for these spells. [+1 Intelligence]",
    spellcastingAbility: 4,
    scores: [0, 0, 0, 1, 0, 0]
  },
  "wisdom": {
    description: "I learn Invisibility and one 1st level Illusion or Necromancy spell. I can cast each once per long rest at their lowest level without expending a spell slot, and can cast them by expending a spell slot as normal. Charisma is my spellcasting ability for these spells. [+1 Wisdom]",
    spellcastingAbility: 5,
    scores: [0, 0, 0, 0, 1, 0]
  },
  "charisma": {
    description: "I learn Invisibility and one 1st level Illusion or Necromancy spell. I can cast each once per long rest at their lowest level without expending a spell slot, and can cast them by expending a spell slot as normal. Charisma is my spellcasting ability for these spells. [+1 Charisma]",
    spellcastingAbility: 6,
    scores: [0, 0, 0, 0, 0, 1]
  },
  description: desc([
    "+1 Int, Wis, or Cha, You learn the Invisibility and one other 1st-level spell from the Illusion or Necromancy school.",
  ]),
  descriptionFull: desc([
    "You gain the following benefits",
    "Ability Score Increase : Increase your Intelligence, Wisdom, or Charisma score by 1, to a maximum of 20.",
    "Shadow Magic : Choose one level 1 spell from the Illusion or Necromancy school of magic. You always have that spell and the Invisibility spell prepared. You can cast each of these spells without expending a spell slot. Once you cast either spell in this way, you can't cast that spell in this way again until you finish a Long Rest. You can also cast these spells using spell slots you have of the appropriate level. The spells' spellcasting ability is the ability increased by this feat.",
  ]),
  prerequisite: "Level 4 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4;
  },
};
FeatsList["sharpshooter"] = {
  name: "Sharpshooter",
  source: [["PHB2024", 207]],
  regExpSearch: /^(?=.*sharpshooter).*$/i,
  scores: [0, 1, 0, 0, 0, 0],
  descriptionFull: "You gain the following benefits.\n Ability Score Increase. Increase your Dexterity score by 1, to a maximum of 20.\n Bypass Cover. Your ranged attacks with weapons ignore Half and Three-Quarter Cover.\n   Firing in Melee. Being within 5 feet of an enemy doesn't impose Disadvantage on your attack rolls with Ranged weapons.\n   Long Shots. Attacking at long range doesn't impose Disadvantage on your attack rolls with Ranged weapons.",
  description: "My ranged weapon attacks don't have disadvantage in melee or on long range and ignore half cover and three-quarters cover.",
  calcChanges: {
    atkAdd: [
      function (fields, v) {
        if (v.isRangedWeapon || v.isThrownWeapon) {
          fields.Description += (fields.Description ? '; ' : '') + "No disadv. in melee or at long range; Ignore \u00BD and \u00BE cover";
        }
      },
      "My ranged weapon attacks suffer no disadvantage in melee or for long range and ignore half cover and three-quarters cover. This includes thrown weapons."
    ],
  },
  prerequisite: "Level 4 and Dexterity 13 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && What('Dex') >= 13;
  },
};
FeatsList["shield master"] = {
  name: "Shield Master",
  source: [["PHB2024", 207]],
  regExpSearch: /^(?=.*shield)(?=.*master).*$/i,
  scores: [1, 0, 0, 0, 0, 0],
  weaponOptions: [{
    regExpSearch: /^(?=.*shield)(?=.*bash).*$/i,
    name: "Shield Bash",
    source: [["PHB2024", 207]],
    ability: 1,
    type: "shield bash",
    damage: ["", "", ""],
    range: "Melee, 5ft",
    description: "Once per turn as part of the attack action, use shield to knock an enemy prone or push 5 ft.",
    abilitytodamage: false,
    dc: true,
    selectNow: true,
  }],
  weaponProfs: [false, false, ["shield bash"]],
  descriptionFull: "You gain the following benefits:\n \u2022 Ability Score Increase. Increase your Strength score by 1, to a maximum of 20.\n \u2022 Shield Bash. If you attack a creature within 5 feet of you as part of the Attack action and hit with a Melee weapon, you can immediately bash the target with your Shield if it's equipped forcing the target to make a Strength saving throw (DC 8 plus your Strength modifier and Proficiency Bonus). On a failed save, you either push the target 5 feet from you or cause it to have the Prone condition (your choice). You can use this benefit only once on each of your turns.\n \u2022 Interpose Shield. If you're subjected to an effect that allows you to make a Dexterity saving throw to take only half damage, you can take a Reaction to take no damage if you succeed on the saving throw and are holding a Shield.",
  description: "As a bonus action, when I use the Attack action, I can shove someone within 5 ft. with my shield. I add my shield's AC bonus to Dex saves vs. effects targeting only me. As a reaction, if I succeed on a Dex save for half damage, I can interpose my shield to avoid the damage.",
  action: [['reaction', 'Interpose shield (Uncanny Dodge)']],
  prerequisite: "Level 4 and Shield Training",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && v.shieldProf;
  },
};
FeatsList["skill expert"] = {
  name: "Skill Expert",
  source: [["PHB2024", 207]],
  regExpSearch: /^(?=.*skill)(?=.*expert).*$/i,
  descriptionFull: "You gain the following benefits:\n \u2022 Ability Score Increase. Increase one ability score of your choice by 1, to a maximum of 20.\n \u2022 Skill Proficiency. You gain proficiency in one skill of your choice.\n \u2022 Expertise. Choose one skill in which you have proficiency but lack Expertise. You gain expertise with that skill.",
  description: "I gain proficiency in one skill and expertise in that same skill or another skill I'm proficient with. [+1 to one ability score of my choice]",
  skillstxt: "Proficiency with one skill, and\n Expertise with one skill I'm proficient with",
  scorestxt: "+1 to one ability score of my choice",
  prerequisite: "Level 4",
  prereqeval: function (v) {
    return v.characterLevel >= 4;
  },
};
FeatsList["skulker"] = {
  name: "Skulker",
  source: [["PHB2024", 208]],
  regExpSearch: /^(?=.*skulker).*$/i,
  scores: [0, 1, 0, 0, 0, 0],
  descriptionFull: "You gain the following benefits:\n \u2022 Blindsight. You have Blindsight with a range of 10 feet.\n \u2022 Fog of War. You exploit the distractions of battle, gaining Advantage on any Dexterity (Stealth) check you make as part of the Hide action during combat.\n \u2022 Sniper. If you make an attack roll while hidden and the roll misses, making the attack roll doesn't reveal your location.",
  description: "Adv. to hide in combat. My position is not revealed when I am hidden from a creature and miss it with a ranged weapon attack. Blindsight 10ft.",
  prerequisite: "Level 4 and Dexterity 13 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && What('Dex') >= 13;
  },
  vision: [["Blindsight", 10]],
};
FeatsList["slasher"] = {
  name: "Slasher",
  source: [["PHB2024", 208]],
  regExpSearch: /^(?=.*slasher).*$/i,
  descriptionFull: "You gain the following benefits:\n \u2022 Ability Score Increase. Increase your Strength or Dexterity by 1, to a maximum of 20.\n \u2022 Hamstring. Once per turn you hit a creature with an attack that deals Slashing damage, you can reduce the speed of that creature by 10 feet until the start of your next turn.\n \u2022 Enhanced Critical. When you score a Critical Hit that deals Slashing damage to a creature, it has Disadvantage on attack rolls until the start of your next turn.",
  description: "+1 Str/Dex, Once per turn when I deal slashing damage to a target, I can reduce its speed by 10 ft. until the start of my next turn. When I score a critical hit that deals slashing damage to a creature, the grievous wound causes it to have disadvantage on all attack rolls until the start of my next turn. ",
  choices: ["Strength", "Dexterity"],
  "strength": {
    description: "Once per turn when I deal slashing damage to a target, I can reduce its speed by 10 ft. until the start of my next turn. When I score a critical hit that deals slashing damage to a creature, the grievous wound causes it to have disadvantage on all attack rolls until the start of my next turn. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    description: "Once per turn when I deal slashing damage to a target, I can reduce its speed by 10 ft. until the start of my next turn. When I score a critical hit that deals slashing damage to a creature, the grievous wound causes it to have disadvantage on all attack rolls until the start of my next turn. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
  },
  prerequisite: "Level 4 and Strength or Dexterity 13 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && What('Str') >= 13 || What('Dex') >= 13;
  },
};
FeatsList["speedy"] = {
  name: "Speedy",
  source: [["PHB2024", 208]],
  regExpSearch: /^(?=.*speedy).*$/i,
  speed: {walk: "+10"},
  descriptionFull: "You gain the following benefits:\n \u2022 Ability Score Increase. Increase your Dexterity or Constitution by 1, to a maximum of 20.\n \u2022 Speed Increase. Your Speed increases by 10 feet.\n \u2022 Dash over Difficult Terrain. When you take the Dash action on your turn, Difficult Terrain doesn't cost you extra movement for the rest of that turn.\n \u2022 Agile Movement. Opportunity Attacks have Disadvantage against you.",
  description: "+1 Dex/Con, +10 Speed, Dash over Difficult Terrain does not cost extra movement, Opportunity Attacks have Disadvantage against you. ",
  choices: ["Dexterity", "Constitution"],
  "dexterity": {
    description: "+10 Speed, Dash over Difficult Terrain does not cost extra movement, Opportunity Attacks have Disadvantage against you. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
  },
  "constitution": {
    description: "+10 Speed, Dash over Difficult Terrain does not cost extra movement, Opportunity Attacks have Disadvantage against you. [+1 Constitution]",
    scores: [0, 0, 1, 0, 0, 0],
  },
  prerequisite: "Level 4 and Dexterity or Constitution 13 or higher",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && What('Dex') >= 13 || What('Con') >= 13;
  },
};
FeatsList["spell sniper"] = {
  name: "Spell Sniper",
  source: [["PHB2024", 208]],
  regExpSearch: /^(?=.*spell)(?=.*sniper).*$/i,
  descriptionFull: "You gain the following benefits.\n \u2022 Ability Score Increase. Increase your Intelligence, Wisdom, or Charisma by 1, to a maximum of 20.\n \u2022 Bypass Cover. Your attack rolls for spells ignore Half Cover and Three-quarter Cover.\n \u2022 Casting in Melee. Being within 5 feet of an enemy doesn't impose Disadvantage on your attack rolls with spells.\n \u2022 Increased Range. When you cast a spell that has a range of at least 10 feet and requires you to make an attack roll, you can increase the spell's range by 60 feet.",
  description: "+1 Int/Wis/Cha Your spells ignore half and three-quarter cover; casting in melee doesn't impose disadvantage; your ranged spells with a range of 10ft or more have their range increased by 60 ft..",
  prerequisite: "Level 4 and has Spellcasting or Pact Magic Feature",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && v.isSpellcaster;
  },
  choices: ["Intelligence", "Wisdom", "Charisma"],
  "intelligence": {
    description: "Your spells ignore half and three-quarter cover; casting in melee doesn't impose disadvantage; your ranged spells with a range of 10ft or more have their range increased by 60 ft.. [+1 Intelligence]",
    scores: [0, 0, 0, 1, 0, 0],
  },
  "wisdom": {
    description: "Your spells ignore half and three-quarter cover; casting in melee doesn't impose disadvantage; your ranged spells with a range of 10ft or more have their range increased by 60 ft.. [+1 Wisdom]",
    scores: [0, 0, 0, 0, 1, 0],
  },
  "charisma": {
    description: "Your spells ignore half and three-quarter cover; casting in melee doesn't impose disadvantage; your ranged spells with a range of 10ft or more have their range increased by 60 ft.. [+1 Charisma]",
    scores: [0, 0, 0, 0, 0, 1],
  },
};
FeatsList["telekinetic"] = {
  name: "Telekinetic",
  source: [["PHB2024", 208]],
  regExpSearch: /^(?=.*telekinetic).*$/i,
  descriptionFull: "You gain the following benefits:\n \u2022 Ability Score Increase. Increase your Intelligence, Wisdom, or Charisma by 1, to a maximum of 20.\n \u2022 Minor Telekinesis. You learn the mage hand cantrip. You can cast it without verbal or somatic components, and you can make the spectral hand invisible. If you already know this spell, its range increases by 30 feet when you cast it. Its spellcasting ability is the ability increased by this feat.\n \u2022 Telekinetic Shove. As a bonus action, you can try to telekinetically shove one creature you can see within 30 feet of you. When you do so, the target must succeed on a Strength saving throw (DC 8 + your proficiency bonus + the ability modifier of the score increased by this feat) or be moved 5 feet toward you or away from you. A creature can willingly fail this save.",
  description: "I know the Mage Hand cantrip, can cast it without components, and the spectral hand can be invisible. As a bonus action, I can shove one creature I can see within 30 ft.. It must make a Str save vs. this feat's spell save DC or be moved 5 ft. from or towards me. My spellcasting ability is the ability I choose to increase when I gain this feat. [+1 Int, Wis, or Cha]",
  action: [["bonus action", " Shove"]],
  spellcastingBonus: {
    name: "Mage Hand",
    spells: ["mage hand"],
    selection: ["mage hand"],
    firstCol: "atwill"
  },
  spellcastingAbility: 4,
  calcChanges: {
    spellAdd: [
      function (spellKey, spellObj, spName) {
        if (spellKey !== "mage hand") return;
        spellObj.components = "";
        if (spellObj.description === SpellsList["mage hand"].description) spellObj.description = "Create (in)visible spectral hand for simple tasks or carry up to 10 lb; 1 a to control; can't have multiple";
        var rangeRx = /(\d+)( ?ft| ?m)/i;
        if (!/^(?=.*telekinetic)(?=.*feat).*$/i.test(CurrentSpells[spName].name) && rangeRx.test(spellObj.range)) {
          // add the +30 ft. rang only if not the entry for the feat itself
          var spRangeM = spellObj.range.match(rangeRx);
          spellObj.range = spellObj.range.replace(rangeRx, Number(spRangeM[1]) + (What("Unit System") === "metric" ? 9 : 30) + spRangeM[2]);
        }
        return true;
      },
      "My Telekinetic feat allows me to cast the Mage Hand cantrip without verbal or somatic components and I can make the spectral hand invisible. If I already know the cantrip from another source, its range is also increased with 30 ft.."
    ]
  },
  choices: ["Intelligence", "Wisdom", "Charisma"],
  "intelligence": {
    description: "I know the Mage Hand cantrip, can cast it without components, and the spectral hand can be invisible. As a bonus action, I can shove one creature I can see within 30 ft.. It must make a Str" + (typePF ? "" : "ength") + " save vs. this feat's spell save DC or be moved 5 ft." + (typePF ? "" : " away") + " from or towards me. Intelligence is my spellcasting ability for these. [+1 Intelligence]",
    spellcastingAbility: 4,
    scores: [0, 0, 0, 1, 0, 0]
  },
  "wisdom": {
    description: "I know the Mage Hand cantrip, can cast it without components, and the spectral hand can be invisible. As a bonus action, I can shove one creature I can see within 30 ft.. It must make a Str" + (typePF ? "" : "ength") + " save vs. this feat's spell save DC or be moved 5 ft." + (typePF ? "" : " away") + " from or towards me. Wisdom is my spellcasting ability for these. [+1 Wisdom]",
    spellcastingAbility: 5,
    scores: [0, 0, 0, 0, 1, 0]
  },
  "charisma": {
    description: "I know the Mage Hand cantrip, can cast it without components, and the spectral hand can be invisible. As a bonus action, I can shove one creature I can see within 30 ft.. It must make a Str" + (typePF ? "" : "ength") + " save vs. this feat's spell save DC or be moved 5 ft." + (typePF ? "" : " away") + " from or towards me. Charisma is my spellcasting ability for these. [+1 Charisma]",
    spellcastingAbility: 6,
    scores: [0, 0, 0, 0, 0, 1]
  },
  prerequisite: "Level 4",
  prereqeval: function (v) {
    return v.characterLevel >= 4;
  },
};
FeatsList["telepathic"] = {
  name: "Telepathic",
  source: [["PHB2024", 208 - 209]],
  regExpSearch: /^(?=.*telepathic).*$/i,
  descriptionFull: "You gain the following benefits:\n \u2022 Ability Score Increase. Increase your Intelligence, Wisdom, or Charisma by 1, to a maximum of 20.\n \u2022 Telepathic Utterance. You can speak telepathically to any creature you can see within 60 feet of you. Your telepathic utterances are in a language you know, and the creature understands you only if it knows that language. Your communication doesn't give the creature the ability to respond to you telepathically.\n \u2022 Detect thoughts. You can cast the detect thoughts spell, requiring no spell slot or components, and you must finish a long rest before you can cast it this way again. Your spellcasting ability for the spell is the ability increased by this feat. If you have spell slots of 2nd level or higher, you can cast this spell with them.",
  description: "I can telepathically speak to a creature I can see within 60 ft. in a language I know, but it can't respond telepathically. I can cast Detect Thoughts once per long rest at its lowest level, requiring no spell slot or components, and can cast it using a spell slot as normal. My spellcasting ability is the ability I increase with this feat. [+1 Int, Wis, or Cha]",
  spellcastingBonus: {
    name: "Detect Thoughts",
    spells: ["detect thoughts"],
    selection: ["detect thoughts"],
    firstCol: "oncelr"
  },
  spellcastingAbility: 4,
  allowUpCasting: true,
  spellChanges: {
    "detect thoughts": {
      components: "(V,S,M)",
      changes: "My Telepathic feat allows me to cast Detect Thoughts once per long rest without requiring a spell slot or spell components, or by using a spell slot and cast it with components as normal."
    }
  },
  choices: ["Intelligence", "Wisdom", "Charisma"],
  "intelligence": {
    description: "I can telepathically speak to a creature I can see within 60 ft. in a language I know, but it can't respond telepathically. I can cast Detect Thoughts once per long rest at its lowest level, requiring no spell slot or components, and can cast it using a spell slot as normal. Intelligence is my spellcasting ability for this. [+1 Int" + (typePF ? "" : "elligence") + "]",
    spellcastingAbility: 4,
    scores: [0, 0, 0, 1, 0, 0]
  },
  "wisdom": {
    description: "I can telepathically speak to a creature I can see within 60 ft. in a language I know, but it can't respond telepathically. I can cast Detect Thoughts once per long rest at its lowest level, requiring no spell slot or components, and can cast it using a spell slot as normal. Wisdom is my spellcasting ability for this. [+1 Wis" + (typePF ? "" : "dom") + "]",
    spellcastingAbility: 5,
    scores: [0, 0, 0, 0, 1, 0]
  },
  "charisma": {
    description: "I can telepathically speak to a creature I can see within 60 ft. in a language I know, but it can't respond telepathically. I can cast Detect Thoughts once per long rest at its lowest level, requiring no spell slot or components, and can cast it using a spell slot as normal. Charisma is my spellcasting ability for this. [+1 Cha" + (typePF ? "" : "risma") + "]",
    spellcastingAbility: 6,
    scores: [0, 0, 0, 0, 0, 1]
  },
  prerequisite: "Level 4",
  prereqeval: function (v) {
    return v.characterLevel >= 4;
  },
};
FeatsList["war caster"] = {
  name: "War Caster",
  source: [["PHB2024", 209]],
  regExpSearch: /^(?=.*war)(?=.*caster).*$/i,
  descriptionFull: "You gain the following benefits.\n \u2022 Ability Score Increase. Increase your Intelligence, Wisdom, or Charisma by 1, to a maximum of 20.\n \u2022 Concentration. You have Advantage on Constitution saving throws that you make to maintain Concentration.\n \u2022 Reactivate Spell. When a creature provokes an Opportunity Attack from you by leaving your reach, you can take a Reaction to cast a spell at the creature rather than making an Opportunity Attack. The spell must have a casting time of one action and must target only that creature.\n \u2022 Somatic Components. You can perform the Somatic components of spells even when you have Weapons or a Shield in one or both hands.",
  description: "+1 Int/Wis/Cha Advantage on Con saves to maintain concentration on spells when damaged. Perform somatic components even when holding weapons or shield in one or both hands. Cast spell of 1 action casting time that targets only one creature instead of an opportunity attack.",
  action: ["reaction", " - Opportunity Spell"],
  savetxt: {text: "Adv. on Con (Concentration) saves when damaged"},
  prerequisite: "Level 4 and has Spellcasting or Pact Magic Feature",
  prereqeval: function (v) {
    return v.characterLevel >= 4 && v.isSpellcaster;
  },
  choices: ["Intelligence", "Wisdom", "Charisma"],
  "intelligence": {
    description: "Advantage on Con saves to maintain concentration on spells when damaged. Perform somatic components even when holding weapons or shield in one or both hands. Cast spell of 1 action casting time that targets only one creature instead of an opportunity attack. [+1 Intelligence]",
    scores: [0, 0, 0, 1, 0, 0],
  },
  "wisdom": {
    description: "Advantage on Con saves to maintain concentration on spells when damaged. Perform somatic components even when holding weapons or shield in one or both hands. Cast spell of 1 action casting time that targets only one creature instead of an opportunity attack. [+1 Wisdom]",
    scores: [0, 0, 0, 0, 1, 0],
  },
  "charisma": {
    description: "Advantage on Con saves to maintain concentration on spells when damaged. Perform somatic components even when holding weapons or shield in one or both hands. Cast spell of 1 action casting time that targets only one creature instead of an opportunity attack. [+1 Charisma]",
    scores: [0, 0, 0, 0, 0, 1],
  },
};
FeatsList["weapon master"] = {
  name: "Weapon Master",
  source: [["PHB2024", 209]],
  regExpSearch: /^(?=.*weapon)(?=.*master).*$/i,
  descriptionFull: "You gain the following benefits.\n \u2022 Ability Score Increase. Increase your Strength or Dexterity score by 1, to a maximum of 20.\n \u2022 Mastery Property. Your training with weapons allows you to use the mastery property of one kind of Simple or Martial weapon of your choice, provided you have proficiency with it. Whenever you finish a Long Rest, you can change the kind of weapon to another kind.",
  description: "+1 Str/Dex, Gain Weapon Mastery in one weapon of choice. can change choice during a long rest provided you have the appropriate proficiencies.",
  choices: ["Club", "Dagger", "Greatclub", "Handaxe", "Javelin", "Light Hammer", "Mace", "Quarterstaff", "Sickle", "Spear", "Dart", "Light Crossbow", "Shortbow", "Sling", "Battleaxe", "Flail", "Glaive", "Greataxe", "Greatsword", "Halberd", "Lance", "Longsword", "Maul", "Morningstar", "Pike", "Rapier", "Scimitar", "Shortsword", "Trident", "Warhammer", "War Pick", "Whip", "Blowgun", "Hand Crossbow", "Heavy Crossbow", "Longbow", "Musket", "Pistol"],
  "club": {
    name: "Club",
    description: desc([
      "You gain access to the Club's 'Slow' Mastery feature",
      "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
    ]),
    prerequisite: "Club Proficiency",
    prereqeval: function (v) {
      return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("club") !== -1;
    },
  },
  "dagger": {
    name: "Dagger",
    description: desc([
      "You gain access to the Dagger's 'Nick' Mastery feature",
      "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
    ]),
    prerequisite: "Dagger Proficiency",
    prereqeval: function (v) {
      return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("dagger") !== -1;
    },
  },
  "greatclub": {
    name: "Greatclub",
    description: desc([
      "You gain access to the Greatclub's 'Push' Mastery feature",
      "Push : If you hit a creature with this weapon, you can push the creature up to 10 feet straight away from yourself if it is Large or smaller.",
    ]),
    prerequisite: "Greatclub Proficiency",
    prereqeval: function (v) {
      return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("greatclub") !== -1;
    },
  },
  "handaxe": {
    name: "Handaxe",
    description: desc([
      "You gain access to the Handaxe's 'Vex' Mastery feature",
      "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
    ]),
    prerequisite: "Handaxe Proficiency",
    prereqeval: function (v) {
      return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("handaxe") !== -1;
    },
  },
  "javelin": {
    name: "Javelin",
    description: desc([
      "You gain access to the Javelin's 'Slow' Mastery feature",
      "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
    ]),
    prerequisite: "Javelin Proficiency",
    prereqeval: function (v) {
      return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("javelin") !== -1;
    },
  },
  "light hammer": {
    name: "Light Hammer",
    description: desc([
      "You gain access to the Light Hammer's 'Nick' Mastery feature",
      "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
    ]),
    prerequisite: "Light Hammer Proficiency",
    prereqeval: function (v) {
      return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("light hammer") !== -1;
    },
  },
  "mace": {
    name: "Mace",
    description: desc([
      "You gain access to the Mace's 'Sap' Mastery feature",
      "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
    ]),
    prerequisite: "Mace Proficiency",
    prereqeval: function (v) {
      return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("mace") !== -1;
    },
  },
  "quarterstaff": {
    name: "Quarterstaff",
    description: desc([
      "You gain access to the Quarterstaff's 'Topple' Mastery feature",
      "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
    ]),
    prerequisite: "Quarterstaff Proficiency",
    prereqeval: function (v) {
      return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("quarterstaff") !== -1;
    },
  },
  "sickle": {
    name: "Sickle",
    description: desc([
      "You gain access to the Sickle's 'Nick' Mastery feature",
      "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
    ]),
    prerequisite: "Sickle Proficiency",
    prereqeval: function (v) {
      return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("sickle") !== -1;
    },
  },
  "spear": {
    name: "Spear",
    description: desc([
      "You gain access to the Spear's 'Sap' Mastery feature",
      "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
    ]),
    prerequisite: "Spear Proficiency",
    prereqeval: function (v) {
      return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("spear") !== -1;
    },
  },
  "dart": {
    name: "Dart",
    description: desc([
      "You gain access to the Dart's 'Vex' Mastery feature",
      "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
    ]),
    prerequisite: "Dart Proficiency",
    prereqeval: function (v) {
      return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("dart") !== -1;
    },
  },
  "light crossbow": {
    name: "Light Crossbow",
    description: desc([
      "You gain access to the Light Crossbow's 'Slow' Mastery feature",
      "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
    ]),
    prerequisite: "Light Crossbow Proficiency",
    prereqeval: function (v) {
      return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("light crossbow") !== -1;
    },
  },
  "shortbow": {
    name: "Shortbow",
    description: desc([
      "You gain access to the Shortbow's 'Vex' Mastery feature",
      "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
    ]),
    prerequisite: "Shortbow Proficiency",
    prereqeval: function (v) {
      return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("shortbow") !== -1;
    },
  },
  "sling": {
    name: "Sling",
    description: desc([
      "You gain access to the Sling's 'Slow' Mastery feature",
      "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
    ]),
    prerequisite: "Sling Proficiency",
    prereqeval: function (v) {
      return v.simpleWeaponsProf || v.otherWeaponsProf.indexOf("sling") !== -1;
    },
  },
  "battleaxe": {
    name: "Battleaxe",
    description: desc([
      "You gain access to the Battleaxe's 'Topple' Mastery feature",
      "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
    ]),
    prerequisite: "Battleaxe Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("battleaxe") !== -1;
    },
  },
  "flail": {
    name: "Flail",
    description: desc([
      "You gain access to the Flail's 'Sap' Mastery feature",
      "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
    ]),
    prerequisite: "Flail Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("flail") !== -1;
    },
  },
  "glaive": {
    name: "Glaive",
    description: desc([
      "You gain access to the Glaive's 'Graze' Mastery feature",
      "Graze : If your attack roll with this weapon misses a creature, you can deal damage to that creature equal to the ability modifier you used to make the attack roll. This damage is the same type dealt by the weapon, and the damage can be increased only by increasing the ability modifier.",
    ]),
    prerequisite: "Glaive Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("glaive") !== -1;
    },
  },
  "greataxe": {
    name: "Greataxe",
    description: desc([
      "You gain access to the Greataxe's 'Cleave' Mastery feature",
      "Cleave : If you hit a creature with a melee attack roll using this weapon, you can make a melee attack roll with the weapon against a second creature within 5 feet of the first that is also within your reach. On a hit the second creature takes the weapon's damage, but don't add your ability modifier to that damage unless the modifier is negative. You can make this extra attack only once per turn.",
    ]),
    prerequisite: "Greataxe Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("greataxe") !== -1;
    },
  },
  "greatsword": {
    name: "Greatsword",
    description: desc([
      "You gain access to the Greatsword's 'Graze' Mastery feature",
      "Graze : If your attack roll with this weapon misses a creature, you can deal damage to that creature equal to the ability modifier you used to make the attack roll. This damage is the same type dealt by the weapon, and the damage can be increased only by increasing the ability modifier.",
    ]),
    prerequisite: "Greatsword Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("greatsword") !== -1;
    },
  },
  "halberd": {
    name: "Halberd",
    description: desc([
      "You gain access to the Halberd's 'Cleave' Mastery feature",
      "Cleave : If you hit a creature with a melee attack roll using this weapon, you can make a melee attack roll with the weapon against a second creature within 5 feet of the first that is also within your reach. On a hit the second creature takes the weapon's damage, but don't add your ability modifier to that damage unless the modifier is negative. You can make this extra attack only once per turn.",
    ]),
    prerequisite: "Halberd Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("halberd") !== -1;
    },
  },
  "lance": {
    name: "Lance",
    description: desc([
      "You gain access to the Lance's 'Topple' Mastery feature",
      "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
    ]),
    prerequisite: "Lance Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("lance") !== -1;
    },
  },
  "longsword": {
    name: "Longsword",
    description: desc([
      "You gain access to the Longsword's 'Sap' Mastery feature",
      "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
    ]),
    prerequisite: "Longsword Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("longsword") !== -1;
    },
  },
  "maul": {
    name: "Maul",
    description: desc([
      "You gain access to the Maul's 'Topple' Mastery feature",
      "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
    ]),
    prerequisite: "Maul Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("maul") !== -1;
    },
  },
  "morningstar": {
    name: "Morningstar",
    description: desc([
      "You gain access to the Morningstar's 'Sap' Mastery feature",
      "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
    ]),
    prerequisite: "Morningstar Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("morningstar") !== -1;
    },
  },
  "pike": {
    name: "Pike",
    description: desc([
      "You gain access to the Pike's 'Push' Mastery feature",
      "Push : If you hit a creature with this weapon, you can push the creature up to 10 feet straight away from yourself if it is Large or smaller.",
    ]),
    prerequisite: "Pike Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("pike") !== -1;
    },
  },
  "rapier": {
    name: "Rapier",
    description: desc([
      "You gain access to the Rapier's 'Vex' Mastery feature",
      "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
    ]),
    prerequisite: "Rapier Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("rapier") !== -1;
    },
  },
  "scimitar": {
    name: "Scimitar",
    description: desc([
      "You gain access to the Scimitar's 'Nick' Mastery feature",
      "Nick : When you make the extra attack of the Light property, you can make it as part of the Attack action instead of as a Bonus Action. You can make this extra attack only once per turn.",
    ]),
    prerequisite: "Scimitar Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("scimitar") !== -1;
    },
  },
  "shortsword": {
    name: "Shortsword",
    description: desc([
      "You gain access to the Shortsword's 'Vex' Mastery feature",
      "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
    ]),
    prerequisite: "Shortsword Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("shortsword") !== -1;
    },
  },
  "trident": {
    name: "Trident",
    description: desc([
      "You gain access to the Trident's 'Topple' Mastery feature",
      "Topple : If you hit a creature with this weapon, you can force the creature to make a Constitution saving throw (DC 8 plus the ability modifier used to make the attack roll and your Proficiency Bonus). On a failed save, the creature has the Prone condition.",
    ]),
    prerequisite: "Trident Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("trident") !== -1;
    },
  },
  "warhammer": {
    name: "Warhammer",
    description: desc([
      "You gain access to the Warhammer's 'Push' Mastery feature",
      "Push : If you hit a creature with this weapon, you can push the creature up to 10 feet straight away from yourself if it is Large or smaller.",
    ]),
    prerequisite: "Warhammer Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("warhammer") !== -1;
    },
  },
  "war pick": {
    name: "War Pick",
    description: desc([
      "You gain access to the War Pick's 'Sap' Mastery feature",
      "Sap : If you hit a creature with this weapon that creature has Disadvantage on its next attack roll before the start of your next turn.",
    ]),
    prerequisite: "War Pick Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("war pick") !== -1;
    },
  },
  "whip": {
    name: "Whip",
    description: desc([
      "You gain access to the Whip's 'Slow' Mastery feature",
      "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
    ]),
    prerequisite: "Whip Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("whip") !== -1;
    },
  },
  "blowgun": {
    name: "Blowgun",
    description: desc([
      "You gain access to the Blowgun's 'Vex' Mastery feature",
      "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
    ]),
    prerequisite: "Blowgun Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("blowgun") !== -1;
    },
  },
  "hand crossbow": {
    name: "Hand Crossbow",
    description: desc([
      "You gain access to the Hand Crossbow's 'Vex' Mastery feature",
      "Vex : If you hit a creature with this weapon and deal damage to the creature, you have Advantage on your next attack roll against the creature before the end of your next turn.",
    ]),
    prerequisite: "Hand Crossbow Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("hand crossbow") !== -1;
    },
  },
  "heavy crossbow": {
    name: "Heavy Crossbow",
    description: desc([
      "You gain access to the Heavy Crossbow's 'Push' Mastery feature",
      "Push : If you hit a creature with this weapon, you can push the creature up to 10 feet straight away from yourself if it is Large or smaller.",
    ]),
    prerequisite: "Heavy Crossbow Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("heavy crossbow") !== -1;
    },
  },
  "longbow": {
    name: "Longbow",
    description: desc([
      "You gain access to the Longbow's 'Slow' Mastery feature",
      "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
    ]),
    prerequisite: "Longbow Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("longbow") !== -1;
    },
  },
  "musket": {
    name: "Musket",
    description: desc([
      "You gain access to the Musket's 'Slow' Mastery feature",
      "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
    ]),
    prerequisite: "Musket Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("musket") !== -1;
    },
  },
  "pistol": {
    name: "Pistol",
    description: desc([
      "You gain access to the Pistol's 'Slow' Mastery feature",
      "Slow : If you hit a creature with this weapon and deal damage to it, you can reduce its Speed by 10 feet until the start of your next turn. If the creature is hit more than once by weapons that have this property, the Speed reduction doesn't exceed 10 feet.",
    ]),
    prerequisite: "Pistol Proficiency",
    prereqeval: function (v) {
      return v.martialWeaponsProf || v.otherWeaponsProf.indexOf("pistol") !== -1;
    },
  },
  prerequisite: "Level 4",
  prereqeval: function (v) {
    return v.characterLevel >= 4;
  },
};
FeatsList["fighting style"] = {
  name: "Fighting Style",
  source: [["PHB2024", 209]],
  regExpSearch: /^(?=.*fighting)(?=.*style).*$/i,
  descriptionFull: "Choose a Fighting Style.",
  description: "Choose a Fighting Style.",
  choices: ["Archery", "Blind Fighting", "Defense", "Dueling", "Great Weapon Fighting", "Interception", "Protection", "Thrown Weapon Fighting", "Two-Weapon Fighting", "Unarmed Fighting"],
  "archery": {
    name: "Archery",
    description: desc([
      "You gain a +2 bonus to attack rolls you make with Ranged weapons.",
    ]),
    calcChanges: {
      atkCalc: [
        function (fields, v, output) {
          if (v.isRangedWeapon && !v.isNaturalWeapon && !v.isDC) output.extraHit += 2;
        },
        "My ranged weapons get a +2 bonus on the To Hit."
      ]
    }
  },
  "blind fighting": {
    name: "Blind Fighting",
    description: desc([
      "You have Blindsight with a range of 10 feet.",
    ]),
    vision: [["Blindsight", 10]],
  },
  "defense": {
    name: "Defense",
    description: desc([
      "While you're wearing Light, Medium, or Heavy armor, you gain a +1 bonus to Armor Class.",
    ]),
    extraAC: {
      name: "Defense Fighting Style", // necessary for features referring to fighting style properties directly
      mod: 1,
      text: "I gain a +1 bonus to AC while wearing armor.",
      stopeval: function (v) {
        return !v.wearingArmor;
      }
    },
  },
  "dueling": {
    name: "Dueling",
    description: desc([
      "When you're holding a Melee weapon in one hand and no other weapons, you gain a +2 bonus to damage rolls with that weapon.",
    ]),
    calcChanges: {
      atkCalc: [
        function (fields, v, output) {
          for (var i = 1; i <= FieldNumbers.actions; i++) {
            if ((/off.hand.attack/i).test(What('Bonus Action ' + i))) return;
          }
          if (v.isMeleeWeapon && !v.isNaturalWeapon && !(/((^|[^+-]\b)2|\btwo).?hand(ed)?s?\b/i).test(fields.Description)) output.extraDmg += 2;
        },
        "When I'm wielding a melee weapon in one hand and no weapon in my other hand, I do +2 damage with that melee weapon. This condition will always be false if the bonus action 'Off-hand Attack' exists."
      ]
    }
  },
  "great weapon fighting": {
    name: "Great Weapon Fighting",
    description: desc([
      "When you roll damage for an attack you make with a Melee weapon that you are holding with two hands, you can treat any 1 or 2 on a damage die as a 3. The weapon must have the Two-Handed or Versatile properties to gain this benefit.",
    ]),
    calcChanges: {
      atkAdd: [
        function (fields, v) {
          if (v.isMeleeWeapon && (/(\bversatile|((^|[^+-]\b)2|\btwo).?hand(ed)?s?)\b/i).test(fields.Description)) {
            fields.Description += (fields.Description ? '; ' : '') + 'treat rolls of 1 or 2 on the damage die as a 3' + ((/versatile/i).test(fields.Description) ? ' when two-handed' : '');
          }
        },
        "While wielding a two-handed or versatile melee weapon in two hands, I can treat a roll of 1 or 2 on any damage die as a 3."
      ]
    },
  },
  "interception": {
    name: "Interception",
    description: desc([
      "When a creature you can see hits another creature within 5 feet of you with an attack roll, you can take a Reaction to reduce the damage dealt to the target by 1d10 plus your Proficiency Bonus. You must be holding a Shield or a Simple or Martial weapon to use this Reaction.",
    ]),
    action: [["reaction", ""]],
  },
  "protection": {
    name: "Protection",
    description: desc([
      "When a creature you can see attacks a target other than you that is within 5 feet of you, you can take a Reaction to interpose your Shield if you're holding one. You impose Disadvantage on the triggering attack roll and all other attack rolls against the target until the start of your next turn if you remain within 5 feet of the target.",
    ]),
    action: ["reaction", ""],
  },
  "thrown weapon fighting": {
    name: "Thrown Weapon Fighting",
    description: desc([
      "When you hit with a ranged attack roll using a weapon that has the Thrown property, you gain a +2 bonus to the damage roll.",
    ]),
    calcChanges: {
      atkAdd: [
        function (fields, v) {
          if (v.isThrownWeapon && v.isMeleeWeapon) {
            fields.Description += (fields.Description ? '; ' : '') + '+2 damage when thrown';
          }
        },
        "I deal +2 damage when I hit a ranged attack made with a thrown weapon."
      ],
      atkCalc: [
        function (fields, v, output) {
          if (v.isThrownWeapon && !v.isMeleeWeapon) {
            output.extraDmg += 2;
          }
        },
        ""
      ],
    },
  },
  "two-weapon fighting": {
    name: "Two-Weapon Fighting",
    description: desc([
      "When you make an extra attack as a result of using a weapon that has the Light property, you can add your ability modifier to the damage o that attack if you aren't already adding it to the damage.",
    ]),
    calcChanges: {
      atkCalc: [
        function (fields, v, output) {
          if (v.isOffHand) output.modToDmg = true;
        },
        "When engaging in two-weapon fighting, I can add my ability modifier to the damage of my off-hand attacks. If a melee weapon includes 'off-hand' or 'secondary' in its name or description, it is considered an off-hand attack."
      ]
    },
  },
  "unarmed fighting": {
    name: "Unarmed Fighting",
    description: desc([
      "When you hit with your Unarmed Strike and deal damage, you can deal Bludgeoning damage equal to 1d6 plus your Strength modifier instead of the normal damage of an Unarmed Strike. If you aren't holding any weapons or a Shield when you make the attack roll, the d6 becomes a d8.\n At the start of each of your turns, you can deal 1d4 Bludgeoning damage to one creature Grappled by you.",
    ]),
    calcChanges: {
      atkAdd: [
        function (fields, v) {
          if (v.baseWeaponName == "unarmed strike") {
            if (fields.Damage_Die == 1 || fields.Damage_Die == "1d4") fields.Damage_Die = '1d6';
            fields.Description += (fields.Description ? '; ' : '') + 'Versatile (d8)';
          }
        },
        "My unarmed strikes deal 1d6 damage instead of 1, which increases to 1d8 if I have both hands free to make an unarmed strike with.",
        1
      ]
    },
  },
  allowDuplicates: true,
};
//Epic Boon Feats
FeatsList["boon of combat prowess"] = {
  name: "Boon of Combat Prowess",
  source: [["PHB2024", 210]],
  descriptionFull: "You gain the following benefits.\n \u2022 Ability Score Improvement. Increase one ability sore of your choice by 1, to a Maximum of 30.\n \u2022 Peerless Aim. When you miss with an attack roll, you can hit instead. Once you use this benefit, you can't use it again until the start of your next turn.",
  description: "+1 to Any, Once per turn, when you miss with an attack, you can instead hit.",
  choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
  "strength": {
    name: "Strength",
    description: "Once per turn, when you miss with an attack, you can instead hit. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
    scoresMaximum: [30, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    name: "Dexterity",
    description: "Once per turn, when you miss with an attack, you can instead hit. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
    scoresMaximum: [0, 30, 0, 0, 0, 0],
  },
  "constitution": {
    name: "Constitution",
    description: "Once per turn, when you miss with an attack, you can instead hit. [+1 constitution]",
    scores: [0, 0, 1, 0, 0, 0],
    scoresMaximum: [0, 0, 30, 0, 0, 0],
  },
  "intelligence": {
    name: "Intelligence",
    description: "Once per turn, when you miss with an attack, you can instead hit. [+1 Intelligence]",
    scores: [0, 0, 0, 1, 0, 0],
    scoresMaximum: [0, 0, 0, 30, 0, 0],
  },
  "wisdom": {
    name: "Wisdom",
    description: "Once per turn, when you miss with an attack, you can instead hit. [+1 Wisdom]",
    scores: [0, 0, 0, 0, 1, 0],
    scoresMaximum: [0, 0, 0, 0, 30, 0],
  },
  "charisma": {
    name: "Charisma",
    description: "Once per turn, when you miss with an attack, you can instead hit. [+1 Charisma]",
    scores: [0, 0, 0, 0, 0, 1],
    scoresMaximum: [0, 0, 0, 0, 0, 30],
  },
  prereqeval: function (v) {
    return v.characterLevel >= 19;
  },
};
FeatsList["boon of dimensional travel"] = {
  name: "Boon of Dimensional Travel",
  source: [["PHB2024", 210]],
  descriptionFull: "You gain the following benefits.\n \u2022 Ability Score Improvement. Increase one ability sore of your choice by 1, to a Maximum of 30.\n \u2022 Blink Steps. Immediately after you take the Attack action or the Magic action, you can teleport up to 30 feet to an unoccupied space you can see.",
  description: "+1 to Any, Once per turn, when you miss with an attack, you can instead hit.",
  choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
  "strength": {
    name: "Strength",
    description: "Immediately after you take the Attack action or the Magic action, you can teleport up to 30 feet to an unoccupied space you can see. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
    scoresMaximum: [30, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    name: "Dexterity",
    description: "Immediately after you take the Attack action or the Magic action, you can teleport up to 30 feet to an unoccupied space you can see. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
    scoresMaximum: [0, 30, 0, 0, 0, 0],
  },
  "constitution": {
    name: "Constitution",
    description: "Immediately after you take the Attack action or the Magic action, you can teleport up to 30 feet to an unoccupied space you can see. [+1 constitution]",
    scores: [0, 0, 1, 0, 0, 0],
    scoresMaximum: [0, 0, 30, 0, 0, 0],
  },
  "intelligence": {
    name: "Intelligence",
    description: "Immediately after you take the Attack action or the Magic action, you can teleport up to 30 feet to an unoccupied space you can see. [+1 Intelligence]",
    scores: [0, 0, 0, 1, 0, 0],
    scoresMaximum: [0, 0, 0, 30, 0, 0],
  },
  "wisdom": {
    name: "Wisdom",
    description: "Immediately after you take the Attack action or the Magic action, you can teleport up to 30 feet to an unoccupied space you can see. [+1 Wisdom]",
    scores: [0, 0, 0, 0, 1, 0],
    scoresMaximum: [0, 0, 0, 0, 30, 0],
  },
  "charisma": {
    name: "Charisma",
    description: "Immediately after you take the Attack action or the Magic action, you can teleport up to 30 feet to an unoccupied space you can see. [+1 Charisma]",
    scores: [0, 0, 0, 0, 0, 1],
    scoresMaximum: [0, 0, 0, 0, 0, 30],
  },
  prereqeval: function (v) {
    return v.characterLevel >= 19;
  },
};
FeatsList["boon of energy resistance"] = {
  name: "Boon of Energy Resistance",
  source: [["PHB2024", 210]],
  action: ["reaction", "Energy Redirection"],
  descriptionFull: "You gain the following benefits.\n \u2022 Ability Score Improvement. Increase one ability sore of your choice by 1, to a Maximum of 30.\n \u2022 Energy Resistances. You gain Resistance to two of the following damage types of your choice: Acid, Cold, Fire, Lightning, Necrotic, Poison, Psychic, Radiant, or Thunder. Whenever you finish a Long Rest, you can change your choices.\n \u2022 Energy Redirection. When you take damage of one of the types chosen for the Energy Resistances benefit, you can take a Reaction to direct damage of the same type toward another creature you can see within 60 feet of yourself that isn't behind Total Cover. If you do so, that creature must succeed on a Dexterity saving throw (DC 8 plus your Constitution modifier and Proficiency Bonus) or take damage equal to 2d12 plus your Constitution modifier.",
  description: "+1 to Any, +2 Energy Resistances which you can change after a Long Rest; When hit with a damage type you have resistance to Reaction to redirect energy you have a resistance to back on the crea who targeted you 2d12 of energy type as long as they are not behind total cover.",
  extraname: "Boon of Energy Resistance",
  extrachoices: ["Acid", "Cold", "Fire", "Lightning", "Necrotic", "Poison", "Psychic", "Radiant", "Thunder"],
  extraTimes: 2,
  "acid": {
    name: "Acid",
    description: "Boon of Energy Resistance, You gain Resistance to Acid damage",
    dmgres: "Acid",
  },
  "cold": {
    name: "Cold",
    description: "Boon of Energy Resistance, You gain Resistance to Cold damage",
    dmgres: "Cold",
  },
  "fire": {
    name: "Fire",
    description: "Boon of Energy Resistance, You gain Resistance to Fire damage",
    dmgres: "Fire",
  },
  "lightning": {
    name: "Lightning",
    description: "Boon of Energy Resistance, You gain Resistance to Lightning damage",
    dmgres: "Lightning",
  },
  "necrotic": {
    name: "Necrotic",
    description: "Boon of Energy Resistance, You gain Resistance to Necrotic damage",
    dmgres: "Necrotic",
  },
  "poison": {
    name: "Poison",
    description: "Boon of Energy Resistance, You gain Resistance to Poison damage",
    dmgres: "Poison",
  },
  "psychic": {
    name: "Psychic",
    description: "Boon of Energy Resistance, You gain Resistance to Psychic damage",
    dmgres: "Psychic",
  },
  "radiant": {
    name: "Radiant",
    description: "Boon of Energy Resistance, You gain Resistance to Radiant damage",
    dmgres: "Radiant",
  },
  "thunder": {
    name: "Thunder",
    description: "Boon of Energy Resistance, You gain Resistance to Thunder damage",
    dmgres: "Thunder",
  },
  choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
  "strength": {
    name: "Strength",
    description: "+2 Energy Resistances which you can change after a Long Rest; When hit with a damage type you have resistance to Reaction to redirect energy you have a resistance to back on the crea who targeted you 2d12 of energy type as long as they are not behind total cover. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
    scoresMaximum: [30, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    name: "Dexterity",
    description: "+2 Energy Resistances which you can change after a Long Rest; When hit with a damage type you have resistance to Reaction to redirect energy you have a resistance to back on the crea who targeted you 2d12 of energy type as long as they are not behind total cover. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
    scoresMaximum: [0, 30, 0, 0, 0, 0],
  },
  "constitution": {
    name: "Constitution",
    description: "+2 Energy Resistances which you can change after a Long Rest; When hit with a damage type you have resistance to Reaction to redirect energy you have a resistance to back on the crea who targeted you 2d12 of energy type as long as they are not behind total cover. [+1 constitution]",
    scores: [0, 0, 1, 0, 0, 0],
    scoresMaximum: [0, 0, 30, 0, 0, 0],
  },
  "intelligence": {
    name: "Intelligence",
    description: "+2 Energy Resistances which you can change after a Long Rest; When hit with a damage type you have resistance to Reaction to redirect energy you have a resistance to back on the crea who targeted you 2d12 of energy type as long as they are not behind total cover. [+1 Intelligence]",
    scores: [0, 0, 0, 1, 0, 0],
    scoresMaximum: [0, 0, 0, 30, 0, 0],
  },
  "wisdom": {
    name: "Wisdom",
    description: "+2 Energy Resistances which you can change after a Long Rest; When hit with a damage type you have resistance to Reaction to redirect energy you have a resistance to back on the crea who targeted you 2d12 of energy type as long as they are not behind total cover. [+1 Wisdom]",
    scores: [0, 0, 0, 0, 1, 0],
    scoresMaximum: [0, 0, 0, 0, 30, 0],
  },
  "charisma": {
    name: "Charisma",
    description: "+2 Energy Resistances which you can change after a Long Rest; When hit with a damage type you have resistance to Reaction to redirect energy you have a resistance to back on the crea who targeted you 2d12 of energy type as long as they are not behind total cover. [+1 Charisma]",
    scores: [0, 0, 0, 0, 0, 1],
    scoresMaximum: [0, 0, 0, 0, 0, 30],
  },
  prereqeval: function (v) {
    return v.characterLevel >= 19;
  },
};
FeatsList["boon of fate"] = {
  name: "Boon of Fate",
  source: [["PHB2024", 210]],
  descriptionFull: "You gain the following benefits.\n \u2022 Ability Score Improvement. Increase one ability sore of your choice by 1, to a Maximum of 30.\n \u2022 Improved Fate. When you or another creature within 60 feet of you succeeds or fails a D20 Test you can roll 2d4 and apply the total rolled as a bonus or penalty to the d20 roll. Once you use this benefit, you can't use it again until you roll Initiative or finish a Short or Long Rest.",
  description: "+1 to Any, Once per Initiative/Rest you can roll 2d4 and apply them as a bonus or penalty to a single D20 Test rolled by yourself or another creature within 60 feet of you.",
  choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
  "strength": {
    name: "Strength",
    description: "Once per Initiative/Rest you can roll 2d4 and apply them as a bonus or penalty to a single D20 Test rolled by yourself or another creature within 60 feet of you. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
    scoresMaximum: [30, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    name: "Dexterity",
    description: "Once per Initiative/Rest you can roll 2d4 and apply them as a bonus or penalty to a single D20 Test rolled by yourself or another creature within 60 feet of you. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
    scoresMaximum: [0, 30, 0, 0, 0, 0],
  },
  "constitution": {
    name: "Constitution",
    description: "Once per Initiative/Rest you can roll 2d4 and apply them as a bonus or penalty to a single D20 Test rolled by yourself or another creature within 60 feet of you. [+1 constitution]",
    scores: [0, 0, 1, 0, 0, 0],
    scoresMaximum: [0, 0, 30, 0, 0, 0],
  },
  "intelligence": {
    name: "Intelligence",
    description: "Once per Initiative/Rest you can roll 2d4 and apply them as a bonus or penalty to a single D20 Test rolled by yourself or another creature within 60 feet of you. [+1 Intelligence]",
    scores: [0, 0, 0, 1, 0, 0],
    scoresMaximum: [0, 0, 0, 30, 0, 0],
  },
  "wisdom": {
    name: "Wisdom",
    description: "Once per Initiative/Rest you can roll 2d4 and apply them as a bonus or penalty to a single D20 Test rolled by yourself or another creature within 60 feet of you. [+1 Wisdom]",
    scores: [0, 0, 0, 0, 1, 0],
    scoresMaximum: [0, 0, 0, 0, 30, 0],
  },
  "charisma": {
    name: "Charisma",
    description: "Once per Initiative/Rest you can roll 2d4 and apply them as a bonus or penalty to a single D20 Test rolled by yourself or another creature within 60 feet of you. [+1 Charisma]",
    scores: [0, 0, 0, 0, 0, 1],
    scoresMaximum: [0, 0, 0, 0, 0, 30],
  },
  prereqeval: function (v) {
    return v.characterLevel >= 19;
  },
};
FeatsList["boon of fortitude"] = {
  name: "Boon of Fortitude",
  source: [["PHB2024", 210]],
  calcChanges: {
    hp: function (totalHD) {
      return [+40, '\n + ' + totalHD + ' + 40 from the Boon of Fortitude feat ', true];
    },
  },
  descriptionFull: "You gain the following benefits.\n \u2022 Ability Score Improvement. Increase one ability sore of your choice by 1, to a Maximum of 30.\n \u2022 Fortified Health. Your Hit Point maximum increases by 40. In addition, whenever you regain Hit Points, you can regain additional Hit Points equal to your Constitution modifier. Once you've regained these additional Hit Points, you can't do so again until the start of your next turn.",
  description: "+1 to Any, +40 to HP max; Once per turn when you regain HP you can add your Con mod to the HP regained.",
  choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
  "strength": {
    name: "Strength",
    description: "+40 to HP max; Once per turn when you regain HP you can add your Con mod to the HP regained. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
    scoresMaximum: [30, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    name: "Dexterity",
    description: "+40 to HP max; Once per turn when you regain HP you can add your Con mod to the HP regained. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
    scoresMaximum: [0, 30, 0, 0, 0, 0],
  },
  "constitution": {
    name: "Constitution",
    description: "+40 to HP max; Once per turn when you regain HP you can add your Con mod to the HP regained. [+1 constitution]",
    scores: [0, 0, 1, 0, 0, 0],
    scoresMaximum: [0, 0, 30, 0, 0, 0],
  },
  "intelligence": {
    name: "Intelligence",
    description: "+40 to HP max; Once per turn when you regain HP you can add your Con mod to the HP regained. [+1 Intelligence]",
    scores: [0, 0, 0, 1, 0, 0],
    scoresMaximum: [0, 0, 0, 30, 0, 0],
  },
  "wisdom": {
    name: "Wisdom",
    description: "+40 to HP max; Once per turn when you regain HP you can add your Con mod to the HP regained. [+1 Wisdom]",
    scores: [0, 0, 0, 0, 1, 0],
    scoresMaximum: [0, 0, 0, 0, 30, 0],
  },
  "charisma": {
    name: "Charisma",
    description: "+40 to HP max; Once per turn when you regain HP you can add your Con mod to the HP regained. [+1 Charisma]",
    scores: [0, 0, 0, 0, 0, 1],
    scoresMaximum: [0, 0, 0, 0, 0, 30],
  },
  prereqeval: function (v) {
    return v.characterLevel >= 19;
  },
};
FeatsList["boon of irresistible offense"] = {
  name: "Boon of Irresistible Offense",
  source: [["PHB2024", 211]],
  descriptionFull: "You gain the following benefits.\n \u2022 Ability Score Improvement. Increase one ability sore of your choice by 1, to a Maximum of 30.\n \u2022 Overcome Defenses. The Bludgeoning, Piercing, and Slashing damage you deal always ignores Resistance.\n \u2022 Overwhelming Strike. When you roll a 20 on the d20 for an attack roll, you can deal extra damage to the target equal to the ability score increased by this feat.",
  description: "+1 to Any, Blud/Pierc/Slash ignores resistance, you deal extra damage on a crit equal to the ability modifier of the score you increased by this feat.",
  choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
  "strength": {
    name: "Strength",
    description: "Blud/Pierc/Slash ignores resistance, you deal extra damage on a crit equal to your Strength modifier. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
    scoresMaximum: [30, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    name: "Dexterity",
    description: "Blud/Pierc/Slash ignores resistance, you deal extra damage on a crit equal to your Dexterity modifier. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
    scoresMaximum: [0, 30, 0, 0, 0, 0],
  },
  "constitution": {
    name: "Constitution",
    description: "Blud/Pierc/Slash ignores resistance, you deal extra damage on a crit equal to your Constitution modifier. [+1 constitution]",
    scores: [0, 0, 1, 0, 0, 0],
    scoresMaximum: [0, 0, 30, 0, 0, 0],
  },
  "intelligence": {
    name: "Intelligence",
    description: "Blud/Pierc/Slash ignores resistance, you deal extra damage on a crit equal to your Intelligence modifier. [+1 Intelligence]",
    scores: [0, 0, 0, 1, 0, 0],
    scoresMaximum: [0, 0, 0, 30, 0, 0],
  },
  "wisdom": {
    name: "Wisdom",
    description: "Blud/Pierc/Slash ignores resistance, you deal extra damage on a crit equal to your Wisdom modifier. [+1 Wisdom]",
    scores: [0, 0, 0, 0, 1, 0],
    scoresMaximum: [0, 0, 0, 0, 30, 0],
  },
  "charisma": {
    name: "Charisma",
    description: "Blud/Pierc/Slash ignores resistance, you deal extra damage on a crit equal to your Charisma modifier. [+1 Charisma]",
    scores: [0, 0, 0, 0, 0, 1],
    scoresMaximum: [0, 0, 0, 0, 0, 30],
  },
  prereqeval: function (v) {
    return v.characterLevel >= 19;
  },
};
FeatsList["boon of recovery"] = {
  name: "Boon of Recovery",
  source: [["PHB2024", 211]],
  action: ["bonus action", "Recovery"],
  limfeaname: "Last Stand",
  usages: 1,
  recovery: "Long Rest",
  descriptionFull: "You gain the following benefits.\n \u2022 Ability Score Improvement. Increase one ability sore of your choice by 1, to a Maximum of 30.\n \u2022 Last Stand. When you would be reduced to 0 Hit Points, you can drop to 1 Hit Point instead and regain a number of Hit Points equal to half your Hit Point maximum. Once you use this benefit, you can't use it again until you finish a Long Rest.\n \u2022 Recover. You have a pool of ten d10s. As a Bonus Action, you can expend dice from the pool, roll those dice, and regain a number of Hit Points equal to the roll's total. You regain all the expended dice when you finish a Long Rest.",
  description: "+1 to Any, Once per Long Rest when you would be reduced to 0 HP drop to 1 instead and regain HP equal to 1/2 your max HP; you gain 10 d10s that you can roll as a bns. a. which recover over a Long Rest.",
  choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
  "strength": {
    name: "Strength",
    description: "Once per Long Rest when you would be reduced to 0 HP drop to 1 instead and regain HP equal to 1/2 your max HP; you gain 10 d10s that you can roll as a bns. a. which recover over a Long Rest. [+1 Strength]",
    limfeaname: "Recovery Dice",
    usages: 10,
    recovery: "long rest",
    scores: [1, 0, 0, 0, 0, 0],
    scoresMaximum: [30, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    name: "Dexterity",
    description: "Once per Long Rest when you would be reduced to 0 HP drop to 1 instead and regain HP equal to 1/2 your max HP; you gain 10 d10s that you can roll as a bns. a. which recover over a Long Rest. [+1 Dexterity]",
    limfeaname: "Recovery Dice",
    usages: 10,
    recovery: "long rest",
    scores: [0, 1, 0, 0, 0, 0],
    scoresMaximum: [0, 30, 0, 0, 0, 0],
  },
  "constitution": {
    name: "Constitution",
    description: "Once per Long Rest when you would be reduced to 0 HP drop to 1 instead and regain HP equal to 1/2 your max HP; you gain 10 d10s that you can roll as a bns. a. which recover over a Long Rest. [+1 constitution]",
    limfeaname: "Recovery Dice",
    usages: 10,
    recovery: "long rest",
    scores: [0, 0, 1, 0, 0, 0],
    scoresMaximum: [0, 0, 30, 0, 0, 0],
  },
  "intelligence": {
    name: "Intelligence",
    description: "Once per Long Rest when you would be reduced to 0 HP drop to 1 instead and regain HP equal to 1/2 your max HP; you gain 10 d10s that you can roll as a bns. a. which recover over a Long Rest. [+1 Intelligence]",
    limfeaname: "Recovery Dice",
    usages: 10,
    recovery: "long rest",
    scores: [0, 0, 0, 1, 0, 0],
    scoresMaximum: [0, 0, 0, 30, 0, 0],
  },
  "wisdom": {
    name: "Wisdom",
    description: "Once per Long Rest when you would be reduced to 0 HP drop to 1 instead and regain HP equal to 1/2 your max HP; you gain 10 d10s that you can roll as a bns. a. which recover over a Long Rest. [+1 Wisdom]",
    limfeaname: "Recovery Dice",
    usages: 10,
    recovery: "long rest",
    scores: [0, 0, 0, 0, 1, 0],
    scoresMaximum: [0, 0, 0, 0, 30, 0],
  },
  "charisma": {
    name: "Charisma",
    description: "Once per Long Rest when you would be reduced to 0 HP drop to 1 instead and regain HP equal to 1/2 your max HP; you gain 10 d10s that you can roll as a bns. a. which recover over a Long Rest. [+1 Charisma]",
    limfeaname: "Recovery Dice",
    usages: 10,
    recovery: "long rest",
    scores: [0, 0, 0, 0, 0, 1],
    scoresMaximum: [0, 0, 0, 0, 0, 30],
  },
  prereqeval: function (v) {
    return v.characterLevel >= 19;
  },
};
FeatsList["boon of skill"] = {
  name: "Boon of Skill",
  source: [["PHB2024", 211]],
  skills: ["Athletics", "Acrobatics", "Sleight of Hand", "Stealth", "Arcana", "History", "Investigation", "Nature", "Religion", "Animal Handling", "Insight", "Medicine", "Perception", "Survival", "Deception", "Intimidation", "Performance", "Persuasion"],
  skillstxt: "You gain expertise in one skill of choice.",
  descriptionFull: "You gain the following benefits.\n \u2022 Ability Score Improvement. Increase one ability sore of your choice by 1, to a Maximum of 30.\n \u2022 All-Around Adept. You gain proficiency in all skills.\n \u2022 Expertise. Choose one skill in which you lack Expertise. You gain Expertise in that skill.",
  description: "+1 to Any, You gain Proficiency in all skills, and Expertise in one skill of choice.",
  choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
  "strength": {
    name: "Strength",
    description: "You gain Proficiency in all skills, and Expertise in one skill of choice. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
    scoresMaximum: [30, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    name: "Dexterity",
    description: "You gain Proficiency in all skills, and Expertise in one skill of choice. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
    scoresMaximum: [0, 30, 0, 0, 0, 0],
  },
  "constitution": {
    name: "Constitution",
    description: "You gain Proficiency in all skills, and Expertise in one skill of choice. [+1 constitution]",
    scores: [0, 0, 1, 0, 0, 0],
    scoresMaximum: [0, 0, 30, 0, 0, 0],
  },
  "intelligence": {
    name: "Intelligence",
    description: "You gain Proficiency in all skills, and Expertise in one skill of choice. [+1 Intelligence]",
    scores: [0, 0, 0, 1, 0, 0],
    scoresMaximum: [0, 0, 0, 30, 0, 0],
  },
  "wisdom": {
    name: "Wisdom",
    description: "You gain Proficiency in all skills, and Expertise in one skill of choice. [+1 Wisdom]",
    scores: [0, 0, 0, 0, 1, 0],
    scoresMaximum: [0, 0, 0, 0, 30, 0],
  },
  "charisma": {
    name: "Charisma",
    description: "You gain Proficiency in all skills, and Expertise in one skill of choice. [+1 Charisma]",
    scores: [0, 0, 0, 0, 0, 1],
    scoresMaximum: [0, 0, 0, 0, 0, 30],
  },
  prereqeval: function (v) {
    return v.characterLevel >= 19;
  },
};
FeatsList["boon of speed"] = {
  name: "Boon of Speed",
  source: [["PHB2024", 211]],
  descriptionFull: "You gain the following benefits.\n \u2022 Ability Score Improvement. Increase one ability sore of your choice by 1, to a Maximum of 30.\n \u2022 Escape Artist. As a Bonus Action, you can take the Disengage action, which also ends the Grappled condition on you.\n \u2022 Quickness. You Speed increases by 30 feet.",
  description: "+1 to Any, Speed +30 ft., Bonus Action to Disengage, which also ends the Grappled condition.",
  speed: {walk: "+30"},
  choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
  "strength": {
    name: "Strength",
    description: "Speed +30 ft., Bonus Action to Disengage, which also ends the Grappled condition. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
    scoresMaximum: [30, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    name: "Dexterity",
    description: "Speed +30 ft., Bonus Action to Disengage, which also ends the Grappled condition. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
    scoresMaximum: [0, 30, 0, 0, 0, 0],
  },
  "constitution": {
    name: "Constitution",
    description: "Speed +30 ft., Bonus Action to Disengage, which also ends the Grappled condition. [+1 constitution]",
    scores: [0, 0, 1, 0, 0, 0],
    scoresMaximum: [0, 0, 30, 0, 0, 0],
  },
  "intelligence": {
    name: "Intelligence",
    description: "Speed +30 ft., Bonus Action to Disengage, which also ends the Grappled condition. [+1 Intelligence]",
    scores: [0, 0, 0, 1, 0, 0],
    scoresMaximum: [0, 0, 0, 30, 0, 0],
  },
  "wisdom": {
    name: "Wisdom",
    description: "Speed +30 ft., Bonus Action to Disengage, which also ends the Grappled condition. [+1 Wisdom]",
    scores: [0, 0, 0, 0, 1, 0],
    scoresMaximum: [0, 0, 0, 0, 30, 0],
  },
  "charisma": {
    name: "Charisma",
    description: "Speed +30 ft., Bonus Action to Disengage, which also ends the Grappled condition. [+1 Charisma]",
    scores: [0, 0, 0, 0, 0, 1],
    scoresMaximum: [0, 0, 0, 0, 0, 30],
  },
  prereqeval: function (v) {
    return v.characterLevel >= 19;
  },
};
FeatsList["boon of spell recall"] = {
  name: "Boon of Spell Recall",
  source: [["PHB2024", 211]],
  descriptionFull: "You gain the following benefits.\n \u2022 Ability Score Improvement. Increase your Intelligence, Wisdom, or Charisma score by 1, to a Maximum of 30.\n \u2022 Free Casting. Whenever you cast a spell with a level 1-4 spell slot, roll1d4. If the number you roll is the same as the slot's level, the slot isn't expended.",
  description: "+1 Int/Wis/Cha, When you cast a spell level 1-4, roll 1d4 if the number rolled matches the slot's level the spell slot isn't expended.",
  choices: ["Intelligence", "Wisdom", "Charisma"],
  "intelligence": {
    name: "Intelligence",
    description: "When you cast a spell level 1-4, roll 1d4 if the number rolled matches the slot's level the spell slot isn't expended. [+1 Intelligence]",
    scores: [0, 0, 0, 1, 0, 0],
    scoresMaximum: [0, 0, 0, 30, 0, 0],
  },
  "wisdom": {
    name: "Wisdom",
    description: "When you cast a spell level 1-4, roll 1d4 if the number rolled matches the slot's level the spell slot isn't expended. [+1 Wisdom]",
    scores: [0, 0, 0, 0, 1, 0],
    scoresMaximum: [0, 0, 0, 0, 30, 0],
  },
  "charisma": {
    name: "Charisma",
    description: "When you cast a spell level 1-4, roll 1d4 if the number rolled matches the slot's level the spell slot isn't expended. [+1 Charisma]",
    scores: [0, 0, 0, 0, 0, 1],
    scoresMaximum: [0, 0, 0, 0, 0, 30],
  },
  prereqeval: function (v) {
    return v.characterLevel >= 19 && v.isSpellcaster;
  },
};
FeatsList["boon of the night spirit"] = {
  name: "Boon of the Night Spirit",
  source: [["PHB2024", 211]],
  action: [["bonus action", "Merge with Shadows"], ["reaction", "Merge with Shadows"]],
  descriptionFull: "You gain the following benefits.\n \u2022 Ability Score Improvement. Increase one ability sore of your choice by 1, to a Maximum of 30.\n \u2022 Merge with Shadows. While within Dim Light or Darkness, you can give yourself the Invisible condition as a Bonus Action, or a Reaction.\n \u2022 Shadowy Form. While within Dim Light or Darkness, you have Resistance to all damage except Psychic and Radiant.",
  description: "+1 to Any, While in Dim Light or Darkness you have Resistance to all damage except Psychic or Radiant, and as a bns/rea you can turn invisible while in Dim Light or Darkness.",
  choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
  "strength": {
    name: "Strength",
    description: "While in Dim Light or Darkness you have Resistance to all damage except Psychic or Radiant, and as a bns/rea you can turn invisible while in Dim Light or Darkness. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
    scoresMaximum: [30, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    name: "Dexterity",
    description: "While in Dim Light or Darkness you have Resistance to all damage except Psychic or Radiant, and as a bns/rea you can turn invisible while in Dim Light or Darkness. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
    scoresMaximum: [0, 30, 0, 0, 0, 0],
  },
  "constitution": {
    name: "Constitution",
    description: "While in Dim Light or Darkness you have Resistance to all damage except Psychic or Radiant, and as a bns/rea you can turn invisible while in Dim Light or Darkness. [+1 constitution]",
    scores: [0, 0, 1, 0, 0, 0],
    scoresMaximum: [0, 0, 30, 0, 0, 0],
  },
  "intelligence": {
    name: "Intelligence",
    description: "While in Dim Light or Darkness you have Resistance to all damage except Psychic or Radiant, and as a bns/rea you can turn invisible while in Dim Light or Darkness. [+1 Intelligence]",
    scores: [0, 0, 0, 1, 0, 0],
    scoresMaximum: [0, 0, 0, 30, 0, 0],
  },
  "wisdom": {
    name: "Wisdom",
    description: "While in Dim Light or Darkness you have Resistance to all damage except Psychic or Radiant, and as a bns/rea you can turn invisible while in Dim Light or Darkness. [+1 Wisdom]",
    scores: [0, 0, 0, 0, 1, 0],
    scoresMaximum: [0, 0, 0, 0, 30, 0],
  },
  "charisma": {
    name: "Charisma",
    description: "While in Dim Light or Darkness you have Resistance to all damage except Psychic or Radiant, and as a bns/rea you can turn invisible while in Dim Light or Darkness. [+1 Charisma]",
    scores: [0, 0, 0, 0, 0, 1],
    scoresMaximum: [0, 0, 0, 0, 0, 30],
  },
  prereqeval: function (v) {
    return v.characterLevel >= 19;
  },
};
FeatsList["boon of truesight"] = {
  name: "Boon of Truesight",
  source: [["PHB2024", 211]],
  vision: [["Truesight", 60]],
  descriptionFull: "You gain the following benefits.\n \u2022 Ability Score Improvement. Increase one ability sore of your choice by 1, to a Maximum of 30.\n \u2022 Truesight. You have Truesight with a range of 60 feet.",
  description: "+1 to Any, You have Truesight with a range of 60 feet..",
  choices: ["Strength", "Dexterity", "Constitution", "Intelligence", "Wisdom", "Charisma"],
  "strength": {
    name: "Strength",
    description: "You have Truesight with a range of 60 feet. [+1 Strength]",
    scores: [1, 0, 0, 0, 0, 0],
    scoresMaximum: [30, 0, 0, 0, 0, 0],
  },
  "dexterity": {
    name: "Dexterity",
    description: "You have Truesight with a range of 60 feet. [+1 Dexterity]",
    scores: [0, 1, 0, 0, 0, 0],
    scoresMaximum: [0, 30, 0, 0, 0, 0],
  },
  "constitution": {
    name: "Constitution",
    description: "You have Truesight with a range of 60 feet. [+1 constitution]",
    scores: [0, 0, 1, 0, 0, 0],
    scoresMaximum: [0, 0, 30, 0, 0, 0],
  },
  "intelligence": {
    name: "Intelligence",
    description: "You have Truesight with a range of 60 feet. [+1 Intelligence]",
    scores: [0, 0, 0, 1, 0, 0],
    scoresMaximum: [0, 0, 0, 30, 0, 0],
  },
  "wisdom": {
    name: "Wisdom",
    description: "You have Truesight with a range of 60 feet. [+1 Wisdom]",
    scores: [0, 0, 0, 0, 1, 0],
    scoresMaximum: [0, 0, 0, 0, 30, 0],
  },
  "charisma": {
    name: "Charisma",
    description: "You have Truesight with a range of 60 feet. [+1 Charisma]",
    scores: [0, 0, 0, 0, 0, 1],
    scoresMaximum: [0, 0, 0, 0, 0, 30],
  },
  prereqeval: function (v) {
    return v.characterLevel >= 19;
  },
};
//Weapons
WeaponsList["club"] = {
  name: "Club",
  infoname: "Club [1 sp]",
  source: [["PHB2024", 215]],
  regExpSearch: /club/i,
  type: "Simple",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 4, "bludgeoning"],
  range: "Melee, 5ft",
  description: "Light; Slow",
  list: "melee",
  weight: 2,
  monkweapon: true,
};
WeaponsList["dagger"] = {
  name: "Dagger",
  infoname: "Dagger [2 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /dagger/i,
  type: "Simple",
  ability: 2,
  abilitytodamage: true,
  damage: [1, 4, "piercing"],
  range: "Melee, 20/60",
  description: "Finesse, Light, Thrown (Range 20/60); Nick",
  list: "melee",
  weight: 1,
  ammo: "dagger",
  monkweapon: true,
};
WeaponsList["greatclub"] = {
  name: "Greatclub",
  infoname: "Greatclub [2 sp]",
  source: [["PHB2024", 215]],
  regExpSearch: /greatclub/i,
  type: "Simple",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 8, "bludgeoning"],
  range: "Melee, 5ft",
  description: "Two-Handed; Push",
  list: "melee",
  weight: 10,
  monkweapon: true,
};
WeaponsList["handaxe"] = {
  name: "Handaxe",
  infoname: "Handaxe [5 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /handaxe/i,
  type: "Simple",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 6, "slashing"],
  range: "Melee, 20/60",
  description: "Light, Thrown (Range 20/60); Vex",
  list: "melee",
  weight: 2,
  ammo: "axe",
  monkweapon: true,
};
WeaponsList["javelin"] = {
  name: "Javelin",
  infoname: "Javelin [5 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /javelin/i,
  type: "Simple",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 6, "piercing"],
  range: "Melee, 30/120",
  description: "Thrown (Range 30/120); Slow",
  list: "melee",
  weight: 2,
  ammo: "javelin",
  monkweapon: true,
};
WeaponsList["light hammer"] = {
  name: "Light Hammer",
  infoname: "Light Hammer [2 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /^(?=.*light)(?=.*hammer).*$/i,
  type: "Simple",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 4, "bludgeoning"],
  range: "Melee, 20/60",
  description: "Light, Thrown (Range 20/60); Nick",
  list: "melee",
  weight: 2,
  ammo: "hammer",
  monkweapon: true,
};
WeaponsList["mace"] = {
  name: "Mace",
  infoname: "Mace [5 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /mace/i,
  type: "Simple",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 6, "bludgeoning"],
  range: "Melee, 5ft",
  description: "Sap",
  list: "melee",
  weight: 4,
  monkweapon: true,
};
WeaponsList["quarterstaff"] = {
  name: "Quarterstaff",
  infoname: "Quarterstaff [2 sp]",
  source: [["PHB2024", 215]],
  regExpSearch: /quarterstaff/i,
  type: "Simple",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 6, "bludgeoning"],
  range: "Melee, 5ft",
  description: "Versatile (1d8); Topple",
  list: "melee",
  weight: 4,
  monkweapon: true,
};
WeaponsList["sickle"] = {
  name: "Sickle",
  infoname: "Sickle [1 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /sickle/i,
  type: "Simple",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 4, "slashing"],
  range: "Melee, 5ft",
  description: "Light; Nick",
  list: "melee",
  weight: 2,
  monkweapon: true,
};
WeaponsList["spear"] = {
  name: "Spear",
  infoname: "Spear [1 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /spear/i,
  type: "Simple",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 6, "piercing"],
  range: "Melee, 20/60",
  description: "Thrown (20/60), Versatile (1d8); Sap",
  list: "melee",
  weight: 3,
  ammo: "spear",
  monkweapon: true,
};
WeaponsList["dart"] = {
  name: "Dart",
  infoname: "Dart [5 cp]",
  source: [["PHB2024", 215]],
  regExpSearch: /dart/i,
  type: "Simple",
  ability: 2,
  abilitytodamage: true,
  damage: [1, 4, "piercing"],
  range: "20/60",
  description: "Finesse, Thrown (Range 20/60); Vex",
  list: "ranged",
  weight: 0.25,
  ammo: "dart",
  monkweapon: false,
};
WeaponsList["light crossbow"] = {
  name: "Light Crossbow",
  infoname: "Light Crossbow [25 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /^(?=.*light)(?=.*crossbow).*$/i,
  type: "Simple",
  ability: 2,
  abilitytodamage: true,
  damage: [1, 8, "piercing"],
  range: "80/320",
  description: "Ammunition (Range 80/320; Bolt), Loading, Two-Handed; Slow",
  list: "ranged",
  weight: 5,
  ammo: "bolt",
  monkweapon: false,
};
WeaponsList["shortbow"] = {
  name: "Shortbow",
  infoname: "Shortbow [25 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /shortbow/i,
  type: "Simple",
  ability: 2,
  abilitytodamage: true,
  damage: [1, 6, "piercing"],
  range: "80/320",
  description: "Ammunition (Range 80/320; Arrow), Two-Handed; Vex",
  list: "ranged",
  weight: 2,
  ammo: "arrow",
  monkweapon: false,
};
WeaponsList["sling"] = {
  name: "Sling",
  infoname: "Sling [1 sp]",
  source: [["PHB2024", 215]],
  regExpSearch: /sling/i,
  type: "Simple",
  ability: 2,
  abilitytodamage: true,
  damage: [1, 4, "bludgeoning"],
  range: "30/120",
  description: "Ammunition (Range 30/120; Bullet); Topple",
  list: "ranged",
  ammo: "bullet",
  monkweapon: false,
};
WeaponsList["battleaxe"] = {
  name: "Battleaxe",
  infoname: "Battleaxe [10 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /battleaxe/i,
  type: "Martial",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 8, "slashing"],
  range: "Melee, 5ft",
  description: "Versatile (1d10); Topple",
  list: "melee",
  weight: 4,
  monkweapon: false,
};
WeaponsList["flail"] = {
  name: "Flail",
  infoname: "Flail [10 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /flail/i,
  type: "Martial",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 8, "bludgeoning"],
  range: "Melee, 5ft",
  description: "Sap",
  list: "melee",
  weight: 2,
  monkweapon: false,
};
WeaponsList["glaive"] = {
  name: "Glaive",
  infoname: "Glaive [20 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /glaive/i,
  type: "Martial",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 10, "slashing"],
  range: "Melee, 10ft",
  description: "Heavy, Reach, Two-Handed; Graze",
  list: "melee",
  weight: 6,
  monkweapon: false,
};
WeaponsList["greataxe"] = {
  name: "Greataxe",
  infoname: "Greataxe [30 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /greataxe/i,
  type: "Martial",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 12, "slashing"],
  range: "Melee, 5ft",
  description: "Heavy, Two-Handed; Cleave",
  list: "melee",
  weight: 7,
  monkweapon: false,
};
WeaponsList["greatsword"] = {
  name: "Greatsword",
  infoname: "Greatsword [50 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /greatsword/i,
  type: "Martial",
  ability: 1,
  abilitytodamage: true,
  damage: [2, 6, "slashing"],
  range: "Melee, 5ft",
  description: "Heavy, Two-Handed; Graze",
  list: "melee",
  weight: 6,
  monkweapon: false,
};
WeaponsList["halberd"] = {
  name: "Halberd",
  infoname: "Halberd [20 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /halberd/i,
  type: "Martial",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 10, "slashing"],
  range: "Melee, 10ft",
  description: "Heavy, Reach, Two-Handed; Cleave",
  list: "melee",
  weight: 6,
  monkweapon: false,
};
WeaponsList["lance"] = {
  name: "Lance",
  infoname: "Lance [10 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /lance/i,
  type: "Martial",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 10, "piercing"],
  range: "Melee, 10ft",
  description: "Heavy, Reach, Two-Handed (unless mounted); Topple",
  list: "melee",
  weight: 6,
  monkweapon: false,
};
WeaponsList["longsword"] = {
  name: "Longsword",
  infoname: "Longsword [15 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /longsword/i,
  type: "Martial",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 8, "slashing"],
  range: "Melee, 5ft",
  description: "Versatile (1d10); Sap",
  list: "melee",
  weight: 3,
  monkweapon: false,
};
WeaponsList["maul"] = {
  name: "Maul",
  infoname: "Maul [10 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /maul/i,
  type: "Martial",
  ability: 1,
  abilitytodamage: true,
  damage: [2, 6, "bludgeoning"],
  range: "Melee, 5ft",
  description: "Heavy, Two-Handed; Topple",
  list: "melee",
  weight: 10,
  monkweapon: false,
};
WeaponsList["morningstar"] = {
  name: "Morningstar",
  infoname: "Morningstar [15 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /morningstar/i,
  type: "Martial",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 8, "piercing"],
  range: "Melee, 5ft",
  description: "Sap",
  list: "melee",
  weight: 4,
  monkweapon: false,
};
WeaponsList["pike"] = {
  name: "Pike",
  infoname: "Pike [5 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /pike/i,
  type: "Martial",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 10, "piercing"],
  range: "Melee, 10ft",
  description: "Heavy, Reach, Two-Handed; Push",
  list: "melee",
  weight: 18,
  monkweapon: false,
};
WeaponsList["rapier"] = {
  name: "Rapier",
  infoname: "Rapier [25 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /rapier/i,
  type: "Martial",
  ability: 2,
  abilitytodamage: true,
  damage: [1, 8, "piercing"],
  range: "Melee, 5ft",
  description: "Finesse; Vex",
  list: "melee",
  weight: 2,
  monkweapon: false,
};
WeaponsList["scimitar"] = {
  name: "Scimitar",
  infoname: "Scimitar [25 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /scimitar/i,
  type: "Martial",
  ability: 2,
  abilitytodamage: true,
  damage: [1, 6, "slashing"],
  range: "Melee, 5ft",
  description: "Finesse, Light; Nick",
  list: "melee",
  weight: 3,
  monkweapon: true,
};
WeaponsList["shortsword"] = {
  name: "Shortsword",
  infoname: "Shortsword [10 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /shortsword/i,
  type: "Martial",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 6, "piercing"],
  range: "Melee, 5ft",
  description: "Finesse, Light; Vex",
  list: "melee",
  weight: 2,
  monkweapon: true,
};
WeaponsList["trident"] = {
  name: "Trident",
  infoname: "Trident [5 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /trident/i,
  type: "Martial",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 8, "piercing"],
  range: "Melee, 5ft",
  description: "Thrown (Range 20/60), Versatile (1d10); Topple",
  list: "melee",
  weight: 4,
  ammo: "trident",
  monkweapon: false,
};
WeaponsList["warhammer"] = {
  name: "Warhammer",
  infoname: "Warhammer [15 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /warhammer/i,
  type: "Martial",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 8, "bludgeoning"],
  range: "Melee, 5ft",
  description: "Versatile (1d10); Push",
  list: "melee",
  weight: 5,
  monkweapon: false,
};
WeaponsList["war pick"] = {
  name: "War Pick",
  infoname: "War Pick [5 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /^(?=.*war)(?=.*pick).*$/i,
  type: "Martial",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 8, "piercing"],
  range: "Melee, 5ft",
  description: "Versatile (1d10); Sap",
  list: "melee",
  weight: 2,
  monkweapon: false,
};
WeaponsList["whip"] = {
  name: "Whip",
  infoname: "Whip [2 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /whip/i,
  type: "Martial",
  ability: 1,
  abilitytodamage: true,
  damage: [1, 4, "slashing"],
  range: "Melee, 10ft",
  description: "Finesse, Reach; Slow",
  list: "melee",
  weight: 3,
  monkweapon: false,
};
WeaponsList["blowgun"] = {
  name: "Blowgun",
  infoname: "Blowgun [10 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /blowgun/i,
  type: "Martial",
  ability: 2,
  abilitytodamage: true,
  damage: [1, "", "piercing"],
  range: "25/100",
  description: "Ammunition (Range 25/100; Needle), Loading; Vex",
  list: "ranged",
  weight: 1,
  ammo: "needle",
  monkweapon: false,
};
WeaponsList["hand crossbow"] = {
  name: "Hand Crossbow",
  infoname: "Hand Crossbow [75 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /^(?=.*hand)(?=.*crossbow).*$/i,
  type: "Martial",
  ability: 2,
  abilitytodamage: true,
  damage: [1, 6, "piercing"],
  range: "30/120",
  description: "Ammunition (Range 30/120; Bolt), Light, Loading; Vex",
  list: "ranged",
  weight: 3,
  ammo: "bolt",
  monkweapon: false,
};
WeaponsList["heavy crossbow"] = {
  name: "Heavy Crossbow",
  infoname: "Heavy Crossbow [50 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /^(?=.*heavy)(?=.*crossbow).*$/i,
  type: "Martial",
  ability: 2,
  abilitytodamage: true,
  damage: [1, 10, "piercing"],
  range: "100/400",
  description: "Ammunition (Range 100/400; Bolt), Heavy, Loading, Two-Handed; Push",
  list: "ranged",
  weight: 18,
  ammo: "bolt",
  monkweapon: false,
};
WeaponsList["longbow"] = {
  name: "Longbow",
  infoname: "Longbow [50 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /longbow/i,
  type: "Martial",
  ability: 2,
  abilitytodamage: true,
  damage: [1, 8, "piercing"],
  range: "150/600",
  description: "Ammunition (Range 150/600; Arrow), Light; Slow",
  list: "ranged",
  weight: 2,
  ammo: "arrow",
  monkweapon: false,
};
WeaponsList["musket"] = {
  name: "Musket",
  infoname: "Musket [500 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /musket/i,
  type: "Martial",
  ability: 2,
  abilitytodamage: true,
  damage: [1, 12, "piercing"],
  range: "40/120",
  description: "Ammunition (Range 40/120; Bullet), Loading, Two-Handed; Slow",
  list: "ranged",
  weight: 10,
  ammo: "bullet",
  monkweapon: false,
};
WeaponsList["pistol"] = {
  name: "Pistol",
  infoname: "Pistol [250 gp]",
  source: [["PHB2024", 215]],
  regExpSearch: /pistol/i,
  type: "Martial",
  ability: 2,
  abilitytodamage: true,
  damage: [1, 10, "piercing"],
  range: "30/90",
  description: "Ammunition (Range 30/90; Bullet), Loading; Vex",
  list: "ranged",
  weight: 3,
  ammo: "bullet",
  monkweapon: false,
};
WeaponsList["vial of acid"] = {
  name: "Vial of Acid",
  source: [["PHB2024", 222]],
  regExpSearch: /^(?=.*vial)(?=.*acid).*$/i,
  list: "improvised",
  ability: 2,
  type: "Improvised Weapons",
  dc: true,
  damage: [2, 6, "acid"],
  range: "20 ft.",
  weight: 1,
  description: "",
  abilitytodamage: false,
  isAlwaysProf: true,
  ammo: "vials of acid",
  isNotWeapon: true,
};
WeaponsList["alchemist fire"] = {
  name: "Alchemist's Fire",
  source: [["PHB2024", 222]],
  regExpSearch: /^(?=.*alchemist)(?=.*fire).*$/i,
  list: "improvised",
  ability: 2,
  type: "Improvised Weapons",
  dc: true,
  damage: [1, 4, "fire"],
  range: "20 ft.",
  weight: 1,
  description: "Target +1d4 at the start of each of its turns; Can end if target falls prone and uses their action to extinguish.",
  abilitytodamage: false,
  isAlwaysProf: true,
  ammo: "alchemist fire",
  isNotWeapon: true,
};
WeaponsList["holy water"] = {
  name: "Holy Water",
  source: [["PHB2024", 226]],
  regExpSearch: /^(?=.*holy)(?=.*water).*$/i,
  list: "improvised",
  ability: 2,
  type: "Improvised Weapons",
  dc: true,
  damage: [2, 6, "radiant"],
  range: "20 ft.",
  weight: 1,
  description: "Only does damage against fiends and undead; Comes in flasks",
  abilitytodamage: false,
  ammo: "holy water",
  isNotWeapon: true
};
WeaponsList["acid splash"] = {
  regExpSearch: /^(?=.*acid)(?=.*splash).*$/i,
  name: "Acid Splash",
  source: [["PHB2024", 239]],
  list: "spell",
  ability: 4,
  type: "Cantrip",
  damage: ["C", 6, "acid"],
  range: "60 ft.",
  description: "5ft rad. sphere Dex save, success - no damage;",
  abilitytodamage: false,
  dc: true
};
WeaponsList["chill touch"] = {
  regExpSearch: /^(?=.*chill)(?=.*touch).*$/i,
  name: "Chill Touch",
  source: [["PHB2024", 249]],
  list: "spell",
  ability: 6,
  type: "Cantrip",
  damage: ["C", 10, "necrotic"],
  range: "Touch",
  description: "Target can't regain HP; Undead dis. on attacks vs. me until my next turn",
  abilitytodamage: false
};
WeaponsList["eldritch blast"] = {
  regExpSearch: /(agonizing|eldritch|repelling).(spear|blast)/i,
  name: "Eldritch Blast",
  source: [["PHB2024", 267]],
  list: "spell",
  ability: 6,
  type: "Cantrip",
  damage: ["C\xD7" + 1, 10, "force"],
  range: "120 ft.",
  description: "Each d10 is a separate beam requiring separate rolls",
  abilitytodamage: false
};
WeaponsList["fire bolt"] = {
  regExpSearch: /^(?=.*fire)(?=.*bolt).*$/i,
  name: "Fire Bolt",
  source: [["PHB2024", 274]],
  list: "spell",
  ability: 6,
  type: "Cantrip",
  damage: ["C", 10, "fire"],
  range: "120 ft.",
  description: "Unattended flammable objects ignite",
  abilitytodamage: false
};
WeaponsList["mind sliver"] = {
  regExpSearch: /^(?=.*mind)(?=.*sliver).*$/i,
  name: "Mind Sliver",
  source: [["PHB2024", 298]],
  list: "spell",
  ability: 6,
  type: "Cantrip",
  damage: ["C", 6, "psychic"],
  range: "60 ft.",
  description: "1 creature Int save, success - no damage, fail - also -1d4 on first save before my next turn ends",
  abilitytodamage: false,
  dc: true
};
WeaponsList["poison spray"] = {
  regExpSearch: /^(?=.*poison)(?=.*spray).*$/i,
  name: "Poison Spray",
  source: [["PHB2024", 306]],
  list: "spell",
  ability: 6,
  type: "Cantrip",
  damage: ["C", 12, "poison"],
  range: "30 ft.",
  description: "Spell attack; 1 creature",
  abilitytodamage: false,
  dc: false,
};
WeaponsList["produce flame"] = {
  regExpSearch: /^(?=.*produce)(?=.*flame).*$/i,
  name: "Produce Flame",
  source: [["PHB2024", 308]],
  list: "spell",
  ability: 5,
  type: "Cantrip",
  damage: ["C", 8, "fire"],
  range: "30 ft.",
  description: "10-ft. radius bright light and 10-ft. radius dim light until thrown",
  abilitytodamage: false
};
WeaponsList["ray of frost"] = {
  regExpSearch: /^(?=.*ray)(?=.*frost).*$/i,
  name: "Ray of Frost",
  source: [["PHB2024", 311]],
  list: "spell",
  ability: 6,
  type: "Cantrip",
  damage: ["C", 8, "cold"],
  range: "60 ft.",
  description: "Target -10 ft. speed until start of my next turn",
  abilitytodamage: false
};
WeaponsList["sacred flame"] = {
  regExpSearch: /^(?=.*sacred)(?=.*flame).*$/i,
  name: "Sacred Flame",
  source: [["PHB2024", 313]],
  list: "spell",
  ability: 5,
  type: "Cantrip",
  damage: ["C", 8, "radiant"],
  range: "60 ft.",
  description: "Dex save, no bonus from cover, success - no damage; 1 creature",
  abilitytodamage: false,
  dc: true
};
WeaponsList["shillelagh"] = {
  baseWeapon: "quarterstaff",
  regExpSearch: /shillelagh/i,
  name: "Shillelagh",
  source: [["PHB2024", 316]],
  list: "spell",
  ability: 5,
  type: "Simple",
  damage: [1, 8, "bludgeoning"],
  range: "Melee",
  description: "Imbued club or quarterstaff; Counts as a magical weapon; 1d10 lvl 5, 1d12 lvl 11, 2d6 lvl 17",
  monkweapon: true,
  abilitytodamage: true
};
WeaponsList["shocking grasp"] = {
  regExpSearch: /^(?=.*shocking)(?=.*grasp).*$/i,
  name: "Shocking Grasp",
  source: [["PHB2024", 316]],
  list: "spell",
  ability: 6,
  type: "Cantrip",
  damage: ["C", 8, "lightning"],
  range: "Melee",
  description: "Advantage if target is wearing metal armor, target cannot take reactions until its next turn",
  abilitytodamage: false
};
WeaponsList["sorcerous burst"] = {
  regExpSearch: /^(?=.*sorcerous)(?=.*burst).*$/i,
  name: "Sorcerous Burst",
  source: [["PHB2024", 318]],
  list: "spell",
  ability: 6,
  type: "Cantrip",
  damage: ["C", 8, "acid"],
  range: "120 ft.",
  description: "(Acid/Cold/Fire/Lightn/Pois/Psy/Thund) dmg; if you roll an 8 add 1d8 dmg(you can add a number of d8's equal to spell mod)",
  abilitytodamage: false
};
WeaponsList["starry wisp"] = {
  regExpSearch: /^(?=.*starry)(?=.*wisp).*$/i,
  name: "Starry Wisp",
  source: [["PHB2024", 320]],
  list: "spell",
  ability: 6,
  type: "Cantrip",
  damage: ["C", 8, "radiant"],
  range: "60 ft.",
  description: "target emit dim light in a 10ft rad. can't benefit from Invis.",
  abilitytodamage: false
};
WeaponsList["thorn whip"] = {
  regExpSearch: /^(?=.*thorn)(?=.*whip).*$/i,
  name: "Thorn Whip",
  source: [["PHB2024", 333]],
  list: "spell",
  ability: 5,
  type: "Cantrip",
  damage: ["C", 6, "piercing"],
  range: "Melee, 30 ft.",
  description: "Melee spell attack, pull target up to 10 ft. closer",
  abilitytodamage: false
};
WeaponsList["thunderclap"] = {
  regExpSearch: /thunderclap/i,
  name: "Thunderclap",
  source: [["PHB2024", 333]],
  list: "spell",
  ability: 6,
  type: "Cantrip",
  damage: ["C", 6, "thunder"],
  range: "5-ft. radius",
  description: "Con save, success - no damage; all creatures in area; audible in 100 ft.",
  abilitytodamage: false,
  dc: true
};
WeaponsList["vicious mockery"] = {
  regExpSearch: /^(?=.*vicious)(?=.*mockery).*$/i,
  name: "Vicious Mockery",
  source: [["PHB2024", 337]],
  list: "spell",
  ability: 6,
  type: "Cantrip",
  damage: ["C", 6, "psychic"],
  range: "60 ft.",
  description: "Wis save, success - no damage, fail - also disadv. on next attack roll in next turn; 1 creature",
  abilitytodamage: false,
  dc: true
};
WeaponsList["word of radiance"] = {
  regExpSearch: /^(?=.*word)(?=.*radiance).*$/i,
  name: "Word of Radiance",
  source: [["PHB2024", 343]],
  list: "spell",
  ability: 5,
  type: "Cantrip",
  damage: ["C", 6, "radiant"],
  range: "5-ft. radius",
  description: "Con save, success - no damage; Only chosen creatures I can see are affected",
  abilitytodamage: false,
  dc: true
};
//Ammo
AmmoList["arrows"] = {
  name: "Arrows",
  infoname: "Arrows [1 gp]",
  source: [["PHB2024", 222]],
  icon: "Arrows",
  amount: 20,
  weight: 0.05,
};
AmmoList["bolts"] = {
  name: "Bolts",
  infoname: "Bolts [1 gp]",
  source: [["PHB2024", 222]],
  icon: "Arrows",
  invName: "Crossbow bolts",
  weight: 0.075,
};
AmmoList["bullets, firearm"] = {
  name: "Bullets, Firearm",
  infoname: "Bullets, Firearm [3 gp]",
  source: [["PHB2024", 222]],
  icon: "Bullets",
  invName: "Firearm bullets",
  weight: 0.1,
};
AmmoList["bullets, sling"] = {
  name: "Bullets, Sling",
  infoname: "Bullets, Sling [4 cp]",
  source: [["PHB2024", 222]],
  icon: "Arrows",
  invName: "Sling bullets",
  weight: 0.075,
};
AmmoList["needles"] = {
  name: "Needles",
  infoname: "Needles [1 gp]",
  source: [["PHB2024", 222]],
  invName: "Blowgun needles",
  amount: 50,
  weight: 0.02,
};
AmmoList["dagger"] = {
  name: "Daggers",
  source: [["PHB2024", 215]],
  weight: 1,
  icon: "Daggers"
};
AmmoList["dart"] = {
  name: "Darts",
  source: [["PHB2024", 215]],
  weight: 0.25,
  icon: "Arrows"
};
AmmoList["flask"] = {
  name: "Flasks (1 pint)",
  source: [["PHB2024", 215]],
  weight: 1,
  icon: "Flasks"
};
AmmoList["handaxe"] = {
  name: "Handaxes",
  source: [["PHB2024", 215]],
  weight: 2,
  icon: "Axes",
  alternatives: ["axe"]
};
AmmoList["javelin"] = {
  name: "Javelins",
  source: [["PHB2024", 215]],
  weight: 2,
  icon: "Spears"
};
AmmoList["light hammer"] = {
  name: "Light Hammers",
  source: [["PHB2024", 215]],
  weight: 2,
  icon: "Hammers",
  alternatives: ["hammer"]
};
AmmoList["spear"] = {
  name: "Spears",
  source: [["PHB2024", 215]],
  weight: 3,
  icon: "Spears"
};
AmmoList["trident"] = {
  name: "Tridents",
  source: [["PHB2024", 215]],
  weight: 4,
  icon: "Spears"
};
AmmoList["vial"] = {
  name: "Vials (4 ounces)",
  source: [["PHB2024", 215]],
  weight: 0.25,
  icon: "Vials"
};
AmmoList["alchemist fire"] = {
  name: "Alchemist's Fire, flasks",
  source: [["PHB2024", 215]],
  weight: 1,
  icon: "Flasks",
  invName: "Alchemist's fire, flasks of",
  alternatives: [/^(?=.*alchemist)(?=.*fire).*$/i]
};
AmmoList["vials of acid"] = {
  name: "Vials of Acid",
  source: [["PHB2024", 215]],
  weight: 1,
  icon: "Vials",
  invName: "Acid, vials of",
  alternatives: [/^(?=.*acid)(?=.*vial).*$/i]
};
AmmoList["holy water"] = {
  name: "Holy Water, flasks",
  source: [["PHB2024", 215]],
  weight: 1,
  icon: "Flasks",
  invName: "Holy Water, flasks of",
  alternatives: [/^(?=.*holy)(?=.*water).*$/i]
};
//Armour
ArmourList["padded armor"] = {
  name: "Padded Armor",
  infoname: "Padded Armor [5 gp]",
  source: [["PHB2024", 219]],
  regExpSearch: /^(?=.*padded)(?=.*armor).*$/i,
  ac: 11,
  type: "light",
  stealthdis: true,
  weight: 8,
};
ArmourList["leather armor"] = {
  name: "Leather Armor",
  infoname: "Leather Armor [10 gp]",
  source: [["PHB2024", 219]],
  regExpSearch: /^(?=.*leather)(?=.*armor).*$/i,
  ac: 11,
  type: "light",
  stealthdis: false,
  weight: 10,
};
ArmourList["studded leather armor"] = {
  name: "Studded Leather Armor",
  infoname: "Studded Leather Armor [45 gp]",
  source: [["PHB2024", 219]],
  regExpSearch: /^(?=.*studded)(?=.*leather)(?=.*armor).*$/i,
  ac: 12,
  type: "light",
  stealthdis: false,
  weight: 13,
};
ArmourList["hide armor"] = {
  name: "Hide Armor",
  infoname: "Hide Armor [10 gp]",
  source: [["PHB2024", 219]],
  regExpSearch: /^(?=.*hide)(?=.*armor).*$/i,
  ac: 12,
  type: "medium",
  stealthdis: false,
  weight: 12,
};
ArmourList["chain shirt"] = {
  name: "Chain Shirt",
  infoname: "Chain Shirt [50 gp]",
  source: [["PHB2024", 219]],
  regExpSearch: /^(?=.*chain)(?=.*shirt).*$/i,
  ac: 13,
  type: "medium",
  stealthdis: false,
  weight: 20,
};
ArmourList["scale mail"] = {
  name: "Scale Mail",
  infoname: "Scale Mail [50 gp]",
  source: [["PHB2024", 219]],
  regExpSearch: /^(?=.*Scale)(?=.*mail).*$/i,
  ac: 14,
  type: "medium",
  stealthdis: true,
  weight: 45,
};
ArmourList["breastplate"] = {
  name: "Breastplate",
  infoname: "Breastplate [400 gp]",
  source: [["PHB2024", 219]],
  regExpSearch: /breastplate/i,
  ac: 14,
  type: "medium",
  stealthdis: false,
  weight: 20,
};
ArmourList["half plate"] = {
  name: "Half Plate",
  infoname: "Half Plate [750 gp]",
  source: [["PHB2024", 219]],
  regExpSearch: /^(?=.*half)(?=.*plate).*$/i,
  ac: 15,
  type: "medium",
  stealthdis: true,
  weight: 40,
};
ArmourList["ring mail"] = {
  name: "Ring Mail",
  infoname: "Ring Mail [30 gp]",
  source: [["PHB2024", 219]],
  regExpSearch: /^(?=.*ring)(?=.*mail).*$/i,
  ac: 14,
  type: "heavy",
  stealthdis: true,
  weight: 40,
};
ArmourList["chain mail"] = {
  name: "Chain Mail",
  infoname: "Chain Mail [75 gp]",
  source: [["PHB2024", 219]],
  regExpSearch: /^(?=.*chain)(?=.*mail).*$/i,
  ac: 16,
  type: "heavy",
  stealthdis: true,
  weight: 55,
  strReq: 13,
};
ArmourList["splint armor"] = {
  name: "Splint Armor",
  infoname: "Splint Armor [200 gp]",
  source: [["PHB2024", 219]],
  regExpSearch: /^(?=.*splint)(?=.*armor).*$/i,
  ac: 17,
  type: "heavy",
  stealthdis: true,
  weight: 60,
  strReq: 15,
};
ArmourList["plate armor"] = {
  name: "Plate Armor",
  infoname: "Plate Armor [1500 gp]",
  source: [["PHB2024", 219]],
  regExpSearch: /^(?=.*plate)(?=.*armor).*$/i,
  ac: 18,
  type: "heavy",
  stealthdis: true,
  weight: 65,
  strReq: 15,
};
//Tools
ToolsList["alchemist's supplies"] = {
  infoname: "Alchemist's Supplies [50 gp]",
  name: "Alchemist's Supplies",
  weight: 8,
  type: "artisan's tools",
  source: [["PHB2024", 220]],
};
ToolsList["brewer's supplies"] = {
  infoname: "Brewer's Supplies [20 gp]",
  name: "Brewer's Supplies",
  weight: 9,
  type: "artisan's tools",
  source: [["PHB2024", 220]],
};
ToolsList["calligrapher's supplies"] = {
  infoname: "Calligrapher's Supplies [10 gp]",
  name: "Calligrapher's Supplies",
  weight: 5,
  type: "artisan's tools",
  source: [["PHB2024", 220]],
};
ToolsList["carpenter's tools"] = {
  infoname: "Carpenter's Tools [8 gp]",
  name: "Carpenter's Tools",
  weight: 6,
  type: "artisan's tools",
  source: [["PHB2024", 220]],
};
ToolsList["cartographer's tools"] = {
  infoname: "Cartographer's Tools [15 gp]",
  name: "Cartographer's Tools",
  weight: 6,
  type: "artisan's tools",
  source: [["PHB2024", 220]],
};
ToolsList["cobbler's tools"] = {
  infoname: "Cobbler's tools [5 gp]",
  name: "Cobbler's Tools",
  weight: 5,
  type: "artisan's tools",
  source: [["PHB2024", 220]],
};
ToolsList["cook's utensils"] = {
  infoname: "Cook's Utensils [1 gp]",
  name: "Cook's Utensils",
  weight: 8,
  type: "artisan's tools",
  source: [["PHB2024", 220]],
};
ToolsList["glassblower's tools"] = {
  infoname: "Glassblower's Tools [30 gp]",
  name: "Glassblower's Tools",
  weight: 5,
  type: "artisan's tools",
  source: [["PHB2024", 220]],
};
ToolsList["jeweler's tools"] = {
  infoname: "Jeweler's Tools [20 gp]",
  name: "Jeweler's Tools",
  weight: 2,
  type: "artisan's tools",
  source: [["PHB2024", 220]],
};
ToolsList["leatherworker's tools"] = {
  infoname: "Leatherworker's Tools [5 gp]",
  name: "Leatherworker's tools",
  weight: 5,
  type: "artisan's tools",
  source: [["PHB2024", 220]],
};
ToolsList["mason's tools"] = {
  infoname: "Mason's Tools [10 gp]",
  name: "Mason's Tools",
  weight: 8,
  type: "artisan's tools",
  source: [["PHB2024", 221]],
};
ToolsList["painter's supplies"] = {
  infoname: "Painter's Supplies [10 gp]",
  name: "Painter's Supplies",
  weight: 5,
  type: "artisan's tools",
  source: [["PHB2024", 221]],
};
ToolsList["potter's tools"] = {
  infoname: "Potter's Tools [10 gp]",
  name: "Potter's Tools",
  weight: 3,
  type: "artisan's tools",
  source: [["PHB2024", 221]],
};
ToolsList["smith's tools"] = {
  infoname: "Smith's Tools [20 gp]",
  name: "Smith's Tools",
  weight: 8,
  type: "artisan's tools",
  source: [["PHB2024", 221]],
};
ToolsList["tinker's tools"] = {
  infoname: "Tinker's Tools [50 gp]",
  name: "Tinker's Tools",
  weight: 10,
  type: "artisan's tools",
  source: [["PHB2024", 221]],
};
ToolsList["weaver's tools"] = {
  infoname: "Weaver's Tools [1 gp]",
  name: "Weaver's Tools",
  weight: 5,
  type: "artisan's tools",
  source: [["PHB2024", 221]],
};
ToolsList["woodcarver's tools"] = {
  infoname: "Woodcarver's Tools [1 gp]",
  name: "Woodcarver's Tools",
  weight: 5,
  type: "artisan's tools",
  source: [["PHB2024", 221]],
};
ToolsList["disguise kit"] = {
  infoname: "Disguise Kit [25 gp]",
  name: "Disguise Kit",
  weight: 3,
  source: [["PHB2024", 221]],
};
ToolsList["forgery kit"] = {
  infoname: "Forgery Kit [15 gp]",
  name: "Forgery Kit",
  weight: 5,
  source: [["PHB2024", 221]],
};
ToolsList["dice"] = {
  infoname: "Dice [1 sp]",
  name: "Dice",
  weight: "",
  type: "gaming set",
  source: [["PHB2024", 221]],
};
ToolsList["dragonchess"] = {
  infoname: "Dragonchess [1 gp]",
  name: "Dragonchess",
  weight: "",
  type: "gaming set",
  source: [["PHB2024", 221]],
};
ToolsList["playing cards"] = {
  infoname: "Playing Cards [5 sp]",
  name: "Playing Cards",
  weight: "",
  type: "gaming set",
  source: [["PHB2024", 221]],
};
ToolsList["three-dragon ante"] = {
  infoname: "Three-Dragon Ante [1 gp]",
  name: "Three-Dragon Ante",
  weight: "",
  type: "gaming set",
  source: [["PHB2024", 221]],
};
ToolsList["herbalism kit"] = {
  infoname: "Herbalism Kit [5 gp]",
  name: "Herbalism Kit",
  weight: 3,
  source: [["PHB2024", 221]],
};
ToolsList["bagpipes"] = {
  infoname: "Bagpipes [30 gp]",
  name: "Bagpipes",
  weight: 6,
  type: "musical instrument",
  source: [["PHB2024", 221]],
};
ToolsList["drum"] = {
  infoname: "Drum [6 gp]",
  name: "Drum",
  weight: 3,
  type: "musical instrument",
  source: [["PHB2024", 221]],
};
ToolsList["dulcimer"] = {
  infoname: "Dulcimer [25 gp]",
  name: "Dulcimer",
  weight: 10,
  type: "musical instrument",
  source: [["PHB2024", 221]],
};
ToolsList["flute"] = {
  infoname: "Flute [2 gp]",
  name: "Flute",
  weight: 1,
  type: "musical instrument",
  source: [["PHB2024", 221]],
};
ToolsList["horn"] = {
  infoname: "Horn [3 gp]",
  name: "Horn",
  weight: 2,
  type: "musical instrument",
  source: [["PHB2024", 221]],
};
ToolsList["lute"] = {
  infoname: "Lute [35 gp]",
  name: "Lute",
  weight: 2,
  type: "musical instrument",
  source: [["PHB2024", 221]],
};
ToolsList["lyre"] = {
  infoname: "Lyre [30 gp]",
  name: "Lyre",
  weight: 2,
  type: "musical instrument",
  source: [["PHB2024", 221]],
};
ToolsList["pan flute"] = {
  infoname: "Pan Flute [12 gp]",
  name: "Pan Flute",
  weight: 2,
  type: "musical instrument",
  source: [["PHB2024", 221]],
};
ToolsList["shawm"] = {
  infoname: "Shawm [2 gp]",
  name: "Shawm",
  weight: 1,
  type: "musical instrument",
  source: [["PHB2024", 221]],
};
ToolsList["viol"] = {
  infoname: "Viol [30 gp]",
  name: "Viol",
  weight: 1,
  type: "musical instrument",
  source: [["PHB2024", 221]],
};
ToolsList["navigator's tools"] = {
  infoname: "Navigator's Tools [25 gp]",
  name: "Navigator's Tools",
  weight: 2,
  source: [["PHB2024", 221]],
};
ToolsList["poisoner's kit"] = {
  infoname: "Poisoner's Kit [50 gp]",
  name: "Poisoner's Kit",
  weight: 2,
  source: [["PHB2024", 221]],
};
ToolsList["thieves' tools"] = {
  infoname: "Thieves' Tools [25 gp]",
  name: "Thieves' Tools",
  weight: 1,
  source: [["PHB2024", 221]],
};
//Gear
GearList["acid"] = {
  infoname: "Acid [25 gp]",
  name: "Acid",
  amount: "",
  weight: 1,
};
GearList["alchemist's fire"] = {
  infoname: "Alchemist's Fire [50 gp]",
  name: "Alchemist's Fire",
  amount: "",
  weight: 1,
};
GearList["animal feed (1 day)"] = {
  infoname: "Animal feed (1 day) [5 cp]",
  name: "Animal feed, days of",
  amount: 1,
  weight: 10
};
GearList["arrows (20)"] = {
  infoname: "Arrows (20) [1 gp]",
  name: "Arrows",
  amount: 20,
  weight: 0.05,
  type: "ammunition"
};
GearList["blowgun needles (50)"] = {
  infoname: "Blowgun needles (50) [1 gp]",
  name: "Blowgun needles",
  amount: 50,
  weight: 0.02,
  type: "ammunition"
};
GearList["crossbow bolts (20)"] = {
  infoname: "Crossbow bolts (20) [1 gp]",
  name: "Crossbow bolts",
  amount: 20,
  weight: 0.075,
  type: "ammunition"
};
GearList["firearm bullets (10)"] = {
  infoname: "Firearm bullets (10) [3 gp]",
  name: "Firearm Bullets",
  amount: 10,
  weight: 0.2,
  type: "ammunition",
};
GearList["sling bullets (20)"] = {
  infoname: "Sling bullets (20) [4 cp]",
  name: "Sling bullets",
  amount: 20,
  weight: 0.075,
  type: "ammunition"
};
GearList["antitoxin"] = {
  infoname: "Antitoxin [50 gp]",
  name: "Antitoxin",
  amount: "",
  weight: "",
};
GearList["crystal"] = {
  infoname: "Crystal [10 gp]",
  name: "Crystal arcane focus",
  amount: "",
  weight: 1,
  type: "arcane focus"
};
GearList["orb"] = {
  infoname: "Orb [20 gp]",
  name: "Orb arcane focus",
  amount: "",
  weight: 3,
  type: "arcane focus"
};
GearList["rod"] = {
  infoname: "Rod [10 gp]",
  name: "Rod arcane focus",
  amount: "",
  weight: 2,
  type: "arcane focus"
};
GearList["staff"] = {
  infoname: "Staff [5 gp]",
  name: "Staff arcane focus",
  amount: "",
  weight: 4,
  type: "arcane focus"
};
GearList["wand"] = {
  infoname: "Wand [10 gp]",
  name: "Wand arcane focus",
  amount: "",
  weight: 1,
  type: "arcane focus"
};
GearList["backpack"] = {
  infoname: "Backpack [2 gp]",
  name: "Backpack",
  amount: "",
  weight: 5
};
GearList["ball bearings (bag of 1,000)"] = {
  infoname: "Ball bearings (bag of 1,000) [1 gp]",
  name: "Bag of 1000 ball bearings",
  amount: "",
  weight: 2
};
GearList["barrel"] = {
  infoname: "Barrel [2 gp]",
  name: "Barrel",
  amount: "",
  weight: 70
};
GearList["basket"] = {
  infoname: "Basket [4 sp]",
  name: "Basket",
  amount: "",
  weight: 2
};
GearList["bedroll"] = {
  infoname: "Bedroll [1 gp]",
  name: "Bedroll",
  amount: "",
  weight: 7
};
GearList["bell"] = {
  infoname: "Bell [1 gp]",
  name: "Bell",
  amount: "",
  weight: ""
};
GearList["blanket"] = {
  infoname: "Blanket [5 sp]",
  name: "Blanket",
  amount: "",
  weight: 3
};
GearList["block and tackle"] = {
  infoname: "Block and tackle [1 gp]",
  name: "Block and tackle",
  amount: "",
  weight: 5
};
GearList["book"] = {
  infoname: "Book [25 gp]",
  name: "Book",
  amount: "",
  weight: 5
};
GearList["bottle, glass"] = {
  infoname: "Bottle, glass [2 gp]",
  name: "Glass bottle",
  amount: "",
  weight: 2
};
GearList["bucket"] = {
  infoname: "Bucket [5 sp]",
  name: "Bucket",
  amount: "",
  weight: 2
};
GearList["caltrops"] = {
  infoname: "Caltrops [1 gp]",
  name: "Caltrops",
  amount: 20,
  weight: 0.1
};
GearList["candle"] = {
  infoname: "Candle [1 cp]",
  name: "Candle",
  amount: "",
  weight: ""
};
GearList["case, crossbow bolt"] = {
  infoname: "Case, crossbow bolt [1 gp]",
  name: "Crossbow bolt case",
  amount: "",
  weight: 1
};
GearList["case, map or scroll"] = {
  infoname: "Case, map or scroll [1 gp]",
  name: "Map or scroll case",
  amount: "",
  weight: 1
};
GearList["chain (10 feet)"] = {
  infoname: "Chain (10 feet) [5 gp]",
  name: "Chain, feet of",
  amount: 10,
  weight: 1
};
GearList["chest"] = {
  infoname: "Chest [5 gp]",
  name: "Chest",
  amount: "",
  weight: 25
};
GearList["climber's kit"] = {
  infoname: "Climber's kit [25 gp]",
  name: "Climber's kit",
  amount: "",
  weight: 12
};
GearList["costume"] = {
  infoname: "Costume [5 gp]",
  name: "Costume clothes",
  amount: "",
  weight: 4,
  type: "clothes"
};
GearList["fine"] = {
  infoname: "Fine [15 gp]",
  name: "Fine clothes",
  amount: "",
  weight: 6,
  type: "clothes"
};
GearList["traveler's"] = {
  infoname: "Traveler's [2 gp]",
  name: "Traveler's clothes",
  amount: "",
  weight: 4,
  type: "clothes"
};
GearList["component pouch"] = {
  infoname: "Component pouch [25 gp]",
  name: "Component pouch",
  amount: "",
  weight: 2
};
GearList["crowbar"] = {
  infoname: "Crowbar [2 gp]",
  name: "Crowbar",
  amount: "",
  weight: 5
};
GearList["sprig of mistletoe"] = {
  infoname: "Sprig of mistletoe [1 gp]",
  name: "Sprig of mistletoe druidic focus",
  amount: "",
  weight: "",
  type: "druidic focus"
};
GearList["wooden staff"] = {
  infoname: "Wooden staff [5 gp]",
  name: "Wooden staff druidic focus",
  amount: "",
  weight: 4,
  type: "druidic focus",
};
GearList["yew wand"] = {
  infoname: "Yew wand  [10 gp]",
  name: "Yew wand druidic focus",
  amount: "",
  weight: 1,
  type: "druidic focus"
};
GearList["flask"] = {
  infoname: "Flask [2 cp]",
  name: "Flask",
  amount: "",
  weight: 1
};
GearList["grappling hook"] = {
  infoname: "Grappling hook [2 gp]",
  name: "Grappling hook",
  amount: "",
  weight: 4
};
GearList["healer's kit"] = {
  infoname: "Healer's kit [5 gp]",
  name: "Healer's kit",
  amount: "",
  weight: 3
};
GearList["amulet"] = {
  infoname: "Amulet [5 gp]",
  name: "Amulet holy symbol",
  amount: "",
  weight: 1,
  type: "holy symbol"
};
GearList["emblem"] = {
  infoname: "Emblem [5 gp]",
  name: "Emblem holy symbol",
  amount: "",
  weight: "",
  type: "holy symbol"
};
GearList["reliquary"] = {
  infoname: "Reliquary [5 gp]",
  name: "Reliquary holy symbol",
  amount: "",
  weight: 2,
  type: "holy symbol"
};
GearList["holy water (flask)"] = {
  infoname: "Holy water (flask) [25 gp]",
  name: "Holy water, flasks of",
  amount: "",
  weight: 1
};
GearList["hunting trap"] = {
  infoname: "Hunting trap [5 gp]",
  name: "Hunting trap",
  amount: "",
  weight: 25
};
GearList["ink (1 ounce bottle)"] = {
  infoname: "Ink (1 ounce bottle) [10 gp]",
  name: "Ink, 1 ounce bottle of",
  amount: "",
  weight: ""
};
GearList["ink pen"] = {
  infoname: "Ink pen [2 cp]",
  name: "Ink pen",
  amount: "",
  weight: ""
};
GearList["jug"] = {
  infoname: "Jug [2 cp]",
  name: "Jug",
  amount: "",
  weight: 4
};
GearList["ladder (10-foot)"] = {
  infoname: "Ladder (10-foot) [1 sp]",
  name: "10-foot ladder",
  amount: "",
  weight: 25
};
GearList["lamp"] = {
  infoname: "Lamp [5 sp]",
  name: "Lamp",
  amount: "",
  weight: 1
};
GearList["lantern, bullseye"] = {
  infoname: "Lantern, bullseye [10 gp]",
  name: "Bullseye lantern",
  amount: "",
  weight: 2
};
GearList["lantern, hooded"] = {
  infoname: "Lantern, hooded [5 gp]",
  name: "Hooded lantern",
  amount: "",
  weight: 2
};
GearList["lock"] = {
  infoname: "Lock [10 gp]",
  name: "Lock",
  amount: "",
  weight: 1
};
GearList["magnifying glass"] = {
  infoname: "Magnifying glass [100 gp]",
  name: "Magnifying glass",
  amount: "",
  weight: ""
};
GearList["manacles"] = {
  infoname: "Manacles [2 gp]",
  name: "Manacles",
  amount: "",
  weight: 6
};
GearList["mirror, steel"] = {
  infoname: "Mirror, steel [5 gp]",
  name: "Steel mirror",
  amount: "",
  weight: 0.5
};
GearList["net"] = {
  infoname: "Net [1 gp]",
  name: "Net",
  amount: "",
  weight: 3,
};
GearList["oil (flask)"] = {
  infoname: "Oil (flask) [1 sp]",
  name: "Oil, flasks of",
  amount: "",
  weight: 1,
};
GearList["paper (one sheet)"] = {
  infoname: "Paper (one sheet) [2 sp]",
  name: "Paper, sheets of",
  amount: "",
  weight: ""
};
GearList["parchment (one sheet)"] = {
  infoname: "Parchment (one sheet) [1 sp]",
  name: "Parchment, sheets of",
  amount: "",
  weight: ""
};
GearList["perfume (vial)"] = {
  infoname: "Perfume (vial) [5 gp]",
  name: "Perfume, vials of",
  amount: "",
  weight: ""
};
GearList["poison, basic (vial)"] = {
  infoname: "Poison, basic (vial) [100 gp]",
  name: "Basic poison, vials of",
  amount: "",
  weight: ""
};
GearList["pole (10-foot)"] = {
  infoname: "Pole (10-foot) [5 cp]",
  name: "10-foot pole",
  amount: "",
  weight: 7
};
GearList["pot, iron"] = {
  infoname: "Pot, iron [2 gp]",
  name: "Iron pot",
  amount: "",
  weight: 10
};
GearList["potion of healing"] = {
  infoname: "Potion of healing [50 gp]",
  name: "Potion of healing",
  amount: "",
  weight: 0.5
};
GearList["pouch"] = {
  infoname: "Pouch [5 sp]",
  name: "Pouch",
  amount: "",
  weight: 1
};
GearList["quiver"] = {
  infoname: "Quiver [1 gp]",
  name: "Quiver",
  amount: "",
  weight: 1
};
GearList["ram, portable"] = {
  infoname: "Ram, portable [4 gp]",
  name: "Portable ram",
  amount: "",
  weight: 35
};
GearList["rations (1 day)"] = {
  infoname: "Rations (1 day) [5 sp]",
  name: "Rations, days of",
  amount: 1,
  weight: 2
};
GearList["robes"] = {
  infoname: "Robes [1 gp]",
  name: "Robes",
  amount: "",
  weight: 4
};
GearList["rope (50 feet)"] = {
  infoname: "Rope (50 feet) [1 gp]",
  name: "Rope, feet of",
  amount: 50,
  weight: 0.2
};
GearList["sack"] = {
  infoname: "Sack [1 cp]",
  name: "Sack",
  amount: "",
  weight: 0.5
};
GearList["exotic"] = {
  infoname: "Exotic [60 gp]",
  name: "Exotic saddle",
  amount: "",
  weight: 40,
  type: "saddle"
};
GearList["military"] = {
  infoname: "Military [20 gp]",
  name: "Military saddle",
  amount: "",
  weight: 30,
  type: "saddle"
};
GearList["riding"] = {
  infoname: "Riding [10 gp]",
  name: "Riding saddle",
  amount: "",
  weight: 25,
  type: "saddle"
};
GearList["shovel"] = {
  infoname: "Shovel [2 gp]",
  name: "Shovel",
  amount: "",
  weight: 5
};
GearList["signal whistle"] = {
  infoname: "Signal whistle [5 cp]",
  name: "Signal whistle",
  amount: "",
  weight: ""
};
GearList["spellbook"] = {
  infoname: "Spellbook [50 gp]",
  name: "Spellbook",
  amount: "",
  weight: 3
};
GearList["spell scroll (cantrip)"] = {
  infoname: "Spell Scroll (Cantrip) [30 gp]",
  name: "Spell Scroll (Cantrip)",
  amount: "",
  weight: "",
};
GearList["spell scroll (level 1)"] = {
  infoname: "Spell Scroll (Level 1) [50 gp]",
  name: "Spell Scroll (Level 1)",
  amount: "",
  weight: "",
};
GearList["spikes, iron (10)"] = {
  infoname: "Spikes, iron (10) [1 gp]",
  name: "Iron spike",
  amount: 10,
  weight: 0.5
};
GearList["spyglass"] = {
  infoname: "Spyglass [1000 gp]",
  name: "Spyglass",
  amount: "",
  weight: 1
};
GearList["string"] = {
  infoname: "String [1 sp]",
  name: "String",
  amount: 10,
  weight: "",
};
GearList["tent, two-person"] = {
  infoname: "Tent, two-person [2 gp]",
  name: "Two-person tent",
  amount: "",
  weight: 20
};
GearList["tinderbox"] = {
  infoname: "Tinderbox [5 sp]",
  name: "Tinderbox",
  amount: "",
  weight: 1
};
GearList["torch"] = {
  infoname: "Torch [1 cp]",
  name: "Torch",
  amount: "",
  weight: 1
};
GearList["vial"] = {
  infoname: "Vial [1 gp]",
  name: "Vial",
  amount: "",
  weight: ""
};
GearList["waterskin"] = {
  infoname: "Waterskin [2 sp]",
  name: "Waterskin",
  amount: "",
  weight: 5
};
//Packs
PacksList["burglar"] = {
  name: "Burglar's pack (16 gp)",
  source: [["PHB2024", 224]],
  items: [
    ["Backpack, with:", "", 5],
    ["Bag of 1000 ball bearings", "", 2],
    ["Bell", "", ""],
    ["Candles", 10, ""],
    ["Crowbar", "", 5],
    ["Hooded lantern", "", 2],
    ["Oil, flasks of", 7, 1],
    ["Rations, days of", 5, 2],
    ["Rope, feet of", 50, 0.2],
    ["Tinderbox", "", 1],
    ["Waterskin", "", 5],
  ]
};
PacksList["diplomat"] = {
  name: "Diplomat's pack (39 gp)",
  source: [["PHB2024", 225]],
  items: [
    ["Chest, with:", "", 25],
    ["Fine clothes", "", 6],
    ["Ink", "", ""],
    ["Ink Pens", 5, ""],
    ["Lamp", "", 1],
    ["Cases, Map or Scroll", 2, 1],
    ["Oil, flasks of", 4, 1],
    ["Paper, sheets of", 5, ""],
    ["Parchment, sheets of", 5, ""],
    ["Perfume, vial of", "", ""],
    ["Tinderbox", "", 1],
  ]
};
PacksList["dungeoneer"] = {
  name: "Dungeoneer's pack (12 gp)",
  source: [["PHB2024", 225]],
  items: [
    ["Backpack, with:", "", 5],
    ["Caltrops", 20, 0.1],
    ["Crowbar", "", 5],
    ["Oil, flasks of", 2, 1],
    ["Rations, days of", 10, 2],
    ["Rope, feet of", 50, 0.2],
    ["Tinderbox", "", 1],
    ["Torches", 10, 1],
    ["Waterskin", "", 5],
  ]
};
PacksList["entertainer"] = {
  name: "Entertainer's pack (40 gp)",
  source: [["PHB2024", 225]],
  items: [
    ["Backpack, with:", "", 5],
    ["Bedroll", "", 7],
    ["Bell", "", ""],
    ["Bullseye Lantern", "", 2],
    ["Costume clothes", 3, 4],
    ["Mirror, steel", "", 0.5],
    ["Oil, flasks of", 8, 1],
    ["Rations, days of", 9, 2],
    ["Tinderbox", "", 1],
    ["Waterskin", "", 5],
  ]
};
PacksList["explorer"] = {
  name: "Explorer's pack (10 gp)",
  source: [["PHB2024", 225]],
  items: [
    ["Backpack, with:", "", 5],
    ["Bedroll", "", 7],
    ["Oil, flasks of", 2, 1],
    ["Rations, days of", 10, 2],
    ["Rope, feet of", 50, 0.2],
    ["Torches", 10, 1],
    ["Tinderbox", "", 1],
    ["Waterskin", "", 5],
  ]
};
PacksList["priest"] = {
  name: "Priest's pack (33 gp)",
  source: [["PHB2024", 225]],
  items: [
    ["Backpack, with:", "", 5],
    ["Blanket", "", 3],
    ["Holy Water, flask of", 1, 1],
    ["Lamp", "", 1],
    ["Rations, days of", 7, 2],
    ["Robe", "", 4],
    ["Tinderbox", "", 1],
  ]
};
PacksList["scholar"] = {
  name: "Scholar's pack (40 gp)",
  source: [["PHB2024", 225]],
  items: [
    ["Backpack, with:", "", 5],
    ["Book", "", 5],
    ["Ink", "", ""],
    ["Ink Pen", "", ""],
    ["Lamp", "", 1],
    ["Oil, flasks of", 10, 1],
    ["Parchment, sheets of", 10, ""],
    ["Tinderbox", "", 1],
  ]
};
//Spells
legacySpellRefactor("acid splash", {
  name: "Acid Splash",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 239]],
  level: 0,
  school: "Evoc",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "Instantaneous",
  save: "Dex",
  description: "Ea crea within a 5 ft. rad. sphere makes a Dex save or 1d6 Acid dmg; +1d6 at CL 5, 11, and 17",
  descriptionCantripDie: "Ea crea within a 5 ft. rad. sphere makes a Dex save or `CD`d6 Acid dmg",
  descriptionFull: "You create an acidic bubble at a point within range, where it explode in a 5-foot radius Sphere. Each creature in that Sphere must succeed on a Dexterity saving throw or take 1d6 Acid damage." + "\n   " + "This spell's damage increases by 1d6 when you reach 5th Level (2d6), 11th level (3d6) and 17th level (4d6).",
});
legacySpellRefactor("aid", {
  name: "Aid",
  classes: ["bard", "cleric", "druid", "paladin", "ranger"],
  source: [["PHB2024", 239]],
  level: 2,
  school: "Abjur",
  time: "1 a",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A strip of white cloth",
  duration: "8 h",
  description: "3 creatures gain 5+5/SL current HP and HP max for the duration",
  descriptionFull: "Choose up to three creatures within range. Each target's Hit Point maximum and Current Hit Points increase by 5 for the duration." + AtHigherLevels + "Each target's Hit Points increases by 5 for each spell slot level above 2."
});
legacySpellRefactor("alarm", {
  name: "Alarm",
  classes: ["ranger", "wizard"],
  source: [["PHB2024", 239]],
  ritual: true,
  level: 1,
  school: "Abjur",
  time: "1 min",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A bell and silver wire",
  duration: "8 h",
  description: "Door, window, or 20-ft. cube area; audible (60 ft.) or mental alarm (1 mile) if undesignated crea enters",
  descriptionFull: "You set an alarm against intrusion. Choose a door, a window, or an area within range that is no larger than a 20-foot Cube. Until the spell ends, an alarm alerts you whenever a creature touches or enters the warded area. When you cast the spell, you can designate creatures that won't set off the alarm. You also choose whether the alarm is audible or mental." + "\n   " + "Audible Alarm : The alarm produces the sound of a handbell for 10 seconds within 60 feet of the warded area." + "\n   " + "You are alerted by a mental ping if you are within 1 mile of the warded area. This ping awakens you if you're asleep."
});
legacySpellRefactor("alter self", {
  name: "Alter Self",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 239]],
  level: 2,
  school: "Trans",
  time: "1 a",
  range: "Self",
  components: "V,S",
  duration: "Conc, 1 h",
  description: "Change appearance, gain +1 magical 1d6 natural weapons, or water breathing and swim spd",
  descriptionFull: "You alter your physical form. Choose one of the following options. Its effects last for the duration, during which you can take a Magic action to replace the option you chose with a different one." + "\n   " + toUni("Aquatic Adaptation") + ": You sprout gills and grow webs between your fingers. You can breathe underwater and gain a Swim Speed equal to your Speed." + "\n   " + toUni("Change Appearance") + ": You alter your appearance. You decide what you look like, including your height, weight, facial features, sound of your voice, hair length, coloration, and other distinguishing characteristics. You can make yourself appear as a member of another species, though none of your statistics change. You can't appear as a creature of a different size, and your basic shape stays the same; if you're bipedal, you can't use this spell to become quadrupedal, for instance. For the duration, you can take a Magic action to change your appearance in this way again." + "\n   " + toUni("Natural Weapons") + ": You grow claws (Slashing), fangs (Piercing), horns (Piercing), or hooves (Bludgeoning). When you use your Unarmed Strike to deal damage with that new growth, it deals 1d6 damage of the type in parenthesis instead of dealing the normal damage for your Unarmed Strike, and you use your spellcasting ability modifier for the attack and damage rolls rather than using Strength."
});
legacySpellRefactor("animal friendship", {
  name: "Animal Friendship",
  classes: ["bard", "druid", "ranger"],
  source: [["PHB2024", 239]],
  level: 1,
  school: "Ench",
  time: "1 a",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A morsel of food",
  duration: "24 h",
  save: "Wis",
  description: "1+1/SL beasts save or charmed for the duration",
  descriptionFull: "Target a Beast that you can see within range. The target must succeed on a Wisdom saving throw or have the Charmed condition for the duration. If you or one of your allies deals damage to the target, the spell ends." + AtHigherLevels + "You can target one additional Beast for each spell slot above 1."
});
legacySpellRefactor("animal messenger", {
  name: "Animal Messenger",
  classes: ["bard", "druid", "ranger"],
  source: [["PHB2024", 240]],
  ritual: true,
  level: 2,
  school: "Ench",
  time: "1 a",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A morsel of food",
  duration: "24 h",
  save: "Cha",
  description: "Tiny beast makes Cha save or delivers 25 word message up to 25 miles (50 miles if flier); +48h/SL duration",
  descriptionFull: "A Tiny Beast of your choice that you can see within range must succeed on a Charisma saving throw, or it attempts to deliver a message for you (if the target's Challenge Rating isn't 0, it automatically succeeds). You specify a location you have visited and a recipient who matches a general description such as 'a person dressed in the uniform of the town guard' or  'a red-haired dwarf wearing a pointed hat'. You also communicate a message of up to twenty-five words. The Beast travels for the duration toward the specified location, covering 25 miles per 24 hours or 50 miles if the Beast can fly." + "\n   " + "When the Beast arrives, it delivers your message to the creature that you described, mimicking your communication. If the Beast doesn't reach its destination before the spell ends, the message is lost, and the Beast returns to where you cast the spell." + AtHigherLevels + "The spell's duration increases by 48 hours for each spell slot level above 2."
});
legacySpellRefactor("animal shapes (wip)", {
  name: "Animal Shapes",
  classes: ["druid"],
  source: [["PHB2024", 240]],
  level: 8,
  school: "Trans",
  time: "1 a",
  range: "30 ft.",
  components: "V,S",
  duration: "24 h",
  description: "Any willing creatures transform into up to Large CR4 beasts; retain Wis, Int, Cha, but nothing else",
  descriptionFull: "Choose any number of willing creatures tat you can see within range. Each target shape-shifts into a Large or smaller Beast of your choice that has a Challenge Rating of 4 or lower. You can choose a different form for each target. On later turns, you can take a Magic action to transform the targets again." + "\n   " + "A target's game statistics are replaced by the chosen Beast's statistics, but the target retains its creature type; HitPoints; Hit Point Dice; alignment; ability to communicate and Intelligence, Wisdom, and Charisma scores. The target's actions are limited by the Beast form's anatomy, and it can't cast spells, the target's equipment melds into the new form, and the target can't use any of that equipment while in that form." + "\n   " + "The target gains a number of Temporary Hit Points equal to the Beast form's Hit Points. The transformation lasts for the duration for each target..."
});
legacySpellRefactor("animate dead", {
  name: "Animate Dead",
  classes: ["cleric", "wizard"],
  source: [["PHB2024", 240]],
  level: 3,
  school: "Necro",
  time: "1 min",
  range: "10 ft.",
  components: "V,S,M",
  compMaterial: "A drop of blood, a piece of flesh, and a pinch of bone dust",
  duration: "Instantaneous",
  description: "Turn corpses into 1+2/SL Skeletons or Zombies; control for 24h; bns a command within 60 ft.",
  descriptionFull: "Choose a pile of bones or a corpse of a Medium or Small Humanoid within range. The target becomes an Undead creature: a Skeleton if you chose bones or a Zombie if you chose a corpse (see appendix B for the stat blocks)." + "\n   " + "On each of your turns, you can take a Bonus Action to mentally command any creature you made with this spell if the creature is within 60 feet of you (if you control multiple creatures, you can command all of them at the same time, issuing the same command to each one) You decide what action the creature will take and where it will move on its next turn, or you can issue a general command, such as to guard a chamber or corridor. If you issue no commands, the creature takes the Dodge action and moves only to avoid harm. Once given an order, the creature continues to follow it until its task is complete." + "\n   " + "The creature is under your control for 24 hours, after which it stops obeying any command you've given it. To maintain control of the creature for another 24 hours, you must cast this spell on the creature again before the current 24-hour period ends. This use of the spell reasserts your control over up to four creatures you have animated with this spell rather than animating a new creature." + AtHigherLevels + "You animate or reassert control over two additional Undead creatures for each spell slot level above 3.Each of the creatures must come from a different corpse or pile of bones."
});
legacySpellRefactor("animate objects", {
  name: "Animate Objects",
  classes: ["bard", "sorcerer", "wizard"],
  source: [["PHB2024", 240 - 241]],
  level: 5,
  school: "Trans",
  time: "1 a",
  range: "120 ft.",
  components: "V,S",
  duration: "Conc, 1 min",
  description: "10+2/SL nonmagical objects not worn or carried; bns a command within 500 ft.; see book",
  descriptionFull: "Objects animate at your command. Choose a number of nonmagical objects within range that aren't being worn or carried, aren't fixed to a surface, and aren't Gargantuan. The maximum number of objects is equal to your spellcasting ability modifier, for this number, a Medium or smaller target counts as one object, a Large target counts as two, and a Huge target counts as four." + "\n   " + "Each target animates, sprouts legs, and becomes a Construct that uses the Animated Object stat block; this creature is under your control until the spell ends or until it is reduced to 0 Hit Points. Each creature you make with this spell is an ally to you and your allies. In combat, it shares your Initiative count and takes its turn immediately after yours." + "\n   " + "Until the spell ends you can take a Bonus Action you can mentally command any creatures you made with this spell if the creature is within 500 feet of you (if you control multiple creatures, you can command any of them at the same time, issuing the same command to each one). If you issue no commands, the creature takes the Dodge action and moves only to avoid harm. When the creature drops to 0 Hit Points it reverts to its object form, and any remaining damage carries over to that form\n\n" + AtHigherLevels + "The creature's Slam damage increases by 1d4 (Medium or smaller), 1d6 (Large), or 1d12 (Huge) for each spell slot level above 5."
});
legacySpellRefactor("antilife shell", {
  name: "Antilife Shell",
  classes: ["druid"],
  source: [["PHB2024", 241]],
  level: 5,
  school: "Abjur",
  time: "1 a",
  range: "Self",
  components: "V,S",
  duration: "Conc, 1 h",
  description: "Only undead and constructs can come within 10 ft.; if forced upon living creature the spell ends",
  descriptionFull: "An aura extends from you in a 10-foot Emanation for the duration. The aura prevents creatures other than Constructs and Undead from passing or reaching through it. An affected creature can cast spells or making attacks with Ranged or Reach weapons through the barrier." + "\n   " + "If you move so that an affected creature is forced to pass through the barrier, the spell ends.",
});
legacySpellRefactor("antimagic field", {
  name: "Antimagic Field",
  classes: ["cleric", "wizard"],
  source: [["PHB2024", 241]],
  level: 8,
  school: "Abjur",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "iron filings",
  duration: "Conc, 1 h",
  description: "No magical effects functions in area except those created by an artifact or a deity",
  descriptionFull: "An aura of antimagic surrounds you in a 10-foot Emanation. No one ca cast spells, take Magic actions, or create other magical effects inside the aura, and those things can't target or otherwise affect anything inside it. Magical properties of magic items don't work inside the aura or on anything inside it." + "\n   " + "Areas of effect created by spells or other magic can't extend into the aura, and no one can teleport into or out of it, or use planar travel there. Portals close temporarily while in the aura." + "\n   " + "Ongoing spells, except those cast by an Artifact or a deity, are suppressed in the are. While an effect is suppressed, it doesn't function, but the time it spends suppressed counts against its duration." + "\n   " + "Dispel Magic has no effect on the aura, and the auras created by different Antimagic Field spells don't nullify each other."
});
legacySpellRefactor("antipathy/sympathy", {
  name: "Antipathy/Sympathy",
  classes: ["bard", "druid", "wizard"],
  source: [["PHB2024", 242]],
  level: 8,
  school: "Ench",
  time: "1 h",
  range: "60 ft.",
  components: "V,S,M",
  compMaterial: "a mix of vinegar and honey",
  duration: "10 days",
  save: "Wis",
  description: "Creature, or object attracts or repels specific type of crea; see book",
  descriptionFull: "As you cast the spell, choose whether it creates antipathy or sympathy, and target one creature or object that is Huge or smaller. Then specify a kind of creature, such as red dragons, goblins, or vampires. A creature of the chosen kind makes a Wisdom saving throw when it comes within 120 feet of the target. You choice of antipathy or sympathy determines what happens to a creature when it fails the save:" + "\n   " + toUni("Antipathy") + ": The creature has the Frightened condition. The Frightened creature must use its movement on its turn to get as far away as possible from the target, moving by the safest route." + "\n   " + toUni("Sympathy") + ": The creature has the Charmed condition. The Charmed creature must use its movement on its turns to get as close as possible to the target, moving by the safest route. If the creature is within 5 feet of the target, the creature can't willingly move away. IF the target damages the Charmed creature, that creature can make a Wisdom saving throw to end the effect, as described below" + "\n   " + toUni("Ending the Effect") + ": If the Frightened or Charmed creature ends its turn more than 120 feet away from the target, the creature makes a Wisdom saving throw. On a Successful save, the creature is no longer affected by the target. A creature that successfully saves against this effect is immune to it for 1 minute, after which it can be affected again.",
});
legacySpellRefactor("arcane eye", {
  name: "Arcane Eye",
  classes: ["wizard"],
  source: [["PHB2024", 242]],
  level: 4,
  school: "Div",
  time: "1 a",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A bit of bat fur",
  duration: "Conc, 1 h",
  description: "Create invisible, moving (unlimited range, 30 ft./rnd) 1\" magic eye with darkvision I see through",
  descriptionFull: "You create an Invisible, invulnerable eye within range that hovers for the duration. You mentally receive visual information from the eye, which can see in every direction. It also has Darkvision with a range of 30 feet." + "\n   " + "As a Bonus Action, you can move the eye up to 30 feet in any direction. A solid barrier blocks the eye's movement, but the eye can pass through an opening as small as 1 inch in diameter."
});
legacySpellRefactor("arcane gate", {
  name: "Arcane Gate",
  classes: ["sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 242]],
  level: 6,
  school: "Conj",
  time: "1 a",
  range: "500 ft.",
  components: "V,S",
  duration: "Conc, 10 min",
  description: "Two portals, up to 500 ft. apart, teleport any to other side; portals are filled with opaque mist",
  descriptionFull: "You create linked teleportation portals. Choose two Large, unoccupied spaces on the ground that you can see, one space within range and the other one within 10 feet of you. A circular portal opens in each of those spaces and remains for the duration." + "\n   " + "The portals are two-dimensional glowing rings filled with mist that blocks sight. They hover inches from the ground and are perpendicular to it." + "\n   " + "A portal is open on only one side (you choose which). Anything entering the open side of a portal exits from the open side on the other portal as if they two were adjacent to each other. As a Bonus Action, you can change the facing of the open sides."
});
legacySpellRefactor("arcane lock", {
  name: "Arcane Lock",
  classes: ["artificer", "wizard"],
  source: [["PHB2024", 242]],
  level: 2,
  school: "Abjur",
  time: "1 a",
  range: "Touch",
  components: "V,S,M\u2020",
  compMaterial: "Gold dust worth 25+ gp, which the spell consumes",
  duration: "until dispelled",
  description: "Entryway locked; password or designated crea opens;(25gp cons.)",
  descriptionFull: "You touch a closed door, window, gate, container, or hatch and magically lock it for the duration. This lock can't be unlocked by any nonmagical means. You and any creatures you designate when you cast the spell can open and close the object despite the lock. You can also set a password that, when spoken within 5 feet of the object, unlocks it for 1 minute."
});
legacySpellRefactor("arcane vigor", {
  name: "Arcane Vigor",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 242]],
  level: 2,
  school: "Abjur",
  time: "1 bns",
  range: "Self",
  components: "V,S",
  duration: "Instantaneous",
  description: "You can spend 2+1/SL Hit Dice roll them and add your spellcasting mod and regain that much HP.",
  descriptionFull: "You tap into your life force to heal yourself. Roll one or two of your unexpended Hit Point Dice, and regain a number of Hit Point's equal to the rolls total plus your spellcasting ability modifier. Those dice are expended\n\n" + AtHigherLevels + "The number of unexpended Hit Dice you can roll increases by one for each spell slot level above 2.",
});
legacySpellRefactor("armor of agathys", {
  name: "Armor of Agathys",
  classes: ["warlock"],
  source: [["PHB2024", 243]],
  level: 1,
  school: "Abjur",
  time: "1 bns",
  range: "Self",
  components: "V,S,M",
  compMaterial: "A shard of blue glass",
  duration: "1 h",
  description: "5+5/SL temp HP; as long as temp HP last any crea that hits in melee takes 5+5/SL Cold dmg",
  descriptionFull: "Protective magical frost surrounds you. You gain 5 Temporary Hit Points. IF a creature hits you with a melee attack roll before the spell ends, the creature takes 5 Cold damage. The spell ends early if you have no Temporary Hit Points." + AtHigherLevels + "The Temporary Hit Points and the Cold damage both increase by 5 for each spell slot above 1."
});
legacySpellRefactor("arms of hadar", {
  name: "Arms of Hadar",
  classes: ["warlock"],
  source: [["PHB2024", 243]],
  level: 1,
  school: "Conj",
  time: "1 a",
  range: "Self",
  components: "V,S",
  duration: "Instantaneous",
  save: "Str",
  description: "2d6+1d6/SL Necrotic dmg; save halves; on failed save no reactions until next turn",
  descriptionFull: "Invoking Hadar, you cuase tendrils to erupt from yourself. Each creature in a 10-foot Emanation originating from you makes a Strength saving throw. On a failed save, a target takes 2d6 necrotic damage and can't take Reactions until the start of its next turn. On a successful save, a target takes half as much damage only." + AtHigherLevels + "The damage increases by 1d6 for each spell slot levels above 1."
});
legacySpellRefactor("astral projection", {
  name: "Astral Projection",
  classes: ["cleric", "warlock", "wizard"],
  source: [["PHB2024", 243]],
  level: 9,
  school: "Necro",
  time: "1 h",
  range: "10 ft.",
  components: "V,S,M\u2020",
  compMaterial: "For each of the spell's targets, one jacinth worth 1,000 gp and one silver bar worth 100+ gp, all of which the spell consumes",
  duration: "Until dispelled",
  description: "Me + 8 willing crea projected to Astral Plane with identical statistics (per crea 1100gp cons.)",
  descriptionFull: "You and up to eight willing creatures within range project your astral bodies into the Astral Plane (the spell ends instantly if you are already on that plane). Each target's body is left behind in a state of suspended animation; it has the Unconscious condition, doesn't need food or air, and doesn't age." + "\n   " + "A target's astral form resembles its body in almost every way, replicating its game statistics and possessions. The principal difference is the addition of a silvery cord that trails from between the shoulder blades of the astral form. The cord fades from view after 1 foot. If the cord is cut which happens only when an effect specifically states that it does-your soul and body are separated, killing you instantly." + "\n   " + "A target's astral form can travel through the Astral Plane. The moment an astral form leaves that plane, the target's body and possessions travel along the silver cord, causing the target to re-enter its body on the new plane." + "\n   " + "Any damage or other effect that apply to an astral form have no effect on the target's body and vice versa. If a target's body or astral form drops to 0 Hit Points, the spell ends for that target. The spell ends for all the targets if you take a Magic action to dismiss it." + "\n   " + "When the spell ends for a target who isn't dead the target reappears in a body and exits the state of suspended animation."
});
legacySpellRefactor("augury", {
  name: "Augury",
  classes: ["cleric", "druid", "wizard"],
  source: [["PHB2024", 244]],
  ritual: true,
  level: 2,
  school: "Div",
  time: "1 min",
  range: "Self",
  components: "V,S,M\u0192",
  compMaterial: "Specially marked sticks, bones, cards, or other divinatory tokens worth 25+ gp",
  duration: "Instantaneous",
  description: "Omen about specific course of action I plan to take in the next 30 min (25gp)",
  descriptionFull: "You receive an omen from an otherworldly entity about the result of a course of action that you plan to take within the next 30 minutes. The DM chooses the omen from the Omens table." + "\n " + "\u2022 Weal, for good results" + "\n " + "\u2022 Woe, for bad results" + "\n " + "\u2022 Weal and woe, for both good and bad results" + "\n " + "\u2022 Indifference, for results that aren't especially good or bad" + "\n\n" + "The spell doesn't account for circumstances, such as other spells, that might change the results." + "\n   " + "If you cast the spell more than once before finishing a Long Rest, there is a cumulative 25 percent chance for each casting after the first that you get no answer."
});
legacySpellRefactor("aura of life", {
  name: "Aura of Life",
  classes: ["cleric", "paladin"],
  source: [["PHB2024", 244]],
  level: 4,
  school: "Abjur",
  time: "1 a",
  range: "Self",
  components: "V",
  duration: "Conc, 10 min",
  description: "Me + any crea while in area Necrotic dmg resist.; at turn start, 0 HP living in area heal 1 HP",
  descriptionFull: "An aura radiates from you in a 30-foot Emanation for the duration. While in the aura, you and your allies have Resistance to Necrotic damage, and your Hit Point maximums can't be reduced. If an ally starts its turn in the aura with 0 Hit Points it regains 1 Hit Point."
});
legacySpellRefactor("aura of purity", {
  name: "Aura of Purity",
  classes: ["cleric", "paladin"],
  source: [["PHB2024", 244]],
  level: 4,
  school: "Abjur",
  time: "1 a",
  range: "Self",
  components: "V",
  duration: "Conc, 10 min",
  description: "Me + any crea while in area Poison dmg resist., adv. on saves vs. conditions",
  descriptionFull: "An aura radiates from you in a 30-foot Emanation for the duration. While in the aura, you and your allies have Resistance to Poison damage and Advantage on saving throws to avoid or end effects that include the Blinded, Charmed, Deafened, Frightened, Paralyzed, Poisoned, or Stunned condition."
});
legacySpellRefactor("aura of vitality", {
  name: "Aura of Vitality",
  classes: ["cleric", "druid", "paladin"],
  source: [["PHB2024", 244]],
  level: 3,
  school: "Abjur",
  time: "1 a",
  range: "Self",
  components: "V",
  duration: "Conc, 1 min",
  description: "At the start of each of your turns for the duration, I can heal 2d6 HP to 1 creature in range (can be me)",
  descriptionFull: "An aura radiates from you in a 30-foot Emanation for the duration. When you create the aura and at the start of each of your turns while it persists, you can restore 2d6 Hit Points to one creature in it."
});
legacySpellRefactor("awaken", {
  name: "Awaken",
  classes: ["bard", "druid"],
  source: [["PHB2024", 244]],
  level: 5,
  school: "Trans",
  time: "8 h",
  range: "Touch",
  components: "V,S,M\u2020",
  compMaterial: "An agate worth 1,000+ gp, which the spell consumes",
  duration: "Instantaneous",
  description: "Give beast or plant Int 10 and ability to move. Follows commands for 30 days (1000gp cons.)",
  descriptionFull: "You spend the casting time tracing magical pathways within a precious gemstone, and then touch the target. The target must e either a Beast or Plant creature with an Intelligence of 3 or less or a natural plant that isn't a creature. The target gains an Intelligence of 10 and the ability to speak one language you know. If the target is a natural plant, it becomes a Plant creature and gains the ability to move its limbs, roots, vines, creepers, and so forth, and it gains senses similar to a human's. The DM chooses statistics appropriate for the awakened Plant, such as the statistics for the Awakened Shrub or Awakened Tree in the Monster Manual." + "\n   " + "The awakened target has the Charmed condition for 30 days or until you or your allies deal damage to it. When the condition ends, the awakened creature chooses its attitude toward you."
});
legacySpellRefactor("bane", {
  name: "Bane",
  classes: ["bard", "cleric", "warlock"],
  source: [["PHB2024", 245]],
  level: 1,
  school: "Ench",
  time: "1 a",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A drop of blood",
  duration: "Conc, 1 min",
  save: "Cha",
  description: "3+1/SL creatures save or have to subtract 1d4 on every attack or save for the duration",
  descriptionFull: "Up to three creatures of your choice that you can see within range must make Charisma saving throws. Whenever a target that fails this saving throw makes an attack roll or a saving throw before the spell ends, the target must subtract 1d4 from the attack roll or saving throw." + AtHigherLevels + "You can target one additional creature for each spell slot level above 1."
});
legacySpellRefactor("banishing smite", {
  name: "Banishing Smite",
  classes: ["paladin"],
  source: [["PHB2024", 245]],
  level: 5,
  school: "Conj",
  time: "1 bns",
  range: "Self",
  components: "V",
  duration: "Conc, 1 min",
  description: "Next weapon hit +5d10 Force dmg; if this brings target HP<50, I banish it until spell ends",
  descriptionFull: "The target hit by the attack roll takes an extra 5d10 Force damage from the attack. If the attack reduces the target to 50 Hit Points or fewer, the target must succeed on a Charisma saving throw or be transported to a harmless demiplane for the duration. While there, the target has the Incapacitated condition. When the spell ends, the target reappears in the space it left or in the nearest unoccupied space if that space is occupied.",
});
legacySpellRefactor("banishment", {
  name: "Banishment",
  classes: ["cleric", "paladin", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 245]],
  level: 4,
  school: "Abjur",
  time: "1 a",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A pentacle",
  duration: "Conc, 1 min",
  save: "Cha",
  description: "1+1/SL crea save or banished; crea return if spell lasts < 1 min",
  descriptionFull: "One creature that you can see within range must succeed on a Charisma saving throw or be transported to a harmless demiplane for the duration. While there, the target has the Incapacitated condition. When the spell ends, the target reappears in the space it left or in the nearest unoccupied space if that space is occupied." + "\n   " + "If the target is an Aberration, a Celestial, an Elemental, a Fey, or a Fiend, the target doesn't return if the spell lasts for 1 minute. The target is instead transported to a random location on a plane (DM's choice) associated with its creature type." + AtHigherLevels + "You can target one additional creature for each spell slot above 4."
});
legacySpellRefactor("barkskin", {
  name: "Barkskin",
  classes: ["druid", "ranger"],
  source: [["PHB2024", 245]],
  level: 2,
  school: "Trans",
  time: "1 bns",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "A handful of bark",
  duration: "1 h",
  description: "1 willing crea AC cannot be reduced below 17, regardless of armor it is wearing",
  descriptionFull: "You touch a willing creature. Until the spell ends, the target's skin assumes a bark-like appearance, and the target has an AC of 17 if its AC is lower than that."
});
legacySpellRefactor("beacon of hope", {
  name: "Beacon of Hope",
  classes: ["cleric"],
  source: [["PHB2024", 245]],
  level: 3,
  school: "Abjur",
  time: "1 a",
  range: "30 ft.",
  components: "V,S",
  duration: "Conc, 1 min",
  description: "Any crea in range adv. on Wis/Death saves and gains max HP from any healing",
  descriptionFull: "Choose any number of creatures within range. For the duration, each target has Advantage on Wisdom saving throws and Death Saving Throws and regains the maximum number of Hit Points possible from any healing."
});
legacySpellRefactor("beast sense", {
  name: "Beast Sense",
  classes: ["druid", "ranger"],
  source: [["PHB2024", 245]],
  ritual: true,
  level: 2,
  school: "Div",
  time: "1 a",
  range: "Touch",
  components: "S",
  duration: "Conc, 1 h",
  description: "Use 1 willing beast's senses; I'm blinded and deafened while doing so",
  descriptionFull: "You touch a willing, Beast. For the duration, you can perceive through the Beast's senses as well as your own. When perceiving through the Beast's senses, you benefit from any special senses it has."
});
legacySpellRefactor("befuddlement", {
  replaces: "feeblemind",
  name: "Befuddlement",
  classes: ["bard", "druid", "warlock", "wizard"],
  source: [["PHB2024", 245 - 246]],
  level: 8,
  school: "Ench",
  time: "1 a",
  range: "150 ft.",
  components: "V,S,M",
  compMaterial: "A key ring with no keys",
  duration: "Instantaneous",
  save: "Int",
  description: "1 crea Int save or take 10d12 Psy dmg and cant cast spell or take Magic action, remake save after 30 days.",
  descriptionFull: "You blast the mind of a creature that you can see within range. The target makes an Intelligence saving throw." + "\n   " + "On a failed save, the target takes 10d12 Psychic damage and can't cast spells or take the Magic action. At the end of every 30 days, he target repeats the save, ending the effect on a success. The effect can also be ended by the Greater Restoration, Heal, or Wish spell." + "\n   " + "On a successful save, the target takes half as much damage only",
});
legacySpellRefactor("bestow curse", {
  name: "Bestow Curse",
  classes: ["bard", "cleric", "wizard"],
  source: [["PHB2024", 246]],
  level: 3,
  school: "Necro",
  time: "1 a",
  range: "Touch",
  components: "V,S",
  duration: "Conc, 1 min",
  save: "Wis",
  description: "1 creature save or cursed, see book; duration SL4:conc, 10 min; SL5:8h; SL7:24h; SL9:until dispelled",
  descriptionFull: "You touch a creature, which must succeed on a Wisdom saving throw or become cursed for the duration. Until the curse ends, the target suffers one of the following effects of your choice:." + "\n " + "\u2022 Choose one ability. The target has Disadvantage on ability check and saving throws made with that ability." + "\n " + "\u2022 The target has Disadvantage on attack rolls against you." + "\n " + "\u2022 In combat, the target must succeed on a Wisdom saving throw at the start of each of its turns or be forced to take the Dodge action on that turn." + "\n " + "\u2022 If you deal damage to the target with an attack roll or a spell, the target takes an extra 1d8 Necrotic damage." + AtHigherLevels + "If you cast this spell using a level 4 spell slot, you can maintain Concentration on it for up to 10 minutes. If you use a level 5+ spell slot, the spell doesn't require Concentration, and the duration becomes 8 hours (level 5-6 slot) or 24 hours (7-8 slot). If you use a level 9 spell slot, the spell lasts until dispelled."
});
legacySpellRefactor("bigby's hand", {
  name: "Bigby's Hand",
  nameAlt: "Arcane Hand",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 246 - 247]],
  level: 5,
  school: "Evoc",
  time: "1 a",
  range: "120 ft.",
  components: "V,S,M",
  compMaterial: "An eggshell and a glove",
  duration: "Conc, 1 min",
  description: "Large hand attacks, pushes, grapples or shields, see book; AC 20, my max HP; bns a move 60 ft.",
  descriptionFull: "You create a Large hand of shimmering magical energy in an unoccupied space that you can see within range. The hand lasts for the duration, and it moves at your command, mimicking the movements of your own hand." + "\n   " + "The hand is an object that has AC 2 and Hit Points equal to your Hit Point maximum. If it drops to 0 Hit Points, the spell ends. The hand doesn't occupy its space." + "\n   " + "When you cast the spell and as a Bonus Action on your later turns, you can move the hand up to 60 feet and then cause one of the following effects:" + "\n   " + "Clenched Fist. The hand strikes a target within 5 feet of it. Make a melee spell attack. On a hit, the target takes 5d8 Force damage." + "\n   " + "Forceful Hand. The hand attempts to push a Huge or smaller creature within 5 feet of it. The target must succeed on a Strength saving throw, or the hand pushes the target up to 5 feet plus a number of feet equal to five times your spellcasting ability modifier. The hand moves with the target, remaining within 5 feet of it. " + "\n   " + "Grasping Hand. The hand attempts to grapple a Huge or smaller creature within 5 feet of it. The target must succeed on a Dexterity saving throw, or the target has the Grappled condition, with an escape DC equal to your spell save DC. When the hand grapples the target, you can take a Bonus Action to cause the hand to crush it, dealing Bludgeoning damage to the target equal to 4d6 plus your spellcasting ability modifier." + "\n   " + "Interposing Hand. The hand grants you Half Cover against attacks and other effects that originate from its space or that pass through it. In addition, the space counts as Difficult Terrain for your enemies." + AtHigherLevels + "The damage of the Clenched Fist increases by 2d8 and the damage of the grasping Hand increases by 2d6 for each spell slot level above 5."
});
legacySpellRefactor("blade barrier", {
  name: "Blade Barrier",
  classes: ["cleric"],
  source: [["PHB2024", 247]],
  level: 6,
  school: "Evoc",
  time: "1 a",
  range: "90 ft.",
  components: "V,S",
  duration: "Conc, 10 min",
  save: "Dex",
  description: "100\xD720\xD75ft (l\xD7w\xD7h) wall or 60 diam 20\xD75ft (w\xD7h) ring; 6d10 Slashing dmg; save halves; 3/4 cover",
  descriptionMetric: "60\xD76\xD71,5m (l\xD7w\xD7h) wall or 9 rad 6\xD71,5m (w\xD7h) ring; 6d10 Slashing dmg; save halves; 3/4 cover",
  descriptionShorter: typePF ? false : "100|20|5ft (l|w|h) wall or 30|20|5ft (r|w|h) ring; 6d10 Slashing dmg; save half; \u00BEcover",
  descriptionShorterMetric: typePF ? false : "60|6|1,5m (l|w|h) wall or 9|6|1,5m (r|w|h) ring; 6d10 Slash. dmg; save half; \u00BEcover",
  descriptionFull: "You create a wall of whirling blades made of magical energy. The wall appears within range and lasts for the duration. You make a straight wall up to 100 feet long, 20 feet high, and 5 feet thick, or a ringed wall up to 60 feet in diameter, 20 feet high, and 5 feet thick. The wall provides Three-Quarter Cover, and its space is Difficult Terrain." + "\n   " + "Any creature in the wall's space makes a Dexterity saving throw, taking 6d10 Force damage on a failed save or half as much damage on a successful one. A creature also makes that save if it enters the wall's area for the first time on a turn or starts its turn there.",
});
legacySpellRefactor("blade ward", {
  name: "Blade Ward",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 247]],
  level: 0,
  school: "Abjur",
  time: "1 a",
  range: "Self",
  components: "V,S",
  duration: "Conc, 1 min",
  description: "For the duration, when a crea makes an atk roll against you it rolls 1d4 and subtracts it from the atk roll.",
  descriptionFull: "Whenever a creature makes an attack roll against you before the spell ends, the attacker subtracts 1d4 from the attack roll."
});
legacySpellRefactor("bless", {
  name: "Bless",
  classes: ["cleric", "paladin"],
  source: [["PHB2024", 247]],
  level: 1,
  school: "Ench",
  time: "1 a",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A holy symbol worth 5+ gp",
  duration: "Conc, 1 min",
  description: "3+1/SL creatures can add 1d4 on every attack roll or saving throw during the duration",
  descriptionFull: "You bless up to three creatures within range. Whenever a target makes an attack roll or a saving throw before the spell ends, the target adds 1d4 to the attack roll or save." + AtHigherLevels + "You can target one additional creature for each spell slot above 1."
});
legacySpellRefactor("blight", {
  name: "Blight",
  classes: ["druid", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 247]],
  level: 4,
  school: "Necro",
  time: "1 a",
  range: "30 ft.",
  components: "V,S",
  duration: "Instantaneous",
  save: "Con",
  description: "1 creature takes 8d8+1d8/SL Necrotic dmg; save halves; plants have dis. on save",
  descriptionFull: "A creature that you can see within range makes a Constitution saving throw, taking 8d8 Necrotic damage on a failed save or half as much damage on a successful one. A plant creature automatically fails the save." + "\n   " + "Alternatively, target a nonmagical plant that isn't a creature, such as a tree or shrub. It doesn't make a save; it simply withers and dies." + AtHigherLevels + "The damage increases by 1d8 for each spell slot above 4."
});
legacySpellRefactor("blinding smite", {
  name: "Blinding Smite",
  classes: ["paladin"],
  source: [["PHB2024", 247 - 248]],
  level: 3,
  school: "Evoc",
  time: "1 bns",
  range: "Self",
  components: "V",
  duration: "1 min",
  save: "Con",
  description: "Next melee weapon hit +3d8+1d8/SL Radiant dmg; save or blinded; extra save at end of every turn",
  descriptionFull: "The target hit by the attack roll takes an extra 3d8 Force damage from the attack and the target must succeed on a Constitution saving throw, or it has the Blinded condition until the spell ends. At the end of each of its turns, the Blinded target makes a Constitution saving throw, ending the spell on itself on a success." + AtHigherLevels + "The extra damage increases b 1d8 for each spell slot level above 3."
});
legacySpellRefactor("blindness/deafness", {
  name: "Blindness/Deafness",
  classes: ["bard", "cleric", "sorcerer", "wizard"],
  source: [["PHB2024", 248]],
  level: 2,
  school: "Trans",
  time: "1 a",
  range: "120 ft.",
  components: "V",
  duration: "1 min",
  save: "Con",
  description: "1+1/SL crea save or blinded or deafened; extra save at end of every turn",
  descriptionFull: "One creature that you can see within range must succeed on a Constitution saving throw, or it has the Blinded or deafened condition (your choice) for the duration. At the end of each of its turns, the target repeats the save, ending the spell on itself on a success." + AtHigherLevels + "You can target one additional creature for each spell slot level above 2."
});
legacySpellRefactor("blink", {
  name: "Blink",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 248]],
  level: 3,
  school: "Trans",
  time: "1 a",
  range: "Self",
  components: "V,S",
  duration: "1 min (D)",
  description: "50% chance every turn to travel to Ethereal Plane and return to an empty space within 10 ft. next turn",
  descriptionFull: "Roll 1d6 at the end of each of your turns for the duration. On a roll of 4-6, you vanish from your current plane of existence and appear in the Ethereal Plane (the spell ends instantly if you are already on that plane). While on the Ethereal Plane, you can perceive the plane you left, which is cast in shades of gray, but you can't see anything there more than 60 feet away. You can affect and be affected only by other creatures on the Ethereal Plan, and creatures on the other plane can't perceive you unless they have a special ability that lets them perceive things on the Ethereal Plane." + "\n   " + "You return to the other plane at the start of your next turn and when the spell ends if you are on the Ethereal Plane. You return to an unoccupied space of your choice that you can see within 10 feet of the space you left. If no unoccupied space is available within that range, you appear in the nearest unoccupied space."
});
legacySpellRefactor("blur", {
  name: "Blur",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 248]],
  level: 2,
  school: "Illus",
  time: "1 a",
  range: "Self",
  components: "V",
  duration: "Conc, 1 min",
  description: "Enemies have dis. on attacks vs. me; no effect against crea without vision or immune to illus.",
  descriptionFull: "Your body becomes blurred. For the duration, any creature has Disadvantage on attack rolls against you. An attacker is immune to the effect if it perceives you with Blindsight or Truesight."
});
legacySpellRefactor("burning hands", {
  name: "Burning Hands",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 248]],
  level: 1,
  school: "Evoc",
  time: "1 a",
  range: "Self",
  components: "V,S",
  duration: "Instantaneous",
  save: "Dex",
  description: "All in area 15-ft. cone 3d6+1d6/SL Fire dmg; save halves; unattended flammable objects ignite",
  descriptionFull: "A thin sheet of flames shoots forth from you. Each creature in a 15-foot Cone makes a Dexterity saving throw, taking 3d6 Fire damage on a failed save or half as much damage on a successful one." + "\n   " + "Flammable objects in the Cone that aren't being worn or carried start burning." + AtHigherLevels + "The damage increases by 1d6 for each spell slot level above 1."
});
legacySpellRefactor("call lightning", {
  name: "Call Lightning",
  classes: ["druid"],
  source: [["PHB2024", 248]],
  level: 3,
  school: "Conj",
  time: "1 a",
  range: "120 ft.",
  components: "V,S",
  duration: "Conc, 10 min",
  save: "Dex",
  description: "60-ft. rad 10-ft. high cloud; 1 a. all in 5-ft. rad under cloud 3d10+1d10/SL Lightning dmg; save half",
  descriptionShorter: "60-ft. rad 10-ft. high cloud; 1 a. all in 5-ft. rad under it 3d10+1d10/SL Lightn. dmg; save half",
  descriptionFull: "A storm cloud appears at a point within range that you can see above yourself. It takes the shape of a Cylinder that is 10 feet tall with a 60-foot radius." + "\n   " + "When you cast the spell, choose a point you can see under the cloud. A lightning bolt shoots from the cloud to that point. Each creature within 5 feet of that point makes a Dexterity saving throw, taking 3d10 Lightning damage on a failed save or half as much damage on a successful one." + "\n   " + "Until the spell ends, you can take a Magic action to call down lightning in that way again, targeting the same point or a different one." + "\n   " + "If you're outside in a storm when you cast this spell, the spell gives you control over that storm instead of creating a new one. Under such conditions, the spell's damage increases by 1d10." + AtHigherLevels + "The damage increases by 1d10 for each spell slot level above 3."
});
legacySpellRefactor("calm emotions", {
  name: "Calm Emotions",
  classes: ["bard", "cleric"],
  source: [["PHB2024", 249]],
  level: 2,
  school: "Ench",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "Conc, 1 min",
  save: "Cha",
  description: "20-ft. rad all humanoids save or I suppress either charm/fear effects or hostility",
  descriptionFull: "Each Humanoid in a 20-foot radius Sphere centered on a point you choose within range must succeed on a Charisma saving throw or be affected by one of the following effects (choose for each creature)." +
    "\n The creature has Immunity to the Charmed and Frightened condition until the spell ends. If the creature was already Charmed or Frightened those conditions are suppressed for the duration." +
    "\n The creature becomes indifferent about creatures of your choice that it's Hostile toward. This indifference ends if the targets takes damage or witnesses its allies taking damage. When the spell ends, the creature's attitude returns to normal."
});
legacySpellRefactor("chain lightning", {
  name: "Chain Lightning",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 249]],
  level: 6,
  school: "Evoc",
  time: "1 a",
  range: "150 ft.",
  components: "V,S,M",
  compMaterial: "Three silver pins",
  duration: "Instantaneous",
  save: "Dex",
  description: "Lightning bolt 1 crea and 3+1/SL crea within 30 ft.; 10d8 Lightning dmg; save halves",
  descriptionFull: "You launch a lightning bolt toward the target you can see within range. Three bolts then leap from that target to as many as three other targets of your choice each of which must be within 30 feet of the first target. A target can be a creature or an object and can be targeted by only one of the bolts." + "\n   " + "Each target makes a Dexterity saving throw, taking 10d8 Lightning damage on a failed save or half as much damage on a successful one." + AtHigherLevels + "One additional bolt leaps from the first target to another target for each spell slot level above 6."
});
legacySpellRefactor("charm monster", {
  name: "Charm Monster",
  classes: ["bard", "druid", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 249]],
  level: 4,
  school: "Ench",
  time: "1 a",
  range: "30 ft.",
  components: "V,S",
  duration: "1 h",
  save: "Wis",
  description: "1+1/SL creatures, each max 30 ft. apart, save or charmed; adv. on save if me/ally is fighting it",
  descriptionFull: "One creature you can see within range makes a Wisdom saving throw. It does so with Advantage if you or your allies are fighting it. On a failed save, the target has the Charmed condition until the spell ends or until you or your allies damage it. The Charmed creature is Friendly to you. When the spell ends, the target knows it was Charmed by you." + AtHigherLevels + "You can target one additional creature for each spell slot level above 4."
});
legacySpellRefactor("charm person", {
  name: "Charm Person",
  classes: ["bard", "druid", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 249]],
  level: 1,
  school: "Ench",
  time: "1 a",
  range: "30 ft.",
  components: "V,S",
  duration: "1 h",
  save: "Wis",
  description: "1+1/SL humanoids, each max 30 ft. apart, save or charmed; adv. on save if me/ally is fighting it",
  descriptionFull: "One Humanoid you can see within range makes a Wisdom saving throw. It does so with Advantage if you or your allies are fighting it. On a failed save, the target has the Charmed condition until the spell ends or until you or your allies damage it. The Charmed creature Friendly to you. When the spell ends, the target knows it was Charmed by you." + AtHigherLevels + "you can target on additional creature for each spell slot level above 1."
});
legacySpellRefactor("chill touch", {
  name: "Chill Touch",
  classes: ["sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 249]],
  level: 0,
  school: "Necro",
  time: "1 a",
  range: "Touch",
  components: "V,S",
  duration: "Instantaneous",
  description: "Melee spell attack for 1d10 Necrotic dmg; can't regain HP; undead dis. atks vs. me; +1d10 at CL 5, 11, and 17",
  descriptionShorter: "Melee spell attack for 1d10 Necrotic dmg; can't regain HP; undead dis. atks vs. me; +1d10 at CL 5/11/17",
  descriptionCantripDie: "Melee spell attack for `CD`d10 Necrotic dmg; can't regain HP; undead dis. atks vs. me",
  descriptionFull: "Channeling the chill of the grave, make a melee spell attack against a target within reach. On a hit, the target takes 1d10 Necrotic damage, and it can't regain Hit Points until the end of your next turn." + "\n   " + "Cantrip Upgrade.  The damage increases by 1d10 when you reach levels 5 (2d10), 11 (3d10), and 17 (4d10)."
});
legacySpellRefactor("chromatic orb", {
  name: "Chromatic Orb",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 249]],
  level: 1,
  school: "Evoc",
  time: "1 a",
  range: "90 ft.",
  components: "V,S,M\u0192",
  compMaterial: "A diamond worth 50+ gp",
  duration: "Instantaneous",
  description: "Spell attack for 3d8+1d8/SL Acid, Cold, Fire, Lightning, Poison or Thunder dmg, if you roll 2 dice with the same number bounce the ball to 1+1/SL target(s) within 30 ft.. (50gp)",
  descriptionFull: "You hurl an orb of energy at a target within range. Choose Acid, Cold, Fire, Lightning, Poison, or Thunder for the type of orb you create, and then make a ranged spell attack against the target. On a hit, the target takes 3d8 damage of the chosen type" + "\n   " + "If you roll the same number on two or more of the d8s, the orb leaps to a different target of your choice within 30 feet of the original target, make a new attack roll against the new target, and make a new damage roll. The orb can't leap again unless you cast the spell with a level 2+ spell slot." + AtHigherLevels + "When you cast this spell using a spell slot of 2nd level or higher, the damage increases by 1d8 for each slot level above 1st.",
  dynamicDamageBonus: {
    multipleDmgTypes: {
      dmgTypes: ["acid", "cold", "fire", "lightning", "poison", "thunder"],
      inDescriptionAs: "Acid, Cold, Fire, Lightning, Poison or Thunder",
    },
  },
});
legacySpellRefactor("circle of death", {
  name: "Circle of Death",
  classes: ["sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 250]],
  level: 6,
  school: "Necro",
  time: "1 a",
  range: "150 ft.",
  components: "V,S,M\u0192",
  compMaterial: "The powder of a crushed black pearl worth 500+ gp",
  duration: "Instantaneous",
  save: "Con",
  description: "60-ft. rad all 8d6+2d6/SL Necrotic dmg; save halves (500gp)",
  descriptionFull: "Negative energy ripples out in a 60-foot-radius Sphere from a point you choose within range. Each creature in that area makes a Constitution saving throw, taking 8d8 Necrotic damage on a failed save or half as much damage on a successful one." + AtHigherLevels + "The damage increases by 2d8 for each spell slot level above 6."
});
legacySpellRefactor("circle of power", {
  name: "Circle of Power",
  classes: ["cleric", "paladin", "wizard"],
  source: [["PHB2024", 250]],
  level: 5,
  school: "Abjur",
  time: "1 a",
  range: "Self",
  components: "V",
  duration: "Conc, 10 min",
  description: "Any crea while in area adv. on saves vs. magical effects; if save would half dmg it takes no dmg",
  descriptionFull: "An aura radiates from you in a 30-foot Emanation for the duration. While in the aura, you and your allies have Advantage on saving throws against spells and other magical effects. When an affected creature makes a saving throw against a spell or magical effect that allows a save to take only half damage, it takes no damage if it succeeds on the save."
});
legacySpellRefactor("clairvoyance", {
  name: "Clairvoyance",
  classes: ["bard", "cleric", "sorcerer", "wizard"],
  source: [["PHB2024", 250]],
  level: 3,
  school: "Div",
  time: "10 min",
  range: "1 mile",
  components: "V,S,M\u0192",
  compMaterial: "A focus worth 100+ gp, either a jeweled horn for hearing or a glass eye for seeing",
  duration: "Conc, 10 min",
  description: "See or hear a familiar place; 1 a to switch between seeing and hearing (100gp)",
  descriptionFull: "You create an invisible sensor within range in a location familiar to you (a place you have visited or seen before) or in an obvious location that is unfamiliar to you (such as behind a door, around a corner, or in a grove of trees). The intangible, invulnerable sensor remains in place for the duration." + "\n   " + "When you cast the spell, choose seeing or hearing. You can use the chosen sense through the sensor as if you were in its space. As a Bonus Action, you can switch between seeing and hearing." + "\n   " + "A creature that sees the sensor (such as a creature benefiting from See Invisibility or Truesight) sees a luminous orb about the size of your fist."
});
legacySpellRefactor("clone", {
  name: "Clone",
  classes: ["wizard"],
  source: [["PHB2024", 251]],
  level: 8,
  school: "Necro",
  time: "1 h",
  range: "Touch",
  components: "V,S,M\u2020",
  compMaterial: "A diamond worth 1000+ gp, which the spell consumes, and a sealable vessel worth 2000+ gp that is large enough to hold the creature being cloned",
  duration: "Instantaneous",
  description: "Create a clone of a living crea; after death its soul can move to the clone (1K gp cons.; 2K gp)",
  descriptionFull: "You touch a creature or at least 1 cubic inch of its flesh the vessel used in this spell's casting and finishes growing after 120 days; you choose whether the finished clone is the same age as the creature or younger. The clone remains inert and endures indefinitely while its vessel remains undisturbed." + "\n   " + "If the original creature dies after the clone finishes forming, the creature's soul transfer to the clone if the soul is free and willing to return. The clone is physically identical to the original and has the same personality, memories, and abilities, but none of the original's equipment. The creature's original remains, if any, become inert and can't be revived, since the creature's soul is elsewhere."
});
legacySpellRefactor("cloudkill", {
  name: "Cloudkill",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 251]],
  level: 5,
  school: "Conj",
  time: "1 a",
  range: "120 ft.",
  components: "V,S",
  duration: "Conc, 10 min",
  save: "Con",
  description: "20-ft. rad 5d8+1d8/SL Poison dmg; save halves; move 10 ft./rnd; heavily obscured",
  descriptionShorter: "20-ft. rad 5d8+1d8/SL Poison dmg; save halves; move 10 ft./rnd; heavily obscured",
  descriptionFull: "You create a 20-foot-radius Sphere of yellow-green fog centered on a point within range. The fog lasts for the duration or until string wind (such as the one created by Gust of Wind) disperses it, ending the spell. Its area is Heavily Obscured." + "\n   " + "Each creature in the Sphere makes a Constitution saving throw, taking 5d8 Poison damage on a failed save or half as much damage on a successful one. A creature also make this save when the Sphere moves into its space or ends its turn there." + "\n   " + "The Sphere moves 10 feet away from you at the start of your turns." + AtHigherLevels + "The damage increases by 1d8 for each spell slot level above 5."
});
legacySpellRefactor("cloud of daggers", {
  name: "Cloud of Daggers",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 251]],
  level: 2,
  school: "Conj",
  time: "1 a",
  range: "60 ft.",
  components: "V,S,M",
  compMaterial: "A sliver of glass",
  duration: "Conc, 1 min",
  description: "5-ft. cube 4d4+2d4/SL Slashing dmg to all that enter or start turn in area",
  descriptionFull: "You conjure spinning daggers in a 5-foot Cube centered on a point within range. Each creature in that area takes 4d4 Slashing damage. A creature also takes this damage if it enters the Cube or ends its turn there or if the Cube moves into its space. A creature takes this damage only once per turn." + "\n   " + "On your later turns, you can take a Magic action to teleport the Cube up to 30 feet." + AtHigherLevels + "The damage increases by 2d4 for each spell slot level above 2."
});
legacySpellRefactor("color spray", {
  name: "Color Spray",
  classes: ["bard", "sorcerer", "wizard"],
  source: [["PHB2024", 251]],
  level: 1,
  school: "Illus",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "A pinch of colorful sand",
  duration: "Instantaneous",
  save: "Con",
  description: "15-foot Cone all crea in area Con Save or have Blinded condition till end of your next turn.",
  descriptionFull: "You launch a dazzling array of flashing, colorful light. Each creature in a 15-foot Cone originating from you must succeed on a Constitution saving throw or have the Blinded condition until the end of your next turn."
});
legacySpellRefactor("command", {
  name: "Command",
  classes: ["bard", "cleric", "paladin"],
  source: [["PHB2024", 251]],
  level: 1,
  school: "Ench",
  time: "1 a",
  range: "60 ft.",
  components: "V",
  duration: "Instantaneous",
  save: "Wis",
  description: "1+1/SL crea, each max 30 ft. apart, save or follow one word command, e.g. approach, drop, flee, halt",
  descriptionFull: "You speak a one-word command to a creature you can see within range. The target must succeed on a Wisdom saving throw or follow the command on its next turn. Choose the command from these options." + "\n   " + toUni("Approach") + ": The target moves toward you by the shortest and most direct route, ending its turn if it moves within 5 feet of you." + "\n   " + toUni("Drop") + ": The target drops whatever it is holding and then ends its turn." + "\n   " + toUni("Flee") + ": The target spends its turn moving away from you by the fastest available means." + "\n   " + toUni("Grovel") + ": The target has the Prone condition and then ends its turn." + "\n   " + toUni("Halt") + ": On its turn, the target doesn't move and takes no action or Bonus Action." + AtHigherLevels + "You can affect one additional creature for each spell slot level above 1."
});
legacySpellRefactor("commune", {
  name: "Commune",
  classes: ["cleric"],
  source: [["PHB2024", 252]],
  ritual: true,
  level: 5,
  school: "Div",
  time: "1 min",
  range: "Self",
  components: "V,S,M",
  compMaterial: "Incense",
  duration: "1 min",
  description: "Ask up to three yes/no questions to my deity or a divine proxy (25gp)",
  descriptionFull: "You contact a deity or a divine proxy and ask up to three questions that can be answered with a yes or no. You must ask your questions before the spell ends. You receive a correct answer for each question." + "\n   " + "Divine beings aren't necessarily omniscient, so you might receive \"unclear\" as an answer if a question pertains to information that lies beyond the deity's knowledge. In a case where a one-word answer could be misleading or contrary to the deity's interests, the DM might offer a short phrase as an answer instead." + "\n   " + "If you cast the spell more than one before finishing a Long Rest, there is a cumulative 25 percent chance for each casting after the first that you get no answer."
});
legacySpellRefactor("commune with nature", {
  name: "Commune with Nature",
  nameShort: "Commune w. Nature",
  classes: ["druid", "ranger"],
  source: [["PHB2024", 252]],
  ritual: true,
  level: 5,
  school: "Div",
  time: "1 min",
  range: "Self",
  components: "V,S",
  duration: "Instantaneous",
  description: "Know 3 facts about natural features in 3 miles rad (300 ft. rad underground)",
  descriptionFull: "You commune with nature spirits and gain knowledge of the surrounding area. In the outdoors, the spell gives you knowledge of the area within 3 miles of you. In caves and other natural underground settings, the radius is limited to 300 feet. The spell doesn't function where nature has been replaced by construction, such as in castles and settlements." + "\n   " + "Choose three of the following facts; you learn those facts as the pertain to the spell's area." + "\n   " + "Locations of Settlements, Locations of portals to other planes of existence, Location of one Challenge Rating 10+ creature (DM's choice) that is a Celestial, an Elemental, a Fey, a Fiend, or an Undead, The most prevalent, kind of plant, mineral, or Beast (you choose which to learn), Locations of bodies of water. For example you could determine the location of a powerful monster in the are, the location of bodies of water, and the locations of any towns."
});
legacySpellRefactor("compelled duel", {
  name: "Compelled Duel",
  classes: ["paladin"],
  source: [["PHB2024", 252]],
  level: 1,
  school: "Ench",
  time: "1 bns",
  range: "30 ft.",
  components: "V",
  duration: "Conc, 1 min",
  save: "Wis",
  description: "1 crea save or dis. on attacks vs. not-me and save if moving more than 30 ft. away",
  descriptionFull: "You try to compel a creature into a duel. One creature that you can see within range makes Wisdom saving throw. On a failed save, the target has Disadvantage on attack rolls against creatures other than you, and it can't willingly move to a space that is more than 30 feet away from you." + "\n   " + "The spell ends if you make an attack roll against a creature other than the target, if you cast a spell on an enemy other than the target, if an ally of yours damages the target, or if your end your turn more than 30 feet away form the target."
});
legacySpellRefactor("comprehend languages", {
  name: "Comprehend Languages",
  nameShort: "Comp. Languages",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 252]],
  ritual: true,
  level: 1,
  school: "Div",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "A pinch of soot and salt",
  duration: "1 h",
  description: "Understand all spoken language or written language when touched; does not help vs. ciphers",
  descriptionFull: "For the duration, you understand the literal meaning of any language that you hear or see signed. You also understand any written language that you can see, but you must be touching the surface on which the words are written. It takes about 1 minute to read one page of text. This spell doesn't decode symbols or secret messages."
});
legacySpellRefactor("compulsion", {
  name: "Compulsion",
  classes: ["bard"],
  source: [["PHB2024", 252]],
  level: 4,
  school: "Ench",
  time: "1 a",
  range: "30 ft.",
  components: "V,S",
  duration: "Conc, 1 min",
  save: "Wis",
  description: "Any crea that hear me save or I can, as bns, have it move fully in one direction; save again after move",
  descriptionFull: "Each creature of your choice that you can see within range must succeed on a Wisdom saving throw or have the Charmed condition until the spell ends." + "\n   " + "For the duration, you can take a Bonus Action to designate a direction that is horizontal to you. Each Charmed target must use as much of its movement as possible to move in a direction on its next turn, taking the safest route. After moving in this way, a target repeats the save, ending the spell on itself on a success."
});
legacySpellRefactor("cone of cold", {
  name: "Cone of Cold",
  classes: ["druid", "sorcerer", "wizard"],
  source: [["PHB2024", 253]],
  level: 5,
  school: "Evoc",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "A small crystal or glass cone",
  duration: "Instantaneous",
  save: "Con",
  description: "8d8+1d8/SL Cold dmg; save halves; crea killed become frozen statues until thawed",
  descriptionFull: "You unleash a blast of cold air. Each creature in a 60-foot Cone originating from you makes a Constitution saving throw, taking 8d8 Cold damage on a failed save or half as much damage on a successful one. A creature killed by this spell becomes a frozen statue until it thaws." + AtHigherLevels + "The damage increases by 1d8 for each spell slot level above 5."
});
legacySpellRefactor("confusion", {
  name: "Confusion",
  classes: ["bard", "druid", "sorcerer", "wizard"],
  source: [["PHB2024", 253 - 254]],
  level: 4,
  school: "Ench",
  time: "1 a",
  range: "90 ft.",
  components: "V,S,M",
  compMaterial: "Three nut shells",
  duration: "Conc, 1 min",
  save: "Wis",
  description: "10+5/SL-ft. rad all save or confused, see book; extra save at end of every turn",
  descriptionFull: "Each creature in a 10-foot-radius Sphere centered on a point you choose within range must succeed on a Wisdom saving throw, or that target can't take Bonus Actions or Reactions and must roll 1d10 at the start of each of its turns to determine its behavior for that turn, consulting the table below." + "\n\n" + toUni("d10") + "\t" + toUni("Behavior") + "\n   " + "1\tThe target doesn't take an action, and it uses all its movement to move. Roll 1d4 for the direction: 1, north; 2, east; 3, south; or 4,west." + "\n   " + "2-6\tThe target doesn't move or take actions." + "\n   " + "7-8\tThe target doesn't move, and it takes the Attack action to make one melee attack against a random creature within reach. If none are within reach, the target takes no action." + "\n   " + "9-10\tThe target can act and move normally." + "\n\n" + "At the end of each of its turns, an affected target repeats the save, ending the spell on itself on a success." + AtHigherLevels + "The Sphere's radius increases by 5 feet for each spell slot level above 4."
});
legacySpellRefactor("conjure animals", {
  name: "Conjure Animals",
  classes: ["druid", "ranger"],
  source: [["PHB2024", 254]],
  level: 3,
  school: "Conj",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  save: "Dex",
  duration: "Conc, 10 min",
  description: "Summon a pack of animal spirits, you gain adv on str saves when within 5 feet of pack, when you move, you can move the pack 30 ft. to an unoccupied space you can see, when within 10 feet of the pack crea. make a Dex save or take 3d10+1d10/SL Slash. dmg once per turn.",
  descriptionFull: "You conjure nature spirits that appear as a Large pack of spectral, intangible animals in an unoccupied space you can see within range. The pack lasts for the duration, and you choose the spirits' animal form, such as wolves, serpents, or birds." + "\n   " + "You have Advantage on Strength saving throws while you're within 5 feet of the pack, and when you move on your turn, you can also move the pack up to 30 feet to an unoccupied space you can see." + "\n   " + "Whenever the pack moves within 10 feet of a creature you can see and whenever a creature you can see enters a space within 10 feet of the pack or ends its turn there, you can force that creature to make a Dexterity saving throw. On a failed save, the creature takes 3d10 Slashing damage. A creature makes this save only once per turn." + AtHigherLevels + "The damage increases by 1d10 for each sell slot level above 3."
});
legacySpellRefactor("conjure barrage", {
  name: "Conjure Barrage",
  classes: ["ranger"],
  source: [["PHB2024", 254]],
  level: 3,
  school: "Conj",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "A melee or ranged weapon worth at least 1 cp",
  duration: "Instantaneous",
  save: "Dex",
  description: "60-ft. Cone Throw weapon or ammo; copies rain down for 5d8+1d8/SL force dmg; save halves",
  descriptionFull: "You brandish the weapon used to cast the spell and conjure similar spectral weapons (or ammunition appropriate to the weapon) that launch forward and then disappear. Each creature of your choice that you can see in a 60-foot Cone makes a Dexterity saving throw, taking 5d8 Force damage on a failed save or half as much damage on a successful one." + AtHigherLevels + "The damage increases by 1d8 for each spell slot level above 3."
});
legacySpellRefactor("conjure celestial", {
  name: "Conjure Celestial",
  classes: ["cleric"],
  source: [["PHB2024", 254]],
  level: 7,
  school: "Conj",
  time: "1 a",
  range: "90 ft.",
  components: "V,S",
  duration: "Conc, 10 min",
  description: "Conjure a Celestial spirit that takes the form of a 10ftx40ft Cylinder of Bright light that deals 6d12+1d12/SL Rad dmg, or heals 4d12+1d12/SL HP plus your spellcasting ability mod. move up to 30 ft.. when you take your movement on your turn.",
  descriptionFull: "You conjure a spirit from the Upper planes, which manifests as a pillar of light in a 10-foot-radius, 40-foot-high Cylinder centered on a point within range. For each creature you can see in the Cylinder, choose which one of these lights shines on it:" + "\n   " + "Healing Light. The target regains Hit Points equal to 4d12 plus your spellcasting ability modifier." + "\n   " + "Searing Light. The target makes a Dexterity saving throw, taking 5d12 Radiant damage on a failed save or half as much damage on a successful one." + "\n   " + "Until the spell ends, Bright Light fills the Cylinder, and when you move on your turn, you can also move the Cylinder up to 30 feet." + "\n   " + "Whenever the Cylinder moves into the space of a creature you can see and whenever a creature you can see enters the Cylinder or ends its turn there you can bathe it in one of the lights. A creature can be affected by this spell only once per turn." + AtHigherLevels + "The healing and damage increases by 1d12 for each spell slot level above 7."
});
legacySpellRefactor("conjure elemental", {
  name: "Conjure Elemental",
  classes: ["druid", "wizard"],
  source: [["PHB2024", 254]],
  level: 5,
  school: "Conj",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "Conc, 10 min",
  description: "Conjure an Elemental Spirit to an unoccupied space within range, when a crea. enters its space or comes within 5 ft.. Dex save, or Restrained and take 8d8 (a.Lightn., e.Thund., f.fire, w.Cold) dmg, at start of turn Dex save on fail, 4d8 dmg, on success no longer restrained.",
  descriptionFull: "You conjure a Large, intangible spirit from the Elemental Planes that appears in an unoccupied space within range. Choose the spirit's element, which determines its damage type: air (Lighting), earth (Thunder), fire (Fire), or water (Cold), the spirit lasts for the duration." + "\n   " + "Whenever a creature you can see enters the spirit's space or stats its turn within 5 feet of the spirit, you can force that creature to make a Dexterity saving throw if the spirit has no creature Restrained. On failed save, the target takes 8d8 damage of the spirit's type, and the target has the Restrained condition until the spell ends. At the start of each of its turns, the Restrained target repeats the save. On a failed save, the target takes 4d8 damage of the spirit's type. On a successful save the target isn't Restrained by the spirit.",
});
legacySpellRefactor("conjure fey", {
  name: "Conjure Fey",
  classes: ["druid"],
  source: [["PHB2024", 255]],
  level: 6,
  school: "Conj",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "Conc, 10 min",
  description: "Conj. a Med Fey Spirit, make one melee spell atk against a crea w/i 5ft of the spirit dealing 3d12+2d12/SL plus casting ability mod, crea has fright. cond until start of next turn. As Bns on subsequent turns can teleport spirit up to 30 feet and make atk.",
  descriptionFull: "You conjure a Medium spirit from the Feywild in an unoccupied space you can see within range. The spirit lasts for the duration, and it looks like a Fey creature of your choice. When the spirit appears, you can make one melee spell attack against a creature within 5 feet of it. On a hit, the target takes Psychic damage equal to 3d12 plus your spellcasting ability modifier, and the target has the Frightened condition until the start of your next turn, with both you and the spirit as the source of the fear." + "\n   " + "As a Bonus Action on your later turns, you can teleport the spirit to an unoccupied space you can see within 30 feet of the space it left, and make the attack against a creature within 5 feet of it." + AtHigherLevels + "The damage increases by 2d12 for each spell slot level above 6."
});
legacySpellRefactor("conjure minor elementals", {
  name: "Conjure Minor Elementals",
  nameShort: "Conj. Minor Elementals",
  classes: ["druid", "wizard"],
  source: [["PHB2024", 255]],
  level: 4,
  school: "Conj",
  time: "1 a",
  range: "Self",
  components: "V,S",
  duration: "Conc, 10 min",
  description: "You summon elemental spirits that flit around you in 15-ft. emanation, when you hit a crea with an atk you deal an extra 2d8+2d8/SL Acid/Cold/Fire/Lightn. dmg, the emanation is considered Diff. Terr. for enemies.",
  descriptionFull: "You conjure spirits from the Elemental Plans that flit around you in a 15-foot Emanation for the duration. Until the spell ends, any attack you make deals an extra 2d8 damage when you hit a creature in the Emanation. This damage is Acid, Cold, Fir, or Lightning (your choice when you make the attack)." + "\n   " + "In addition, the ground in the Emanation is Difficult Terrain for your enemies." + AtHigherLevels + "The damage increases by 2d8 for each spell slot level above 4."
});
legacySpellRefactor("conjure volley", {
  name: "Conjure Volley",
  classes: ["ranger"],
  source: [["PHB2024", 255]],
  level: 5,
  school: "Conj",
  time: "1 a",
  range: "150 ft.",
  components: "V,S,M",
  compMaterial: "A melee or ranged weapon worth at least 1 cp",
  duration: "Instantaneous",
  save: "Dex",
  description: "Turn ammo/thrown wea into volley; 40-ft. rad 20-ft. high 8d8 dmg; dmg type as weapon; save halves",
  descriptionFull: "You brandish the weapon used to cast the spell and choose a point within range. Hundreds of similar spectral weapons (or ammunition appropriate to the weapon) that launch forward and then disappear. Each creature of your choice that you can see in a 40-foot-radius, 20-foot-high Cylinder centered on that point makes a Dexterity saving throw. A creature takes 8d8 Force damage on a failed save or half as much damage on a successful one."
});
legacySpellRefactor("conjure woodland beings", {
  name: "Conjure Woodland Beings",
  nameShort: "Conj. Woodland Beings",
  classes: ["druid", "ranger"],
  source: [["PHB2024", 255]],
  level: 4,
  school: "Conj",
  time: "1 a",
  range: "60 ft.",
  components: "V,S,M",
  compMaterial: "One holly berry per creature summoned",
  duration: "Conc, 1 h",
  description: "You summon a 10-foot emanation that takes the form of nature spirits, when a crea that you can see enters the space it must make a Wis save or take 5d8+1d8/SL force dmg. Half as much on a success, you can also take the Disengage action as a bns for the duration.",
  descriptionFull: "You conjure nature spirits that flit around you in a 10-foot Emanation for the duration. Whenever the Emanation enters the space of a creature you can see and whenever a creature you can see enters the Emanation or ends its turn there, you can force that creature to make a Wisdom saving throw. The creature takes 5d8 Force damage on a failed save or half as much damage on a successful one. A creature makes this save only once per turn." + "\n   " + "In addition, you can take the Disengage action as a Bonus Action for the spell's duration." + AtHigherLevels + "The damage increases by 1d8 for each spell slot level above 5."
});
legacySpellRefactor("contact other plane", {
  name: "Contact Other Plane",
  classes: ["warlock", "wizard"],
  source: [["PHB2024", 255]],
  ritual: true,
  level: 5,
  school: "Div",
  time: "1 min",
  range: "Self",
  components: "V",
  duration: "1 min",
  save: "Int",
  description: "I make DC 15 save to ask extra planar entity 5 questions with one word answers; 6d6 Psy. dmg. on fail",
  descriptionFull: "You mentally contact a demigod, the spirit of a long-dead sage, or some other knowledgeable entity from another plane. Contacting this otherworldly intelligence can break your mind. When you cast this spell, make a DC 15 Intelligence saving throw. On a successful save, you can ask the entity up to five questions. You must ask your questions before the spell ends. The DM answers each question with one word, such as \"yes\", \"no\", \"maybe\", \"maybe\", \"never\", \"irrelevant\", or \"unclear\" (if the entity doesn't know the answer to the question. If a one-word answer would be misleading, the DM might instead offer a short phrase as an answer." + "\n   " + "On a failed save, you take 6d6 Psychic damage and have the Incapacitated condition until you finish a Long Rest. A Greater Restoration spell cast on you ends this effect."
});
legacySpellRefactor("contagion", {
  name: "Contagion",
  classes: ["cleric", "druid"],
  source: [["PHB2024", 256]],
  level: 5,
  school: "Necro",
  time: "1 a",
  range: "Touch",
  components: "V,S",
  duration: "7 days",
  save: "Con",
  description: "Melee spell attack for Con save or take 11d8 Necrotic, Poisoned + Dis Adv on one save of choice; save each rnd, 3 success: spell ends, 3 fail: poisoned lasts for 7 days",
  descriptionFull: "Your touch inflicts a magical contagion. The target must succeed on a Constitution saving throw or take 11d8 Necrotic damage and have the Poisoned condition. Also, choose one ability when you cast the spell. While Poisoned, the target has Disadvantage on saving throws made with the chosen ability.." + "\n   " + "The target must repeat the saving throw at the end of each of its turns until it gets three successes or failures. If the target succeeds on three of these saves, the spell ends on the target. IF the target fails three of the saves, the spell lasts for 7 days on it." + "\n   " + "Whenever the Poisoned target receives an effect that would end the Poisoned condition, the target must succeed on a Constitution saving throw, or the Poisoned condition doesn't end on it."
});
legacySpellRefactor("contingency", {
  name: "Contingency",
  classes: ["wizard"],
  source: [["PHB2024", 256]],
  level: 6,
  school: "Evoc",
  time: "10 min",
  range: "Self",
  components: "V,S,M\u0192",
  compMaterial: "a gem-encrusted statuette of yourself worth 1500 gp",
  duration: "10 days",
  description: "Prepare another SL<6 spell I can cast to activate when some condition is met (1500gp)",
  descriptionFull: "Choose a spell of level 5 or lower that you can cast, that has a casting time of an action, and that can target you. You cast that spell - called the contingent spell - as part of casting Contingency, expending spell slots for both, both the contingent spell doesn't come into effect. Instead, it takes effect when a certain trigger occurs. You describe that trigger when you cast the two spells. For example, a Contingency cast with Water Breathing might stipulate that Water Breathing comes into effect when you are engulfed in water or a similar liquid." + "\n   " + "The contingent spell takes effect immediately after the trigger occurs for the first time, whether or not you want it to, and hen Contingency ends." + "\n   " + "The contingent spell takes effect only on you, even if it can normally target others. You can use only one Contingency spell at a time. If you cast this spell again, the effect of another Contingency spell on you ends. Also, Contingency ends on you if its material component is ever not on your person."
});
legacySpellRefactor("continual flame", {
  name: "Continual Flame",
  classes: ["cleric", "druid", "wizard"],
  source: [["PHB2024", 256]],
  level: 2,
  school: "Evoc",
  time: "1 a",
  range: "Touch",
  components: "V,S,M\u2020",
  compMaterial: "Ruby dust worth 50+ gp, which the spell consumes",
  duration: "Until dispelled",
  description: "Create a permanent flame (50gp cons.)",
  descriptionFull: "A flame springs from an object that you touch. The effect casts Bright Light in a 20-foot radius and Dim Light for an additional 20 feet. It looks like a regular flame, but it creates no heat and consumes no fuel. The flame can be covered or hidden but not smothered or quenched."
});
legacySpellRefactor("control water", {
  name: "Control Water",
  classes: ["cleric", "druid", "wizard"],
  source: [["PHB2024", 256]],
  level: 4,
  school: "Trans",
  time: "1 a",
  range: "300 ft.",
  components: "V,S,M",
  compMaterial: "A drop of water and a pinch of dust",
  duration: "Conc, 10 min",
  description: "Control an amount of water in a 100 ft. cube as 1 a; flood, part, redirect, or whirlpool, see book",
  descriptionFull: "Until the spell ends, you control any water inside an area you choose that is a Cube up to 100 feet on a side, using one of the following effects. As a Magic action on your later turns, you can repeat the same effect or choose a different one." + "\n   " + toUni("Flood") + ": You cause the water level of all standing water in the area to rise by as much as 20 feet. If you choose an area in a large body of water, you instead create a 20-foot tall wave that travels from one side of the area to the other and then crashes. Any Huge or smaller vehicles in the wave's path are carried with it to the other side. Any Huge or smaller vehicles struck by the wave have a 25 percent chance of capsizing." + "\n   " + "The water level remains elevated until the spell ends or you choose a different effect. If this effect produces a wave, the wave repeats on the start of your next turn while the flood effect lasts." + "\n   " + toUni("Part Water") + ": You part water in the are and create a trench. The trench extends across the spell's area, and the separated water forms a wall to either side. The trench remains until the spell ends or you choose a different effect. The water then slowly fills in the trench over the course of the next round until the normal water level is restored." + "\n   " + toUni("Redirect Flow") + ": You cause flowing water in the area to move in a direction you choose, even if the water has to flow over obstacles, up walls, or in other unlikely directions. The water in the area moves as you direct it, but once it moves beyond the spell's area, it resumes its flow based on the terrain conditions. The water continues to move in the direction you chose until the spell ends or you choose a different effect." + "\n   " + toUni("Whirlpool") + ": You cause a whirlpool to form in the center of the area, which must be at least 50 feet square and 25 feet deep. The whirlpool lasts until you choose a different effect or the spell ends. The whirlpool is 5 feet wide at the base, up to 50 feet wide at the top, and 25 feet tall. Any creature in the water and within 25 feet of the whirlpool is pulled 10 feet toward it. When a creature enters the whirlpool for the first time on a turn or ends its turn there, it makes a strength saving throw. On a failed save, the creature takes 2d8 Bludgeoning damage. On a successful save, the creature takes half as much damage. A creature can swim away from the whirlpool only if it first takes an action to pull away and succeeds on a Strength (Athletics) check against your spell save DC."
});
legacySpellRefactor("control weather", {
  name: "Control Weather",
  classes: ["cleric", "druid", "wizard"],
  source: [["PHB2024", 257]],
  level: 8,
  school: "Trans",
  time: "10 min",
  range: "Self",
  components: "V,S,M",
  compMaterial: "Burning incense",
  duration: "Conc, 8 h",
  description: "Change current weather; changes take 1d4\xD710 min; change precipitation, temperature, wind, see B",
  descriptionFull: "You take control of the weather within 5 miles of you for the duration. You must be outdoors to cast this spell. Moving to a place where you don't have a clear path to the sky ends the spell early." + "\n   " + "When you cast the spell, you change the current weather conditions, which are determined by the DM based on the climate and season. You can change precipitation, temperature, and wind. It takes 1d4 \xD7 10 minutes for the new conditions to take effect. Once they do so, you can change the conditions again. When the spell ends, the weather gradually returns to normal." + "\n   " + "When you change the weather conditions, find a current condition on the following tables and change its stage by one, up or down. When changing the wind, you can change its direction." + "\n\n" + toUni("Precipitation") + "\n " + toUni("Stage") + "\t" + toUni("Condition") + "\n     " + "1\tClear" + "\n     " + "2\tLight clouds" + "\n     " + "3\tOvercast or ground fog" + "\n     " + "4\tRain, hail or snow" + "\n     " + "5\tTorrential rain, driving hail or blizzard" + "\n\n" + toUni("Temperature") + "\t\t" + toUni("Wind") + "\n " + toUni("Stage") + "\t" + toUni("Condition") + "\t " + toUni("Stage") + "\t" + toUni("Condition") + "\n     " + "1\tUnbearable heat" + "\t     " + "1\tCalm" + "\n     " + "2\tHot" + "\t\t     " + "2\tModerate wind" + "\n     " + "3\tWarm" + "\t\t     " + "3\tStrong wind" + "\n     " + "4\tCool" + "\t\t     " + "4\tGale" + "\n     " + "5\tCold" + "\t\t     " + "5\tStorm" + "\n     " + "6\tArctic cold"
});
legacySpellRefactor("cordon of arrows", {
  name: "Cordon of Arrows",
  classes: ["ranger"],
  source: [["PHB2024", 258]],
  level: 2,
  school: "Trans",
  time: "1 a",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "An ornamental braid",
  duration: "8 h",
  save: "Dex",
  description: "4+2/SL arrows/bolts attack first crea in 30 ft. one at a time for 2d4 Piercing dmg",
  descriptionFull: "You touch up to four nonmagical Arrows or Bolts and plant them in the ground in your space. Until the spell ends, the ammunition can't be physically uprooted, and whenever a creature other than you enters a space within 30 feet of the ammunition for the first time on a turn or ends its turn there, one piece of ammunition flies up to strike it. The creature must succeed on a Dexterity saving throw or take 2d4 Piercing damage. The piece of ammunition is then destroyed. The spell ends when none of the ammunition remains planted in the ground." + "\n   " + "When you cast this spell, you can designate any creatures you choose, and the spell ignores them." + AtHigherLevels + "The amount of ammunition that can be affected increases by two for each spell slot level above 2."
});
legacySpellRefactor("counterspell", {
  name: "Counterspell",
  classes: ["sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 258]],
  level: 3,
  school: "Abjur",
  time: "1 rea",
  timeFull: "1 reaction, which you take when you see a creature within 60 feet of you casting a spell with Verbal, Somatic, or Material components",
  range: "60 ft.",
  components: "S",
  duration: "Instantaneous",
  save: "Con",
  description: "Stop a spell being cast, target makes Con save, on fail spell dissipates with no effect, wasting the action, but not the slot.",
  descriptionFull: "You attempt to interrupt a creature in the process of casting a spell. The creature makes a Constitution saving throw. On a failed save, the spell dissipates with no effect, and the action, Bonus Action or Reaction used to cast it is wasted. If that spell was cast with a spell slot, the slot isn't expended."
});
legacySpellRefactor("create food and water", {
  name: "Create Food and Water",
  classes: ["cleric", "paladin"],
  source: [["PHB2024", 258]],
  level: 3,
  school: "Conj",
  time: "1 a",
  range: "30 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "Create 45 pounds of food and 30 gallons of fresh water; enough for 15 humanoids or 5 steeds for 24h",
  descriptionFull: "You create 45 pounds of food and 30 gallons of fresh water on the ground or in containers within range - both useful in fending off the hazards of malnutrition and dehydration. The food is bland but nourishing, and spoils if uneaten after 24 hours. The water is clean and doesn't go bad."
});
legacySpellRefactor("create or destroy water", {
  name: "Create or Destroy Water",
  classes: ["cleric", "druid"],
  source: [["PHB2024", 258]],
  level: 1,
  school: "Trans",
  time: "1 a",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A mix of water and sand",
  duration: "Instantaneous",
  description: "Create/destroy 10+10/SL gal of water in open container or create rain/destroy fog in 30+5/SL-ft. cu",
  descriptionFull: "You do one of the following." + "\n   " + toUni("Create Water") + ": You create up to 10 gallons of clean water within range in an open container. Alternatively, the water falls as rain in a 30-foot cube within range, extinguishing exposed flames in the area." + "\n   " + toUni("Destroy Water") + ": You destroy up to 10 gallons of water in an open container within range. Alternatively, you destroy fog in a 30-foot cube within range." + AtHigherLevels + "When you cast this spell using a spell slot of 2nd level or higher, you create or destroy 10 additional gallons of water, or the size of the cube increases by 5 feet, for each slot level above 1st."
});
legacySpellRefactor("create undead", {
  name: "Create Undead",
  classes: ["cleric", "warlock", "wizard"],
  source: [["PHB2024", 258 - 259]],
  level: 6,
  school: "Necro",
  time: "1 min",
  range: "10 ft.",
  components: "V,S,M\u2020",
  compMaterial: "one 150+ gp black onyx stone for each corpse.",
  duration: "Instantaneous",
  description: "Turn corpses into 3+1/SL ghouls i.a.; control 24h; bns a command 120 ft.; see B (150gp/corpse cons.)", // i.a. -> inter alia -> among others
  descriptionFull: "You can cast this spell only at night. Choose up to three corpses of Medium or Small Humanoids within range. Each one becomes a Ghoul under your control (see the Monster Manual for its stat block)." + "\n   " + "As a Bonus Action on each of your turns, you can mentally command any creature you animated with this spell if the creature is within 120 feet of you (if you control multiple creatures, you can command all of them at the same time, issuing the same command to them). You decide what action the creature will take and where it will move on its next turn, or you can issue a general command, such as to guard a particular place. If you issue no commands, the creature takes the Dodge action and moves only to avoid harm. Once given an order, the creature continues to follow the order until its task is complete." + "\n   " + "The creature is under your control for 24 hours, after which it stops obeying any command you have given it. To maintain control of the creature for another 24 hours, you must cast this spell on the creature before the current 24-hour period ends. This use of the spell reasserts your control over up to three creatures you have animated with this spell, rather than animating new ones." + AtHigherLevels + "When you cast this spell using a 7th-level spell slot, you can animate or reassert control over four ghouls. When you cast this spell using an 8th-level spell slot, you can animate or reassert control over five ghouls or two ghasts or wights. When you cast this spell using a 9th-level spell slot, you can animate or reassert control over six ghouls, three ghasts or wights, or two mummies."
});
legacySpellRefactor("creation", {
  name: "Creation",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 259]],
  level: 5,
  school: "Illus",
  time: "1 min",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A paintbrush",
  duration: "Special",
  description: "Create a nonliving object up to a 5+5/SL-ft. cube of vegetable matter, stone, metal, gems or rare metals",
  descriptionFull: "You pull wisps of shadow material from the Shadowfell to create a nonliving object of vegetable matter within range - soft goods, rope, wood, or something similar. You can also use this spell to create mineral objects such as stone, crystal, or metal. The object created must be no larger than a 5-foot cube, and the object must be of a form and material that you have seen before." + "\n   " + "The duration depends on the object's material. If the object is composed of multiple materials, use the shortest duration." + "\n\n" + toUni("Material") + "\t\t" + toUni("Duration") + "\n" + "Vegetable matter\t1 day" + "\n" + "Stone or crystal\t12 hours" + "\n" + "Precious metals\t1 hour" + "\n" + "Gems\t\t10 minutes" + "\n\n" + "Adamantine/Mithral - 1 minute" + "\n   " + "Using any material created by this spell as another spell's material component causes that spell to fail." + AtHigherLevels + "The Cube increases by 5 feet for each spell slot level above 5."
});
legacySpellRefactor("crown of madness", {
  name: "Crown of Madness",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 259]],
  level: 2,
  school: "Ench",
  time: "1 a",
  range: "120 ft.",
  components: "V,S",
  duration: "Conc, 1 min",
  save: "Wis",
  description: "1 humanoid save or charmed and must melee attack against crea chosen by me; extra save/rnd",
  descriptionFull: "One creature that you can see within range must succeed on a Wisdom saving throw or have the Charmed condition for the duration. The creature succeeds automatically if it isn't Humanoid." + "\n   " + "A spectral crown appears on the Charmed target's head, and a madness glows in its eyes." + "\n   " + "The charmed target must use each of its turns to make a melee attack against a creature other than itself that you mentally choose. The target can act normally on its turn if you choose no creature or if no creature is within its reach. The target repeats the save at the end of each of its turns, ending the spell on itself on a success." + "\n   " + "On your later turns, you must take the Magic action to maintain control of the target, or the spell ends."
});
legacySpellRefactor("crusader's mantle", {
  name: "Crusader's Mantle",
  classes: ["paladin"],
  source: [["PHB2024", 259]],
  level: 3,
  school: "Evoc",
  time: "1 a",
  range: "Self",
  components: "V",
  duration: "Conc, 1 min",
  description: "30-foot Emanation, Me and allies in range deal extra 1d4 Radiant dmg with weapon attacks",
  descriptionFull: "You radiate a magical aura in a 30-foot Emanation. While in the aura, you and your allies each deal an extra 1d4 Radiant damage when hitting with a weapon or an Unarmed Strike."
});
legacySpellRefactor("cure wounds", {
  name: "Cure Wounds",
  classes: ["bard", "cleric", "druid", "paladin", "ranger"],
  source: [["PHB2024", 259]],
  level: 1,
  school: "Abjur",
  time: "1 a",
  range: "Touch",
  components: "V,S",
  duration: "Instantaneous",
  description: "1 living creature heals 2d8+2d8/SL+spellcasting ability modifier HP",
  descriptionFull: "A creature you touch regains a number of Hit Points equal to 2d8 plus your spellcasting Ability modifier." + AtHigherLevels + "The healing increases by 2d8 for each spell slot level above 1."
});
legacySpellRefactor("dancing lights", {
  name: "Dancing Lights",
  classes: ["bard", "sorcerer", "wizard"],
  source: [["PHB2024", 259]],
  level: 0,
  school: "Illus",
  time: "1 a",
  range: "120 ft.",
  components: "V,S,M",
  compMaterial: "A bit of phosphorous",
  duration: "Conc, 1 min",
  description: "4 torch-sized lights or 1 humanoid-sized light; 10-ft. rad dim light; bns a to move 60 ft.",
  descriptionFull: "You create up to four torch-sized lights within range, making them appear as torches, lanterns, or glowing orbs that hover in the air for the duration. You can also combine the four lights into one glowing vaguely humanoid form of Medium size. Whichever form you choose, each light sheds dim light in a 10-foot radius." + "\n   " + "As a bonus action on your turn, you can move the lights up to 60 feet to a new spot within range. A light must be within 20 feet of another light created by this spell, and a light winks out if it exceeds the spell's range."
});
legacySpellRefactor("darkness", {
  name: "Darkness",
  classes: ["sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 260]],
  level: 2,
  school: "Evoc",
  time: "1 a",
  range: "60 ft.",
  components: "V,M",
  compMaterial: "Bat fur and a piece of coal",
  duration: "Conc, 10 min",
  description: "15-ft. rad darkness on point or object; darkvision doesn't work; only magical light of SL 3+ works in it",
  descriptionFull: "For the duration, magical Darkness spreads from a point within range and fills a 15-foot-radius Sphere. Darkvision can't see through it, and nonmagical light can't illuminate it." + "\n   " + "Alternatively, you can cast the spell on an object that isn't being worn or carried, causing the Darkness to fill a 15-foot Emanation originating from that object. Covered that object with something opaque such as a bowl or helm, blocks the Darkness." + "\n   " + "If any of this spell's area overlaps with an area of Bright Light or Dim Light created by a spell of level 2 or lower, that other spell is dispelled."
});
legacySpellRefactor("darkvision", {
  name: "Darkvision",
  classes: ["druid", "ranger", "sorcerer", "wizard"],
  source: [["PHB2024", 260]],
  level: 2,
  school: "Trans",
  time: "1 a",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "A dried carrot",
  duration: "8 h",
  description: "1 willing creature has darkvision 150 ft. for the duration",
  descriptionFull: "For the duration, a willing creature you touch has Darkvision with a range of 150 feet."
});
legacySpellRefactor("daylight", {
  name: "Daylight",
  classes: ["cleric", "druid", "paladin", "ranger"],
  source: [["PHB2024", 260]],
  level: 3,
  school: "Evoc",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "1 h",
  description: "60-ft. rad bright light + 60-ft. dim light on point or object; only magical darkness of SL 4+ works in it",
  descriptionFull: "For the duration, sunlight spreads from a point within range and fills a 60-foot-radius Sphere. The sunlight's area is Bright Light and sheds Dim Light for an additional 60 feet." + "\n   " + "Alternatively, you cast the spell on an object that isn't being worn or carried, causing the sunlight to fill a 60-foot Emanation originating from that object. Covering that object with something opaque, such as a bowl or helm, blocks the sunlight." + "\n   " + "If any of this spell's area overlaps with an area of Darkness created by a spell of level 3 or lower, that other spell is dispelled."
});
legacySpellRefactor("death ward", {
  name: "Death Ward",
  classes: ["cleric", "paladin"],
  source: [["PHB2024", 261]],
  level: 4,
  school: "Abjur",
  time: "1 a",
  range: "Touch",
  components: "V,S",
  duration: "8 h",
  description: "Once, when crea drops to 0 HP it drops to 1 HP instead; or negates first instantaneous kill effect",
  descriptionFull: "You touch a creature and grant it a measure of protection from death. The first time the target would drop to 0 Hit Points before the spell ends, the target instead drops to 1 Hit Point, and the spell ends." + "\n   " + "If the spell is still in effect when the target is subjected to an effect that would kill it instantly without dealing damage, the effect is negated against the target, and the spell ends."
});
legacySpellRefactor("delayed blast fireball", {
  name: "Delayed Blast Fireball",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 261]],
  level: 7,
  school: "Evoc",
  time: "1 a",
  range: "150 ft.",
  components: "V,S,M",
  compMaterial: "A ball of bat guano and sulfur",
  duration: "Conc, 1 min",
  save: "Dex",
  description: "Create bead; at chosen moment, or if conc. is broken, 20-ft. rad 12d6+1d6/SL Fire dmg; save halves",
  descriptionFull: "A beam of yellow light flashes from your pointing finger, then condenses to linger at a chosen point within range as a glowing bead for the duration. When the spell ends, either because your concentration is broken or because you decide to end it, the bead blossoms with a low roar into an explosion of flame that spreads around corners. Each creature in a 20-foot-radius sphere centered on that point must make a Dexterity saving throw. A creature takes fire damage equal to the total accumulated damage on a failed save, or half as much damage on a successful one." + "\n   " + "The spell's base damage is 12d6. If at the end of your turn the bead has not yet detonated, the damage increases by 1d6." + "\n   " + "If the glowing bead is touched before the interval has expired, the creature touching it must make a Dexterity saving throw. On a failed save, the spell ends immediately, causing the bead to erupt in flame. On a successful save, the creature can throw the bead up to 40 feet. When it strikes a creature or a solid object, the spell ends, and the bead explodes." + "\n   " + "The fire damages objects in the area and ignites flammable objects that aren't being worn or carried." + AtHigherLevels + "When you cast this spell using a spell slot of 8th level or higher, the base damage increases by 1d6 for each slot level above 7th.",
  dynamicDamageBonus: {multipleDmgMoments: false}
});
legacySpellRefactor("demiplane", {
  name: "Demiplane",
  classes: ["sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 261]],
  level: 8,
  school: "Conj",
  time: "1 a",
  range: "60 ft.",
  components: "S",
  duration: "1 h",
  description: "Create door to a demiplane of 30-ft. cube; when spell ends, creatures inside remain trapped",
  descriptionFull: "You create a shadowy door on a flat solid surface that you can see within range. The door is large enough to allow Medium creatures to pass through unhindered. When opened, the door leads to a demiplane that appears to be an empty room 30 feet in each dimension, made of wood or stone. When the spell ends, the door disappears, and any creatures or objects inside the demiplane remain trapped there, as the door also disappears from the other side." + "\n   " + "Each time you cast this spell, you can create a new demiplane, or have the shadowy door connect to a demiplane you created with a previous casting of this spell. Additionally, if you know the nature and contents of a demiplane created by a casting of this spell by another creature, you can have the shadowy door connect to its demiplane instead."
});
legacySpellRefactor("destructive wave", {
  name: "Destructive Wave",
  classes: ["paladin"],
  source: [["PHB2024", 261]],
  level: 5,
  school: "Evoc",
  time: "1 a",
  range: "Self",
  components: "V",
  duration: "Instantaneous",
  save: "Con",
  description: "30ft Emanation Any crea 5d6 Thunder dmg \u0026 5d6 Radiant or Necrotic dmg \u0026 knocked prone; save halves, not prone",
  descriptionShorter: "30ft Eman. Any crea 5d6 Thunder dmg \u0026 5d6 Radiant or Necrotic dmg \u0026 prone; save half, not prone",
  descriptionFull: "Destructive energy ripples outward from you in a 30-foot Emanation. Each creature you choose in the Emanation makes a Constitution saving throw. On a failed save, a target takes 5d6 Thunder damage and 5d6 Radiant or Necrotic damage (your choice) and has the Prone condition. On a successful save, a target takes half as much damage only.",
  dynamicDamageBonus: {
    allDmgTypesSingleMoment: true,
    multipleDmgTypes: {
      dmgTypes: ["radiant", "necrotic"],
      inDescriptionAs: "Radiant or Necrotic"
    }
  }
});
legacySpellRefactor("detect evil and good", {
  name: "Detect Evil and Good",
  classes: ["cleric", "paladin"],
  source: [["PHB2024", 261]],
  level: 1,
  school: "Div",
  time: "1 a",
  range: "Self",
  components: "V,S",
  duration: "Conc, 10 min",
  description: "Know if aberration, celestial, elemental, fey, fiend, undead, and des-/consecrated area within 30 ft.",
  descriptionFull: "For the duration, you sens the location of any Aberration, Celestial, Elemental, Fey, Fiend, or Undead within 30 feet of yourself. You also sense whether the Hallow spell is active there and, if so, where." + "\n   " + "The spell is blocked by 1 foot of stone, dirt, or wood; 1 inch of metal; or a thin sheet of lead."
});
legacySpellRefactor("detect magic", {
  name: "Detect Magic",
  classes: ["bard", "cleric", "druid", "paladin", "ranger", "sorcerer", "sorcerer", "wizard"],
  source: [["PHB2024", 262]],
  ritual: true,
  level: 1,
  school: "Div",
  time: "1 a",
  range: "Self",
  components: "V,S",
  duration: "Conc, 10 min",
  description: "Know presence of magic within 30 ft.; 1 a to see auras and determine school",
  descriptionFull: "For the duration, you sense the presence of magical effects within 30 feet of yourself. If you sense such effects, you can take the Magic Action to see a faint aura around any visible creature or object int he area that bears the magic, and if an effect was created by a spell, you learn the spell's school of magic." + "\n   " + "The spell is blocked by 1 foot of stone, dirt, or wood; 1 inch of metal; or a thin sheet of lead."
});
legacySpellRefactor("detect poison and disease", {
  name: "Detect Poison and Disease",
  nameShort: "Detect Poison/Disease",
  classes: ["cleric", "druid", "paladin", "ranger"],
  source: [["PHB2024", 262]],
  ritual: true,
  level: 1,
  school: "Div",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "A yew leaf",
  duration: "Conc, 10 min",
  description: "Know presence, location, and type of poisons, poisonous creatures, and diseases within 30 ft.",
  descriptionFull: "For the duration, you sense the location of poisons, poisonous or venomous creatures, and magical contagions within 30 feet of yourself. You sense the kind of poison, creature, or contagion in each case." + "\n   " + "The spell is blocked by 1 foot of stone, dirt, or wood; 1 inch of metal; or a thin sheet of lead."
});
legacySpellRefactor("detect thoughts", {
  name: "Detect Thoughts",
  classes: ["bard", "sorcerer", "wizard"],
  source: [["PHB2024", 262]],
  level: 2,
  school: "Div",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "A copper piece",
  duration: "Conc, 1 min",
  save: "Wis",
  description: "You can sense the presence of crea that know at least 1 language w/i 30 ft., action to probe crea mind and read thoughts, wis save",
  descriptionFull: "You activate one of the effects below. Until the spell ends, you can activate either effect as a Magic Action on your later turns." + "\n   " + "Sense Thoughts. You sense the presence of thoughts within 30 feet of yourself that belong to creatures that know languages or are telepathic. You don't read the thoughts, but you know that a thinking creature is present." + "\n   " + "The spell is blocked by 1 foot of stone, dirt, or wood; 1 inch of metal; or a thin sheet of lead." + "\n   " + "Read Thoughts. Target one creature you can see within 30 feet of yourself or one creature within 30 feet of yourself that you detected with the Sense Thoughts option. You learn what is most on the target's mind right now if the target doesn't know any languages, they are unaffected." + "\n   " + "As a Magic action on your next turn, you can try to probe deeper into the target's mind. If you probe deeper, the target makes a Wisdom saving throw. On a failed save, you discern the target's reasoning, emotions, and something that looms large in it mind (such as a worry, love, or hate). On a successful save the spell ends. Either way, the target knows that you are probing into its mind, and until you shift your attention away from the target's mind, the target can take an action on its turn to make an Intelligence (Arcana) check against your spell save DC, ending the spell on a success."
});
legacySpellRefactor("dimension door", {
  name: "Dimension Door",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 262]],
  level: 4,
  school: "Conj",
  time: "1 a",
  range: "500 ft.",
  components: "V",
  duration: "Instantaneous",
  description: "Teleport myself and 1 willing crea within 5 ft., up to 500 ft. to a place I can see, specify, or describe",
  descriptionFull: "You teleport yourself from your current location to any other spot within range. You arrive at exactly the spot desired. It can be a place you can see, one you can visualize, or one you can describe by stating distance and direction, such as 200 feet straight downward or upward to the northwest at a 45-degree angle, 300 feet." + "\n   " + "You can bring along objects as long as their weight doesn't exceed what you can carry. You can also bring one willing creature of your size or smaller who is carrying gear up to its carrying capacity. The creature must be within 5 feet of you when you cast this spell." + "\n   " + "If you would arrive in a place already occupied by an object or a creature, you and any creature traveling with you each take 4d6 force damage, and the spell fails to teleport you."
});
legacySpellRefactor("disguise self", {
  name: "Disguise Self",
  classes: ["bard", "sorcerer", "wizard"],
  source: [["PHB2024", 262]],
  level: 1,
  school: "Illus",
  time: "1 a",
  range: "Self",
  components: "V,S",
  duration: "1 h",
  description: "Alter appearance; Int(Investigation) check vs. spell DC to determine disguise",
  descriptionFull: "You make yourself, including your clothing, armor, weapons, and other belongings on your person, look different until the spell ends or until you use your action to dismiss it. You can seem 1 foot shorter or taller and can appear thin, fat, or in between. You can't change your body type, so you must adopt a form that has the same basic arrangement of limbs. Otherwise, the extent of the illusion is up to you." + "\n   " + "The changes wrought by this spell fail to hold up to physical inspection. For example, if you use this spell to add a hat to your outfit, objects pass through the hat, and anyone who touches it would feel nothing or would feel your head and hair. If you use this spell to appear thinner than you are, the hand of someone who reaches out to touch you would bump into you while it was seemingly still in midair." + "\n   " + "To discern that you are disguised, a creature can use its action to inspect your appearance and must succeed on an Intelligence (Investigation) check against your spell save DC."
});
legacySpellRefactor("disintegrate", {
  name: "Disintegrate",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 263]],
  level: 6,
  school: "Trans",
  time: "1 a",
  range: "60 ft.",
  components: "V,S,M",
  compMaterial: "A lodestone and dust",
  duration: "Instantaneous",
  save: "Dex",
  description: "1 crea save or 40+10d6+3d6/SL Force dmg; or up to 10-ft. cube nonmagical object is destroyed",
  descriptionFull: "A thin green ray springs from your pointing finger to a target that you can see within range. The target can be a creature, an object, or a creation of magical force, such as the wall created by Wall of Force." + "\n   " + "A creature targeted by this spell must make a Dexterity saving throw. On a failed save, the target takes 10d6+40 force damage. The target is disintegrated if this damage leaves it with 0 hit points." + "\n   " + "A disintegrated creature and everything it is wearing and carrying, except magic items, are reduced to a pile of fine gray dust. The creature can be restored to life only by means of a true resurrection or a wish spell." + "\n   " + "This spell automatically disintegrates a Large or smaller nonmagical object or a creation of magical force. If the target is a Huge or larger object or creation of force, this spell disintegrates a 10-foot-cube portion of it. A magic item is unaffected by this spell." + AtHigherLevels + "When you cast this spell using a spell slot of 7th level or higher, the damage increases by 3d6 for each slot level above 6th."
});
legacySpellRefactor("dispel evil and good", {
  name: "Dispel Evil and Good",
  classes: ["cleric", "paladin"],
  source: [["PHB2024", 263]],
  level: 5,
  school: "Abjur",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "powdered silver and iron",
  duration: "Conc, 1 min",
  description: "Cele., elem., fey, fiends, and undead dis. on attacks vs. me; end early for dismissal/break enchantment",
  descriptionFull: "Shimmering energy surrounds and protects you from fey, undead, and creatures originating from beyond the Material Plane. For the duration, celestials, elementals, fey, fiends, and undead have disadvantage on attack rolls against you. You can end the spell early by using either of the following special functions." + "\n   " + toUni("Break Enchantment") + ": As your action, you touch a creature you can reach that is charmed, frightened, or possessed by a celestial, an elemental, a fey, a fiend, or an undead. The creature you touch is no longer charmed, frightened, or possessed by such creatures." + "\n   " + toUni("Dismissal") + ": As your action, make a melee spell attack against a celestial, an elemental, a fey, a fiend, or an undead you can reach. On a hit, you attempt to drive the creature back to its home plane. The creature must succeed on a Charisma saving throw or be sent back to its home plane (if it isn't there already). If they aren't on their home plane, undead are sent to the Shadowfell, and fey are sent to the Feywild."
});
legacySpellRefactor("dispel magic", {
  name: "Dispel Magic",
  classes: ["bard", "cleric", "druid", "paladin", "ranger", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 264]],
  level: 3,
  school: "Abjur",
  time: "1 a",
  range: "120 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "Dispel all magical effects on crea or object; if above this SL, DC 10+SL spellcasting ability check",
  descriptionFull: "Choose one creature, object, or magical effect within range. Any spell of 3rd level or lower on the target ends. For each spell of 4th level or higher on the target, make an ability check using your spellcasting ability. The DC equals 10 + the spell's level. On a successful check, the spell ends." + AtHigherLevels + "When you cast this spell using a spell slot of 4th level or higher, you automatically end the effects of a spell on the target if the spell's level is equal to or less than the level of the spell slot you used."
});
legacySpellRefactor("dissonant whispers", {
  name: "Dissonant Whispers",
  classes: ["bard"],
  source: [["PHB2024", 264]],
  level: 1,
  school: "Ench",
  time: "1 a",
  range: "60 ft.",
  components: "V",
  duration: "Instantaneous",
  save: "Wis",
  description: "1 crea 3d6+1d6/SL Psychic dmg and flee; save halves and no fleeing; deaf crea are immune",
  descriptionFull: "You whisper a discordant melody that only one creature of your choice within range can hear, wracking it with terrible pain. The target must make a Wisdom saving throw. On a failed save, it takes 3d6 psychic damage and must immediately use its reaction, if available, to move as far as its speed allows away from you. The creature doesn't move into obviously dangerous ground, such as a fire or a pit. On a successful save, the target takes half as much damage and doesn't have to move away. A deafened creature automatically succeeds on the save." + AtHigherLevels + "When you cast this spell using a spell slot of 2nd level or higher, the damage increases by 1d6 for each slot level above 1st."
});
legacySpellRefactor("divination", {
  name: "Divination",
  classes: ["cleric", "druid", "wizard"],
  source: [["PHB2024", 264]],
  ritual: true,
  level: 4,
  school: "Div",
  time: "1 a",
  range: "Self",
  components: "V,S,M\u2020",
  compMaterial: "Incense worth 25+ gp, which the spell consumes",
  duration: "Instantaneous",
  description: "Get answer to one question about a goal, event, or activity to occur within the next 7 days (25gp cons.)",
  descriptionFull: "Your magic and an offering put you in contact with a god or a god's servants. You ask a single question concerning a specific goal, event, or activity to occur within 7 days. The DM offers a truthful reply. The reply might be a short phrase, a cryptic rhyme, or an omen." + "\n   " + "The spell doesn't take into account any possible circumstances that might change the outcome, such as the casting of additional spells or the loss or gain of a companion." + "\n   " + "If you cast this spell two or more times before finishing your next long rest, there is a cumulative 25 percent chance for each casting after the first that you get a random reading. The DM makes this roll in secret."
});
legacySpellRefactor("divine favor", {
  name: "Divine Favor",
  classes: ["paladin"],
  source: [["PHB2024", 265]],
  level: 1,
  school: "Trans",
  time: "1 bns",
  range: "Self",
  components: "V,S",
  duration: "1 min",
  description: "My weapon attacks deal an +1d4 Radiant damage for the duration",
  descriptionFull: "Until the spell ends, your attacks with weapons deal an extra 1d4 Radiant damage on a hit."
});
legacySpellRefactor("divine smite", {
  name: "Divine Smite",
  classes: ["paladin"],
  source: [["PHB2024", 265]],
  level: 1,
  school: "Evoc",
  time: "1 bns",
  timeFull: "Bonus Action, which you take immediately after hitting a target with a Melee weapon or Unarmed Strike.",
  range: "Self",
  components: "V",
  duration: "Instantaneous",
  description: "+2d8+1d8/SL+1d8(if Fiend or Undead) Rad. dmg on a melee weapon attack that hits.",
  descriptionFull: "The target takes an extra 2d8 Radiant damage from the attack. The damage increases by 1d8 if the target is a Fiend or an Undead." + AtHigherLevels + "The damage increases by 1d8 for each spell slot level above 1."
});
legacySpellRefactor("divine word", {
  name: "Divine Word",
  classes: ["cleric"],
  source: [["PHB2024", 265]],
  level: 7,
  school: "Evoc",
  time: "1 bns",
  range: "30 ft.",
  components: "V",
  duration: "Instantaneous",
  save: "Cha",
  description: "Any crea save or deaf/blind/stunned/dead depending on current HP; banishes extra planar crea",
  descriptionFull: "You utter a divine word, imbued with the power that shaped the world at the dawn of creation. Choose any number of creatures you can see within range. Each creature that can hear you must make a Charisma saving throw. On a failed save, a creature suffers an effect based on its current hit points." + "\n " + "\u2022 50 hit points or fewer - deafened for 1 minute" + "\n " + "\u2022 40 hit points or fewer - deafened and blinded for 10 minutes" + "\n " + "\u2022 30 hit points or fewer - blinded, deafened, and stunned for 1 hour" + "\n " + "\u2022 20 hit points or fewer - killed instantly" + "\n\n" + "Regardless of its current hit points, a celestial, an elemental, a fey, or a fiend that fails its save is forced back to its plane of origin (if it isn't there already) and can't return to your current plane for 24 hours by any means short of a wish spell."
});
legacySpellRefactor("dominate beast", {
  name: "Dominate Beast",
  classes: ["druid", "ranger", "sorcerer"],
  source: [["PHB2024", 265]],
  level: 4,
  school: "Ench",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "Conc, 1 min",
  save: "Wis",
  description: "1 beast save or charmed, follows telepathic commands, 1 a for complete control; +SL for duration",
  descriptionFull: "You attempt to beguile a beast that you can see within range. It must succeed on a Wisdom saving throw or be charmed by you for the duration. If you or creatures that are friendly to you are fighting it, it has advantage on the saving throw." + "\n   " + "While the beast is charmed, you have a telepathic link with it as long as the two of you are on the same plane of existence. You can use this telepathic link to issue commands to the creature while you are conscious (no action required), which it does its best to obey. You can specify a simple and general course of action, such as Attack that creature, Run over there, or Fetch that object. If the creature completes the order and doesn't receive further direction from you, it defends and preserves itself to the best of its ability." + "\n   " + "You can use your action to take total and precise control of the target. Until the end of your next turn, the creature takes only the actions you choose, and doesn't do anything that you don't allow it to do. During this time, you can also cause the creature to use a reaction, but this requires you to use your own reaction as well." + "\n   " + "Each time the target takes damage, it makes a new Wisdom saving throw against the spell. If the saving throw succeeds, the spell ends." + AtHigherLevels + "When you cast this spell with a 5th-level spell slot, the duration is concentration, up to 10 minutes. When you use a 6th-level spell slot, the duration is concentration, up to 1 hour. When you use a spell slot of 7th level or higher, the duration is concentration, up to 8 hours."
});
legacySpellRefactor("dominate monster", {
  name: "Dominate Monster",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 265]],
  level: 8,
  school: "Ench",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "Conc, 1 h",
  save: "Wis",
  description: "1 crea save or charmed, follows telepathic commands, 1 a for complete control; SL9: conc, 8h",
  descriptionFull: "You attempt to beguile a creature that you can see within range. It must succeed on a Wisdom saving throw or be charmed by you for the duration. If you or creatures that are friendly to you are fighting it, it has advantage on the saving throw." + "\n   " + "While the creature is charmed, you have a telepathic link with it as long as the two of you are on the same plane of existence. You can use this telepathic link to issue commands to the creature while you are conscious (no action required), which it does its best to obey. You can specify a simple and general course of action, such as Attack that creature, Run over there, or Fetch that object. If the creature completes the order and doesn't receive further direction from you, it defends and preserves itself to the best of its ability." + "\n   " + "You can use your action to take total and precise control of the target. Until the end of your next turn, the creature takes only the actions you choose, and doesn't do anything that you don't allow it to do. During this time, you can also cause the creature to use a reaction, but this requires you to use your own reaction as well." + "\n   " + "Each time the target takes damage, it makes a new Wisdom saving throw against the spell. If the saving throw succeeds, the spell ends." + AtHigherLevels + "When you cast this spell with a 9th-level spell slot, the duration is concentration, up to 8 hours."
});
legacySpellRefactor("dominate person", {
  name: "Dominate Person",
  classes: ["bard", "sorcerer", "wizard"],
  source: [["PHB2024", 266]],
  level: 5,
  school: "Ench",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "Conc, 1 min",
  save: "Wis",
  description: "1 humanoid save or charmed, follows telepathic commands, 1 a for complete control; +SL for dur.",
  descriptionFull: "You attempt to beguile a humanoid that you can see within range. It must succeed on a Wisdom saving throw or be charmed by you for the duration. If you or creatures that are friendly to you are fighting it, it has advantage on the saving throw." + "\n   " + "While the target is charmed, you have a telepathic link with it as long as the two of you are on the same plane of existence. You can use this telepathic link to issue commands to the creature while you are conscious (no action required), which it does its best to obey. You can specify a simple and general course of action, such as Attack that creature, Run over there, or Fetch that object. If the creature completes the order and doesn't receive further direction from you, it defends and preserves itself to the best of its ability." + "\n   " + "You can use your action to take total and precise control of the target. Until the end of your next turn, the creature takes only the actions you choose, and doesn't do anything that you don't allow it to do. During this time you can also cause the creature to use a reaction, but this requires you to use your own reaction as well." + "\n   " + "Each time the target takes damage, it makes a new Wisdom saving throw against the spell. If the saving throw succeeds, the spell ends." + AtHigherLevels + "When you cast this spell using a 6th-level spell slot, the duration is concentration, up to 10 minutes. When you use a 7th-level spell slot, the duration is concentration, up to 1 hour. When you use a spell slot of 8th level or higher, the duration is concentration, up to 8 hours."
});
legacySpellRefactor("dragon's breath", {
  name: "Dragon's Breath",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 266]],
  level: 2,
  school: "Trans",
  time: "1 bns",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "A hot pepper",
  duration: "Conc, 1 min",
  save: "Dex",
  description: "1 willing crea: 1 a breathe 15-ft. cone all 3d6+1d6/SL Acid/Cold/Fire/Lightn./Poison dmg; save half",
  descriptionShorter: "1 willing crea: 1 a 15-ft. cone 3d6+1d6/SL Acid/Cold/Fire/Lightn/Poison dmg; save half",
  descriptionFull: "You touch one willing creature and imbue it with the power to spew magical energy from its mouth, provided it has one. Choose acid, cold, fire, lightning, or poison. Until the spell ends, the creature can use an action to exhale energy of the chosen type in a 15-foot cone. Each creature in that area must make a Dexterity saving throw, taking 3d6 damage of the chosen type on a failed save, or half as much damage on a successful one." + AtHigherLevels + "When you cast this spell using a spell slot of 3rd level or higher, the damage increases by 1d6 for each slot level above 2nd.",
  dynamicDamageBonus: {
    multipleDmgTypes: {
      dmgTypes: ["acid", "cold", "fire", "lightning", "poison"],
      inDescriptionAs: "Acid/Cold/Fire/Lightn.?/Poison"
    }
  }
});
legacySpellRefactor("drawmij's instant summons", {
  name: "Drawmij's Instant Summons",
  nameShort: "Draw. Instant Sum.",
  nameAlt: "Instant Summons",
  classes: ["wizard"],
  source: [["PHB2024", 266]],
  ritual: true,
  level: 6,
  school: "Conj",
  time: "1 min",
  range: "Touch",
  components: "V,S,M\u0192",
  compMaterial: "A sapphire worth 1,000+ gp",
  duration: "Until dispelled",
  description: "Link object to sapphire (1000gp); 1 a crush gem to summon the unattended object or learn of wielder",
  descriptionFull: "You touch an object weighing 10 pounds or less whose longest dimension is 6 feet or less. The spell leaves an invisible mark on its surface and invisibly inscribes the name of the item on the sapphire you use as the material component. Each time you cast this spell, you must use a different sapphire." + "\n   " + "At any time thereafter, you can use your action to speak the item's name and crush the sapphire. The item instantly appears in your hand regardless of physical or planar distances, and the spell ends." + "\n   " + "If another creature is holding or carrying the item, crushing the sapphire doesn't transport the item to you, but instead you learn who the creature possessing the object is and roughly where that creature is located at that moment." + "\n   " + "Dispel magic or a similar effect successfully applied to the sapphire ends this spell's effect."
});
legacySpellRefactor("dream", {
  name: "Dream",
  classes: ["bard", "warlock", "wizard"],
  source: [["PHB2024", 266]],
  level: 5,
  school: "Illus",
  time: "1 min",
  range: "Special",
  components: "V,S,M",
  compMaterial: "A handful of sand",
  duration: "8 h",
  description: "Me or willing crea enters a crea's dreams, manifesting as a messenger with whom it can communicate",
  descriptionFull: "This spell shapes a creature's dreams. Choose a creature known to you as the target of this spell. The target must be on the same plane of existence as you. Creatures that don't sleep, such as elves, can't be contacted by this spell. You, or a willing creature you touch, enters a trance state, acting as a messenger. While in the trance, the messenger is aware of his or her surroundings, but can't take actions or move." + "\n   " + "If the target is asleep, the messenger appears in the target's dreams and can converse with the target as long as it remains asleep, through the duration of the spell. The messenger can also shape the environment of the dream, creating landscapes, objects, and other images. The messenger can emerge from the trance at any time, ending the effect of the spell early. The target recalls the dream perfectly upon waking. If the target is awake when you cast the spell, the messenger knows it, and can either end the trance (and the spell) or wait for the target to fall asleep, at which point the messenger appears in the target's dreams." + "\n   " + "You can make the messenger appear monstrous and terrifying to the target. If you do, the messenger can deliver a message of no more than ten words and then the target must make a Wisdom saving throw. On a failed save, echoes of the phantasmal monstrosity spawn a nightmare that lasts the duration of the target's sleep and prevents the target from gaining any benefit from that rest. In addition, when the target wakes up, it takes 3d6 psychic damage." + "\n   " + "If you have a body part, lock of hair, clipping from a nail, or similar portion of the target's body, the target makes its saving throw with disadvantage."
});
legacySpellRefactor("druidcraft", {
  name: "Druidcraft",
  classes: ["druid"],
  source: [["PHB2024", 266 - 267]],
  level: 0,
  school: "Trans",
  time: "1 a",
  range: "30 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "Small nature effect; predict weather, expedite small plant growth, snuff light, harmless sensory effect",
  descriptionFull: "Whispering to the spirits of nature, you create one of the following effects within range." + "\n " + "\u2022 You create a tiny, harmless sensory effect that predicts what the weather will be at your location for the next 24 hours. The effect might manifest as a golden orb for clear skies, a cloud for rain, falling snowflakes for snow, and so on. This effect persists for 1 round." + "\n " + "\u2022 You instantly make a flower blossom, a seed pod open, or a leaf bud bloom." + "\n " + "\u2022 You create an instantaneous, harmless sensory effect, such as falling leaves, a puff of wind, the sound of a small animal, or the faint odor of skunk. The effect must fit in a 5-foot cube." + "\n " + "\u2022 You instantly light or snuff out a candle, a torch, or a small campfire."
});
legacySpellRefactor("earthquake", {
  name: "Earthquake",
  classes: ["cleric", "druid", "sorcerer"],
  source: [["PHB2024", 267]],
  level: 8,
  school: "Trans",
  time: "1 a",
  range: "500 ft.",
  components: "V,S,M",
  compMaterial: "A fractured rock",
  duration: "Conc, 1 min",
  description: "Cause an earthquake in a 100-ft. rad, damaging structures and creating dangerous fissures, see book",
  descriptionFull: "You create a seismic disturbance at a point on the ground that you can see within range. For the duration, an intense tremor rips through the ground in a 100-foot- radius circle centered on that point and shakes creatures and structures in contact with the ground in that area." + "\n   " + "The ground in the area becomes difficult terrain. Each creature on the ground that is concentrating must make a Constitution saving throw. On a failed save, the creature's concentration is broken." + "\n   " + "When you cast this spell and at the end of each turn you spend concentrating on it, each creature on the ground in the area must make a Dexterity saving throw. On a failed save, the creature is knocked prone and its concentration is broken." + "\n   " + "This spell can have additional effects depending on the terrain in the area, as determined by the DM." + "\n   " + "Fissures. Fissures open throughout the spell's area at the start of your next turn after you cast the spell. A total of 1d6 such fissures open in locations chosen by the DM. Each is 1d10 \xD7 10 feet deep, 10 feet wide, and extends from one edge of the spell's area to the opposite side. A creature standing on a spot where a fissure opens must succeed on a Dexterity saving throw or fall in. A creature that successfully saves moves with the fissure's edge as it opens. A fissure that opens beneath a structure causes it to automatically collapse (see below)." + "\n   " + "Structures. The tremor deals 50 bludgeoning damage to any structure in contact with the ground in the area when you cast the spell and at the start of each of your turns until the spell ends. If a structure drops to 0 hit points, it collapses and potentially damages nearby creatures. A creature within half the distance of a structure's height must make a Dexterity saving throw. On a failed save, the creature takes 12d6 bludgeoning damage, is knocked prone, and is buried in the rubble, requiring a DC 20 Strength (Athletics) check as an action to escape. The DM can adjust the DC higher or lower, depending on the nature of the rubble. On a successful save, the creature takes half as much damage and doesn't fall prone or become buried."
});
legacySpellRefactor("eldritch blast", {
  name: "Eldritch Blast",
  classes: ["warlock"],
  source: [["PHB2024", 267]],
  level: 0,
  school: "Evoc",
  time: "1 a",
  range: "120 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "Spell attack beam 1d10 Force damage; beams can be combined or split; CL5:2, CL11:3, CL17:4 beams",
  descriptionShorter: "Spell atk beam 1d10 Force damage; can combine/split beams; CL5:2, CL11:3, CL17:4 beams",
  descriptionCantripDie: "Spell attack for `CD` beam(s), each 1d10 Force damage; beams can be combined or split",
  descriptionFull: "A beam of crackling energy streaks toward a creature within range. Make a ranged spell attack against the target. On a hit, the target takes 1d10 force damage." + "\n   " + "The spell creates more than one beam when you reach higher levels - two beams at 5th level, three beams at 11th level, and four beams at 17th level. you can direct the beams at the same target or at different ones. Make a separate attack roll for each beam.",
  dynamicDamageBonus: {multipleDmgMoments: true}
});
legacySpellRefactor("elementalism", {
  name: "Elementalism",
  classes: ["druid", "sorcerer", "wizard"],
  source: [["PHB2024", 167]],
  level: 0,
  school: "Trans",
  time: "1 a",
  range: "30 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "",
  descriptionFull: "You exert control over the elements, creating one of the following effects within range." + "\n   " + "Beckon Air. You create a breeze strong enough to ripple cloth, stir dust, rustle leaves, and close open doors and shutters, all in a 5-foot Cube. Doors and shutters being held open by someone or something aren't affected." + "\n   " + "Beckon Earth. You create a thin shroud of dirt or sand that covers surfaces in a 5-foot-square area, or you cause a single word to appear in your handwriting in a patch of dirt or sand." + "\n   " + "Beckon Fire. You create a thin cloud of harmless embers and colored, scented smoke in a 5-foot Cube. You choose the color and scent, and the embers can light candles, torches, or lamps in the area. The smoke's scent lingers for 1 minute." + "\n   " + "Beckon Water. You create a spray of cool mist that lightly dampens creatures and objects in a 5-foot Cube. Alternatively, you create 1 cup of clean water either in an open container or on a surface, and the water evaporates in 1 minute." + "\n   " + "Sculpt Element. You cause dirt, sand, fire, smoke, mist, or water that can fit in a 1-foot cube to assume a crude shape (such as that of a creature or an object) for 1 hour."
});
legacySpellRefactor("elemental weapon", {
  name: "Elemental Weapon",
  classes: ["druid", "paladin", "ranger"],
  source: [["PHB2024", 268]],
  level: 3,
  school: "Trans",
  time: "1 a",
  range: "Touch",
  components: "V,S",
  duration: "Conc, 1 h",
  description: "+1 magical weapon; +1d4 Acid, Cold, Fire, Lightning, or Thunder dmg; SL5: +2/+2d4, SL7: +3/+3d4",
  descriptionShorter: "+1 wea; +1d4 Acid/Cold/Fire/Lightning/Thunder dmg; SL5: +2/+2d4, SL7: +3/+3d4",
  descriptionFull: "A nonmagical weapon you touch becomes a magic weapon. Choose one of the following damage types - acid, cold, fire, lightning, or thunder. For the duration, the weapon has a +1 bonus to attack rolls and deals an extra 1d4 damage of the chosen type when it hits." + AtHigherLevels + "When you cast this spell using a spell slot of 5th or 6th level, the bonus to attack rolls increases to +2 and the extra damage increases to 2d4. When you use a spell slot of 7th level or higher, the bonus increases to +3 and the extra damage increases to 3d4.",
  dynamicDamageBonus: {
    multipleDmgTypes: {
      dmgTypes: ["acid", "cold", "fire", "lightning", "thunder"],
      inDescriptionAs: "Acid, Cold, Fire, Lightning, or Thunder|Acid/Cold/Fire/Lightning/Thunder"
    }
  }
});
legacySpellRefactor("enhance ability", {
  name: "Enhance Ability",
  classes: ["bard", "cleric", "druid", "ranger", "sorcerer", "wizard"],
  source: [["PHB2024", 268]],
  level: 2,
  school: "Trans",
  time: "1 a",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "Fur or a feather",
  duration: "Conc, 1 h",
  description: "1+1/SL crea adv. on checks with 1 stat; choosing Str, Dex, Int, Wis, or Cha",
  descriptionFull: "You touch a creature and choose Strength, Dexterity, Intelligence, Wisdom, Charisma. For the duration, the target has Advantage on ability checks using the chosen ability." + AtHigherLevels + "You can target one additional creature for each spell slot level above 2. You can choose a different ability for each target."
});
legacySpellRefactor("enlarge/reduce", {
  name: "Enlarge/Reduce",
  classes: ["bard", "druid", "sorcerer", "wizard"],
  source: [["PHB2024", 268]],
  level: 2,
  school: "Trans",
  time: "1 a",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A pinch of powdered iron",
  duration: "Conc, 1 min",
  save: "Con",
  description: "1 crea/object save or enlarged (Str adv. +1d4 weapon dmg), reduced (Str dis. -1d4 weapon dmg)",
  descriptionFull: "You cause a creature or an object you can see within range to grow larger or smaller for the duration. Choose either a creature or an object that is neither worn nor carried. If the target is unwilling, it can make a Constitution saving throw. On a success, the spell has no effect." + "\n   " + "If the target is a creature, everything it is wearing and carrying changes size with it. Any item dropped by an affected creature returns to normal size at once." + "\n   " + toUni("Enlarge") + ": The target's size doubles in all dimensions, and its weight is multiplied by eight. This growth increases its size by one category - from Medium to Large, for example. If there isn't enough room for the target to double its size, the creature or object attains the maximum possible size in the space available. Until the spell ends, the target also has advantage on Strength checks and Strength saving throws. The target's weapons also grow to match its new size. While these weapons are enlarged, the target's attack with them deal 1d4 extra damage." + "\n   " + toUni("Reduce") + ": The target's size is halved in all dimensions, and its weight is reduced to one-eighth of normal. This reduction decreases its size by one category - from Medium to Small, for example. Until the spell ends, the target also has disadvantage on Strength checks and Strength saving throws. The target's weapons also shrink to match its new size. While these weapons are reduced, the target's attacks with them deal 1d4 less damage (this can't reduce the damage below 1).",
  dynamicDamageBonus: {doNotProcess: true} // Not actual damage form the spell
});
legacySpellRefactor("ensnaring strike", {
  name: "Ensnaring Strike",
  classes: ["ranger"],
  source: [["PHB2024", 268]],
  level: 1,
  school: "Conj",
  time: "1 bns",
  timeFull: "Bonus Action, which you take immediately after hitting a creature with a weapon",
  range: "Self",
  components: "V",
  duration: "Conc, 1 min",
  save: "Str",
  description: "Next crea hit save (Large adv.) or restrained, 1d6+1d6/SL Piercing dmg/rnd; Str check to escape",
  descriptionShorter: "Next crea hit save (Large adv.) or restrained, 1d6+1d6/SL Piercing dmg/rnd; Str chk escape",
  descriptionFull: "The next time you hit a creature with a weapon attack before this spell ends, a writhing mass of thorny vines appears at the point of impact, and the target must succeed on a Strength saving throw or be restrained by the magical vines until the spell ends. A Large or larger creature has advantage on this saving throw. If the target succeeds on the save, the vines shrivel away." + "\n   " + "While restrained by this spell, the target takes 1d6 piercing damage at the start of each of its turns. A creature restrained by the vines or one that can touch the creature can use its action to make a Strength check against your spell save DC. On a success, the target is freed." + AtHigherLevels + "If you cast this spell using a spell slot of 2nd level or higher, the damage increases by 1d6 for each slot level above 1st."
});
legacySpellRefactor("entangle", {
  name: "Entangle",
  classes: ["druid", "ranger"],
  source: [["PHB2024", 268]],
  level: 1,
  school: "Conj",
  time: "1 a",
  range: "90 ft.",
  components: "V,S",
  duration: "Conc, 1 min",
  save: "Str",
  description: "20-ft. square save or restrained; Str check vs. Spell DC to escape; for duration area is difficult terrain",
  descriptionFull: "Grasping weeds and vines sprout from the ground in a 20-foot square starting from a point within range. For the duration, these plants turn the ground in the area into difficult terrain." + "\n   " + "A creature in the area when you cast the spell must succeed on a Strength saving throw or be restrained by the entangling plants until the spell ends. A creature restrained by the plants can use its action to make a Strength check against your spell save DC. On a success, it frees itself." + "\n   " + "When the spell ends, the conjured plants wilt away."
});
legacySpellRefactor("enthrall", {
  name: "Enthrall",
  classes: ["bard", "warlock"],
  source: [["PHB2024", 269]],
  level: 2,
  school: "Ench",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "Conc, 1 min",
  save: "Wis",
  description: "While I speak, any crea save (succ. if fighting) or -10 on Wis(Perception) and Passive Perception",
  descriptionFull: "You weave a distracting string of words, causing creatures of your choice that you can see within range to make a Wisdom saving throw. Any creature you or your companions are fighting automatically succeed on this save. On a failed save, a target has a -10 penalty to Wisdom (Perception) checks and Passive Perception until the spell ends."
});
legacySpellRefactor("etherealness", {
  name: "Etherealness",
  classes: ["bard", "cleric", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 269]],
  level: 7,
  school: "Conj",
  time: "1 a",
  range: "Self",
  components: "V,S",
  duration: "8 h",
  description: "Me or 3/SL willing go to Ethereal Plane; move there, but able to perceive 60 ft. into the normal plane",
  descriptionFull: "You step into the border regions of the Ethereal Plane, in the area where it overlaps with your current plane. You remain in the Border Ethereal for the duration or until you use your action to dismiss the spell. During this time, you can move in any direction. If you move up or down, every foot of movement costs an extra foot. You can see and hear the plane you originated from, but everything there looks gray, and you can't see anything more than 60 feet away." + "\n   " + "While on the Ethereal Plane, you can only affect and be affected by other creatures on that plane. Creatures that aren't on the Ethereal Plane can't perceive you and can't interact with you, unless a special ability or magic has given them the ability to do so." + "\n   " + "You ignore all objects and effects that aren't on the Ethereal Plane, allowing you to move through objects you perceive on the plane you originated from." + "\n   " + "When the spell ends, you immediately return to the plane you originated from in the spot you currently occupy. If you occupy the same spot as a solid object or creature when this happens, you are immediately shunted to the nearest unoccupied space that you can occupy and take force damage equal to twice the number of feet you are moved." + "\n   " + "This spell has no effect if you cast it while you are on the Ethereal Plane or a plane that doesn't border it, such as one of the Outer Planes." + AtHigherLevels + "When you cast this spell using a spell slot of 8th level or higher, you can target up to three willing creatures (including you) for each slot level above 7th. The creatures must be within 10 feet of you when you cast the spell."
});
legacySpellRefactor("evard's black tentacles", {
  name: "Evard's Black Tentacles",
  nameAlt: "Black Tentacles",
  classes: ["wizard"],
  source: [["PHB2024", 270]],
  level: 4,
  school: "Conj",
  time: "1 a",
  range: "90 ft.",
  components: "V,S,M",
  compMaterial: "A tentacle",
  duration: "Conc, 1 min",
  save: "Dex",
  description: "All who enter/start 20-ft. square save or restrained \u0026 3d6 Bludg. dmg/rnd; Str/Dex check to escape",
  descriptionShorter: "All enter/start 20-ft. square save or restrained \u0026 3d6 Bludg. dmg/rnd; Str/Dex chk escape",
  descriptionFull: "Squirming, ebony tentacles fill a 20-foot square on ground that you can see within range. For the duration, these tentacles turn the ground in the area into difficult terrain." + "\n   " + "When a creature enters the affected area for the first time on a turn or starts its turn there, the creature must succeed on a Dexterity saving throw or take 3d6 bludgeoning damage and be restrained by the tentacles until the spell ends. A creature that starts its turn in the area and is already restrained by the tentacles takes 3d6 bludgeoning damage." + "\n   " + "A creature restrained by the tentacles can use its action to make a Strength or Dexterity check (its choice) against your spell save DC. On a success, it frees itself."
});
legacySpellRefactor("expeditious retreat", {
  name: "Expeditious Retreat",
  classes: ["sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 270]],
  level: 1,
  school: "Trans",
  time: "1 bns",
  range: "Self",
  components: "V,S",
  duration: "Conc, 10 min",
  description: "I can take Dash action now, and as a bonus action for the duration",
  descriptionFull: "This spell allows you to move at an incredible pace. When you cast this spell, and then as a bonus action on each of your turns until the spell ends, you can take the Dash action."
});
legacySpellRefactor("eyebite", {
  name: "Eyebite",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 270]],
  level: 6,
  school: "Necro",
  time: "1 a",
  range: "Self",
  components: "V,S",
  duration: "Conc, 1 min",
  save: "Wis",
  description: "1 crea/rnd within 60 ft. save or either fall asleep, panicked, or sickened, my choice",
  descriptionFull: "For the spell's duration, your eyes become an inky void imbued with dread power. One creature of your choice within 60 feet of you that you can see must succeed on a Wisdom saving throw or be affected by one of the following effects of your choice for the duration. On each of your turns until the spell ends, you can use your action to target another creature but can't target a creature again if it has succeeded on a saving throw against this casting of Eyebite." + "\n   " + toUni("Asleep") + ": The target falls unconscious. It wakes up if it takes any damage or if another creature uses its action to shake the sleeper awake." + "\n   " + toUni("Panicked") + ": The target is frightened of you. On each of its turns, the frightened creature must take the Dash action and move away from you by the safest and shortest available route, unless there is nowhere to move. If the target moves to a place at least 60 feet away from you where it can no longer see you, this effect ends." + "\n   " + toUni("Sickened") + ": The target has disadvantage on attack rolls and ability checks. At the end of each of its turns, it can make another Wisdom saving throw. If it succeeds, the effect ends."
});
legacySpellRefactor("fabricate", {
  name: "Fabricate",
  classes: ["wizard"],
  source: [["PHB2024", 271]],
  level: 4,
  school: "Trans",
  time: "10 min",
  range: "120 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "Create simple object from raw materials; or complex object if proficient in the appropriate tools",
  descriptionFull: "You convert raw materials into products of the same material. For example, you can fabricate a wooden bridge from a clump of trees, a rope from a patch of hemp, and clothes from flax or wool." + "\n   " + "Choose raw materials that you can see within range. You can fabricate a Large or smaller object (contained within a 10-foot cube, or eight connected 5-foot cubes), given a sufficient quantity of raw material. If you are working with metal, stone, or another mineral substance, however, the fabricated object can be no larger than Medium (contained within a single 5-foot cube). The quality of objects made by the spell is commensurate with the quality of the raw materials." + "\n   " + "Creatures or magic items can't be created or transmuted by this spell. You also can't use it to create items that ordinarily require a high degree of craftsmanship, such as jewelry, weapons, glass, or armor, unless you have proficiency with the type of artisan's tools used to craft such objects."
});
legacySpellRefactor("faerie fire", {
  name: "Faerie Fire",
  classes: ["bard", "druid"],
  source: [["PHB2024", 271]],
  level: 1,
  school: "Evoc",
  time: "1 a",
  range: "60 ft.",
  components: "V",
  duration: "Conc, 1 min",
  save: "Dex",
  description: "20-ft. cube all obj/crea save or outlined in 10 ft. dim light and attacks have adv.; see invisible crea",
  descriptionFull: "Each object in a 20-foot cube within range is outlined in blue, green, or violet light (your choice). Any creature in the area when the spell is cast is also outlined in light if it fails a Dexterity saving throw. For the duration, objects and affected creatures shed dim light in a 10-foot radius." + "\n   " + "Any attack roll against an affected creature or object has advantage if the attacker can see it, and the affected creature or object can't benefit from being invisible."
});
legacySpellRefactor("false life", {
  name: "False Life",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 271]],
  level: 1,
  school: "Necro",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "A drop of alcohol",
  duration: "Instantaneous",
  description: "I gain 1d4+4+5/SL temporary hit points for the duration",
  descriptionFull: "Bolstering yourself with a necromatic facsimile of life, you gain 1d4+4 temporary hit points for the duration." + AtHigherLevels + "When you cast this spell using a spell slot of 2nd level or higher, you gain 5 additional temporary hit points for each slot level above 1st."
});
legacySpellRefactor("fear", {
  name: "Fear",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 271]],
  level: 3,
  school: "Illus",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "A white feather",
  duration: "Conc, 1 min",
  save: "Wis",
  description: "All crea save or drop what it is holding and frightened; extra save at end of turn if not in line of sight",
  descriptionFull: "You project a phantasmal image of a creature's worst fears. Each creature in a 30-foot cone must succeed on a Wisdom saving throw or drop whatever it is holding and become frightened for the duration." + "\n   " + "While frightened by this spell, a creature must take the Dash action and move away from you by the safest available route on each of its turns, unless there is nowhere to move. If the creature ends its turn in a location where it doesn't have line of sight to you, the creature can make a Wisdom saving throw. On a successful save, the spell ends for that creature."
});
legacySpellRefactor("feather fall", {
  name: "Feather Fall",
  classes: ["bard", "sorcerer", "wizard"],
  source: [["PHB2024", 271]],
  level: 1,
  school: "Trans",
  time: "1 rea",
  timeFull: "1 reaction, which you take when you or a creature within 60 feet of you falls",
  range: "60 ft.",
  components: "V,M",
  compMaterial: "A small feather or piece of down",
  duration: "1 min",
  description: "5 creatures descent only 60 ft./rnd for duration or until landed, taking no falling damage",
  descriptionFull: "Reaction - When you or a creature within 60 feet of you falls Choose up to five falling creatures within range. A falling creature's rate of descent slows to 60 feet per round until the spell ends. If the creature lands before the spell ends, it takes no falling damage and can land on its feet, and the spell ends for that creature."
});
legacySpellRefactor("feign death", {
  name: "Feign Death",
  classes: ["bard", "cleric", "druid", "wizard"],
  source: [["PHB2024", 271]],
  ritual: true,
  level: 3,
  school: "Necro",
  time: "1 a",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "A pinch of graveyard dirt",
  duration: "1 h",
  description: "Willing creature appears dead; it is blinded, incapacitated, has dmg resist. all but Psychic, and speed 0",
  descriptionFull: "You touch a willing creature and put it into a cataleptic state that is indistinguishable from death." + "\n   " + "For the spell's duration, or until you use an action to touch the target and dismiss the spell, the target appears dead to all outward inspection and to spells used to determine the target's status. The target is blinded and incapacitated, and its speed drops to 0. The target has resistance to all damage except psychic damage. If the target is diseased or poisoned when you cast the spell, or becomes diseased or poisoned while under the spell's effect, the disease and poison have no effect until the spell ends."
});
legacySpellRefactor("find familiar", {
  name: "Find Familiar",
  classes: ["wizard"],
  source: [["PHB2024", 272]],
  ritual: true,
  level: 1,
  school: "Conj",
  time: "1 h",
  range: "10 ft.",
  components: "V,S,M\u2020",
  compMaterial: "burning incense worth 10+ gp, which the spell consumes",
  duration: "Instantaneous",
  description: "Gain the services of a familiar; can see through its eyes; it can deliver touch spells; see B (10gp cons.)",
  descriptionFull: "You gain the service of a familiar, a spirit that takes an animal form you choose: Bat, Cat, Frog, Hawk, Lizard, Octopus, Owl, Rat, Raven, Spider, Weasel, or another Beast that has a Challenge Rating of 0. Appearing in an unoccupied space within range, the familiar has the statistics of the chosen form (see appendix B), though it is a Celestial, Fey, or Fiend (your choice) instead of a Beast. Your familiar acts independently of you, but obeys your commands." + "\n   " + "Telepathic Connection. While your familiar is within 100 feet of you, you can communicate with it telepathically. Additionally, as a Bonus Action, you can see through the familiar's eyes and hear what it hears until the start of your next turn, gaining the benefits of any special senses it has." + "\n   " + "Finally, when you cast a spell with a range of touch, your familiar can deliver the touch. You familiar must be within 100 feet of you, and it must take a Reaction to deliver the touch when you cast the spell." + "\n   " + "Combat. The familiar is an ally to you and your allies. It rolls its own Initiative and acts on its own turn. A familiar can't attack, but it can take other actions as normal." + "\n   " + "Disappearance of the Familiar. When the familiar drops to 0 Hit Points, it disappears. It reappears after you cast this spell again. As a Magic action, you can temporarily dismiss the familiar to pocket dimension. Alternatively, you can dismiss it forever. As a Magic action while it is temporarily dismissed, you can cause it to reappear in an unoccupied space within 30 feet of you. Whenever the familiar drops to 0 Hit Points or disappears into the pocket dimension, it leaves behind in its space anything it was wearing or carrying." + "\n   " + "One Familiar Only. You can't have more than one familiar at a time. If you cast this spell while you have a familiar, you instead cause i to adopt a new eligible form."
});
legacySpellRefactor("find steed", {
  name: "Find Steed",
  classes: ["paladin"],
  source: [["PHB2024", 272]],
  level: 2,
  school: "Conj",
  time: "1 a",
  range: "30 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "Gain the services of an Otherworldly Steed; communicate with each other telepathically; share spells with it; see book",
  descriptionFull: "You summon an otherworldly being that appears as a loyal steed in an unoccupied space of your choice within range. This creature uses the Otherworldly Steed stat block. If you already have a steed from this spell, the steed is replaced by a new one." + "\n   " + "The steed resembles a Large, rideable animal of your choice, such as a horse, a camel, a dire wolf, or an elk. Whenever you cast the spell, choose the steed's creature type - Celestial, Fey, or Fiend -." + "\n   " + "Combat. The steed is an ally to you and your allies. In combat, it shares your Initiative count, and it functions as a controlled mount while you ride it (as defined in the rules on mounted combat). If you have the Incapacitated condition, the steed takes its turn immediately after yours and acts independently, focusing on protecting you." + "\n   " + "Disappearance of the Steed. The steed disappears if it drops to 0 Hit Points or if you die. When it disappears, it leaves behind anything it was wearing or carrying, if you cast this spell again, you decide whether you summon the steed that disappeared or a different one." + "\n   " + "Using the spell slot's level for the spell's level in the stat block."
});
legacySpellRefactor("find the path", {
  name: "Find the Path",
  classes: ["bard", "cleric", "druid"],
  source: [["PHB2024", 273]],
  level: 6,
  school: "Div",
  time: "1 min",
  range: "Self",
  components: "V,S,M\u0192",
  compMaterial: "A set of divination tools - such as cards or runes - worth 100+ gp",
  duration: "Conc, 1 day",
  description: "Know the shortest route to a location I am familiar with and are on the same plane with (100gp)",
  descriptionFull: "This spell allows you to find the shortest, most direct physical route to a specific fixed location that you are familiar with on the same plane of existence. If you name a destination on another plan of existence, a destination that moves (such as a mobile fortress), or a destination that isn't specific (such as a green dragon's lair), the spell fails." + "\n   " + "For the duration, as long as you are on the same plane of existence as the destination, you know how far it is and in what direction it lies. While you are traveling there, whenever you are presented with a choice of paths along the way, you automatically determine which path is the shortest and most direct route (but not necessarily the safest route) to the destination."
});
legacySpellRefactor("find traps", {
  name: "Find Traps",
  classes: ["cleric", "druid", "ranger"],
  source: [["PHB2024", 273]],
  level: 2,
  school: "Div",
  time: "1 a",
  range: "120 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "Sense presence of any trap within line of sight; not exact location, but general nature of trap",
  descriptionFull: "You sense the presence of any trap within range that is within line of sight. A trap, for the purpose of this spell, includes anything that would inflict a sudden or unexpected effect you consider harmful or undesirable, which was specifically intended as such by its creator. Thus, the spell would sense an area affected by the alarm spell, a glyph of warding, or a mechanical pit trap, but it would not reveal a natural weakness in the floor, an unstable ceiling, or a hidden sinkhole." + "\n   " + "This spell merely reveals that a trap is present. You don't learn the location of each trap, but you do learn the general nature of the danger posed by a trap you sense."
});
legacySpellRefactor("finger of death", {
  name: "Finger of Death",
  classes: ["sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 273]],
  level: 7,
  school: "Necro",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "Instantaneous",
  save: "Con",
  description: "1 crea 7d8+30 Necrotic dmg; save halves; crea killed becomes zombie under my command",
  descriptionFull: "You send negative energy coursing through a creature that you can see within range, causing it searing pain. The target must make a Constitution saving throw. It takes 7d8+30 necrotic damage on a failed save, or half as much damage on a successful one." + "\n   " + "A humanoid killed by this spell rises at the start of your next turn as a zombie that is permanently under your command, following your verbal orders to the best of its ability."
});
legacySpellRefactor("fireball", {
  name: "Fireball",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 274]],
  level: 3,
  school: "Evoc",
  time: "1 a",
  range: "150 ft.",
  components: "V,S,M",
  compMaterial: "A ball of bat guano and sulfur",
  duration: "Instantaneous",
  save: "Dex",
  description: "20-ft. rad all crea 8d6+1d6/SL Fire dmg; save halves; unattended flammable objects ignite",
  descriptionFull: "A bright streak flashes from your pointing finger to a point you choose within range then blossoms with a low roar into an explosion of flame. Each creature in a 20-foot radius must make a Dexterity saving throw. A target takes 8d6 fire damage on a failed save, or half as much damage on a successful one." + "\n   " + "The fire spreads around corners. It ignites flammable objects in the area that aren't being worn or carried." + AtHigherLevels + "When you cast this spell using a spell slot of 4th level or higher, the damage increases by 1d6 for each slot level above 3rd."
});
legacySpellRefactor("fire bolt", {
  name: "Fire Bolt",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 274]],
  level: 0,
  school: "Evoc",
  time: "1 a",
  range: "120 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "Spell attack for 1d10 Fire dmg; unattended flammable objects ignite; +1d10 at CL 5, 11, and 17",
  descriptionCantripDie: "Spell attack for `CD`d10 Fire dmg; unattended flammable objects ignite",
  descriptionFull: "You hurl a mote of fire at a creature or object within range. Make a ranged spell attack against the target. On a hit, the target takes 1d10 fire damage. A flammable object hit by this spell ignites if it isn't being worn or carried." + "\n   " + "This spell's damage increases by 1d10 when you reach 5th level (2d10), 11th level (3d10), and 17th level (4d10)."
});
legacySpellRefactor("fire shield", {
  name: "Fire Shield",
  classes: ["druid", "sorcerer", "wizard"],
  source: [["PHB2024", 274]],
  level: 4,
  school: "Evoc",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "A bit of phosphorous or a firefly",
  duration: "10 min",
  description: "Fiery shield gives either Fire or Cold dmg resist. and deals 2d8 of the other dmg type to melee attackers",
  descriptionShorter: "Fiery shield; Fire or Cold dmg resistance; deals 2d8 of other dmg type to melee attackers",
  descriptionFull: "Thin and wispy flames wreathe your body for the duration, shedding bright light in a 10-foot radius and dim light for an additional 10 feet. You can end the spell early by using an action to dismiss it." + "\n   " + "The flames provide you with a warm shield or a chill shield, as you choose. The warm shield grants you resistance to cold damage, and the chill shield grants you resistance to fire damage." + "\n   " + "In addition, whenever a creature within 5 feet of you hits you with a melee attack, the shield erupts with flame. The attacker takes 2d8 fire damage from a warm shield, or 2d8 cold damage from a cold shield.",
  dynamicDamageBonus: {
    multipleDmgTypes: {
      dmgTypes: ["cold", "fire"],
      inDescriptionAs: "of other|of the other"
    }
  }
});
legacySpellRefactor("fire storm", {
  name: "Fire Storm",
  classes: ["cleric", "druid", "sorcerer"],
  source: [["PHB2024", 275]],
  level: 7,
  school: "Evoc",
  time: "1 a",
  range: "150 ft.",
  components: "V,S",
  duration: "Instantaneous",
  save: "Dex",
  description: "10 connected 10-ft. cubes all crea 7d10 Fire dmg; save halves; unattended flammable objects ignite",
  descriptionFull: "A storm made up of sheets of roaring flame appears in a location you choose within range. The area of the storm consists of up to ten 10-foot cubes, which you can arrange as you wish. Each cube must have at least one face adjacent to the face of another cube. Each creature in the area must make Dexterity saving throw. It takes 7d10 fire damage on a failed save, or half as much damage on a successful one." + "\n   " + "The fire damages objects in the area and ignites flammable objects that aren't being worn or carried. If you choose, plant life in the area is unaffected by this spell."
});
legacySpellRefactor("flame blade", {
  name: "Flame Blade",
  classes: ["druid", "sorcerer"],
  source: [["PHB2024", 275]],
  level: 2,
  school: "Evoc",
  time: "1 bns",
  range: "Self",
  components: "V,S,M",
  compMaterial: "Leaf of sumac",
  duration: "Conc, 10 min",
  description: "Summon fiery blade; 1 a to make a melee spell attack for 3d6+1d6/2SL Fire dmg; 10 ft. bright light",
  descriptionShorter: "Summon fiery blade; 1 a to make melee spell atk 3d6+1d6/2SL Fire dmg; 10 ft. bright light",
  descriptionFull: "You evoke a fiery blade in your free hand. The blade is similar in size and shape to a scimitar, and it lasts for the duration. If you let go of the blade, it disappears, but you can evoke the blade again as a bonus action." + "\n   " + "You can use your action to make a melee spell attack with the fiery blade. On a hit, the target takes 3d6 fire damage." + "\n   " + "The flaming blade sheds bright light in a 10-foot radius and dim light for an additional 10 feet." + AtHigherLevels + "When you cast this spell using a spell slot of 4th level or higher, the damage increases by 1d6 for every two slot levels above 2nd."
});
legacySpellRefactor("flame strike", {
  name: "Flame Strike",
  classes: ["cleric"],
  source: [["PHB2024", 275]],
  level: 5,
  school: "Evoc",
  time: "1 a",
  range: "60 ft.",
  components: "V,S,M",
  compMaterial: "Pinch of sulfur",
  duration: "Instantaneous",
  save: "Dex",
  description: "10-ft. rad 40-ft. high all crea 4d6 Fire dmg and 4d6 Radiant dmg; save halves; +1d6/SL Fire or Radiant",
  descriptionShorter: "10-ft. rad 40-ft. high all crea 4d6 Fire dmg and 4d6 Radiant dmg; save half; +1d6/SL dmg",
  descriptionFull: "A vertical column of divine fire roars down from the heavens in a location you specify. Each creature in a 10-foot radius, 40-foot-high cylinder centered on a point within range must make a Dexterity saving throw. A creature takes 5d6 fire damage and 5d6 radiant damage on a failed save, or half as much damage on a successful one." + AtHigherLevels + "When you cast this spell using a spell slot of 6th level or higher, the fire damage or the radiant damage (your choice) increases by 1d6 for each slot level above 5th.",
  dynamicDamageBonus: {allDmgTypesSingleMoment: true}
});
legacySpellRefactor("flaming sphere", {
  name: "Flaming Sphere",
  classes: ["druid", "sorcerer", "wizard"],
  source: [["PHB2024", 275]],
  level: 2,
  school: "Conj",
  time: "1 a",
  range: "60 ft.",
  components: "V,S,M",
  compMaterial: "A ball of wax",
  duration: "Conc, 1 min",
  save: "Dex",
  description: "2.5-ft. rad flaming sphere; bns a move 30 ft.; all within 5-ft. rad 2d6+1d6/SL Fire dmg; save halves",
  descriptionShorter: "2.5-ft. rad flaming sphere; bns a move 30 ft.; all in 5-ft. rad 2d6+1d6/SL Fire dmg; save half",
  descriptionFull: "A 5-foot-diameter sphere of fire appears in an unoccupied space of your choice within range and lasts for the duration. Any creature that ends its turn within 5 feet of the sphere must make a Dexterity saving throw. The creature takes 2d6 fire damage on a failed save, or half as much damage on a successful one." + "\n   " + "As a bonus action, you can move the sphere up to 30 feet. If you ram the sphere into a creature, that creature must make the saving throw against the sphere's damage, and the sphere stops moving this turn." + "\n   " + "When you move the sphere, you can direct it over barriers up to 5 feet tall and jump it across pits up to 10 feet wide. The sphere ignites flammable objects not being worn or carried, and it sheds bright light in a 20-foot radius and dim light for an additional 20 feet." + AtHigherLevels + "When you cast this spell using a spell slot of 3rd level or higher, the damage increases by 1d6 for each slot level above 2nd."
});
legacySpellRefactor("flesh to stone", {
  name: "Flesh to Stone",
  classes: ["druid", "sorcerer", "wizard"],
  source: [["PHB2024", 275]],
  level: 6,
  school: "Trans",
  time: "1 a",
  range: "60 ft.",
  components: "V,S,M",
  compMaterial: "A cockatrice feather",
  duration: "Conc, 1 min",
  save: "Con",
  description: "1 crea save or restrained; save at end of turn, 3 cumulative fail: petrified, 3 cumulative success: free",
  descriptionFull: "You attempt to turn one creature that you can see within range into stone. If the targets body is made of flesh, the creature must make a Constitution saving throw. On a failed save, it is restrained as its flesh begins to harden. On a successful save, the creature isn't affected." + "\n   " + "A creature restrained by this spell must make another Constitution saving throw at the end of each of its turns. If it successfully saves against this spell three times, the spell ends. If it fails saves three times, it is turned to stone and subjected to the petrified condition for the duration. The successes and failures don't need to be consecutive, keep track of both until the target collects three of a kind." + "\n   " + "If the creature is physically broken while petrified, it suffers from similar deformities if it reverts to its original state." + "\n   " + "If you maintain your concentration on this spell for the entire possible duration, the creature is turned to stone until the effect is removed."
});
legacySpellRefactor("fly", {
  name: "Fly",
  classes: ["sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 276]],
  level: 3,
  school: "Trans",
  time: "1 a",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "A feather",
  duration: "Conc, 10 min",
  description: "1+1/SL willing creatures gain fly 60 ft. speed",
  descriptionFull: "You touch a willing creature. The target gains a flying speed of 60 feet for the duration. When the spell ends, the target falls if it is still aloft, unless it can stop the fall." + AtHigherLevels + "When you cast this spell using a spell slot of 4th level or higher, you can target one additional creature for each slot level above 3rd."
});
legacySpellRefactor("fog cloud", {
  name: "Fog Cloud",
  classes: ["druid", "ranger", "sorcerer", "wizard"],
  source: [["PHB2024", 276]],
  level: 1,
  school: "Conj",
  time: "1 a",
  range: "120 ft.",
  components: "V,S",
  duration: "Conc, 1 h",
  description: "20-ft.+20-ft./SL rad fog that spreads around corners; heavily obscures; 10 mph wind disperses it",
  descriptionFull: "You create a 20-foot-radius sphere of fog centered on a point within range. The sphere spreads around corners, and its area is heavily obscured. It lasts for the duration or until a wind of moderate or greater speed (at least 10 miles per hour) disperses it." + AtHigherLevels + "When you cast this spell using a spell slot of 2nd level or higher, the radius of the fog increases by 20 feet for each slot level above 1st."
});
legacySpellRefactor("forbiddance", {
  name: "Forbiddance",
  classes: ["cleric"],
  source: [["PHB2024", 276]],
  ritual: true,
  level: 6,
  school: "Abjur",
  time: "10 min",
  range: "Touch",
  components: "V,S,M\u0192",
  compMaterial: "ruby dust worth 1000+ gp",
  duration: "1 day",
  description: "40k sq ft. 30-ft. high no extra planar travel; 1 crea type 5d10 Radiant/Necrotic dmg per rnd (1000gp)",
  descriptionMetric: "3,7k m2 9-m high no extra planar travel; 1 crea type 5d10 Radiant or Necrotic dmg per rnd (1000gp)",
  descriptionShorter: "40k sq ft. 30ft high no planar travel; 1 crea type 5d10 Radiant/Necro. dmg/rnd (1k gp)",
  descriptionShorterMetric: "3,6k m2 9-m high no planar travel; 1 crea type 5d10 Radiant/Necrotic dmg/rnd (1k gp)",
  descriptionFull: "You create a ward against magical travel that protects up to 40,000 square feet of floor space to a height of 30 feet above the floor. For the duration, creatures can't teleport into the area or use portals, such as those created by the gate spell, to enter the area. The spell proofs the area against planar travel, and therefore prevents creatures from accessing the area by way of the Astral Plane, Ethereal Plane, Feywild, Shadowfell, or the plane shift spell." + "\n   " + "In addition, the spell damages types of creatures that you choose when you cast it. Choose one or more of the following - celestials, elementals, fey, fiends, and undead. When a chosen creature enters the spell's area for the first time on a turn or starts its turn there, the creature takes 5d10 radiant or necrotic damage (your choice when you cast this spell)." + "\n   " + "When you cast this spell, you can designate a password. A creature that speaks the password as it enters the area takes no damage from the spell." + "\n   " + "The spell's area can't overlap with the area of another forbiddance spell. If you cast forbiddance every day for 30 days in the same location, the spell lasts until it is dispelled, and the material components are consumed on the last casting.",
  dynamicDamageBonus: {
    multipleDmgTypes: {
      dmgTypes: ["radiant", "necrotic"],
      inDescriptionAs: "Radiant/Necrotic|Radiant/Necro\\.|Radiant or Necrotic"
    }
  }
});
legacySpellRefactor("forcecage", {
  name: "Forcecage",
  classes: ["bard", "warlock", "wizard"],
  source: [["PHB2024", 276]],
  level: 7,
  school: "Evoc",
  time: "1 a",
  range: "100 ft.",
  components: "V,S,M\u0192",
  compMaterial: "Ruby dust worth 1,500+ gp, which the spell consumes",
  duration: "Conc. 1 h",
  save: "Cha",
  description: "20-ft. cube cage, or 10-ft. cube solid; blocks all spells; extra planar travel in/out on save (1500gp)",
  descriptionFull: "An immobile, invisible, cube-shaped prison composed of magical force springs into existence around an area you choose within range. The prison can be a cage or a solid box as you choose." + "\n   " + "A prison in the shape of a cage can be up to 20 feet on a side and is made from 1/2-inch diameter bars spaced 1/2 inch apart." + "\n   " + "A prison in the shape of a box can be up to 10 feet on a side, creating a solid barrier that prevents any matter from passing through it and blocking any spells cast into or out of the area." + "\n   " + "When you cast the spell, any creature that is completely inside the cage's area is trapped. Creatures only partially within the area, or those too large to fit inside the area, are pushed away from the center of the area until they are completely outside the area." + "\n   " + "A creature inside the cage can't leave it by nonmagical means. If the creature tries to use teleportation or interplanar travel to leave the cage, it must first make a Charisma saving throw. On a success, the creature can use that magic to exit the cage. On a failure, the creature can't exit the cage and wastes the use of the spell or effect. The cage also extends into the Ethereal Plane, blocking ethereal travel." + "\n   " + "This spell can't be dispelled by dispel magic."
});
legacySpellRefactor("foresight", {
  name: "Foresight",
  classes: ["bard", "druid", "warlock", "wizard"],
  source: [["PHB2024", 276]],
  level: 9,
  school: "Div",
  time: "1 min",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "A hummingbird feather",
  duration: "8 h",
  description: "1 willing crea can't be surprised; adv. on attacks, ability checks, and saves; dis. on attacks vs. target",
  descriptionFull: "You touch a willing creature and bestow a limited ability to see into the immediate future. For the duration, the target can't be surprised and has advantage on attack rolls, ability checks, and saving throws. Additionally, other creatures have disadvantage on attack rolls against the target for the duration." + "\n   " + "This spell immediately ends if you cast it again before its duration ends."
});
legacySpellRefactor("fount of moonlight", {
  name: "Fount of Moonlight",
  classes: ["bard", "druid"],
  source: [["PHB2024", 277]],
  level: 4,
  school: "Evoc",
  time: "1 a",
  range: "Self",
  components: "V,S",
  duration: "Conc. up to 10 mins",
  description: "You Emit Bright in 20 and Dim in addit. 20, Resist Rad, 2d6 Rad. dmg extra on melee atks, reaction to taking dmg, attacker Con save or Blinded",
  descriptionFull: "A cool light wreathes your body for the duration, emitting Bright Light in a 20-foot radius and Dim Light for an additional 20 feet." + "\n   " + "Until the spell ends, you have Resistance to Radiant damage, and your melee attacks deal and extra 2d6 Radiant damage on a hit." + "\n   " + "In addition, immediately after you take damage from a creature you can see within 60 feet of yourself, you can take a Reaction to force the creature to make a Constitution saving throw. On a failed save, the creature has the Blinded condition until the end of your turn."
});
legacySpellRefactor("freedom of movement", {
  name: "Freedom of Movement",
  classes: ["bard", "cleric", "druid", "ranger"],
  source: [["PHB2024", 277]],
  level: 4,
  school: "Abjur",
  time: "1 a",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "A leather strap",
  duration: "1 h",
  description: "1+1/SL willing crea; magic cannot reduce speed, paralyze, restrain; use 5 ft. to escape nonmagical restraints",
  descriptionFull: "You touch a willing creature. For the duration, the target's movement is unaffected by difficult terrain, and spells and other magical effects can neither reduce the target's speed nor cause the target to be paralyzed or restrained." + "\n   " + "The target can also spend 5 feet of movement to automatically escape from nonmagical restraints, such as manacles or a creature that has it grappled. Finally, being underwater imposes no penalties on the target's movement or attacks."
});
legacySpellRefactor("friends", {
  name: "Friends",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 277]],
  level: 0,
  school: "Ench",
  time: "1 a",
  range: "10 feet",
  components: "S,M",
  compMaterial: "some makeup",
  duration: "Conc, 1 min",
  description: "Adv. on Cha checks vs. 1 crea currently not hostile; when spell ends, crea knows and becomes hostile",
  descriptionFull: "You magically emanate a sens of friendship toward one creature you can see within range. The target must succeed on a Wisdom saving throw or have the Charmed condition for the duration. The target succeeds automatically if it isn't a Humanoid, if you're fighting it, or if you have cast this spell on it..."
});
legacySpellRefactor("gaseous form", {
  name: "Gaseous Form",
  classes: ["sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 277]],
  level: 3,
  school: "Trans",
  time: "1 a",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "A bit of gauze",
  duration: "Conc, 1 h",
  description: "1+1/SL willing crea into a misty cloud with fly 10 ft., resist. to nonmagical dmg, adv. on Str/Dex/saves",
  descriptionFull: "You transform a willing creature you touch, along with everything it's wearing and carrying, into a misty cloud for the duration. The spell ends if the creature drops to 0 hit points. An incorporeal creature isn't affected." + "\n   " + "While in this form, the target's only method of movement is a flying speed of 10 feet. The target can enter and occupy the space of another creature. The target has resistance to nonmagical damage, and it has advantage on Strength, Dexterity, and Constitution saving throws. The target can pass through small holes, narrow openings, and even mere cracks, though it treats liquids as though they were solid surfaces. The target can't fall and remains hovering in the air even when stunned or otherwise incapacitated." + "\n   " + "While in the form of a misty cloud, the target can't talk or manipulate objects, and any objects it was carrying or holding can't be dropped, used, or otherwise interacted with. The target can't attack or cast spells."
});
legacySpellRefactor("gate", {
  name: "Gate",
  classes: ["cleric", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 277]],
  level: 9,
  school: "Conj",
  time: "1 a",
  range: "60 ft.",
  components: "V,S,M\u0192",
  compMaterial: "A diamond worth 5,000+ gp",
  duration: "Conc, 1 min",
  description: "Create a portal to a precise location on a different plane; can transport named crea to me (5000gp)",
  descriptionFull: "You conjure a portal linking an unoccupied space you can see within range to a precise location on a different plane of existence. The portal is a circular opening, which you can make 5 to 20 feet in diameter. You can orient the portal in any direction you choose. The portal lasts for the duration." + "\n   " + "The portal has a front and a back on each plane where it appears. Travel through the portal is possible only by moving through its front. Anything that does so is instantly transported to the other plane, appearing in the unoccupied space nearest to the portal." + "\n   " + "Deities and other planar rulers can prevent portals created by this spell from opening in their presence or anywhere within their domains." + "\n   " + "When you cast this spell, you can speak the name of a specific creature (a pseudonym, title, or nickname doesn't work). If that creature is on a plane other than the one you are on, the portal opens in the named creature's immediate vicinity and draws the creature through it to the nearest unoccupied space on your side of the portal. You gain no special power over the creature, and it is free to act as the DM deems appropriate. It might leave, attack you, or help you."
});
legacySpellRefactor("geas", {
  name: "Geas",
  classes: ["bard", "cleric", "druid", "paladin", "wizard"],
  source: [["PHB2024", 278]],
  level: 5,
  school: "Ench",
  time: "1 min",
  range: "60 ft.",
  components: "V",
  duration: "30 days (D)",
  save: "Wis",
  description: "1 crea save or charmed, it must obey commands or 5d10 Psychic dmg; SL7: 1 year, SL9: until disp.",
  descriptionShorter: "1 crea save or charmed, it must obey order or 5d10 Psychic dmg; SL7: 1 year, SL9: 'til disp.",
  descriptionFull: "You place a magical command on a creature that you can see within range, forcing it to carry out some service or refrain from some action or course of activity as you decide. If the creature can understand you, it must succeed on a Wisdom saving throw or become charmed by you for the duration. While the creature is charmed by you, it takes 5d10 psychic damage each time it acts in a manner directly counter to your instructions, but no more than once each day. A creature that can't understand you is unaffected by the spell." + "\n   " + "You can issue any command you choose, short of an activity that would result in certain death. Should you issue a suicidal command, the spell ends." + "\n   " + "You can end the spell early by using an action to dismiss it. A remove curse, greater restoration, or wish spell also ends it." + AtHigherLevels + "When you cast this spell using a spell slot of 7th or 8th level, the duration is 1 year. When you cast this spell using a spell slot of 9th level, the spell lasts until it is ended by one of the spells mentioned above."
});
legacySpellRefactor("gentle repose", {
  name: "Gentle Repose",
  classes: ["cleric", "paladin", "wizard"],
  source: [["PHB2024", 278]],
  ritual: true,
  level: 2,
  school: "Necro",
  time: "1 a",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "2 copper pieces, which the spell consumes",
  duration: "10 days",
  description: "1 corpse protected from decay and prevent it from becoming undead; add duration to raising dead",
  descriptionFull: "You touch a corpse or other remains. For the duration, the target is protected from decay and can't become undead." + "\n   " + "The spell also effectively extends the time limit on raising the target from the dead, since days spent under the influence of this spell don't count against the time limit of spells such as raise dead."
});
legacySpellRefactor("giant insect", {
  name: "Giant Insect",
  classes: ["druid"],
  source: [["PHB2024", 279]],
  level: 4,
  school: "Conj",
  time: "1 a",
  range: "30 ft.",
  components: "V,S",
  duration: "Conc, 10 min",
  description: "Summon a Giant centipede, spider, or wasp; obey my verbal commands",
  descriptionFull: "You summon a giant centipede, spider, or wasp (chosen when you cast the spell). It manifests in an unoccupied space you can see within range and uses the Giant Insect stat block. The form you choose determines certain details in its stat block. The creature disappears when it drops to 0 Hit Points or when the spell ends." + "\n   " + "The creature is an ally to you and your allies. In combat, the creature shares your Initiative count, but it takes its turn immediately after yours. It obeys your verbal commands (no action required by you). If you don't issue any, it takes the Dodge action and uses its movement to avoid danger." + AtHigherLevels + "Use the spell slot's level for the spell's level in the stat block."
});
legacySpellRefactor("glibness", {
  name: "Glibness",
  classes: ["bard", "warlock"],
  source: [["PHB2024", 279]],
  level: 8,
  school: "Ench",
  time: "1 a",
  range: "Self",
  components: "V",
  duration: "1 h",
  description: "I can choose to roll a 15 on any Charisma check; magic cannot detect if I am lying",
  descriptionFull: "Until the spell ends, when you make a Charisma check, you can replace the number you roll with a 15. Additionally, no matter what you say, magic that would determine if you are telling the truth indicates that you are being truthful."
});
legacySpellRefactor("globe of invulnerability", {
  name: "Globe of Invulnerability",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 279]],
  level: 6,
  school: "Abjur",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "A glass bead",
  duration: "Conc, 1 min",
  description: "SL<(6+1/SL) cast outside area cannot effect inside area; casting with a higher spell slot does not help",
  descriptionFull: "An immobile, faintly shimmering barrier springs into existence in a 10-foot radius around you and remains for the duration." + "\n   " + "Any spell of 5th level or lower cast from outside the barrier can't affect creatures or objects within it, even if the spell is cast using a higher level spell slot. Such a spell can target creatures and objects within the barrier, but the spell has no effect on them. Similarly, the area within the barrier is excluded from the areas affected by such spells." + AtHigherLevels + "When you cast this spell using a spell slot of 7th level or higher, the barrier blocks spells of one level higher for each slot level above 6th."
});
legacySpellRefactor("glyph of warding", {
  name: "Glyph of Warding",
  classes: ["bard", "cleric", "wizard"],
  source: [["PHB2024", 279]],
  level: 3,
  school: "Abjur",
  time: "1 h",
  range: "Touch",
  components: "V,S,M\u2020",
  compMaterial: "Powdered diamond worth 200+ gp, which the spell consumes",
  duration: "Until triggered",
  description: "Create a glyph that triggers on set condition; Int(Investigation) vs. Spell DC; see book (200gp cons.)",
  descriptionFull: "When you cast this spell, you inscribe a glyph that later unleashes a magical effect. You inscribe it either on a surface (such as a table or a section of floor or wall) or within an object that can be closed (such as a book, a scroll, or a treasure chest) to conceal the glyph. The glyph can cover an area no larger than 10 feet in diameter. If the surface or object is moved more than 10 feet from where you cast this spell, the glyph is broken, and the spell ends without being triggered." + "\n   " + "The glyph is nearly invisible and requires a successful Intelligence (Investigation) check against your spell save DC to be found." + "\n   " + "You decide what triggers the glyph when you cast the spell. For glyphs inscribed on a surface, the most typical triggers include touching or standing on the glyph, removing another object covering the glyph, approaching within a certain distance of the glyph, or manipulating the object on which the glyph is inscribed. For glyphs inscribed within an object, the most common triggers include opening that object, approaching within a certain distance of the object, or seeing or reading the glyph. Once a glyph is triggered, this spell ends." + "\n   " + "You can further refine the trigger so the spell activates only under certain circumstances or according to physical characteristics (such as height or weight), creature kind (for example, the ward could be set to affect aberrations or drow), or alignment. You can also set conditions for creatures that don't trigger the glyph, such as those who say a certain password." + "\n   " + "When you inscribe the glyph, choose explosive runes or a spell glyph." + "\n   " + toUni("Explosive Runes") + ": When triggered, the glyph erupts with magical energy in a 20-foot-radius sphere centered on the glyph. The sphere spreads around corners. Each creature in the aura must make a Dexterity saving throw. A creature takes 5d8 acid, cold, fire, lightning, or thunder damage on a failed saving throw (your choice when you create the glyph), or half as much damage on a successful one." + "\n   " + toUni("Spell Glyph") + ": You can store a prepared spell of 3rd level or lower in the glyph by casting it as part of creating the glyph. The spell must target a single creature or an area. The spell being stored has no immediate effect when cast in this way. When the glyph is triggered, the stored spell is cast. If the spell has a target, it targets the creature that triggered the glyph. If the spell affects an area, the area is centered on that creature. If the spell summons hostile creatures or creates harmful objects or traps, they appear as close as possible to the intruder and attack it. If the spell requires concentration, it lasts until the end of its full duration." + AtHigherLevels + "When you cast this spell using a spell slot of 4th level or higher, the damage of an explosive runes glyph increases by 1d8 for each slot level above 3rd. If you create a spell glyph, you can store any spell of up to the same level as the slot you use for the glyph of warding."
});
legacySpellRefactor("goodberry", {
  name: "Goodberry",
  classes: ["druid", "ranger"],
  source: [["PHB2024", 280]],
  level: 1,
  school: "Conj",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "A sprig of mistletoe",
  duration: "24 h",
  description: "Create 10 berries; 1 a to eat 1 berry: heal 1 HP, nourishment for 1 day; berries lose potency after 24h",
  descriptionShorter: "Create 10 berries; 1 a to eat 1 berry: heal 1 HP, nourishment for 1 day; lose potency after 24h",
  descriptionFull: "Up to ten berries appear in your hand and are infused with magic for the duration. A creature can use its bonus action to eat one berry. Eating a berry restores 1 hit point, and the berry provides enough nourishment to sustain a creature for one day." + "\n   " + "The berries lose their potency if they have not been consumed within 24 hours of the casting of this spell."
});
legacySpellRefactor("grasping vine", {
  name: "Grasping Vine",
  classes: ["druid", "ranger"],
  source: [["PHB2024", 280]],
  level: 4,
  school: "Conj",
  time: "1 bns",
  range: "60 ft.",
  components: "V,S",
  duration: "Conc, 1 min",
  save: "Dex",
  description: "Conjure vine with 30 ft. reach, Melee spell atk, on hit target takes 4d8 Blud. dmg and is pulled up to 30ft, if Huge or smaller crea has Grappled cond.; bns a to repeat atk against crea w/i 30 ft.",
  descriptionFull: "You conjure a vine that sprouts from a surface in an unoccupied space that you can see within range. The vine lasts for the duration." + "\n   " + "Make a melee spell attack against a creature within 30 feet of the vine. On a hit, the target takes 4d8 Bludgeoning damage and is pulled up to 30 feet toward the vine; if the target is Huge or smaller, it has the Grappled condition (escape DC equal to your spell save DC). The vine can grapple only one current at a time, and you can cause the vine to release a Grappled creature (no action required)." + "\n   " + "As a Bonus Action on your later turns, yo can repeat the attack against a creature with 30 feet of the vine." + AtHigherLevels + "The number of creatures the vine can grapple increases by one for each spell slot level above 4."
});
legacySpellRefactor("grease", {
  name: "Grease",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 280]],
  level: 1,
  school: "Conj",
  time: "1 a",
  range: "60 ft.",
  components: "V,S,M",
  compMaterial: "A bit of pork rind or butter",
  duration: "1 min",
  save: "Dex",
  description: "10-ft. square difficult terrain; all entering, in area at casting or at end of turn save or fall prone",
  descriptionFull: "Slick grease covers the ground in a 10-foot square centered on a point within range and turns it into difficult terrain for the duration." + "\n   " + "When the grease appears, each creature standing in its area must succeed on a Dexterity saving throw or fall prone. A creature that enters the area or ends its turn there must also succeed on a Dexterity saving throw or fall prone."
});
legacySpellRefactor("greater invisibility", {
  name: "Greater Invisibility",
  classes: ["bard", "sorcerer", "wizard"],
  source: [["PHB2024", 281]],
  level: 4,
  school: "Illus",
  time: "1 a",
  range: "Touch",
  components: "V,S",
  duration: "Conc, 1 min",
  description: "1 crea invisible until end of the spell; anything the target is wearing or carrying is also invisible",
  descriptionFull: "You or a creature you touch becomes invisible until the spell ends. Anything the target is wearing or carrying is invisible as long as it is on the target's person."
});
legacySpellRefactor("greater restoration", {
  name: "Greater Restoration",
  classes: ["bard", "cleric", "druid", "paladin", "ranger"],
  source: [["PHB2024", 281]],
  level: 5,
  school: "Abjur",
  time: "1 a",
  range: "Touch",
  components: "V,S,M\u2020",
  compMaterial: "Diamond dust worth 100+ gp, which the spell consumes",
  duration: "Instantaneous",
  description: "Reduce exhaustion or end charm, petrify, curse, stat or max HP reduction (100gp cons.)",
  descriptionFull: "You imbue a creature you touch with positive energy to undo a debilitating effect. You can reduce the target's exhaustion level by one, or end one of the following effects on the target." + "\n " + "\u2022 One effect that charmed or petrified the target" + "\n " + "\u2022 One curse, including the target's attunement to a cursed magic item" + "\n " + "\u2022 Any reduction to one of the target's ability scores" + "\n " + "\u2022 One effect reducing the target's hit point maximum."
});
legacySpellRefactor("guardian of faith", {
  name: "Guardian of Faith",
  classes: ["cleric"],
  source: [["PHB2024", 281]],
  level: 4,
  school: "Conj",
  time: "1 a",
  range: "30 ft.",
  components: "V",
  duration: "8 h",
  save: "Dex",
  description: "Place spectre; hostiles coming in 10 ft. of it 20 Radiant dmg; save half; vanishes after it deals 60 dmg",
  descriptionShorter: "Place spectre; hostiles enter in 10 ft. 20 Radiant dmg; save half; vanishes after doing 60 dmg",
  descriptionFull: "A Large spectral guardian appears and hovers for the duration in an unoccupied space of your choice that you can see within range. The guardian occupies that space and is indistinct except for a gleaming sword and shield emblazoned with the symbol of your deity." + "\n   " + "Any creature hostile to you that moves to a space within 10 feet of the guardian for the first time on a turn must succeed on a Dexterity saving throw. The creature takes 20 radiant damage on a failed save, or half as much damage on a successful one. The guardian vanishes when it has dealt a total of 60 damage."
});
legacySpellRefactor("guards and wards", {
  name: "Guards and Wards",
  classes: ["bard", "wizard"],
  source: [["PHB2024", 282]],
  level: 6,
  school: "Abjur",
  time: "10 h",
  range: "Touch",
  components: "V,S,M\u0192",
  compMaterial: "A silver rod worth 10+ gp",
  duration: "24 h",
  description: "Protect an area with an assortment of effects including fog, web, illusions and locks; see book (10gp)",
  descriptionFull: "You create a ward that protects up to 2,500 square feet of floor space (an area 50 feet square, or one hundred 5-foot squares or twenty-five 10-foot squares). The warded area can be up to 20 feet tall, and shaped as you desire. You can ward several stories of a stronghold by dividing the area among them, as long as you can walk into each contiguous area while you are casting the spell." + "\n   " + "When you cast this spell, you can specify individuals that are unaffected by any or all of the effects that you choose. You can also specify a password that, when spoken aloud, makes the speaker immune to these effects." + "\n   " + "Guards and wards creates the following effects within the warded area." + "\n   " + toUni("Corridors") + ": Fog fills all the warded corridors, making them heavily obscured. In addition, at each intersection or branching passage offering a choice of direction, there is a 50 percent chance that a creature other than you will believe it is going in the opposite direction from the one it chooses." + "\n   " + toUni("Doors") + ": All doors in the warded area are magically locked, as if sealed by an arcane lock spell. In addition, you can cover up to ten doors with an illusion (equivalent to the illusory object function of the minor illusion spell) to make them appear as plain sections of wall." + "\n   " + toUni("Stairs") + ": Webs fill all stairs in the warded area from top to bottom, as the web spell. These strands regrow in 10 minutes if they are burned or torn away while guards and wards lasts." + "\n   " + toUni("Other Spell Effect") + ": You can place your choice of one of the following magical effects within the warded area of the stronghold." + "\n " + "\u2022 Place dancing lights in four corridors. You can designate a simple program that the lights repeat as long as guards and wards lasts." + "\n " + "\u2022 Place magic mouth in two locations." + "\n " + "\u2022 Place stinking cloud in two locations. The vapors appear in the places you designate they return within 10 minutes if dispersed by wind while guards and wards lasts." + "\n " + "\u2022 Place a constant gust of wind in one corridor or room. Place a suggestion in one location. You select an area of up to 5 feet square, and any creature that enters or passes through the area receives the suggestion mentally." + "\n\n" + "The whole warded area radiates magic. A dispel magic cast on a specific effect, if successful, removes only that effect." + "\n   " + "You can create a permanently guarded and warded structure by casting this spell there every day for one year."
});
legacySpellRefactor("guidance", {
  name: "Guidance",
  classes: ["cleric", "druid"],
  source: [["PHB2024", 282]],
  level: 0,
  school: "Div",
  time: "1 a",
  range: "Touch",
  components: "V,S",
  duration: "Conc, 1 min",
  description: "1 willing creature adds 1d4 to ability check of its choice, after rolling, once during the duration",
  descriptionFull: "You touch a willing creature and choose a skill. Until the spell ends, the creature adds 1d4 to any ability check using the chosen skill."
});
legacySpellRefactor("guiding bolt", {
  name: "Guiding Bolt",
  classes: ["cleric"],
  source: [["PHB2024", 282]],
  level: 1,
  school: "Evoc",
  time: "1 a",
  range: "120 ft.",
  components: "V,S",
  duration: "1 rnd",
  description: "Spell attack for 4d6+1d6/SL Radiant dmg and next attack against target has advantage",
  descriptionFull: "A flash of light streaks toward a creature of your choice within range. Make a ranged spell attack against the target. On a hit, the target takes 4d6 radiant damage, and the next attack roll made against this target before the end of your next turn has advantage, thanks to the mystical dim light glittering on the target until then." + AtHigherLevels + "When you cast this spell using a spell slot of 2nd level or higher, the damage increases by 1d6 for each slot level above 1st."
});
legacySpellRefactor("gust of wind", {
  name: "Gust of Wind",
  classes: ["druid", "ranger", "sorcerer", "wizard"],
  source: [["PHB2024", 282]],
  level: 2,
  school: "Evoc",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "A legume seed",
  duration: "Conc, 1 min",
  save: "Str",
  description: "60-ft. long 10-ft. wide line of wind; crea starting turn in wind save or pushed 15 ft.; see book",
  descriptionFull: "A line of strong wind 60 feet long and 10 feet wide blasts from you in a direction you choose for the spell's duration. Each creature that starts its turn in the line must succeed on a Strength saving throw or be pushed 15 feet away from you in a direction following the line." + "\n   " + "Any creature in the line must spend 2 feet of movement for every 1 foot it moves when moving closer to you." + "\n   " + "The gust disperses gas or vapor, and it extinguishes candles, torches, and similar unprotected flames in the area. It causes protected flames, such as those of lanterns, to dance wildly and has a 50 percent chance to extinguish them." + "\n   " + "As a bonus action on each of your turns before the spell ends, you can change the direction in which the line blasts from you."
});
legacySpellRefactor("hail of thorns", {
  name: "Hail of Thorns",
  classes: ["ranger"],
  source: [["PHB2024", 283]],
  level: 1,
  school: "Conj",
  time: "1 bns",
  timeFull: "Bonus Action, which you take immediately after hitting a creature with a Ranged weapon",
  range: "Self",
  components: "V",
  duration: "Instantaneous",
  save: "Dex",
  description: "On ranged weapon hit, all within 5 ft. of target 1d10+1d10/SL Piercing dmg; save halves",
  descriptionFull: "As you hit the creature, this spell creates a rain of thorns that sprouts from your Ranged weapon or ammunition. The target of the attack and each creature within 5 feet of it make a Dexterity saving throw, taking 1d10 Piercing damage on a failed save or half as much damage on a successful one." + AtHigherLevels + "The damage increases by 1d10 for each spell slot level above 1.",
  dynamicDamageBonus: {multipleDmgMoments: false}
});
legacySpellRefactor("hallow", {
  name: "Hallow",
  classes: ["cleric"],
  source: [["PHB2024", 283]],
  level: 5,
  school: "Abjur",
  time: "24 h",
  range: "Touch",
  components: "V,S,M\u2020",
  compMaterial: "Incense worth 1000+ gp, which the spell consumes",
  duration: "Until dispelled",
  description: "30-ft. rad protected against celestials, elementals, fey, fiend, and undead; add additional effects; see B",
  descriptionFull: "You touch a point and infuse an area around it with holy (or unholy) power. The area can have a radius up to 60 feet, and the spell fails if the radius includes an area already under the effect a hallow spell. The affected area is subject to the following effects." + "\n   " + "First, celestials, elementals, fey, fiends, and undead can't enter the area, nor can such creatures charm, frighten, or possess creatures within it. Any creature charmed, frightened, or possessed by such a creature is no longer charmed, frightened, or possessed upon entering the area. You can exclude one or more of those types of creatures from this effect." + "\n   " + "Second, you can bind an extra effect to the area. Choose the effect from the following list, or choose an effect offered by the DM. Some of these effects apply to creatures in the area, you can designate whether the effect applies to all creatures, creatures that follow a specific deity or leader, or creatures of a specific sort, such as ores or trolls. When a creature that would be affected enters the spell's area for the first time on a turn or starts its turn there, it can make a Charisma saving throw. On a success, the creature ignores the extra effect until it leaves the area." + "\n   " + toUni("Courage") + ": Affected creatures can't be frightened while in the area." + "\n   " + toUni("Darkness") + ": Darkness fills the area. Normal light, as well as magical light created by spells of a lower level than the slot you used to cast this spell, can't illuminate the area." + "\n   " + toUni("Daylight") + ": Bright light fills the area. Magical darkness created by spells of a lower level than the slot you used to cast this spell can't extinguish the light." + "\n   " + toUni("Energy Protection") + ": Affected creatures in the area have resistance to one damage type of your choice, except for bludgeoning, piercing, or slashing." + "\n   " + toUni("Energy Vulnerability") + ": Affected creatures in the area have vulnerability to one damage type of your choice, except for bludgeoning, piercing, or slashing." + "\n   " + toUni("Everlasting Rest") + ": Dead bodies interred in the area can't be turned into undead." + "\n   " + toUni("Extradimensional Interference") + ": Affected creatures can't move or travel using teleportation or by extradimensional or interplanar means." + "\n   " + toUni("Fear") + ": Affected creatures are frightened while in the area." + "\n   " + toUni("Silence") + ": No sound can emanate from within the area, and no sound can reach into it." + "\n   " + toUni("Tongues") + ": Affected creatures can communicate with any other creature in the area, even if they don't share a common language."
});
legacySpellRefactor("hallucinatory terrain", {
  name: "Hallucinatory Terrain",
  classes: ["bard", "druid", "warlock", "wizard"],
  source: [["PHB2024", 283]],
  level: 4,
  school: "Illus",
  time: "10 min",
  range: "300 ft.",
  components: "V,S,M",
  compMaterial: "A mushroom",
  duration: "24 h",
  description: "150-ft. cube of terrain resembles some other sort of terrain; Int (Investigation) vs. Spell DC; see book",
  descriptionFull: "You make natural terrain in a 150-foot cube in range look, sound, and smell like some other sort of natural terrain. Thus, open fields or a road can be made to resemble a swamp, hill, crevasse, or some other difficult or impassable terrain. A pond can be made to seem like a grassy meadow, a precipice like a gentle slope, or a rock-strewn gully like a wide and smooth road. Manufactured structures, equipment, and creatures within the area aren't changed in appearance." + "\n   " + "The tactile characteristics of the terrain are unchanged, so creatures entering the area are likely to see through the illusion. If the difference isn't obvious by touch, a creature carefully examining the illusion can attempt an Intelligence (Investigation) check against your spell save DC to disbelieve it. A creature who discerns the illusion for what it is, sees it as a vague image superimposed on the terrain."
});
legacySpellRefactor("harm", {
  name: "Harm",
  classes: ["cleric"],
  source: [["PHB2024", 283]],
  level: 6,
  school: "Necro",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "Instantaneous",
  save: "Con",
  description: "1 crea 14d6 Necrotic dmg, reduce max HP by same; not <1 HP; save halves and no max HP reduce",
  descriptionFull: "You unleash a virulent disease on a creature that you can see within range. The target must make a Constitution saving throw. On a failed save, it takes 14d6 necrotic damage, or half as much damage on a successful save. The damage can't reduce the target's hit points below 1. If the target fails the saving throw, its hit point maximum is reduced for 1 hour by an amount equal to the necrotic damage it took. Any effect that removes a disease allows a creature's hit point maximum to return to normal before that time passes."
});
legacySpellRefactor("haste", {
  name: "Haste",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 284]],
  level: 3,
  school: "Trans",
  time: "1 a",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A shaving of licorice root",
  duration: "Conc, 1 min",
  description: "1 willing crea +2 AC, speed doubled, adv. on Dex saves, extra action (1 attack, dash, disengage, hide, or utilize)",
  descriptionFull: "Choose a willing creature that you can see within range. Until the spell ends, the target's speed is doubled, it gains a +2 bonus to AC, it has advantage on Dexterity saving throws, and it gains an additional action on each of its turns. That action can be used only to take the Attack (one weapon attack only), Dash, Disengage, Hide, or Utilize action." + "\n   " + "When the spell ends, the target can't move or take actions until after its next turn, as a wave of lethargy sweeps over it."
});
legacySpellRefactor("heal", {
  name: "Heal",
  classes: ["cleric", "druid"],
  source: [["PHB2024", 284]],
  level: 6,
  school: "Abjur",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "1 living creature heals 70+10/SL HP and is cured of blindness, deafness, and all diseases",
  descriptionShorter: "1 living creature heals 70+10/SL HP and is cured of blindness, deafness, all diseases",
  descriptionFull: "Choose a creature that you can see within range. A surge of positive energy washes through the creature, causing it to regain 70 hit points. The spell also ends blindness, deafness, and any diseases affecting the target. This spell has no effect on constructs or undead." + AtHigherLevels + "When you cast this spell using a spell slot of 7th level or higher, the amount of healing increases by 10 for each slot level above 6th."
});
legacySpellRefactor("healing word", {
  name: "Healing Word",
  classes: ["bard", "cleric", "druid"],
  source: [["PHB2024", 284]],
  level: 1,
  school: "Abjur",
  time: "1 bns",
  range: "60 ft.",
  components: "V",
  duration: "Instantaneous",
  description: "1 living creature heals 2d4+2d4/SL+spellcasting ability modifier HP",
  descriptionFull: "A creature of your choice that you can see within range regains hit points equal to 2d4 + your spellcasting ability modifier. This spell has no effect on undead or constructs." + AtHigherLevels + "When you cast this spell using a spell slot of 2nd level or higher, the healing increases by 2d4 for each slot level above 1st."
});
legacySpellRefactor("heat metal", {
  name: "Heat Metal",
  classes: ["bard", "druid"],
  source: [["PHB2024", 284]],
  level: 2,
  school: "Trans",
  time: "1 a",
  range: "60 ft.",
  components: "V,S,M",
  compMaterial: "A piece of iron and a flame",
  duration: "Conc, 1 min",
  save: "Con",
  description: "1 metal obj on touch 2d8+1d8/SL Fire dmg; save or drop obj; if held: dis. atk/chk; bns a reheat obj",
  descriptionShorter: "1 metal obj, touch it 2d8+1d8/SL Fire dmg; save or drop it; if held: dis. atk/chk; bns a redo",
  descriptionFull: "Choose a manufactured metal object, such as a metal weapon or a suit of heavy or medium metal armor, that you can see within range. You cause the object to glow red-hot. Any creature in physical contact with the object takes 2d8 fire damage when you cast the spell. Until the spell ends, you can use a bonus action on each of your subsequent turns to cause this damage again." + "\n   " + "If a creature is holding or wearing the object and takes the damage from it, the creature must succeed on a Constitution saving throw or drop the object if it can. If it doesn't drop the object, it has disadvantage on attack rolls and ability checks until the start of your next turn." + AtHigherLevels + "When you cast this spell using a spell slot of 3rd level or higher, the damage increases by 1d8 for each slot above 2nd."
});
legacySpellRefactor("hellish rebuke", {
  name: "Hellish Rebuke",
  classes: ["warlock"],
  source: [["PHB2024", 284]],
  level: 1,
  school: "Evoc",
  time: "1 rea",
  timeFull: "1 reaction, which you take in response to being damaged by a creature within 60 feet of you that you can see",
  range: "60 ft.",
  components: "V,S",
  duration: "Instantaneous",
  save: "Dex",
  description: "Cast when taking dmg, crea that dealt dmg 2d10+1d10/SL Fire dmg; save halves",
  descriptionFull: "You point your finger, and the creature that damaged you is momentarily surrounded by hellish flames. The creature must make a Dexterity saving throw. It takes 2d10 fire damage on a failed save, or half as much damage on a successful one." + AtHigherLevels + "When you cast this spell using a spell slot of 2nd level or higher, the damage increases by 1d10 for each slot level above 1st."
});
legacySpellRefactor("heroes' feast", {
  name: "Heroes' Feast",
  classes: ["bard", "cleric", "druid"],
  source: [["PHB2024", 284]],
  level: 6,
  school: "Conj",
  time: "10 min",
  range: "30 ft.",
  components: "V,S,M\u2020",
  compMaterial: "A gem-encrusted bowl worth 1,000+ gp, which the spell consumes",
  duration: "Instantaneous",
  description: "Up to 12 crea; 1h to consume; for 24h: resist pois. Immune Fright. and Poisoned, +2d10 max HP, see B (1000gp cons.)",
  descriptionFull: "You bring forth a great feast, including magnificent food and drink. The feast takes 1 hour to consume and disappears at the end of that time, and the beneficial effects don't set in until this hour is over. Up to twelve creatures can partake of the feast." + "\n   " + "A creature that partakes of the feast gains several benefits. The creature is Resistant to Poison damage, becomes immune to the Poisoned and frightened conditions. Its hit point maximum also increases by 2d10, and it gains the same number of hit points. These benefits last for 24 hours."
});
legacySpellRefactor("heroism", {
  name: "Heroism",
  classes: ["bard", "paladin"],
  source: [["PHB2024", 285]],
  level: 1,
  school: "Ench",
  time: "1 a",
  range: "Touch",
  components: "V,S",
  duration: "Conc, 1 min",
  description: "1+1/SL crea immune to fear, gain spellcasting ability modifier temp. HP start of each turn as spell lasts",
  descriptionFull: "A willing creature you touch is imbued with bravery. Until the spell ends, the creature is immune to being frightened and gains temporary hit points equal to your spellcasting ability modifier at the start of each of its turns. When the spell ends, the target loses any remaining temporary hit points from this spell." + AtHigherLevels + "When you cast this spell using a spell slot of 2nd level or higher, you can target one additional creature for each slot level above 1st."
});
legacySpellRefactor("hex", {
  name: "Hex",
  classes: ["warlock"],
  source: [["PHB2024", 285]],
  level: 1,
  school: "Ench",
  time: "1 bns",
  range: "90 ft.",
  components: "V,S,M",
  compMaterial: "The petrified eye of a newt",
  duration: "Conc, 1 h",
  description: "1 crea +1d6 Necrotic dmg from my atks; dis. on chosen ability checks; SL3: conc, 8h; SL5: conc, 24h",
  descriptionShorter: "1 crea +1d6 Necrotic dmg from my atks; dis. chosen abi chks; SL3: conc, 8h; SL5: conc, 24h",
  descriptionFull: "You place a curse on a creature that you can see within range. Until the spell ends, you deal an extra 1d6 necrotic damage to the target whenever you hit it with an attack. Also, choose one ability when you cast the spell. The target has disadvantage on ability checks made with the chosen ability." + "\n   " + "If the target drops to 0 hit points before this spell ends, you can use a bonus action on a subsequent turn of yours to curse a new creature." + "\n   " + "A remove curse cast on the target ends this spell early." + AtHigherLevels + "When you cast this spell using a spell slot of 3rd or 4th level, you can maintain your concentration on the spell for up to 8 hours. When you use a spell slot of 5th level or higher, you can maintain your concentration on the spell for up to 24 hours."
});
legacySpellRefactor("hold monster", {
  name: "Hold Monster",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 285]],
  level: 5,
  school: "Ench",
  time: "1 a",
  range: "90 ft.",
  components: "V,S,M",
  compMaterial: "A straight piece of iron",
  duration: "Conc, 1 min",
  save: "Wis",
  description: "1+1/SL crea, each max 30 ft. apart, save or paralyzed; extra save at end of each turn",
  descriptionFull: "Choose a creature that you can see within range. The target must succeed on a Wisdom saving throw or be paralyzed for the duration. At the end of each of its turns, the target can make another Wisdom saving throw. On a success, the spell ends on the target." + AtHigherLevels + "When you cast this spell using a spell slot of 6th level or higher, you can target on additional creature for each slot level above 5th. The creatures must be within 30 feet of each other when you target them."
});
legacySpellRefactor("hold person", {
  name: "Hold Person",
  classes: ["bard", "cleric", "druid", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 286]],
  level: 2,
  school: "Ench",
  time: "1 a",
  range: "60 ft.",
  components: "V,S,M",
  compMaterial: "A straight piece of iron",
  duration: "Conc, 1 min",
  save: "Wis",
  description: "1+1/SL humanoids save or paralyzed; extra save at end of each turn",
  descriptionFull: "Choose a humanoid that you can see within range. The target must succeed on a Wisdom saving throw or be paralyzed for the duration. At the end of each of its turns, the target can make another Wisdom saving throw. On a success, the spell ends on the target." + AtHigherLevels + "When you cast this spell using a spell slot of 3rd level or higher, you can target on additional humanoid for each slot level above 2nd."
});
legacySpellRefactor("holy aura", {
  name: "Holy Aura",
  classes: ["cleric"],
  source: [["PHB2024", 286]],
  level: 8,
  school: "Abjur",
  time: "1 a",
  range: "Self",
  components: "V,S,M\u0192",
  compMaterial: "A reliquary worth 1000+ gp",
  duration: "Conc, 1 min",
  save: "Con",
  description: "Any in 30 ft. of me adv. saves; dis. atks vs. targets; fiend/undead atk a target save or blinded (1000gp)",
  descriptionFull: "Divine light washes out from you and coalesces in a soft radiance in a 30-foot radius around you. Creatures of your choice in that radius when you cast this spell shed dim light in a 5-foot radius and have advantage on all saving throws, and other creatures have disadvantage on attack rolls against them until the spell ends. In addition, when a fiend or an undead hits an affected creature with a melee attack, the aura flashes with brilliant light. The attacker must succeed on a Constitution saving throw or be blinded until the spell ends."
});
legacySpellRefactor("hunger of hadar", {
  name: "Hunger of Hadar",
  classes: ["warlock"],
  source: [["PHB2024", 286]],
  level: 3,
  school: "Conj",
  time: "1 a",
  range: "150 ft.",
  components: "V,S,M",
  compMaterial: "A pickled tentacle",
  duration: "Conc, 1 min",
  save: "Dex",
  description: "20-ft. rad all: blind while in, start turn in 2d6+1d6/SL(if chosen) Cold dmg, end turn in save or 2d6+1d6/SL(if chosen) Acid dmg",
  descriptionFull: "You open a gateway to the dark between the stars, a region infested with unknown horrors. A 20-foot-radius sphere of blackness and bitter cold appears, centered on a point with range and lasting for the duration. This void is filled with a cacophony of soft whispers and slurping noises that can be heard up to 30 feet away. No light, magical or otherwise, can illuminate the area, and creatures fully within the area are blinded." + "\n   " + "The void creates a warp in the fabric of space, and the area is difficult terrain. Any creature that starts its turn in the area takes 2d6 cold damage. Any creature that ends its turn in the area must succeed on a Dexterity saving throw or take 2d6 acid damage as milky, otherworldly tentacles rub against it." + AtHigherLevels + "The Cold or Acid damage (your choice) increases by 1d6 for each spell slot above 3."
});
legacySpellRefactor("hunter's mark", {
  name: "Hunter's Mark",
  classes: ["ranger"],
  source: [["PHB2024", 287]],
  level: 1,
  school: "Div",
  time: "1 bns",
  range: "90 ft.",
  components: "V",
  duration: "Conc, 1 h",
  description: "1 crea +1d6 dmg from my weapon atks; adv. Wis (Perception/Survival) vs. target; SL3: 8h; SL5: 24h",
  descriptionFull: "You choose a creature you can see within range and mystically mark it as your quarry. Until the spell ends, you deal an extra 1d6 force damage to the target whenever you hit it with a weapon attack, and you have advantage on any Wisdom (Perception) or Wisdom (Survival) check you make to find it. If the target drops to 0 hit points before this spell ends, you can use a bonus action on a subsequent turn of yours to mark a new creature." + AtHigherLevels + "When you cast this spell using a spell slot of 3rd or 4th level, you can maintain your concentration on the spell for up to 8 hours. When you use a spell slot of 5th level or higher, you can maintain your concentration on the spell for up to 24 hours."
});
legacySpellRefactor("hypnotic pattern", {
  name: "Hypnotic Pattern",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 287]],
  level: 3,
  school: "Illus",
  time: "1 a",
  range: "120 ft.",
  components: "S,M",
  compMaterial: "A pinch of confetti",
  duration: "Conc, 1 min",
  save: "Wis",
  description: "30-ft. cube all crea save or charmed, incapacitated, speed 0 for duration; ends if crea takes dmg",
  descriptionFull: "You create a twisting pattern of colors that weaves through the air inside a 30-foot cube within range. The pattern appears for a moment and vanishes. Each creature in the area who sees the pattern must make a Wisdom saving throw. On a failed save, the creature becomes charmed for the duration. While charmed by this spell, the creature is incapacitated and has a speed of 0." + "\n   " + "The spell ends for an affected creature if it takes any damage or if someone else uses an action to shake the creature out of its stupor."
});
legacySpellRefactor("ice knife", {
  name: "Ice Knife",
  classes: ["druid", "sorcerer", "wizard"],
  source: [["PHB2024", 287]],
  level: 1,
  school: "Conj",
  time: "1 a",
  range: "60 ft.",
  components: "S,M",
  compMaterial: "A drop of water or piece of ice",
  duration: "Instantaneous",
  save: "Dex",
  description: "Ranged atk for 1d10 Piercing dmg; hit/miss 5-ft. rad on target all crea save or 2d6+1d6/SL Cold dmg",
  descriptionShorter: "Ranged atk 1d10 Piercing dmg; on target 5-ft. rad all crea save or 2d6+1d6/SL Cold dmg",
  descriptionFull: "You create a shard of ice and fling it at one creature within range. Make a ranged spell attack against the target. On a hit, the target takes 1d10 piercing damage. Hit or miss, the shard then explodes. The target and each creature within 5 feet of it must succeed on a Dexterity saving throw or take 2d6 cold damage." + AtHigherLevels + "When you cast this spell using a spell slot of 2nd level or higher, the cold damage increases by 1d6 for each slot level above 1st.",
  dynamicDamageBonus: {
    skipDmgGroupIfNotMultiple: /(atk .*piercing dmg.*?)/i
  }
});
legacySpellRefactor("ice storm", {
  name: "Ice Storm",
  classes: ["druid", "sorcerer", "wizard"],
  source: [["PHB2024", 287]],
  level: 4,
  school: "Evoc",
  time: "1 a",
  range: "300 ft.",
  components: "V,S,M",
  compMaterial: "A mitten",
  duration: "Instantaneous",
  save: "Dex",
  description: "20-ft. rad 40-ft. high all crea 2d10+1d10/SL Bludg. dmg \u0026 4d6 Cold dmg; save half; 1 rnd difficult ter.",
  descriptionFull: "A hail of rock-hard ice pounds to the ground in a 20-foot-radius, 40-foot-high cylinder centered on a point within range. Each creature in the cylinder must make a Dexterity saving throw. A creature takes 2d10 bludgeoning damage and 4d6 cold damage on a failed save, or half as much damage on a successful one." + "\n   " + "Hailstones turn the storm's area of effect into difficult terrain until the end of your next turn." + AtHigherLevels + "When you cast this spell using a spell slot of 5th level or higher, the bludgeoning damage increases by 1d10 for each slot level above 4th.",
  dynamicDamageBonus: {allDmgTypesSingleMoment: true}
});
legacySpellRefactor("identify", {
  name: "Identify",
  classes: ["bard", "wizard"],
  source: [["PHB2024", 287]],
  ritual: true,
  level: 1,
  school: "Div",
  time: "1 min",
  range: "Touch",
  components: "V,S,M\u0192",
  compMaterial: "A pearl worth 100+ gp",
  duration: "Instantaneous",
  description: "1 magical item or magic-imbued crea/obj; learn properties, how to use, and spells affecting it (100gp)",
  descriptionFull: "You choose one object that you must touch throughout the casting of the spell. If it is a magic item or some other magic-imbued object, you learn its properties and how to use them, whether it requires attunement to use, and how many charges it has, if any. You learn whether any spells are affecting the item and what they are. If the item was created by a spell, you learn which spell created it." + "\n   " + "If you instead touch a creature throughout the casting, you learn what spells, if any, are currently affecting it."
});
legacySpellRefactor("illusory script", {
  name: "Illusory Script",
  classes: ["bard", "warlock", "wizard"],
  source: [["PHB2024", 288]],
  ritual: true,
  level: 1,
  school: "Illus",
  time: "1 min",
  range: "Touch",
  components: "S,M\u2020",
  compMaterial: "Ink worth 10+ gp, which the spell consumes",
  duration: "10 days",
  description: "Write a message that only I, designated crea, and any with truesight can understand (10gp cons.)",
  descriptionFull: "You write on parchment, paper, or some other suitable writing material and imbue it with a potent illusion that lasts for the duration." + "\n   " + "To you and any creatures you designate when you cast the spell, the writing appears normal, written in your hand, and conveys whatever meaning you intended when you wrote the text. To all others, the writing appears as if it were written in an unknown or magical script that is unintelligible. Alternatively, you can cause the writing to appear to be an entirely different message, written in a different hand and language, though the language must be one you know." + "\n   " + "Should the spell be dispelled, the original script and the illusion both disappear." + "\n   " + "A creature with truesight can read the hidden message."
});
legacySpellRefactor("imprisonment", {
  name: "Imprisonment",
  classes: ["warlock", "wizard"],
  source: [["PHB2024", 288]],
  level: 9,
  school: "Abjur",
  time: "1 min",
  range: "30 ft.",
  components: "V,S,M\u2020",
  compMaterial: "A statuette of the target worth 5000+ gp",
  duration: "Until dispelled",
  save: "Wis",
  description: "1 crea save or trapped in chosen way with no means of escape; see book (500gp)",
  descriptionFull: "You create a magical restraint to hold a creature that you can see within range. The target must succeed on a Wisdom saving throw or be bound by the spell, if it succeeds, it is immune to this spell if you cast it again. While affected by this spell, the creature doesn't need to breathe, eat, or drink, and it doesn't age. Divination spells can't locate or perceive the target." + "\n   " + "When you cast the spell, you choose one of the following forms of imprisonment." + "\n   " + toUni("Burial") + ": The target is entombed far beneath the earth in a sphere of magical force that is just large enough to contain the target. Nothing can pass through the sphere, nor can any creature teleport or use planar travel to get into or out of it." + "\n   " + "The special component for this version of the spell is a small mithral orb." + "\n   " + toUni("Chaining") + ": Heavy chains, firmly rooted in the ground, hold the target in place. The target is restrained until the spell ends, and it can't move or be moved by any means until then." + "\n   " + "The special component for this version of the spell is a fine chain of precious metal." + "\n   " + toUni("Hedged Prison") + ": The spell transports the target into a tiny demiplane that is warded against teleportation and planar travel. The demiplane can be a labyrinth, a cage, a tower, or any similar confined structure or area of your choice." + "\n   " + "The special component for this version of the spell is a miniature representation of the prison made from jade." + "\n   " + toUni("Minimus Containment") + ": The target shrinks to a height of 1 inch and is imprisoned inside a gemstone or similar object. Light can pass through the gemstone normally (allowing the target to see out and other creatures to see in), but nothing else can pass through, even by means of teleportation or planar travel. The gemstone can't be cut or broken while the spell remains in effect." + "\n   " + "The special component for this version of the spell is a large, transparent gemstone, such as a corundum, diamond, or ruby." + "\n   " + toUni("Slumber") + ": The target falls asleep and can't be awoken." + "\n   " + "The special component for this version of the spell consists of rare soporific herbs." + "\n   " + toUni("Ending the Spell") + ": During the casting of the spell, in any of its versions, you can specify a condition that will cause the spell to end and release the target. The condition can be as specific or as elaborate as you choose, but the DM must agree that the condition is reasonable and has a likelihood of coming to pass. The conditions can be based on a creature's name, identity, or deity but otherwise must be based on observable actions or qualities and not based on intangibles such as level, class, or hit points." + "\n   " + "A dispel magic spell can end the spell only if it is cast as a 9th-level spell, targeting either the prison or the special component used to create it." + "\n   " + "You can use a particular special component to create only one prison at a time. If you cast the spell again using the same component, the target of the first casting is immediately freed from its binding."
});
legacySpellRefactor("incendiary cloud", {
  name: "Incendiary Cloud",
  classes: ["druid", "sorcerer", "wizard"],
  source: [["PHB2024", 288]],
  level: 8,
  school: "Conj",
  time: "1 a",
  range: "150 ft.",
  components: "V,S",
  duration: "Conc, 1 min",
  save: "Dex",
  description: "20-ft. rad all now/enter/end turn 10d8 Fire dmg; save half; heavily obscures; moves 10 ft./rnd away",
  descriptionShorter: "20-ft. rad all now/enter/end turn 10d8 Fire dmg; save half; heavy obsc.; moves 10 ft./rnd",
  descriptionFull: "A swirling cloud of smoke shot through with white-hot embers appears in a 20-foot-radius sphere centered on a point within range. The cloud spreads around corners and is heavily obscured. It lasts for the duration or until a wind of moderate or greater speed (at least 10 miles per hour) disperses it." + "\n   " + "When the cloud appears, each creature in it must make a Dexterity saving throw. A creature takes 10d8 fire damage on a failed save, or half as much damage on a successful one. A creature must also make this saving throw when it enters the spell's area for the first time on a turn or ends its turn there." + "\n   " + "The cloud moves 10 feet directly away from you in a direction that you choose at the start of each of your turns."
});
legacySpellRefactor("inflict wounds", {
  name: "Inflict Wounds",
  classes: ["cleric"],
  source: [["PHB2024", 288]],
  level: 1,
  school: "Necro",
  time: "1 a",
  range: "Touch",
  components: "V,S",
  save: "Con",
  duration: "Instantaneous",
  description: "Con save for 2d10+1d10/SL Necrotic dmg",
  descriptionFull: "A creature you touch makes a Constitution saving throw, taking 2d10 Necrotic damage on a failed save or half as much on a successful one." + AtHigherLevels + "When you cast this spell using a spell slot of 2nd level or higher, the damage increases by 1d10 for each slot level above 1st."
});
legacySpellRefactor("insect plague", {
  name: "Insect Plague",
  classes: ["cleric", "druid", "sorcerer"],
  source: [["PHB2024", 289]],
  level: 5,
  school: "Conj",
  time: "1 a",
  range: "300 ft.",
  components: "V,S,M",
  compMaterial: "A locust",
  duration: "Conc, 10 min",
  save: "Con",
  description: "20-ft. rad all now/enter/end turn 4d10+1d10/SL Piercing dmg; save half, no cover; light obsc.; dif. ter",
  descriptionShorter: "20-ft. rad all now/enter/end 4d10+1d10/SL Piercing dmg; save half; light obscures; dif. ter.",
  descriptionFull: "Swarming, biting locusts fill a 20-foot-radius sphere centered on a point you choose within range. The sphere spreads around corners. The sphere remains for the duration, and its area is lightly obscured. The sphere's area is difficult terrain." + "\n   " + "When the area appears, each creature in it must make a Constitution saving throw. A creature takes 4d10 piercing damage on a failed save, or half as much damage on a successful one. A creature must also make this saving throw when it enters the spell's area for the first time on a turn or ends its turn there." + AtHigherLevels + "When you cast this spell using a spell slot of 6th level or higher, the damage increases by 1d10 for each slot level above 5th."
});
legacySpellRefactor("invisibility", {
  name: "Invisibility",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 289]],
  level: 2,
  school: "Illus",
  time: "1 a",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "An eyelash in gum arabic",
  duration: "Conc, 1 h",
  description: "1+1/SL crea invisible; attacking/casting makes the crea visible; anything worn/carried also invisible",
  descriptionFull: "A creature you touch becomes invisible until the spell ends. Anything the target is wearing or carrying is invisible as long as it is on the target's person. The spell ends for a target that attacks or casts a spell." + AtHigherLevels + "When you cast this spell using a spell slot of 3rd level or higher, you can target one additional creature for each slot level above 2nd."
});
legacySpellRefactor("jallarzi's storm of radiance", {
  name: "Jallarzi's Storm of Radiance",
  classes: ["warlock", "wizard"],
  source: [["PHB2024", 289 - 290]],
  level: 5,
  school: "Evoc",
  time: "1 a",
  range: "120 ft.",
  components: "V,S,M",
  compMaterial: "A pinch of phosphorus",
  save: "Con",
  duration: "Conc. up to 1 min",
  description: "30ft rad, 40ft high Cylind. Crea inside Blind. and Deaf. No V components for spells, Con save or 2d10+1d10/SL Rad. and 2d10+1d10/SL Thund. dmg, half on success.",
  descriptionFull: "You unleash a storm of flashing light and raging thunder in a 10-foot-radius, 40-foot-high Cylinder centered on a point you can see within range. Creatures who enter or start their turn in the storm have the Blinded and Deafened conditions, and they can't cast spells with a Verbal component." + "\n   " + "When the storm appears, each creature in it makes a Constitution saving throw, taking 2d10 Radiant damage and 2d10 Thunder damage on a failed save or half as much damage on a successful one. A creature also makes this save when it enters the spell's area for the first time on a turn or ends its turn there. A creature makes this save only once per turn." + AtHigherLevels + "The Radiant and Thunder damage increase by 1d10 for each spell slot level above 5."
});
legacySpellRefactor("jump", {
  name: "Jump",
  classes: ["druid", "ranger", "sorcerer", "wizard"],
  source: [["PHB2024", 290]],
  level: 1,
  school: "Trans",
  time: "1 bns",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "A grasshopper's hind leg",
  duration: "1 min",
  description: "1+1/SL creature can spend 10ft movement to jump 30ft once per turn",
  descriptionFull: "You touch a willing creature. Once on each of its turns until the spell ends, that creature can jump up to 30 feet by spending 10 feet of movement." + AtHigherLevels + "You can target one additional creature for each spell slot level above 1."
});
legacySpellRefactor("knock", {
  name: "Knock",
  classes: ["bard", "sorcerer", "wizard"],
  source: [["PHB2024", 290]],
  level: 2,
  school: "Trans",
  time: "1 a",
  range: "60 ft.",
  components: "V",
  duration: "Instantaneous",
  description: "1 object is unlocked (1 lock), unstuck, unbarred, arcane lock suppressed for 10 min; audible for 300 ft.",
  descriptionFull: "Choose an object that you can see within range. The object can be a door, a box, a chest, a set of manacles, a padlock, or another object that contains a mundane or magical means that prevents access." + "\n   " + "A target that is held shut by a mundane lock or that is stuck or barred becomes unlocked, unstuck, or unbarred. If the object has multiple locks, only one of them is unlocked." + "\n   " + "If you choose a target that is held shut with arcane lock, that spell is suppressed for 10 minutes, during which time the target can be opened and shut normally." + "\n   " + "When you cast the spell, a loud knock, audible from as far away as 300 feet, emanates from the target object."
});
legacySpellRefactor("legend lore", {
  name: "Legend Lore",
  classes: ["bard", "cleric", "wizard"],
  source: [["PHB2024", 290]],
  level: 5,
  school: "Div",
  time: "10 min",
  range: "Self",
  components: "V,S,M\u2020",
  compMaterial: "Incense worth 250+ gp, which the spell consumes, and four ivory strips worth 50+ gp each",
  duration: "Instantaneous",
  description: "Learn summary of lore of named or described person, place, or object (200gp; 250gp cons.)",
  descriptionFull: "Name or describe a person, place, or object. The spell brings to your mind a brief summary of the significant lore about the thing you named. The lore might consist of current tales, forgotten stories, or even secret lore that has never been widely known. If the thing you named isn't of legendary importance, you gain no information." + "\n   " + "The more information you already have about the thing, the more precise and detailed the information you receive is. The information you learn is accurate but might be couched in figurative language. For example, if you have a mysterious magic axe on hand, the spell might yield this information - Woe to the evildoer whose hand touches the axe, for even the haft slices the hand of the evil ones. Only a true Child of Stone, lover and beloved of Moradin, may awaken the true powers of the axe, and only with the sacred word Rudnogg on the lips."
});
legacySpellRefactor("leomund's secret chest", {
  name: "Leomund's Secret Chest",
  nameAlt: "Secret Chest",
  classes: ["wizard"],
  source: [["PHB2024", 290]],
  level: 4,
  school: "Conj",
  time: "1 a",
  range: "Touch",
  components: "V,S,M\u0192",
  compMaterial: "A chest, 3 feet by 2 feet by 2 feet, constructed from rare materials worth 5,000+ gp, and a Tiny replica made from the same materials worth 50+ gp",
  duration: "Until Dispelled",
  description: "Hide chest with content in Ethereal Plane for 60 days, after that chance of loss; 1 a reappear (5050gp)",
  descriptionFull: "You hide a chest, and all its contents, on the Ethereal Plane. You must touch the chest and the miniature replica that serves as a material component for the spell. The chest can contain up to 12 cubic feet of nonliving material (3 feet by 2 feet by 2 feet)." + "\n   " + "While the chest remains on the Ethereal Plane, you can use an action and touch the replica to recall the chest. It appears in an unoccupied space on the ground within 5 feet of you. You can send the chest back to the Ethereal Plane by using an action and touching both the chest and the replica." + "\n   " + "After 60 days, there is a cumulative 5 percent chance per day that the spell's effect ends. This effect ends if you cast this spell again, if the smaller replica chest is destroyed, or if you choose to end the spell as an action. If the spell ends and the larger chest is on the Ethereal Plane, it is irretrievably lost."
});
legacySpellRefactor("leomund's tiny hut", {
  name: "Leomund's Tiny Hut",
  nameAlt: "Tiny Hut",
  classes: ["bard", "wizard"],
  source: [["PHB2024", 291]],
  ritual: true,
  level: 3,
  school: "Evoc",
  time: "1 min",
  range: "Self",
  components: "V,S,M",
  compMaterial: "A crystal bead",
  duration: "8 h",
  description: "10-ft. rad immobile dome of force holds 9 Medium crea; blocks magic; ends if I leave; see book",
  descriptionFull: "A 10-foot-radius immobile dome of force springs into existence around and above you and remains stationary for the duration. The spell ends if you leave its area." + "\n   " + "Nine creatures of Medium size or smaller can fit inside the dome with you. The spell fails if its area includes a larger creature or more than nine creatures. Creatures and objects within the dome when you cast this spell can move through it freely. All other creatures and objects are barred from passing through it. Spells and other magical effects can't extend through the dome or be cast through it. The atmosphere inside the space is comfortable and dry, regardless of the weather outside." + "\n   " + "Until the spell ends, you can command the interior to become dimly lit or dark. The dome is opaque from the outside, of any color you choose, but it is transparent from the inside."
});
legacySpellRefactor("lesser restoration", {
  name: "Lesser Restoration",
  classes: ["bard", "cleric", "druid", "paladin", "ranger"],
  source: [["PHB2024", 291]],
  level: 2,
  school: "Abjur",
  time: "1 bns",
  range: "Touch",
  components: "V,S",
  duration: "Instantaneous",
  description: "1 crea cured of 1 condition: blinded, deafened, paralyzed, or poisoned",
  descriptionFull: "You touch a creature and can end one condition afflicting it. The condition can be blinded, deafened, paralyzed, or poisoned."
});
legacySpellRefactor("levitate", {
  name: "Levitate",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 291]],
  level: 2,
  school: "Trans",
  time: "1 a",
  range: "60 ft.",
  components: "V,S,M",
  compMaterial: "A metal spring",
  duration: "Conc, 10 min",
  save: "Con",
  description: "1 crea/obj up to 500 lb save or rise vertically, up to 20 ft.; 1 a (move a if self) move up/down 20 ft.",
  descriptionFull: "One creature or loose object of your choice that you can see within range rises vertically, up to 20 feet, and remains suspended there for the duration. The spell can levitate a target that weighs up to 500 pounds. An unwilling creature that succeeds on a Constitution saving throw is unaffected." + "\n   " + "The target can move only by pushing or pulling against a fixed object or surface within reach (such as a wall or a ceiling), which allows it to move as if it were climbing. You can change the target's altitude by up to 20 feet in either direction on your turn. If you are the target, you can move up or down as part of your move. Otherwise, you can use your action to move the target, which must remain within the spell's range." + "\n   " + "When the spell ends, the target floats gently to the ground if it is still aloft."
});
legacySpellRefactor("light", {
  name: "Light",
  classes: ["bard", "cleric", "sorcerer", "wizard"],
  source: [["PHB2024", 292]],
  level: 0,
  school: "Evoc",
  time: "1 a",
  range: "Touch",
  components: "V,M",
  compMaterial: "A firefly or phosphorescent moss",
  duration: "1 h",
  description: "1 obj up to 10-ft. cube sheds bright light 20-ft. rad and dim light 20-ft.; cannot have multiple instances",
  descriptionFull: "You touch one object that is no larger than 10 feet in any dimension. Until the spell ends, the object sheds bright light in a 20-foot radius and dim light for an additional 20 feet. The light can be colored as you like. Completely covering the object with something opaque blocks the light. The spell ends if you cast it again or dismiss it as an action." + "\n   " + "If you target an object held or worn by a hostile creature, that creature must succeed on a Dexterity saving throw to avoid the spell."
});
legacySpellRefactor("lightning arrow", {
  name: "Lightning Arrow",
  classes: ["ranger"],
  source: [["PHB2024", 292]],
  level: 3,
  school: "Trans",
  time: "1 bns",
  timeFull: "Bonus Action, which you take immediately after hitting or missing a target with a ranged attack using a weapon",
  range: "Self",
  components: "V,S",
  duration: "Instantaneous",
  save: "Dex",
  description: "Hit or Miss crea w/ rngd wea atk 4d8+1d8/SL Lightn. dmg, miss half; 10 ft. all Dex save or 2d8+1d8/SL Lightn. dmg, save half",
  descriptionShorter: "Next atk +4d8+1d8/SL Lightn. dmg, miss h" + (typePF ? "a" : "") + "lf; 10 ft. all 2d8+1d8/SL Lightn. dmg, save half",
  descriptionFull: "The next time you make a ranged weapon attack during the spell's duration, the weapon's ammunition, or the weapon itself if it's a thrown weapon, transforms into a bolt of lightning. Make the attack roll as normal. The target takes 4d8 lightning damage on a hit, or half as much damage on a miss, instead of the weapon's normal damage." + "\n   " + "Whether you hit or miss, each creature within 10 feet of the target must make a Dexterity saving throw. Each of these creatures takes 2d8 lightning damage on a failed save, or half as much damage on a successful one." + "\n   " + "The piece of ammunition or weapon then returns to its normal form." + AtHigherLevels + "When you cast this spell using a spell slot of 4th level or higher, the damage for both effects of the spell increases by 1d8 for each slot level above 3rd.",
  dynamicDamageBonus: {
    multipleDmgMoments: false,
    skipDmgGroupIfNotMultiple: /(atk .*?lightn\. dmg.*?)/i
  }
});
legacySpellRefactor("lightning bolt", {
  name: "Lightning Bolt",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 292]],
  level: 3,
  school: "Evoc",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "A bit of fur and a crystal rod",
  duration: "Instantaneous",
  save: "Dex",
  description: "100-ft. long 5-ft. wide all 8d6+1d6/SL Lightn. dmg; save halves; unattended flammable obj ignite",
  descriptionFull: "A stroke of lightning forming a line of 100 feet long and 5 feet wide blasts out from you in a direction you choose. Each creature in the line must make a Dexterity saving throw. A creature takes 8d6 lightning damage on a failed save, or half as much damage on a successful one." + "\n   " + "The lightning ignites flammable objects in the area that aren't being worn or carried." + AtHigherLevels + "When you cast this spell using a spell slot of 4th level or higher, the damage increases by 1d6 for each slot above 3rd."
});
legacySpellRefactor("locate animals or plants", {
  name: "Locate Animals or Plants",
  nameShort: "Locate Animal/Plants",
  classes: ["bard", "druid", "ranger"],
  source: [["PHB2024", 292]],
  ritual: true,
  level: 2,
  school: "Div",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "Fur from a bloodhound",
  duration: "Instantaneous",
  description: "Learn direction and distance to closest named or described kind of beast or plant within 5 miles",
  descriptionFull: "Describe or name a specific kind of beast or plant. Concentrating on the voice of nature in your surroundings, you learn the direction and distance to the closest creature or plant of that kind within 5 miles, if any are present."
});
legacySpellRefactor("locate creature", {
  name: "Locate Creature",
  classes: ["bard", "cleric", "druid", "paladin", "ranger", "wizard"],
  source: [["PHB2024", 292]],
  level: 4,
  school: "Div",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "Fur from a bloodhound",
  duration: "Conc, 1 h",
  description: "Learn direction to closest named or described kind or specific creature within 1000 ft.; see book",
  descriptionFull: "Describe or name a creature that is familiar to you. You sense the direction to the creature's location, as long as that creature is within 1,000 feet of you. If the creature is moving, you know the direction of its movement." + "\n   " + "The spell can locate a specific creature known to you, or the nearest creature of a specific kind (such as a human or a unicorn), so long as you have seen such a creature up close - within 30 feet - at least once. If the creature you described or named is in a different form, such as being under the effects of a polymorph spell, this spell doesn't locate the creature." + "\n   " + "This spell can't locate a creature if running water at least 10 feet wide blocks a direct path between you and the creature."
});
legacySpellRefactor("locate object", {
  name: "Locate Object",
  classes: ["bard", "cleric", "druid", "paladin", "ranger", "wizard"],
  source: [["PHB2024", 293]],
  level: 2,
  school: "Div",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "A forked twig",
  duration: "Conc, 10 min",
  description: "Learn direction to closest named or described kind or specific object within 1000 ft.; see book",
  descriptionFull: "Describe or name an object that is familiar to you. You sense the direction to the object's location, as long as that object is within 1,000 feet of you. If the object is in motion, you know the direction of its movement." + "\n   " + "The spell can locate a specific object known to you, as long as you have seen it up close - within 30 feet - at least once. Alternatively, the spell can locate the nearest object of a particular kind, such as a certain kind of apparel, jewelry, furniture, tool, or weapon." + "\n   " + "This spell can't locate an object if any thickness of lead, even a thin sheet, blocks a direct path between you and the object."
});
legacySpellRefactor("longstrider", {
  name: "Longstrider",
  classes: ["bard", "druid", "ranger", "wizard"],
  source: [["PHB2024", 293]],
  level: 1,
  school: "Trans",
  time: "1 a",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "A pinch of dirt",
  duration: "1 h",
  description: "1+1/SL creature's speed increases by 10 ft. for the duration",
  descriptionFull: "You touch a creature. The target's speed increases by 10 feet until the spell ends." + AtHigherLevels + "When you cast this spell using a spell slot of 2nd level or higher, you can target one additional creature for each slot level above 1st."
});
legacySpellRefactor("mage armor", {
  name: "Mage Armor",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 293]],
  level: 1,
  school: "Abjur",
  time: "1 a",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "A piece of cured leather",
  duration: "8 h",
  description: "1 crea that isn't wearing armor has AC 13 + Dex modifier for the duration; spell ends if it dons armor",
  descriptionFull: "You touch a willing creature who isn't wearing armor, and a protective magical force surrounds it until the spell ends. The target's base AC becomes 13 + its Dexterity modifier. The spell ends it if the target dons armor or if you dismiss the spell as an action."
});
legacySpellRefactor("mage hand", {
  name: "Mage Hand",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 293]],
  level: 0,
  school: "Conj",
  time: "1 a",
  range: "30 ft.",
  components: "V,S",
  duration: "1 min",
  description: "Create spectral hand for simple tasks or carry up to 10 lb; 1 a to control; can't have multiple instances",
  descriptionFull: "A spectral, floating hand appears at a point you choose within range. The hand lasts for the duration or until you dismiss it as an action. The hand vanishes if it is ever more than 30 feet away from you or if you cast this spell again." + "\n   " + "You can use your action to control the hand. You can use the hand to manipulate an object, open an unlocked door or container, stow or retrieve an item from an open container, or pour the contents out of a vial. You can move the hand up to 30 feet each time you use it." + "\n   " + "The hand can't attack, activate magical items, or carry more than 10 pounds."
});
legacySpellRefactor("magic circle", {
  name: "Magic Circle",
  classes: ["cleric", "paladin", "warlock", "wizard"],
  source: [["PHB2024", 293]],
  level: 3,
  school: "Abjur",
  time: "1 min",
  range: "10 ft.",
  components: "V,S,M\u2020",
  compMaterial: "Salt and powdered silver worth 100+ gp, which the spell consumes",
  duration: "1 h",
  description: "Celes., elem., fey, fiends, or undead can't enter/leave; dis. on atk; +1h/SL dura.; see B (100gp cons.)",
  descriptionFull: "You create a 10-foot-radius, 20-foot-tall cylinder of magical energy centered on a point on the ground that you can see within range. Glowing runes appear wherever the cylinder intersects with the floor or other surface." + "\n   " + "Choose one or more of the following types of creatures - celestials, elementals, fey, fiends, or undead. The circle affects a creature of the chosen type in the following ways." + "\n " + "\u2022 The creature can't willingly enter the cylinder by nonmagical means. If the creature tries to use teleportation or interplanar travel to do so, it must first succeed on a Charisma saving throw." + "\n " + "\u2022 The creature has disadvantage on attack rolls against targets within the cylinder." + "\n " + "\u2022 Targets within the cylinder can't be charmed, frightened, or possessed by the creature." + "\n\n" + "When you cast this spell, you can elect to cause its magic to operate in the reverse direction, preventing a creature of the specified type from leaving the cylinder and protecting targets outside it." + AtHigherLevels + "When you cast this spell using a spell slot of 4th level or higher, the duration increases by 1 hour for each slot level above 3rd."
});
legacySpellRefactor("magic jar", {
  name: "Magic Jar",
  classes: ["wizard"],
  source: [["PHB2024", 294]],
  level: 6,
  school: "Necro",
  time: "1 min",
  range: "Self",
  components: "V,S,M\u0192",
  compMaterial: "A gem, crystal, reliquary worth 500+ gp",
  duration: "Until dispelled",
  description: "Transport my soul into container from which I can attempt to possess humanoids; see B (500gp)",
  descriptionFull: "Your body falls into a catatonic state as your soul leaves it and enters the container you used for the spell's material component. While your soul inhabits the container, you are aware of your surroundings as if you were in the container's space. You can't move or use reactions. The only action you can take is to project your soul up to 100 feet out of the container, either returning to your living body (and ending the spell) or attempting to possess a humanoids body." + "\n   " + "You can attempt to possess any humanoid within 100 feet of you that you can see (creatures warded by a protection from evil and good or magic circle spells can't be possessed). The target must make a Charisma saving throw. On a failure, your soul moves into the target's body, and the target's soul becomes trapped in the container. On a success, the target resists your efforts to possess it, and you can't attempt to possess it again for 24 hours." + "\n   " + "Once you possess a creature's body, you control it. Your game statistics are replaced by the statistics of the creature though you retain your alignment and your Intelligence, Wisdom, and Charisma scores. You retain the benefit of your own class feature. If the target has any class levels, you can't use any of its class features." + "\n   " + "Meanwhile, the possessed creature's soul can perceive from the container using its own senses, but it can't move or take actions at all." + "\n   " + "While possessing a body, you can use your action to return from the host body to the container if it is within 100 feet of you, returning the host creature's soul to its body. If the host body dies while you're in it, the creature dies, and you must make a Charisma saving throw against your own spellcasting DC. On a success, you return to the container if it is within 100 feet of you. Otherwise, you die." + "\n   " + "If the container is destroyed or the spell ends, your soul immediately returns to your body. If your body is more than 100 feet away from you, or if your body is dead when you attempt to return to it, you die. If another creature's soul is in the container when it is destroyed, the creature's soul returns to its body if the body is alive and within 100 feet. Otherwise, that creature dies." + "\n   " + "When the spell ends, the container is destroyed."
});
legacySpellRefactor("magic missile", {
  name: "Magic Missile",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 295]],
  level: 1,
  school: "Evoc",
  time: "1 a",
  range: "120 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "3+1/SL darts hit creature(s) I can see for 1d4+1 Force dmg per dart",
  descriptionFull: "You create three glowing darts of magical force. Each dart hits a creature of your choice that you can see within range. A dart deals 1d4+1 force damage to its target. The darts all strike simultaneously and you can direct them to hit one creature or several." + AtHigherLevels + "When you cast this spell using a spell slot of 2nd level or higher, the spell creates one more dart for each slot above 1st.",
  dynamicDamageBonus: {multipleDmgMoments: true}
});
legacySpellRefactor("magic mouth", {
  name: "Magic Mouth",
  classes: ["bard", "wizard"],
  source: [["PHB2024", 295]],
  ritual: true,
  level: 2,
  school: "Illus",
  time: "1 min",
  range: "30 ft.",
  components: "V,S,M\u2020",
  compMaterial: "Jade dust worth 10+ gp, which the spell consumes",
  duration: "Until dispelled",
  description: "Implant a 25 word message in an object that is uttered on chosen trigger condition (10gp cons.)",
  descriptionFull: "You implant a message within an object in range, a message that is uttered when a trigger condition is met. Choose an object that you can see and that isn't being worn or carried by another creature. Then speak the message, which must be 25 words or less, though it can be delivered over as long as 10 minutes. Finally, determine the circumstance that will trigger the spell to deliver your message." + "\n   " + "When that circumstance occurs, a magical mouth appears on the object and recites the message in your voice and at the same volume you spoke. If the object you chose has a mouth or something that looks like a mouth (for example, the mouth of a statue), the magical mouth appears there so that words appear to come from the object's mouth. When you cast this spell, you can have the spell end after it delivers its message, or it can remain and repeats its message whenever the trigger occurs." + "\n   " + "The triggering circumstance can be as general or as detailed as you like, though it must be based on visual or audible conditions that occur within 30 feet of the object. For example, you could instruct the mouth to speak when any creature moves within 30 feet of the object or when a silver bell rings within 30 feet of it."
});
legacySpellRefactor("magic weapon", {
  name: "Magic Weapon",
  classes: ["paladin", "ranger", "sorcerer", "wizard"],
  source: [["PHB2024", 295]],
  level: 2,
  school: "Trans",
  time: "1 bns",
  range: "Touch",
  components: "V,S",
  duration: "1 h",
  description: "1 nonmagical weapon becomes magical with +1 bonus to attack and damage; SL4: +2, SL6: +3",
  descriptionFull: "You touch a nonmagical weapon. Until the spell ends, that weapon becomes a magic weapon with a +1 bonus to attack rolls and damage rolls." + AtHigherLevels + "When you cast this spell using a spell slot of 4th level or higher, the bonus increases to +2. When you use a spell slot of 6th level or higher, the bonus increases to +3."
});
legacySpellRefactor("major image", {
  name: "Major Image",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 295]],
  level: 3,
  school: "Illus",
  time: "1 a",
  range: "120 ft.",
  components: "V,S,M",
  compMaterial: "A bit of fleece",
  duration: "Conc, 10 min",
  description: "20-ft. cube illusion includes visible, audible, olfactory, temperature; 1 a move it; SL6: no conc.; see B",
  descriptionFull: "You create the image of an object, a creature, or some other visible phenomenon that is no larger than a 20-foot cube. The image appears at a spot that you can see within range and lasts for the duration. It seems completely real, including sounds, smells, and temperature appropriate to the thing depicted. You can't create sufficient heat or cold to cause damage, a sound loud enough to deal thunder damage or deafen a creature, or a smell that might sicken a creature (like a troglodyte's stench)." + "\n   " + "As long as you are within range of the illusion, you can use your action to cause the image to move to any other spot within range. As the image changes location, you can alter its appearance so that its movements appear natural for the image. For example, if you create an image of a creature and move it, you can alter the image so that it appears to be walking. Similarly, you can cause the illusion to make different sounds at different times, even making it carry on a conversation, for example." + "\n   " + "Physical interaction with the image reveals it to be an illusion, because things can pass through it. A creature that uses its action to examine the image can determine that it is an illusion with a successful Intelligence (Investigation) check against your spell save DC. If a creature discerns the illusion for what it is, the creature can see through the image, and its other sensory qualities become faint to the creature." + AtHigherLevels + "When you cast this spell using a spell slot of 6th level or higher, the spell lasts until dispelled, without requiring your concentration."
});
legacySpellRefactor("mass cure wounds", {
  name: "Mass Cure Wounds",
  classes: ["bard", "cleric", "druid"],
  source: [["PHB2024", 296]],
  level: 5,
  school: "Abjur",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "6 living creatures within 30-ft. rad heal 5d8+1d8/SL+spellcasting ability modifier HP",
  descriptionFull: "A wave of healing energy washes out from a point of your choice within range. Choose up to six creatures in a 30-foot-radius sphere centered on that point. Each target regains hit points equal to 5d8 + your spellcasting ability modifier. This spell has no effect on undead or constructs." + AtHigherLevels + "When you cast this spell using a spell slot of 6th level or higher, the healing increases by 1d8 for each slot level above 5th."
});
legacySpellRefactor("mass heal", {
  name: "Mass Heal",
  classes: ["cleric"],
  source: [["PHB2024", 296]],
  level: 9,
  school: "Abjur",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "Heal 700 HP split over any crea in range; each healed is cured of blindness, deafness, and all diseases",
  descriptionShorter: "Heal 700 HP split over any crea in range; each healed cured of blindness, deafness, diseases",
  descriptionFull: "A flood of healing energy flows from you into injured creatures around you. You restore up to 700 hit points, divided as you choose among any number of creatures that you can see within range. Creatures healed by this spell are also cured of all diseases and any effect making them blinded or deafened. This spell has no effect on undead or constructs."
});
legacySpellRefactor("mass healing word", {
  name: "Mass Healing Word",
  classes: ["bard", "cleric"],
  source: [["PHB2024", 296]],
  level: 3,
  school: "Abjur",
  time: "1 bns",
  range: "60 ft.",
  components: "V",
  duration: "Instantaneous",
  description: "6 living creatures heal 2d4+1d4/SL+spellcasting ability modifier HP",
  descriptionFull: "As you call out words of restoration, up to six creatures of your choice that you can see within range regain hit points equal to 2d4 + your spellcasting ability modifier. This spell has no effect on undead or constructs." + AtHigherLevels + "When you cast this spell using a spell slot of 4th level or higher, the healing increases by 1d4 for each slot level above 3rd."
});
legacySpellRefactor("mass suggestion", {
  name: "Mass Suggestion",
  classes: ["bard", "sorcerer", "wizard"],
  source: [["PHB2024", 296]],
  level: 6,
  school: "Ench",
  time: "1 a",
  range: "60 ft.",
  components: "V,M",
  compMaterial: "A snake's tongue",
  duration: "24 h",
  save: "Wis",
  description: "12 crea save or follow stated course of action; SL7: 10 day; SL8: 30 days; SL9: 366 days; see book",
  descriptionFull: "You suggest a course of activity (limited to a sentence or two) and magically influence up to twelve creatures of your choice that you can see within range and that can hear and understand you. Creatures that can't be charmed are immune to this effect. The suggestion must be worded in such a manner as to make the course of action sound reasonable. Asking the creature to stab itself, throw itself onto a spear, immolate itself, or do some other obviously harmful act automatically negates the effect of the spell." + "\n   " + "Each target must make a Wisdom saving throw. On a failed save, it pursues the course of action you described to the best of its ability. The suggested course of action can continue for the entire duration. If the suggested activity can be completed in a shorter time, the spell ends when the subject finishes what it was asked to do." + "\n   " + "You can also specify conditions that will trigger a special activity during the duration. For example, you might suggest that a group of soldiers give all their money to the first beggar they meet. If the condition isn't met before the spell ends, the activity isn't performed." + "\n   " + "If you or any of your companions damage a creature affected by this spell, the spell ends for that creature." + AtHigherLevels + "When you cast this spell using a 7th-level spell slot, the duration is 10 days. When you use an 8th-level spell slot, the duration is 30 days. When you use a 9th-level spell slot, the duration is a year and a day."
});
legacySpellRefactor("maze", {
  name: "Maze",
  classes: ["wizard"],
  source: [["PHB2024", 296]],
  level: 8,
  school: "Conj",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "Conc, 10 min",
  description: "1 crea banished to labyrinthine demiplane; DC 20 Int check each rnd to escape; appears in same spot",
  descriptionFull: "You banish a creature that you can see within range into a labyrinthine demiplane. The target remains there for the duration or until it escapes the maze." + "\n   " + "The target can use its action to attempt to escape. When it does so, it makes a DC 20 Intelligence check. If it succeeds, it escapes, and the spell ends (a minotaur or goristro demon automatically succeeds)." + "\n   " + "When the spell ends, the target reappears in the space it left or, if that space is occupied, in the nearest unoccupied space."
});
legacySpellRefactor("meld into stone", {
  name: "Meld into Stone",
  classes: ["cleric", "druid", "ranger"],
  source: [["PHB2024", 296]],
  ritual: true,
  level: 3,
  school: "Trans",
  time: "1 a",
  range: "Touch",
  components: "V,S",
  duration: "8 h",
  description: "I merge into a stone object large enough to contain me; can't see through the stone; see book",
  descriptionFull: "You step into a stone object or surface large enough to fully contain your body, melding yourself and all the equipment you carry with the stone for the duration. Using your movement, you step into the stone at a point you can touch. Nothing of your presence remains visible or otherwise detectable by nonmagical senses." + "\n   " + "While merged with the stone, you can't see what occurs outside it, and any Wisdom (Perception) checks you make to hear sounds outside it are made with disadvantage. You remain aware of the passage of time and can cast spells on yourself while merged in the stone. You can use your movement to leave the stone where you entered it, which ends the spell. You otherwise can't move." + "\n   " + "Minor physical damage to the stone doesn't harm you, but its partial destruction or a change in its shape (to the extent that you no longer fit within it) expels you and deals 6d6 bludgeoning damage to you. The stone's complete destruction (or transmutation into a different substance) expels you and deals 50 bludgeoning damage to you. If expelled, you fall prone in an unoccupied space closest to where you first entered."
});
legacySpellRefactor("melf's acid arrow", {
  name: "Melf's Acid Arrow",
  nameAlt: "Acid Arrow",
  classes: ["wizard"],
  source: [["PHB2024", 297]],
  level: 2,
  school: "Evoc",
  time: "1 a",
  range: "90 ft.",
  components: "V,S,M",
  compMaterial: "Powdered rhubarb leaf",
  duration: "Instantaneous",
  description: "Spell attack for 4d4+1d4/SL Acid dmg and 2d4+1d4/SL next turn; on miss half dmg, no next turn",
  descriptionShorter: "Spell atk for 4d4+1d4/SL Acid dmg \u0026 2d4+1d4/SL next turn; miss: half dmg, no next turn",
  descriptionFull: "A shimmering green arrow streaks toward a target within range and bursts in a spray of acid. Make a ranged spell attack against the target. On a hit, the target takes 4d4 acid damage immediately and 2d4 acid damage at the end of its next turn. On a miss, the arrow splashes the target with acid for half as much of the initial damage and no damage at the end of its next turn." + AtHigherLevels + "When you cast this spell using a spell slot of 3rd level or higher, the damage (both initial and later) increases by 1d4 for each slot level above 2nd.",
  dynamicDamageBonus: {
    extraDmgGroupsSameType: /(and |\u0026 )((?:\+?\d+d?\d*)+)(\+1d4\/SL)/i
  }
});
legacySpellRefactor("mending", {
  name: "Mending",
  classes: ["bard", "cleric", "druid", "sorcerer", "wizard"],
  source: [["PHB2024", 297]],
  level: 0,
  school: "Trans",
  time: "1 min",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "Two lodestones",
  duration: "Instantaneous",
  description: "Repair a single broken object no larger than 1 cu ft.; can't restore magic to broken magic item",
  descriptionFull: "This spell repairs a single break or tear in an object you touch, such as broken chain link, two halves of a broken key, a torn cloak, or a leaking wineskin. As long as the break or tear is no larger than 1 foot in any dimension, you mend it, leaving no trace of the former damage." + "\n   " + "This spell can physically repair a magic item or construct, but the spell can't restore magic to such an object."
});
legacySpellRefactor("message", {
  name: "Message",
  classes: ["bard", "druid", "sorcerer", "wizard"],
  source: [["PHB2024", 298]],
  level: 0,
  school: "Trans",
  time: "1 a",
  range: "120 ft.",
  components: "S,M",
  compMaterial: "A copper wire",
  duration: "1 rnd",
  description: "1 crea I point to hears whispered message and can reply with a whisper; nobody can overhear",
  descriptionFull: "You point your finger toward a creature within range and whisper a message. The target (and only the target) hears the message and can reply in a whisper that only you can hear." + "\n   " + "You can cast this spell through solid objects if you are familiar with the target and know it is beyond the barrier. Magical silence, 1 foot of stone, 1 inch of common metal, a thin sheet of lead, or 3 feet of wood blocks the spell. The spell doesn't have to follow a straight line and can travel freely around corners or through openings."
});
legacySpellRefactor("meteor swarm", {
  name: "Meteor Swarm",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 298]],
  level: 9,
  school: "Evoc",
  time: "1 a",
  range: "1 mile",
  components: "V,S",
  duration: "Instantaneous",
  save: "Dex",
  description: "4\xD7 40-ft. rad all 20d6 Bludgeoning dmg and 20d6 Fire dmg; save halves; areas do not stack",
  descriptionFull: "Blazing orbs of fire plummet to the ground at four different points you can see within range. Each creature in a 40-foot-radius sphere centered on each point you choose must make a Dexterity saving throw. The sphere spreads around corners. A creature takes 20d6 fire damage and 20d6 bludgeoning damage on a failed save, or half as much damage on a successful one. A creature in the area of more than one fiery burst is affected only once." + "\n   " + "The spell damages objects in the area and ignites flammable objects that aren't being worn or carried."
});
legacySpellRefactor("mind blank", {
  name: "Mind Blank",
  classes: ["bard", "wizard"],
  source: [["PHB2024", 298]],
  level: 8,
  school: "Abjur",
  time: "1 a",
  range: "Touch",
  components: "V,S",
  duration: "24 h",
  description: "1 crea immune to charms, psychic damage, divination, mind reading, and any mind altering effects",
  descriptionFull: "Until the spell ends, one willing creature you touch is immune to psychic damage, any effect that would sense its emotions or read its thoughts, divination spells, and the charmed condition. The spell even foils wish spells and spells or effects of similar power used to affect the target's mind or to gain information about the target."
});
legacySpellRefactor("mind sliver", {
  name: "Mind Sliver",
  classes: ["sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 298]],
  level: 0,
  school: "Ench",
  time: "1 a",
  range: "60 ft.",
  components: "V",
  duration: "1 rnd",
  save: "Int",
  description: "1 crea save or 1d6 Psychic dmg, -1d4 on first save before my next turn ends; +1d6 at CL 5, 11, and 17",
  descriptionShort: "1 crea save or 1d6 Psychic dmg, -1d4 on 1st save before my next turn end; +1d6 at CL 5/11/17",
  descriptionCantripDie: "1 crea save or `CD`d6 Psychic dmg and subtract 1d4 from first saving throw before my next turn ends",
  descriptionFull: "You drive a disorienting spike of psychic energy into the mind of one creature you can see within range. The target must succeed on an Intelligence saving throw or take 1d6 psychic damage and subtract 1d4 from the next saving throw it makes before the end of your next turn." +
    "\n This spell's damage increases by 1d6 when you reach certain levels: 5th level (2d6), 11th level (3d6), and 17th level (4d6)."
});
legacySpellRefactor("mind spike", {
  name: "Mind Spike",
  classes: ["sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 298]],
  level: 2,
  school: "Div",
  time: "1 a",
  range: "120 ft.",
  components: "S",
  duration: "Conc, 1 h",
  save: "Wis",
  description: "1 crea 3d8+1d8/SL Psychic dmg, know its location, can't be invis for me; save half, no other benefits",
  descriptionShorter: "1 crea 3d8+1d8/SL Psychic dmg, know its location, can't be invis for me; save half, not rest",
  descriptionFull: "You reach into the mind of one creature you can see within range. The target must make a Wisdom saving throw, taking 3d8 psychic damage on a failed save, or half as much damage on a successful one. On a failed save, you also always know the target's location until the spell ends, but only while the two of you are on the same plane of existence. While you have this knowledge, the target can't become hidden from you, and if it's invisible, it gains no benefit from that condition against you." + AtHigherLevels + "When you cast this spell using a spell slot of 3rd level or higher, the damage increases by 1d8 for each slot level above 2nd.",
  dynamicDamageBonus: {multipleDmgMoments: false}
});
legacySpellRefactor("minor illusion", {
  name: "Minor Illusion",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 298]],
  level: 0,
  school: "Illus",
  time: "1 a",
  range: "30 ft.",
  components: "S,M",
  compMaterial: "A bit of fleece",
  duration: "1 min",
  description: "5-ft. cube illusion includes visible or audible; Int(Investigation) check vs. Spell DC; see book",
  descriptionFull: "You create a sound or an image of an object within range that lasts for the duration. The illusion also ends if you dismiss it as an action or cast this spell again." + "\n   " + "If you create a sound, its volume can range from a whisper to a scream. It can be your voice, someone else's voice, a lion's roar, a beating of drums, or any other sound you choose. The sound continues unabated throughout the duration, or you can make discrete sounds at different times before the spell ends." + "\n   " + "If you create an image of an object - such as a chair, muddy footprints, or a small chest - it must be no larger than a 5-foot cube. The image can't create sound, light, smell, or any other sensory effect. Physical interaction with the image reveals it to be an illusion, because things can pass through it." + "\n   " + "If a creature uses its action to examine the sound or image, the creature can determine that it is an illusion with a successful Intelligence (Investigation) check against your spell save DC. If a creature discerns the illusion for what it is, the illusion becomes faint to the creature."
});
legacySpellRefactor("mirage arcane", {
  name: "Mirage Arcane",
  classes: ["bard", "druid", "wizard"],
  source: [["PHB2024", 299]],
  level: 7,
  school: "Illus",
  time: "10 min",
  range: "Sight",
  components: "V,S",
  duration: "10 days",
  description: "1 sq mile alter terrain illusion includes visible, audible, olfactory, tactile; can make difficult ter.; see B",
  descriptionMetric: "260 ha alter terrain illusion includes visible, audible, olfactory, tactile; can make difficult ter.; see B",
  descriptionFull: "You make terrain in an area up to 1 mile square look, sound, smell, and even feel like some other sort of terrain. The terrain's general shape remains the same, however. Open fields or a road could be made to resemble a swamp, hill, crevasse, or some other difficult or impassable terrain. A pond can be made to seem like a grassy meadow, a precipice like a gentle slope, or a rock-strewn gully like a wide and smooth road." + "\n   " + "Similarly, you can alter the appearance of structures, or add them where none are present. The spell doesn't disguise, conceal, or add creatures." + "\n   " + "The illusion includes audible, visual, tactile, and olfactory elements, so it can turn clear ground into difficult terrain (or vice versa) or otherwise impede movement through the area. Any piece of the illusory terrain (such as a rock or stick) that is removed from the spell's area disappears immediately." + "\n   " + "Creatures with truesight can see through the illusion to the terrain's true form, however, all other elements of the illusion remain, so while the creature is aware of the illusion's presence, the creature can still physically interact with the illusion."
});
legacySpellRefactor("mirror image", {
  name: "Mirror Image",
  classes: ["sorcerer", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 299]],
  level: 2,
  school: "Illus",
  time: "1 a",
  range: "Self",
  components: "V,S",
  duration: "1 min",
  description: "Create three illusory duplicates of me; destroyed if hit; randomize attacks; AC 10 + my Dex mod",
  descriptionFull: "Three illusory duplicates of yourself appear in your space. Until the spell ends, the duplicates move with you and mimic your actions, shifting position so it's impossible to track which image is real. You can use your action to dismiss the illusory duplicates." + "\n   " + "Each time a creature targets you with an attack during the spell's duration, roll a d20 to determine whether the attack instead targets one of your duplicates." + "\n   " + "If you have three duplicates, you must roll a 6 or higher to change the attack's target to a duplicate. With two duplicates, you must roll an 8 or higher. With one duplicate, you must roll an 11 or higher." + "\n   " + "A duplicate's AC equals 10 + your Dexterity modifier. If an attack hits a duplicate, the duplicate is destroyed. A duplicate can be destroyed only by an attack that hits it. It ignores all other damage and effects. The spell ends when all three duplicates are destroyed." + "\n   " + "A creature is unaffected by this spell if it can't see, if it relies on senses other than sight, such as blindsight, or if it can perceive illusions as false, as with truesight."
});
legacySpellRefactor("mislead", {
  name: "Mislead",
  classes: ["bard", "warlock", "wizard"],
  source: [["PHB2024", 299]],
  level: 5,
  school: "Illus",
  time: "1 a",
  range: "Self",
  components: "S",
  duration: "Conc, 1 h",
  description: "I go invisible; create illusory duplicate of me, 1 a move it, bns a switch between its senses and mine",
  descriptionFull: "You become invisible at the same time that an illusory double of you appears where you are standing. The double lasts for the duration, but the invisibility ends if you attack or cast a spell." + "\n   " + "You can use your action to move your illusory double up to twice your speed and make it gesture, speak, and behave in whatever way you choose. You can see through its eyes and hear through its ears as if you were located where it is. On each of your turns as a bonus action, you can switch from using its senses to using your own, or back again. While you are using its senses, you are blinded and deafened in regard to your own surroundings."
});
legacySpellRefactor("misty step", {
  name: "Misty Step",
  classes: ["sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 299]],
  level: 2,
  school: "Conj",
  time: "1 bns",
  range: "Self",
  components: "V",
  duration: "Instantaneous",
  description: "I teleport 30 feet to an unoccupied space I can see",
  descriptionFull: "Briefly surrounded by silvery mist, you teleport up to 30 feet to an unoccupied space that you can see."
});
legacySpellRefactor("modify memory", {
  name: "Modify Memory",
  classes: ["bard", "wizard"],
  source: [["PHB2024", 299 - 300]],
  level: 5,
  school: "Ench",
  time: "1 a",
  range: "30 ft.",
  components: "V,S",
  duration: "Conc, 1 min",
  save: "Wis",
  description: "1 crea save or charmed, alter 1 memory of last (SL6: 7, SL7: 30, SL8: 365) day; SL:9 any memory",
  descriptionFull: "You attempt to reshape another creature's memories. One creature that you can see must make a Wisdom saving throw. If you are fighting the creature, it has advantage on the saving throw. On a failed save, the target becomes charmed by you for the duration. The charmed target is incapacitated and unaware of its surroundings, though it can still hear you. If it takes any damage or is targeted by another spell, this spell ends, and none of the target's memories are modified." + "\n   " + "While this charm lasts, you can affect the target's memory of an event that it experienced within the last 24 hours and that lasted no more than 10 minutes. You can permanently eliminate all memory of the event, allow the target to recall the event with perfect clarity and exacting detail, change its memory of the details of the event, or create a memory of some other event." + "\n   " + "You must speak to the target to describe how its memories are affected, and it must be able to understand your language for the modified memories to take root. Its mind fills in any gaps in the details of your description. If the spell ends before you have finished describing the modified memories, the creature's memory isn't altered. Otherwise, the modified memories take hold when the spell ends." + "\n   " + "A modified memory doesn't necessarily affect how a creature behaves, particularly if the memory contradicts the creature's natural inclinations, alignment, or beliefs. An illogical modified memory, such as implanting a memory of how much the creature enjoyed dousing itself in acid, is dismissed, perhaps as a bad dream. The DM might deem a modified memory too nonsensical to affect a creature in a significant manner." + "\n   " + "A remove curse or greater restoration spell cast on the target restores the creature's true memory." + AtHigherLevels + "If you cast this spell using a spell slot of 6th level or higher, you can alter the target's memories of an event that took place up to 7 days ago (6th level), 30 days ago (7th level), 1 year ago (8th level), or any time in the creature's past (9th level)."
});
legacySpellRefactor("moonbeam", {
  name: "Moonbeam",
  classes: ["druid"],
  source: [["PHB2024", 300]],
  level: 2,
  school: "Evoc",
  time: "1 a",
  range: "120 ft.",
  components: "V,S,M",
  compMaterial: "A moonseed leaf",
  duration: "Conc, 1 min",
  save: "Con",
  description: "5-ft. rad 40-ft. high all enter/start turn 2d10+1d10/SL Radiant dmg; save half; 1 a move it 60 ft.; see B",
  descriptionShorter: "5-ft. rad 40-ft. high all enter/start 2d10+1d10/SL Radiant dmg; save half; 1 a move 60 ft.",
  descriptionFull: "A silvery beam of pale light shines down in a 5-foot radius, 40-foot-high cylinder centered on a point within range. Until the spell ends, dim light fills the cylinder." + "\n   " + "When a creature enters the spell's area for the first time on a turn or starts its turn there, it is engulfed in ghostly flames that cause searing pain, and it must make a Constitution saving throw. It takes 2d10 radiant damage on a failed save, or half as much damage on a successful one." + "\n   " + "A shapechanger makes its saving throw with disadvantage. If it fails, it also instantly reverts to its original form and can't assume a different form until it leaves the spell's light." + "\n   " + "On each of your turns after you cast this spell, you can use an action to move the beam up to 60 feet in any direction." + AtHigherLevels + "When you cast this spell using a spell slot of 3rd level or higher, the damage increases by 1d10 for each slot level above 2nd."
});
legacySpellRefactor("mordenkainen's faithful hound", {
  name: "Mordenkainen's Faithful Hound",
  nameShort: "Mor. Faithful Hound",
  nameAlt: "Faithful Hound",
  classes: ["wizard"],
  source: [["PHB2024", 300]],
  level: 4,
  school: "Conj",
  time: "1 a",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A silver whistle",
  duration: "8 h",
  description: "Invisible, immobile dog does melee spell atk for 4d8 Piercing dmg; sees invisible/ethereal; see book",
  descriptionShorter: "Invisible, immobile dog do melee spell atk 4d8 Piercing dmg; sees invisible/ethereal; see B",
  descriptionFull: "You conjure a phantom watchdog in an unoccupied space that you can see within range, where it remains for the duration, until you dismiss it as an action, or until you move more than 300 feet away from it." + "\n   " + "The hound is invisible to all creatures except you and can't be harmed. When a Small or larger creature comes within 30 feet of it without first speaking the password that you specify when you cast this spell, the hound starts barking loudly. The hound sees invisible creatures and can see into the Ethereal Plane. It ignores illusions." + "\n   " + "At the start of each of your turns, the hound attempts to bite one creature within 5 feet of it that is hostile to you. The hound's attack bonus is equal to your spellcasting ability modifier + your proficiency bonus. On a hit, it deals 4d8 piercing damage."
});
legacySpellRefactor("mordenkainen's magnificent mansion", {
  name: "Mordenkainen's Magnificent Mansion",
  nameShort: "Mor. Magni. Mansion",
  nameAlt: "Magnificent Mansion",
  classes: ["bard", "wizard"],
  source: [["PHB2024", 300]],
  level: 7,
  school: "Conj",
  time: "1 min",
  range: "300 ft.",
  components: "V,S,M\u0192",
  compMaterial: "A miniature door worth 15+ gp",
  duration: "24 h",
  description: "Create extradimensional mansion with rooms, food and servants to serve 100 people; see book (15gp)",
  descriptionFull: "You conjure an extradimensional dwelling in range that lasts for the duration. You choose where its one entrance is located. The entrance shimmers faintly and is 5 feet wide and 10 feet tall. You and any creature you designate when you cast the spell can enter the extradimensional dwelling as long as the portal remains open. You can open or close the portal if you are within 30 feet of it. While closed, the portal is invisible." + "\n   " + "Beyond the portal is a magnificent foyer with numerous chambers beyond. The atmosphere is clean, fresh, and warm." + "\n   " + "You can create any floor plan you like, but the space can't exceed 50 cubes, each cube being 10 feet on each side. The place is furnished and decorated as you choose. It contains sufficient food to serve a nine course banquet for up to 100 people. A staff of 100 near-transparent servants attends all who enter. You decide the visual appearance of these servants and their attire. They are completely obedient to your orders. Each servant can perform any task a normal human servant could perform, but they can't attack or take any action that would directly harm another creature. Thus the servants can fetch things, clean, mend, fold clothes, light fires, serve food, pour wine, and so on. The servants can go anywhere in the mansion but can't leave it. Furnishings and other objects created by this spell dissipate into smoke if removed from the mansion. When the spell ends, any creatures inside the extradimensional space are expelled into the open spaces nearest to the entrance."
});
legacySpellRefactor("mordenkainen's private sanctum", {
  name: "Mordenkainen's Private Sanctum",
  nameShort: "Mor. Private Sanctum",
  nameAlt: "Private Sanctum",
  classes: ["wizard"],
  source: [["PHB2024", 301]],
  level: 4,
  school: "Abjur",
  time: "10 min",
  range: "120 ft.",
  components: "V,S,M",
  compMaterial: "A thin sheet of lead",
  duration: "24 h",
  description: "Up to 100+100/SL ft. cube is magically secured in chosen way; see book",
  descriptionFull: "You make an area within range magically secure. The area is a cube that can be as small as 5 feet to as large as 100 feet on each side. The spell lasts for the duration or until you use an action to dismiss it." + "\n   " + "When you cast the spell, you decide what sort of security the spell provides, choosing any or all of the following properties." + "\n " + "\u2022 Sound can't pass through the barrier at the edge of the warded area." + "\n " + "\u2022 The barrier of the warded area appears dark and foggy, preventing vision (including darkvision) through it." + "\n " + "\u2022 Sensors created by divination spells can't appear inside the protected area or pass through the barrier at its perimeter." + "\n " + "\u2022 Creatures in the area can't be targeted by divination spells." + "\n " + "\u2022 Nothing can teleport into or out of the warded area." + "\n " + "\u2022 Planar travel is blocked within the warded area." + "\n\n" + "Casting this spell on the same spot every day for a year makes this effect permanent." + AtHigherLevels + "When you cast this spell using a spell slot of 5th level or higher, you can increase the size of the cube by 100 feet for each slot level beyond 4th. Thus you could protect a cube that can be up to 200 feet on one side by using a spell slot of 5th level."
});
legacySpellRefactor("mordenkainen's sword", {
  name: "Mordenkainen's Sword",
  nameAlt: "Arcane Sword",
  classes: ["bard", "wizard"],
  source: [["PHB2024", 302]],
  level: 7,
  school: "Evoc",
  time: "1 a",
  range: "90 ft.",
  components: "V,S,M\u0192",
  compMaterial: "A miniature sword worth 250+ gp",
  duration: "Conc, 1 min",
  description: "Hovering sword makes melee spell attacks for 4d12 Force dmg; bns a to move 20 ft. and/or attack",
  descriptionShorter: "Hovering sword makes melee spell atk 4d12 Force dmg; bns a to move 20 ft. and/or attack",
  descriptionFull: "You create a sword-shaped plane of force that hovers within range. It lasts for the duration." + "\n   " + "When the sword appears, you make a melee spell attack against a target of your choice within 5 feet of the sword. On a hit. the target takes 4d12 force damage. Until the spell ends, you can use a bonus action on each of your turns to move the sword up to 20 feet to a spot you can see and repeat this attack against the same target or a different one."
});
legacySpellRefactor("move earth", {
  name: "Move Earth",
  classes: ["druid", "sorcerer", "wizard"],
  source: [["PHB2024", 302]],
  level: 6,
  school: "Trans",
  time: "1 a",
  range: "120 ft.",
  components: "V,S,M",
  compMaterial: "A miniature shovel",
  duration: "Conc, 2 h",
  description: "Every 10 min of concentration, gradually reshape 40 cu ft. of dirt, sand, or clay; see book",
  descriptionFull: "Choose an area of terrain no larger than 40 feet on a side within range. You can reshape dirt, sand, or clay in the area in any manner you choose for the duration. You can raise or lower the area's elevation, create or fill in a trench, erect or flatten a wall, or form a pillar. The extent of any such changes can't exceed half the area's largest dimension. So, if you affect a 40-foot square, you can create a pillar up to 20 feet high, raise or lower the square's elevation by up to 20 feet, dig a trench up to 20 feet deep, and so on. It takes 10 minutes for these changes to complete." + "\n   " + "At the end of every 10 minutes you spend concentrating on the spell, you can choose a new area of terrain to affect." + "\n   " + "Because the terrain's transformation occurs slowly, creatures in the area can't usually be trapped or injured by the ground's movement." + "\n   " + "This spell can't manipulate natural stone or stone construction. Rocks and structures shift to accommodate the new terrain. If the way you shape the terrain would make a structure unstable, it might collapse." + "\n   " + "Similarly, this spell doesn't directly affect plant growth. The moved earth carries any plants along with it."
});
legacySpellRefactor("nondetection", {
  name: "Nondetection",
  classes: ["bard", "ranger", "wizard"],
  source: [["PHB2024", 302]],
  level: 3,
  school: "Abjur",
  time: "1 a",
  range: "Touch",
  components: "V,S,M\u2020",
  compMaterial: "A pinch of diamond dust worth 25+ gp, which the spell consumes",
  duration: "8 h",
  description: "1 crea or object up to 10 cu ft. hidden from all divination magic (25gp cons.)",
  descriptionFull: "For the duration, you hide a target that you touch from divination magic. The target can be a willing creature or a place or an object no larger than 10 feet in any dimension. The target can't be targeted by any divination magic or perceived through magical scrying sensors."
});
legacySpellRefactor("nystul's magic aura", {
  name: "Nystul's Magic Aura",
  nameAlt: "Arcanist's Magic Aura",
  classes: ["wizard"],
  source: [["PHB2024", 302]],
  level: 2,
  school: "Illus",
  time: "1 a",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "A small square of silk",
  duration: "24 h",
  description: "Create a false magic item with chosen properties or shroud a magical item from detection",
  descriptionFull: "You place an illusion on a creature or an object you touch so that divination spells reveal false information about it. The target can be a willing creature or an object that isn't being carried or worn by another creature." + "\n   " + "When you cast the spell, choose one or both of the following effects. The effect lasts for the duration. If you cast this spell on the same creature or object every day for 30 days, placing the same effect on it each time, the illusion lasts until it is dispelled." + "\n   " + toUni("False Aura") + ": You change the way the target appears to spells and magical effects, such as detect magic, that detect magical auras. You can make a nonmagical object appear magical, a magical object appear nonmagical, or change the object's magical aura so that it appears to belong to a specific school of magic that you choose. When you use this effect on an object, you can make the false magic apparent to any creature that handles the item." + "\n   " + toUni("Mask") + ": You change the way the target appears to spells and magical effects that detect creature types, such as a paladin's Divine Sense or the trigger of a symbol spell. You choose a creature type and other spells and magical effects treat the target as if it were a creature of that type or of that alignment."
});
legacySpellRefactor("otiluke's freezing sphere", {
  name: "Otiluke's Freezing Sphere",
  nameAlt: "Freezing Sphere",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 302 - 303]],
  level: 6,
  school: "Evoc",
  time: "1 a",
  range: "300 ft.",
  components: "V,S,M",
  compMaterial: "A miniature crystal sphere",
  duration: "Instantaneous",
  save: "Con",
  description: "60-ft. rad all 10d6+1d6/SL Cold dmg; save halves; freezes water; can save up to 1 min before using",
  descriptionFull: "A frigid globe of cold energy streaks from your fingertips to a point of your choice within range, where it explodes in a 60-foot-radius sphere. Each creature within the area must make a Constitution saving throw. On a failed save, a creature takes 10d6 cold damage. On successful save, it takes half as much damage." + "\n   " + "If the globe strikes a body of water or a liquid that is principally water (not including water-based creatures), it freezes the liquid to a depth of 6 inches over an area 30 feet square. This ice lasts for 1 minute. Creatures that were swimming on the surface of frozen water are trapped in the ice. A trapped creature can use an action to make a Strength check against your spell save DC to break free." + "\n   " + "You can refrain from firing the globe after completing the spell, if you wish. A small globe about the size of a sling stone, cool to the touch, appears in your hand. At any time, you or a creature you give the globe to can throw the globe (to a range of 40 feet) or hurl it with a sling (to the sling's normal range). It shatters on impact, with the same effect as the normal casting of the spell. You can also set the globe down without shattering it. After 1 minute, if the globe hasn't already shattered, it explodes." + AtHigherLevels + "When you cast this spell using a spell slot of 7th level or higher, the damage increases by 1d6 for each slot level above 6th."
});
legacySpellRefactor("otiluke's resilient sphere", {
  name: "Otiluke's Resilient Sphere",
  nameAlt: "Resilient Sphere",
  classes: ["wizard"],
  source: [["PHB2024", 303]],
  level: 4,
  school: "Abjur",
  time: "1 a",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A glass sphere",
  duration: "Conc, 1 min",
  save: "Dex",
  description: "1 crea/obj up to Large save or enclosed in impenetrable sphere; can be moved as hamster ball ",
  descriptionFull: "A sphere of shimmering force encloses a creature or object of Large size or smaller within range. An unwilling creature must make a Dexterity saving throw. On a failed save, the creature is enclosed for the duration." + "\n   " + "Nothing, not physical objects, energy, or other spell effects, can pass through the barrier, in or out, though a creature in the sphere can breathe there. The sphere is immune to all damage, and a creature or object inside can't be damaged by attacks or effects originating from outside, nor can a creature inside the sphere damage anything outside it." + "\n   " + "The sphere is weightless and just large enough to contain the creature or object inside. An enclosed creature can use its action to push against the sphere's walls and thus roll the sphere at up to half the creature's speed. Similarly, the globe can be picked up and moved by other creatures." + "\n   " + "A disintegrate spell targeting the globe destroys it without harming anything inside it."
});
legacySpellRefactor("otto's irresistible dance", {
  name: "Otto's Irresistible Dance",
  nameAlt: "Irresistible Dance",
  classes: ["bard", "wizard"],
  source: [["PHB2024", 303]],
  level: 6,
  school: "Ench",
  time: "1 a",
  range: "30 ft.",
  components: "V",
  duration: "Conc, 1 min",
  description: "1 crea wis save or dances in place, can't move, dis. on atks/Dex saves, adv. on atks vs. target; 1 a Wis save to end",
  descriptionFull: "One creature that you can see within range must make a Wisdom saving throw. On a successful save, The target dances comically until the end of its next turn, during which it must spend all its movement to dance in place." + "\n   " + "On a failed save, the target has the Charmed condition for the duration. While Charmed, the target dances comically, must use all its movement to dance in place, and has Disadvantage on Dexterity saving throws and attack rolls, and other creatures have Advantage on attack rolls against it. On each of its turns, the target can take an action to collect itself and repeat the save, ending the spell on itself on a success."
});
legacySpellRefactor("passwall", {
  name: "Passwall",
  classes: ["wizard"],
  source: [["PHB2024", 303]],
  level: 5,
  school: "Trans",
  time: "1 a",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A pinch of sesame seeds",
  duration: "1 h",
  description: "Create a passage (max. 5 ft. wide, 8 ft. tall, 20 ft. deep) in a wooden, plaster or stone surface for 1 h",
  descriptionFull: "A passage appears at a point of your choice that you can see on a wooden, plaster, or stone surface (such as a wall, a ceiling, or a floor) within range, and lasts for the duration. You choose the opening's dimensions - up to 5 feet wide, 8 feet tall, and 20 feet deep. The passage creates no instability in a structure surrounding it." + "\n   " + "When the opening disappears, any creatures or objects still in the passage created by the spell are safely ejected to an unoccupied space nearest to the surface on which you cast the spell."
});
legacySpellRefactor("pass without trace", {
  name: "Pass Without Trace",
  classes: ["druid", "ranger"],
  source: [["PHB2024", 303]],
  level: 2,
  school: "Abjur",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "Ashes from burned mistletoe",
  duration: "Conc, 1 h",
  description: "Any within 30-ft. rad +10 Dex(Stealth) checks, leave no tracks, can't be tracked by nonmagical means",
  descriptionFull: "A veil of shadows and silence radiates from you, masking you and your companions from detection. For the duration, each creature you choose within 30 feet of you (including you) has a +10 bonus to Dexterity (Stealth) checks and can't be tracked except by magical means. A creature that receives this bonus leaves behind no tracks or other traces of its passage."
});
legacySpellRefactor("phantasmal force", {
  name: "Phantasmal Force",
  classes: ["bard", "sorcerer", "wizard"],
  source: [["PHB2024", 304]],
  level: 2,
  school: "Illus",
  time: "1 a",
  range: "60 ft.",
  components: "V,S,M",
  compMaterial: "A bit of fleece",
  duration: "Conc, 1 min",
  save: "Int",
  description: "1 crea save or sees 10 ft. cube illusion that does 2d8 Psychic dmg/rnd; Int(Investigation) vs. spell DC",
  descriptionShorter: "1 crea save or sees 10 ft. cube illusion that does 2d8 Psychic dmg/rnd; Investigation vs. DC",
  descriptionFull: "You craft an illusion that takes root in the mind of a creature that you can see within range. The target must make an Intelligence saving throw. On a failed save, you create a phantasmal object, creature, or other visible phenomenon of your choice that is no larger than a 10-foot cube and that is perceivable only to the target for the duration. This spell has no effect on undead or constructs." + "\n   " + "The phantasm includes sound, temperature, and other stimuli, also evident only to the creature." + "\n   " + "The target can use its action to examine the phantasm with an Intelligence (Investigation) check against your spell save DC. If the check succeeds, the target realizes that the phantasm is an illusion, and the spell ends." + "\n   " + "While a target is affected by the spell, the target treats the phantasm as if it were real. The target rationalizes any illogical outcomes from interacting with the phantasm. For example, a target attempting to walk across a phantasmal bridge that spans a chasm falls once it steps onto the bridge. If the target survives the fall, it still believes that the bridge exists and comes up with some other explanation for its fall - it was pushed, it slipped, or a strong wind might have knocked it off." + "\n   " + "An affected target is so convinced of the phantasm's reality that it can even take damage from the illusion. A phantasm created to appear as a creature can attack the target. Similarly, a phantasm created to appear as fire, a pool of acid, or lava can burn the target. Each round on your turn, the phantasm can deal 2d8 psychic damage to the target if it is in the phantasm's area or within 5 feet of the phantasm, provided that the illusion is of a creature or hazard that could logically deal damage, such as by attacking. The target perceives the damage as a type appropriate to the illusion."
});
legacySpellRefactor("phantasmal killer", {
  name: "Phantasmal Killer",
  classes: ["bard", "wizard"],
  source: [["PHB2024", 304]],
  level: 4,
  school: "Illus",
  time: "1 a",
  range: "120 ft.",
  components: "V,S",
  duration: "Conc, 1 min",
  save: "Wis",
  description: "1 crea save or 4d10+1d10/SL Psy dmg + disadvantage on ability checks + atk rolls; end of each turn save to end or 4d10+1d10/SL Psychic dmg",
  descriptionFull: "You tap into the nightmares of a creature you can see within range and create an illusion of its deepest fears, visible only to that creature. The target makes a Wisdom saving throw. On a failed save, the target takes 4d10 Psychic damage and has Disadvantage on ability checks and attack rolls for the duration. On a successful save, the target takes half as much damage, and the spell ends." + "\n   " + "For the duration, the target makes a Wisdom saving throw at the end of each of its turns. On a failed save, it takes the Psychic damage again. On a successful save, the spell ends." + AtHigherLevels + "When you cast this spell using a spell slot of 5th level or higher, the damage increases by 1d10 for each slot level above 4th."
});
legacySpellRefactor("phantom steed", {
  name: "Phantom Steed",
  classes: ["wizard"],
  source: [["PHB2024", 304]],
  ritual: true,
  level: 3,
  school: "Illus",
  time: "1 min",
  range: "30 ft.",
  components: "V,S",
  duration: "1 h",
  description: "Summon quasi-real steed with 100 ft. speed (13 mph); I designate rider; spells ends if it takes dmg",
  descriptionFull: "A Large quasi-real, horse-like creature appears on the ground in an unoccupied space of your choice within range. You decide the creature's appearance, but it is equipped with a saddle, bit, and bridle. Any of the equipment created by the spell vanishes in a puff of smoke if it is carried more than 10 feet away from the steed." + "\n   " + "For the duration, you or a creature you choose can ride the steed. The creature uses the statistics for a riding horse, except it has a speed of 100 feet and can travel 13 miles in an hour. When the spell ends, the steed gradually fades, giving the rider 1 minute to dismount. The spell ends if you use an action to dismiss it or if the steed takes any damage."
});
legacySpellRefactor("planar ally", {
  name: "Planar Ally",
  classes: ["cleric"],
  source: [["PHB2024", 304 - 305]],
  level: 6,
  school: "Conj",
  time: "10 min",
  range: "60 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "Otherworldly entity sends celestial, elemental or fiend to a location near me; see book",
  descriptionFull: "You beseech an otherworldly entity for aid. The being must be known to you - a god, a primordial, a demon prince, or some other being of cosmic power. That entity sends a celestial, an elemental, or a fiend loyal to it to aid you, making the creature appear in an unoccupied space within range. If you know a specific creature's name, you can speak that name when you cast this spell to request that creature, though you might get a different creature anyway (DM's choice)." + "\n   " + "When the creature appears, it is under no compulsion to behave in any particular way. You can ask the creature to perform a service in exchange for payment, but it isn't obliged to do so. The requested task could range from simple (fly us across the chasm, or help us fight a battle) to complex (spy on our enemies, or protect us during our foray into the dungeon). You must be able to communicate with the creature to bargain for its services." + "\n   " + "Payment can take a variety of forms. A celestial might require a sizable donation of gold or magic items to an allied temple, while a fiend might demand a living sacrifice or a gift of treasure. Some creatures might exchange their service for a quest undertaken by you." + "\n   " + "As a rule of thumb, a task that can be measured in minutes requires a payment worth 100 gp per minute. A task measured in hours requires 1,000 gp per hour. And a task measured in days (up to 10 days) requires 10,000 gp per day. The DM can adjust these payments based on the circumstances under which you cast the spell. If the task is aligned with the creature's ethos, the payment might be halved or even waived. Nonhazardous tasks typically require only half the suggested payment, while especially dangerous tasks might require a greater gift. Creatures rarely accept tasks that seem suicidal." + "\n   " + "After the creature completes the task, or when the agreed-upon duration of service expires, the creature returns to its home plane after reporting back to you, if appropriate to the task and if possible. If you are unable to agree on a price for the creature's service, the creature immediately returns to its home plane." + "\n   " + "A creature enlisted to join your group counts as a member of it, receiving a full share of experience points awarded."
});
legacySpellRefactor("planar binding", {
  name: "Planar Binding",
  classes: ["bard", "cleric", "druid", "warlock", "wizard"],
  source: [["PHB2024", 305]],
  level: 5,
  school: "Abjur",
  time: "1 h",
  range: "60 ft.",
  components: "V,S,M\u2020",
  compMaterial: "A jewel worth 1,000+ gp, which the spell consumes",
  duration: "24 h",
  save: "Cha",
  description: "1 celestial/elem/fey/fiend save or bound; SL6: 10, SL7: 30, SL8: 180, SL9: 366 days (1000gp cons.)",
  descriptionFull: "With this spell, you attempt to bind a celestial, an elemental, a fey, or a fiend to your service. The creature must be within range for the entire casting of the spell. (Typically, the creature is first summoned into the center of an inverted magic circle in order to keep it trapped while this spell is cast.) At the completion of the casting, the target must make a Charisma saving throw. On a failed save, it is bound to serve you for the duration. If the creature was summoned or created by another spell, that spell's duration is extended to match the duration of this spell." + "\n   " + "A bound creature must follow your instructions to the best of its ability. You might command the creature to accompany you on an adventure, to guard a location, or to deliver a message. The creature obeys the letter of your instructions, but if the creature is hostile to you, it strives to twist your words to achieve its own objectives. If the creature carries out your instructions completely before the spell ends, it travels to you to report this fact if you are on the same plane of existence. If you are on a different plane of existence, it returns to the place where you bound it and remains there until the spell ends." + AtHigherLevels + "When you cast this spell using a spell slot of a higher level, the duration increases to 10 days with a 6th-level slot, to 30 days with a 7th-level slot, to 180 days with an 8th-level slot, and to a year and a day with a 9th-level spell slot."
});
legacySpellRefactor("plane shift", {
  name: "Plane Shift",
  classes: ["cleric", "druid", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 305]],
  level: 7,
  school: "Conj",
  time: "1 a",
  range: "Touch",
  components: "V,S,M\u0192",
  compMaterial: "A forked, metal rod worth 250+ gp, attuned to a particular plane of existence",
  duration: "Instantaneous",
  save: "Cha",
  description: "Me + 8 willing crea teleport to different plane; or spell attack + save or transported to random plane",
  descriptionFull: "You and up to eight willing creatures who link hands in a circle are transported to a different plane of existence. You can specify a target destination in general terms, such as the City of Brass on the Elemental Plane of Fire or the palace of Dispater on the second level of the Nine Hells, and you appear in or near that destination. If you are trying to reach the City of Brass, for example, you might arrive in its Street of Steel, before its Gate of Ashes, or looking at the city from across the Sea of Fire, at the DM's discretion." + "\n   " + "Alternatively, if you know the sigil sequence of a teleportation circle on another plane of existence, this spell can take you to that circle. If the teleportation circle is too small to hold all the creatures you transported, they appear in the closest unoccupied spaces next to the circle." + "\n   " + "You can use this spell to banish an unwilling creature to another plane. Choose a creature within your reach and make a melee spell attack against it. On a hit, the creature must make a Charisma saving throw. If the creature fails the save, it is transported to a random location on the plane of existence you specify. A creature so transported must find its own way back to your current plane of existence."
});
legacySpellRefactor("plant growth", {
  name: "Plant Growth",
  classes: ["bard", "druid", "ranger"],
  source: [["PHB2024", 305 - 306]],
  level: 3,
  school: "Trans",
  time: "1 a/8h",
  timeFull: "1 action or 8 hours",
  range: "150 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "1 a: 100-ft. rad plants overgrow for 1/4 speed; 8h: 1 mile diameter plants yield double food at harvest",
  descriptionFull: "This spell channels vitality into plants within a specific area. There are two possible uses for the spell, granting either immediate or long-term benefits." + "\n   " + "If you cast this spell using 1 action, choose a point within range. All normal plants in a 100-foot radius centered on that point become thick and overgrown. A creature moving through the area must spend 4 feet of movement for every 1 foot it moves." + "\n   " + "You can exclude one or more areas of any size within the spell's area from being affected." + "\n   " + "If you cast this spell over 8 hours, you enrich the land. All plants in a half-mile radius centered on a point within range become enriched for 1 year. The plants yield twice the normal amount of food when harvested."
});
legacySpellRefactor("poison spray", {
  name: "Poison Spray",
  classes: ["druid", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 306]],
  level: 0,
  school: "Necro",
  time: "1 a",
  range: "30 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "Spell attack for 1d12 Poison dmg; +1d12 at CL 5, 11, and 17",
  descriptionCantripDie: "Spell attack for `CD`d12 Poison dmg",
  descriptionFull: "You spray toxic mist at a creature within range. Make a ranged spell attack against the target. On a hit, the target takes 1d12 Poison damage." + "\n   " + "Cantrip Upgrade. The damage increases by 1d12 when you reach 5th level (2d12), 11th level (3d12), and 17 level (4d12)."
});
legacySpellRefactor("polymorph", {
  name: "Polymorph",
  classes: ["bard", "druid", "sorcerer", "wizard"],
  source: [["PHB2024", 306]],
  level: 4,
  school: "Trans",
  time: "1 a",
  range: "60 ft.",
  components: "V,S,M",
  compMaterial: "A caterpillar cocoon",
  duration: "Conc, 1 h",
  save: "Wis",
  description: "1 creature with > 0 HP save or transformed into beast of choice of same CR or lower; see book",
  descriptionFull: "You attempt to transform a creature that you can see within range into a Beast. The target must succeed on a Wisdom saving throw or shape-shift into a Beast for the duration. That form can be any Beast you choose that has a Challenge Rating equal to or less tan the target's (or the target's level if it doesn't have a Challenge Rating). The target's game statistics are replaced by the stat block of the chosen Beast, but the target retains its alignment, personality, creature type, Hit Points, and Hit Point Dice. See appendix B for a sample of Beast stat blocks" + "\n   " + "The target gains a number of Temporary Hit Points equal to the Hit Points of the Beast for. The spell ends early on the target if it has no Temporary Hit Points left." + "\n   " + "The target is limited in their actions it can perform by the anatomy of its new form, and it cant speak or cast spells." + "\n   " + "\n   " + "The target's gear melds into the new form. The creature can't activate, use, wield, or otherwise benefit from any of its equipment."
});
legacySpellRefactor("power word fortify", {
  name: "Power Word Fortify",
  classes: ["bard", "cleric"],
  source: [["PHB2024", 306]],
  level: 7,
  school: "Ench",
  time: "1 a",
  range: "60 ft.",
  components: "V",
  duration: "instantaneous",
  description: "Up to 6 crea, split 120 Temp HP",
  descriptionFull: "You fortify up to six creatures you can see within range. The spell bestows 120 Temporary Hit Points, which you divide among the spell's recipients"
});
legacySpellRefactor("power word heal", {
  name: "Power Word Heal",
  classes: ["bard", "cleric"],
  source: [["PHB2024", 306]],
  level: 9,
  school: "Ench",
  time: "1 a",
  range: "60 ft.",
  components: "V",
  duration: "Instantaneous",
  description: "1 crea heals all HP and stops being charmed, frightened, paralyzed, stunned; it can use rea to stand up",
  descriptionShorter: "1 crea heals all HP, not charmed, frightened, paralyzed, stunned; rea to stand up",
  descriptionFull: "A wave of healing energy washes over the creature you can see within range. The target regains all its hit points. If the creature is charmed, frightened, paralyzed, poisoned, or stunned conditions, the condition ends. If the creature is prone, it can use its reaction to stand up."
});
legacySpellRefactor("power word kill", {
  name: "Power Word Kill",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 306]],
  level: 9,
  school: "Ench",
  time: "1 a",
  range: "60 ft.",
  components: "V",
  duration: "Instantaneous",
  description: "1 creature with 100 current HP or less dies, else 12d12 Psy dmg.",
  descriptionFull: "You utter a word of power that can compel one creature you can see within range to die instantly. If the creature you chose has 100 hit points or fewer, it dies. Otherwise, it takes 12d12 Psychic damage."
});
legacySpellRefactor("power word stun", {
  name: "Power Word Stun",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 306]],
  level: 8,
  school: "Ench",
  time: "1 a",
  range: "60 ft.",
  components: "V",
  duration: "Instantaneous",
  save: "Con",
  description: "1 creature with 150 current HP or less is stunned, else Speed is 0 till start of your next turn; save at end of each turn to end Stunned",
  descriptionFull: "You speak a word of power that can overwhelm the mind of one creature you can see within range, leaving it dumbfounded. If the target has 150 hit points or fewer, it is stunned. Otherwise, its Speed is 0 until the start of your next turn." + "\n   " + "The stunned target must make a Constitution saving throw at the end of each of its turns. On a successful save, this stunning effect ends."
});
legacySpellRefactor("prayer of healing", {
  name: "Prayer of Healing",
  classes: ["cleric", "paladin"],
  source: [["PHB2024", 307]],
  level: 2,
  school: "Abjur",
  time: "10 min",
  range: "30 ft.",
  components: "V",
  duration: "Instantaneous",
  description: "6 living creatures heal 2d8+1d8/SL+spellcasting ability modifier HP",
  descriptionFull: "Up to six creatures of your choice that you can see within range each regain hit points equal to 2d8 + your spellcasting ability modifier. This spell has no effect on undead or constructs." + AtHigherLevels + "When you cast this spell using a spell slot of 3rd level or higher, the healing increases by 1d8 for each slot level above 2nd."
});
legacySpellRefactor("prestidigitation", {
  name: "Prestidigitation",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 307]],
  level: 0,
  school: "Trans",
  time: "1 a",
  range: "10 ft.",
  components: "V,S",
  duration: "1 h",
  description: "Minor trick; harmless sensory effect, illusory image, snuff light, clean/soil/chill/warm/flavor etc.",
  descriptionFull: "This spell is a minor magical trick that novice spellcasters use for practice. You create one of the following magical effects within range." + "\n " + "\u2022 You create an instantaneous, harmless sensory effect, such as a shower of sparks, a puff of wind, faint musical notes, or an odd odor." + "\n " + "\u2022 You instantaneously light or snuff out a candle, a torch, or a small campfire." + "\n " + "\u2022 You instantaneously clean or soil an object no larger than 1 cubic foot." + "\n " + "\u2022 You chill, warm, or flavor up to 1 cubic foot of nonliving material for 1 hour." + "\n " + "\u2022 You make a color, a small mark, or a symbol appear on an object or a surface for 1 hour." + "\n " + "\u2022 You create a nonmagical trinket or an illusory image that can fit in your hand and that lasts until the end of your next turn." + "\n\n" + "If you cast this spell multiple times, you can have up to three of its non-instantaneous effects active at a time, and you can dismiss such an effect as an action."
});
legacySpellRefactor("prismatic spray", {
  name: "Prismatic Spray",
  classes: ["bard", "sorcerer", "wizard"],
  source: [["PHB2024", 307]],
  level: 7,
  school: "Evoc",
  time: "1 a",
  range: "Self",
  components: "V,S",
  duration: "Instantaneous",
  save: "Dex",
  description: "All random effect each, see book: either 12d6 dmg, restrained, or blinded; save halves/negates",
  descriptionFull: "Eight multicolored rays of light flash from your hand. Each ray is a different color and has a different power and purpose. Each creature in a 60-foot cone must make a Dexterity saving throw. For each target, roll a d8 to determine which color ray affects it." +
    "\n   " + toUni("1-Red") + ": The target takes 12d6 fire damage on a failed save, or half as much damage on a successful one." +
    "\n   " + toUni("2-Orange") + ": The target takes 12d6 acid damage on a failed save, or half as much damage on a successful one." +
    "\n   " + toUni("3-Yellow") + ": The target takes 12d6 lightning damage on a failed save, or half as much damage on a successful one." +
    "\n   " + toUni("4-Green") + ": The target takes 12d6 poison damage on a failed save, or half as much damage on a successful one." +
    "\n   " + toUni("5-Blue") + ": The target takes 12d6 cold damage on a failed save, or half as much damage on a successful one." +
    "\n   " + toUni("6-Indigo") + ": On a failed save, the target is restrained. It must then make a Constitution saving throw at the end of each of its turns. If it successfully saves three times, the spell ends. If it fails its save three times, it permanently turns to stone and is subjected to the petrified condition. The successes and failures don't need to be consecutive, keep track of both until the target collects three of a kind." +
    "\n   " + toUni("7-Violet") + ": On a failed save, the target is blinded. It must then make a Wisdom saving throw at the start of your next turn. A successful save ends the blindness. If it fails that save, the creature is transported to another plane of existence of the DM's choosing and is no longer blinded. (Typically, a creature that is on a plane that isn't its home plane is banished home, while other creatures are usually cast into the Astral or Ethereal planes.)" +
    "\n   " + toUni("8-Special") + ": The target is struck by two rays. Roll twice more, rerolling any 8.",
  dynamicDamageBonus: {
    multipleDmgTypes: {
      dmgTypes: ["acid", "cold", "fire", "lightning", "poison"],
      inDescriptionAs: ""
    }
  }
});
legacySpellRefactor("prismatic wall", {
  name: "Prismatic Wall",
  classes: ["bard", "wizard"],
  source: [["PHB2024", 308]],
  level: 9,
  school: "Abjur",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "10 min",
  save: "Con",
  description: "Up to 90 ft. long 30 ft. high 5 inch thick; all in 20 ft. save or blinded; 7 layers with effects, see book",
  descriptionFull: "A shimmering, multicolored plane of light forms a vertical opaque wall - up to 90 feet long, 30 feet high, and 1 inch thick - entered on a point you can see within range. Alternatively, you can shape the wall into a sphere up to 30 feet in diameter centered on a point you choose within range. The wall remains in place for the duration. If you position the wall so that it passes through a space occupied by a creature, the spell fails, and your action and the spell slot are wasted." +
    "\n The wall sheds bright light out to a range of 100 feet and dim light for an additional 100 feet. You and creatures you designate at the time you cast the spell can pass through and remain near the wall without harm. If another creature that can see the wall moves to within 20 feet of it or starts its turn there, the creature must succeed on a Constitution saving throw or become blinded for 1 minute." +
    "\n The wall consists of seven layers, each with a different color. When a creature attempts to reach into or pass through the wall, it does so one layer at a time through all the wall's layers. As it passes or reaches through each layer, the creature must make a Dexterity saving throw or be affected by that layer's properties as described below." +
    "\n The wall can be destroyed, also one layer at a time, in order from red to violet, by means specific to each layer. Once a layer is destroyed, it remains so for the duration of the spell. An antimagic field has no effect on a prismatic wall." +
    "\n   " + toUni("Red") + ": The creature takes 12d6 fire damage on a failed save, or half as much damage on a successful one. While this layer is in place, nonmagical ranged attacks can't pass through the wall. The layer can be destroyed by dealing at least 25 cold damage to it." +
    "\n   " + toUni("Orange") + ": The creature takes 12d6 acid damage on a failed save, or half as much damage on a successful one. While this layer is in place, magical ranged attacks can't pass through the wall. The layer is destroyed by a strong wind." +
    "\n   " + toUni("Yellow") + ": The creature takes 12d6 lightning damage on a failed save, or half as much damage on a successful one. This layer can be destroyed by dealing at least 60 force damage to it." +
    "\n   " + toUni("Green") + ": The creature takes 12d6 poison damage on a failed save, or half as much damage on a successful one. A passwall spell, or another spell of equal or greater level that can open a portal on a solid surface, destroys this layer." +
    "\n   " + toUni("Blue") + ": The creature takes 12d6 cold damage on a failed save, or half as much damage on a successful one. This layer can be destroyed by dealing at least 25 fire damage to it." +
    "\n   " + toUni("Indigo") + ": On a failed save, the creature is restrained. It must then make a Constitution saving throw at the end of each of its turns. If it successfully saves three times, the spell ends. If it fails its save three times, it permanently turns to stone and is subjected to the petrified condition. The successes and failures don't need to be consecutive, keep track of both until the creature collects three of a kind. While this layer is in place, spells can't be cast through the wall. The layer is destroyed by bright light shed by a daylight spell or a similar spell of equal or higher level." +
    "\n   " + toUni("Violet") + ": On a failed save, the creature is blinded. It must then make a Wisdom saving throw at the start of your next turn. A successful save ends the blindness. If it fails that save, the creature is transported to another plane of the DM's choosing and is no longer blinded. (Typically, a creature that is on a plane that isn't its home plane is banished home, while other creatures are usually cast into the Astral or Ethereal planes.) This layer is destroyed by a dispel magic spell or a similar spell of equal or higher level that can end spells and magical effects."
});
legacySpellRefactor("produce flame", {
  name: "Produce Flame",
  classes: ["druid"],
  source: [["PHB2024", 308]],
  level: 0,
  school: "Conj",
  time: "1 bns",
  range: "Self",
  components: "V,S",
  duration: "10 min (D)",
  description: "Flame 10 ft. bright light; once 30 ft. ranged spell attack for 1d8 Fire dmg; +1d8 at CL 5, 11, and 17",
  descriptionCantripDie: "Flame 10 ft. bright light; once 30 ft. ranged spell attack for `CD`d8 Fire dmg",
  descriptionFull: "A flickering flame appears in your hand. The flame remains there for the duration and harms neither you nor your equipment. The flame sheds bright light in a 10-foot radius and dim light for an additional 10 feet. The spell ends if you dismiss it as an action or if you cast it again." + "\n   " + "You can also attack with the flame, although doing so ends the spell. When you cast this spell, or as an action on a later turn, you can hurl the flame at a creature within 30 feet of you. Make a ranged spell attack. On a hit, the target takes 1d8 fire damage." + "\n   " + "This spell's damage increases by 1d8 when you reach 5th level (2d8), 11th level (3d8), and 17th level (4d8).",
  dynamicDamageBonus: {multipleDmgMoments: false}
});
legacySpellRefactor("programmed illusion", {
  name: "Programmed Illusion",
  classes: ["bard", "wizard"],
  source: [["PHB2024", 309]],
  level: 6,
  school: "Illus",
  time: "1 a",
  range: "120 ft.",
  components: "V,S,M\u0192",
  compMaterial: "Jade dust worth 25+ gp",
  duration: "Until dispelled",
  description: "30-ft. cube illusion includes visible, audible; triggers on set condition; see book (25gp)",
  descriptionFull: "You create an illusion of an object, a creature, or some other visible phenomenon within range that activates when a specific condition occurs. The illusion is imperceptible until then. It must be no larger than a 30-foot cube, and you decide when you cast the spell how the illusion behaves and what sounds it makes. This scripted performance can last up to 5 minutes." + "\n   " + "When the condition you specify occurs, the illusion springs into existence and performs in the manner you described. Once the illusion finishes performing, it disappears and remains dormant for 10 minutes. After this time, the illusion can be activated again." + "\n   " + "The triggering condition can be as general or as detailed as you like, though it must be based on visual or audible conditions that occur within 30 feet of the area. For example, you could create an illusion of yourself to appear and warn off others who attempt to open a trapped door, or you could set the illusion to trigger only when a creature says the correct word or phrase." + "\n   " + "Physical interaction with the image reveals it to be an illusion, because things can pass through it. A creature that uses its action to examine the image can determine that it is an illusion with a successful Intelligence (Investigation) check against your spell save DC. If a creature discerns the illusion for what it is, the creature can see through the image, and any noise it makes sounds hollow to the creature."
});
legacySpellRefactor("project image", {
  name: "Project Image",
  classes: ["bard", "wizard"],
  source: [["PHB2024", 309]],
  level: 7,
  school: "Illus",
  time: "1 a",
  range: "500 miles",
  components: "V,S,M\u0192",
  compMaterial: "A statuette of yourself worth 5+ gp",
  duration: "Conc, 1 day",
  description: "Project image of me to familiar place; 1 a manipulate; bns a switch between its senses and mine (5gp)",
  descriptionFull: "You create an illusory copy of yourself that lasts for the duration. The copy can appear at any location within range that you have seen before, regardless of intervening obstacles. The illusion looks and sounds like you but is intangible. If the illusion takes any damage, it disappears, and the spell ends." + "\n   " + "You can use your action to move this illusion up to twice your speed, and make it gesture, speak, and behave in whatever way you choose. It mimics your mannerisms perfectly." + "\n   " + "You can see through its eyes and hear through its ears as if you were in its space. On your turn as a bonus action, you can switch from using its senses to using your own, or back again. While you are using its senses, you are blinded and deafened in regard to your own surroundings." + "\n   " + "Physical interaction with the image reveals it to be an illusion, because things can pass through it. A creature that uses its action to examine the image can determine that it is an illusion with a successful Intelligence (Investigation) check against your spell save DC. If a creature discerns the illusion for what it is, the creature can see through the image, and any noise it makes sounds hollow to the creature."
});
legacySpellRefactor("protection from energy", {
  name: "Protection from Energy",
  classes: ["cleric", "druid", "ranger", "sorcerer", "wizard"],
  source: [["PHB2024", 309]],
  level: 3,
  school: "Abjur",
  time: "1 a",
  range: "Touch",
  components: "V,S",
  duration: "Conc, 1 h",
  description: "1 creature gains resistance to either Acid, Cold, Fire, Lightning, or Thunder damage for duration",
  descriptionFull: "For the duration, the willing creature you touch has resistance to one damage type of your choice - acid, cold, fire, lightning, or thunder."
});
legacySpellRefactor("protection from evil and good", {
  name: "Protection from Evil and Good",
  nameShort: "Prot. from Evil/Good",
  classes: ["cleric", "druid", "paladin", "warlock", "wizard"],
  source: [["PHB2024", 309 - 310]],
  level: 1,
  school: "Abjur",
  time: "1 a",
  range: "Touch",
  components: "V,S,M\u2020",
  compMaterial: "A flask of Holy Water worth 25+ gp, which the spell consumes",
  duration: "Conc, 10 min",
  description: "1 crea immune fear/charm/possess by abber./celest./elem./fey/fiends/undead, they also dis. on atks",
  descriptionFull: "Until the spell ends, one willing creature you touch is protected against certain types of creatures - aberrations, celestials, elementals, fey, fiends, and undead." + "\n   " + "The protection grants several benefits. Creatures of those types have disadvantage on attack rolls against the target. The target also can't be charmed, frightened, or possessed by them. If the target is already charmed, frightened, or possessed by such a creature, the target has advantage on any new saving throw against the relevant effect."
});
legacySpellRefactor("protection from poison", {
  name: "Protection from Poison",
  classes: ["cleric", "druid", "paladin", "ranger"],
  source: [["PHB2024", 310]],
  level: 2,
  school: "Abjur",
  time: "1 a",
  range: "Touch",
  components: "V,S",
  duration: "1 h",
  description: "1 crea cured from 1 poison, gains resistance to Poison damage, and adv. on saves vs. being poisoned",
  descriptionFull: "You touch a creature. If it is poisoned, you neutralize the poison. If more than one poison afflicts the target, you neutralize on poison that you know is present, or you neutralize one at random." + "\n   " + "For the duration, the target has advantage on saving throws against being poisoned, and it has resistance to poison damage."
});
legacySpellRefactor("purify food and drink", {
  name: "Purify Food and Drink",
  classes: ["cleric", "druid", "paladin"],
  source: [["PHB2024", 310]],
  ritual: true,
  level: 1,
  school: "Trans",
  time: "1 a",
  range: "10 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "5-ft. rad of food and drink is rendered free of all poison and disease",
  descriptionFull: "All nonmagical food and drink within a 5-foot-radius sphere centered on a point of your choice within range is purified and rendered free of poison and disease."
});
legacySpellRefactor("raise dead", {
  name: "Raise Dead",
  classes: ["bard", "cleric", "paladin"],
  source: [["PHB2024", 310]],
  level: 5,
  school: "Necro",
  time: "1 h",
  range: "Touch",
  components: "V,S,M\u2020",
  compMaterial: "A diamond worth 500+ gp, which the spell consumes",
  duration: "Instantaneous",
  description: "Restores a creature's body that has died in the last 10 days to life with 1 HP; see book (500gp cons.)",
  descriptionFull: "You return a dead creature you touch to life, provided that it has been dead no longer than 10 days. If the creature's soul is both willing and at liberty to rejoin the body, the creature returns to life with 1 hit point." + "\n   " + "This spell also neutralizes any poison and cures nonmagical diseases that affected the creature at the time it died. This spell doesn't, however, remove magical diseases, curses, or similar effects, if these aren't first removed prior to casting the spell, they take effect when the creature returns to life. The spell can't return an undead creature to life." + "\n   " + "This spell closes all mortal wounds, but it doesn't restore missing body parts. If the creature is lacking body parts or organs integral for its survival - its head, for instance - the spell automatically fails." + "\n   " + "Coming back from the dead is an ordeal. The target takes a -4 penalty to all attack rolls, saving throws, and ability checks. Every time the target finishes a long rest, the penalty is reduced by 1 until it disappears."
});
legacySpellRefactor("rary's telepathic bond", {
  name: "Rary's Telepathic Bond",
  nameShort: "Rary's Telepath. Bond",
  nameAlt: "Telepathic Bond",
  classes: ["bard", "wizard"],
  source: [["PHB2024", 311]],
  ritual: true,
  level: 5,
  school: "Div",
  time: "1 a",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "two eggs",
  duration: "1 h",
  description: "8 willing crea with Int>2 gain a telepathic bond that works for any distance on the same plane",
  descriptionFull: "You forge a telepathic link among up to eight willing creatures of your choice within range, psychically linking each creature to all the others for the duration. Creatures with Intelligence scores of 2 or less aren't affected by this spell." + "\n   " + "Until the spell ends, the targets can communicate telepathically through the bond whether or not they have a common language. The communication is possible over any distance, though it can't extend to other planes of existence."
});
legacySpellRefactor("ray of enfeeblement", {
  name: "Ray of Enfeeblement",
  classes: ["warlock", "wizard"],
  source: [["PHB2024", 311]],
  level: 2,
  school: "Necro",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "Conc, 1 min",
  save: "Con",
  description: "Spell attack; crea does half dmg with weapon attacks that use Str; save at end of each turn to end",
  descriptionFull: "A black beam of enervating energy springs from your finger toward a creature within range. Make a ranged spell attack against the target. On a hit, the target deals only half damage with weapon attacks that use Strength until the spell ends." + "\n   " + "At the end of each of the target's turns, it can make a Constitution saving throw against the spell. On a success, the spell ends."
});
legacySpellRefactor("ray of frost", {
  name: "Ray of Frost",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 311]],
  level: 0,
  school: "Evoc",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "Spell attack for 1d8 Cold dmg and -10 ft. speed until start of my next turn; +1d8 at CL 5, 11, and 17",
  descriptionCantripDie: "Spell attack for `CD`d8 Cold dmg and -10 ft. speed until start of my next turn",
  descriptionFull: "A frigid beam of blue-white light streaks toward a creature within range. Make a ranged spell attack against the target. On a hit, it takes 1d8 cold damage, and its speed is reduced by 10 feet until the start of your next turn." + "\n   " + "The spell's damage increases by 1d8 when you reach 5th level (2d8), 11th level (3d8), and 17th level (4d8)."
});
legacySpellRefactor("ray of sickness", {
  name: "Ray of Sickness",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 311]],
  level: 1,
  school: "Necro",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "Instantaneous",
  save: "Con",
  description: "Spell attack for 2d8+1d8/SL Poison dmg; save or also poisoned until end of my next turn",
  descriptionFull: "A ray of sickening greenish energy lashes out toward a creature within range. Make a ranged spell attack against the target. On a hit, the target takes 2d8 poison damage and must make a Constitution saving throw. On a failed save, it is also poisoned until the end of your next turn." + AtHigherLevels + "When you cast this spell using a spell slot of 2nd level or higher, the damage increases by 1d8 for each slot level above 1st."
});
legacySpellRefactor("regenerate", {
  name: "Regenerate",
  classes: ["bard", "cleric", "druid"],
  source: [["PHB2024", 311]],
  level: 7,
  school: "Trans",
  time: "1 min",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "A prayer wheel",
  duration: "1 h",
  description: "1 crea heals 4d8+15 HP now and 1 HP/rnd for rest of duration; restores lost body parts in 2 min",
  descriptionShorter: "1 crea heals 4d8+15 HP and 1 HP/rnd for the duration; restores lost body parts in 2 min",
  descriptionFull: "You touch a creature and stimulate its natural healing ability. The target regains 4d8 + 15 hit points. For the duration of the spell, the target regains 1 hit point at the start of each of its turns (10 hit points each minute)." + "\n   " + "The target's severed body members (fingers, legs, tails, and so on), if any, are restored after 2 minutes. If you have the severed part and hold it to the stump, the spell instantaneously causes the limb to knit to the stump.",
  dynamicDamageBonus: {
    multipleDmgMoments: false,
    extraDmgGroupsSameType: /(and |\u0026 )((?:\+?\d+d?\d*)+)( HP\/rnd)/i
  }
});
legacySpellRefactor("reincarnate", {
  name: "Reincarnate",
  classes: ["druid"],
  source: [["PHB2024", 311]],
  level: 5,
  school: "Necro",
  time: "1 h",
  range: "Touch",
  components: "V,S,M\u2020",
  compMaterial: "Rare oils worth 1,000+ gp, which the spell consumes",
  duration: "Instantaneous",
  description: "Brings humanoid that died in last 10 days to life in a new random adult body, see book (1000gp cons.)",
  descriptionFull: "You touch a dead humanoid or a piece of a dead humanoid. Provided that the creature has been dead no longer than 10 days, the spell forms a new adult body for it and then calls the soul to enter that body. If the target's soul isn't free or willing to do so, the spell fails." + "\n   " + "The magic fashions a new body for the creature to inhabit, which likely causes the creature's race to change. The DM rolls a d10 and consults the following table to determine what form the creature takes when restored to life, or the DM chooses a form." + "\n\n   " + toUni("d10") + "\t" + toUni("Race") + "\n   " + "1\tAasimar" + "\n   " + "2\tDragonborn" + "\n   " + "3\tDwarf" + "\n   " + "4\tElf" + "\n   " + "5\tGnome" + "\n   " + "6\tGoliath" + "\n   " + "7\tHalfling" + "\n   " + "8\tHuman" + "\n   " + "9\tOrc" + "\n   " + "10\tTiefling" + "\n\n" + "The reincarnated creature recalls its former life and experiences. It retains the capabilities it had in its original form, except it exchanges its original race for the new one and changes its racial traits accordingly."
});
legacySpellRefactor("remove curse", {
  name: "Remove Curse",
  classes: ["cleric", "paladin", "warlock", "wizard"],
  source: [["PHB2024", 312]],
  level: 3,
  school: "Abjur",
  time: "1 a",
  range: "Touch",
  components: "V,S",
  duration: "Instantaneous",
  description: "1 creature or object is freed of all curses; cursed magic items break attunement with owner",
  descriptionFull: "At your touch, all curses affecting one creature or object end. If the object is a cursed magic item, its curse remains, but the spell breaks its owner's attunement to the object so it can be removed or discarded."
});
legacySpellRefactor("resistance", {
  name: "Resistance",
  classes: ["cleric", "druid"],
  source: [["PHB2024", 312]],
  level: 0,
  school: "Abjur",
  time: "1 a",
  range: "Touch",
  components: "V,S",
  duration: "Conc, 1 min",
  description: "Choose 1 dmg type except Force and Psy. 1 crea takes 1d4 less damage of the chosen type",
  descriptionFull: "You touch a willing creature and choose a damage type: Acid, Bludgeoning, Cold, Fire, Lighting, Necrotic, Piercing, Poison, Radiant, Slashing, or Thunder. When the creature takes damage of the chosen type before the spell ends, the creature reduces the total damage taken by 1d4. A creature can benefit from this spell only once."
});
legacySpellRefactor("resurrection", {
  name: "Resurrection",
  classes: ["bard", "cleric"],
  source: [["PHB2024", 312]],
  level: 7,
  school: "Necro",
  time: "1 h",
  range: "Touch",
  components: "V,S,M\u2020",
  compMaterial: "A diamond worth 1,000+ gp, which the spell consumes",
  duration: "Instantaneous",
  description: "Resurrects a crea that died in the last century to life with whole body and full HP; see B (1000gp cons.)",
  descriptionFull: "You touch a dead creature that has been dead for no more than a century, that didn't die of old age, and that isn't undead. If its soul is free and willing, the target returns to life with all its hit points." + "\n   " + "This spell neutralizes any poisons and cures normal diseases afflicting the creature when it died. It doesn't, however, remove magical diseases, curses, and the like, if such affects aren't removed prior to casting the spell, they afflict the target on its return to life." + "\n   " + "This spell closes all mortal wounds and restores any missing body parts." + "\n   " + "Coming back from the dead is an ordeal. The target takes a -4 penalty to all attack rolls, saving throws, and ability checks. Every time the target finishes a long rest, the penalty is reduced by 1 until it disappears." + "\n   " + "Casting this spell to restore life to a creature that has been dead for one year or longer taxes you greatly. Until you finish a long rest, you can't cast spells again, and you have disadvantage on all attack rolls, ability checks, and saving throws."
});
legacySpellRefactor("reverse gravity", {
  name: "Reverse Gravity",
  classes: ["druid", "sorcerer", "wizard"],
  source: [["PHB2024", 312]],
  level: 7,
  school: "Trans",
  time: "1 a",
  range: "100 ft.",
  components: "V,S,M",
  compMaterial: "A lodestone and iron filings",
  duration: "Conc, 1 min",
  save: "Dex",
  description: "50-ft. rad 100-ft. high everything falls upward; save to grab hold onto something solid",
  descriptionFull: "This spell reverses gravity in a 50-foot-radius, 100-foot high cylinder centered on a point within range. All creatures and objects that aren't somehow anchored to the ground in the area fall upward and reach the top of the area when you cast this spell. A creature can make a Dexterity saving throw to grab onto a fixed object it can reach, thus avoiding the fall." + "\n   " + "If some solid object (such as a ceiling) is encountered in this fall, falling objects and creatures strike it just as they would during a normal downward fall. If an object or creature reaches the top of the area without striking anything, it remains there, oscillating slightly, for the duration." + "\n   " + "At the end of the duration, affected objects and creatures fall back down."
});
legacySpellRefactor("revivify", {
  name: "Revivify",
  classes: ["cleric", "paladin", "ranger"],
  source: [["PHB2024", 312]],
  level: 3,
  school: "Necro",
  time: "1 a",
  range: "Touch",
  components: "V,S,M\u2020",
  compMaterial: "A diamond worth 300+ gp, which the spell consumes",
  duration: "Instantaneous",
  description: "Restores a creature's body that has died in the last min to life with 1 HP (300gp cons.)",
  descriptionFull: "You touch a creature that has died within the last minute. That creature returns to life with 1 hit point. This spell can't return to life a creature that has died of old age, nor can it restore any missing body parts."
});
legacySpellRefactor("rope trick", {
  name: "Rope Trick",
  classes: ["wizard"],
  source: [["PHB2024", 312]],
  level: 2,
  school: "Trans",
  time: "1 a",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "A segment of rope",
  duration: "1 h",
  description: "Rope up to 60 ft. stands vertical; extradimens. space with invisible 3\xD75 ft. entrance at top, for 8 crea",
  descriptionFull: "You touch a length of rope that is up to 60 feet long. One end of the rope then rises into the air until the whole rope hangs perpendicular to the ground. At the upper end of the rope, an invisible entrance opens to an extradimensional space that lasts until the spell ends." + "\n   " + "The extradimensional space can be reached by climbing to the top of the rope. The space can hold as many as eight Medium or smaller creatures. The rope can be pulled into the space, making the rope disappear from view outside the space." + "\n   " + "Attacks and spells can't cross through the entrance into or out of the extradimensional space, but those inside can see out of it as if through a 3-foot-by-5-foot window centered on the rope." + "\n   " + "Anything inside the extradimensional space drops out when the spell ends."
});
legacySpellRefactor("sacred flame", {
  name: "Sacred Flame",
  classes: ["cleric"],
  source: [["PHB2024", 313]],
  level: 0,
  school: "Evoc",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "Instantaneous",
  save: "Dex",
  description: "1 crea that I can see save or 1d8 Radiant dmg; no bonus for cover on save; +1d8 at CL 5, 11, and 17",
  descriptionShorter: "1 crea that I can see save or 1d8 Radiant dmg; no bonus for cover on save; +1d8 at CL 5/11/17",
  descriptionCantripDie: "1 creature that I can see save or `CD`d8 Radiant dmg; no bonus for cover on save",
  descriptionFull: "Flame-like radiance descends on a creature that you can see within range. The target must succeed on a Dexterity saving throw or take 1d8 radiant damage. The target gains no benefit from cover for this saving throw." + "\n   " + "The spell's damage increases by 1d8 when you reach 5th level (2d8), 11th level (3d8), and 17th level (4d8)."
});
legacySpellRefactor("sanctuary", {
  name: "Sanctuary",
  classes: ["cleric"],
  source: [["PHB2024", 313]],
  level: 1,
  school: "Abjur",
  time: "1 bns",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A shard of glass from a mirror",
  duration: "1 min",
  save: "Wis",
  description: "1 crea warded; any who want to attack/target must first make save; doesn't protect vs. area spells",
  descriptionFull: "You ward a creature within range against attack. Until the spell ends, any creature who targets the warded creature with an attack or a harmful spell must first make a Wisdom saving throw. On a failed save, the creature must choose a new target or lose the attack or spell. This spell doesn't protect the warded creature from area effects, such as the explosion of a fireball." + "\n   " + "If the warded creature makes an attack, casts a spell that affects an enemy, or deals damage to another creature, this spell ends."
});
legacySpellRefactor("scorching ray", {
  name: "Scorching Ray",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 313]],
  level: 2,
  school: "Evoc",
  time: "1 a",
  range: "120 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "3+1/SL rays hit creature(s) on spell attack with each ray for 2d6 Fire dmg per ray",
  descriptionFull: "You create three rays of fire and hurl them at targets within range. You can hurl them at one target or several." + "\n   " + "Make a ranged spell attack for each ray. On a hit, the target takes 2d6 fire damage." + AtHigherLevels + "When you cast this spell using a spell slot of 3rd level or higher, you create one additional ray for each slot level above 2nd.",
  dynamicDamageBonus: {multipleDmgMoments: true}
});
legacySpellRefactor("scrying", {
  name: "Scrying",
  classes: ["bard", "cleric", "druid", "warlock", "wizard"],
  source: [["PHB2024", 313 - 14]],
  level: 5,
  school: "Div",
  time: "10 min",
  range: "Self",
  components: "V,S,M\u0192",
  compMaterial: "A focus worth 1,000+ gp, such as a crystal ball, mirror, or water filled font",
  duration: "Conc, 10 min",
  save: "Wis",
  description: "1 crea save or sensor follows it around; or create sensor in familiar location; see book (1000gp)",
  descriptionFull: "You can see and hear a particular creature you choose that is on the same plane of existence as you. The target must make a Wisdom saving throw, which is modified by how well you know the target and the sort of physical connection you have to it. If a target knows you're casting this spell, it can fail the saving throw voluntarily if it wants to be observed." + "\n\n" + toUni("Knowledge") + "\t\t\t   " + toUni("Save Modifier") + "\n" + "Secondhand (you have heard of the target)\t+5" + "\n" + "Firsthand (you have met the target)\t\t+0" + "\n" + "Familiar (you know the target well)\t\t-5" + "\n\n" + toUni("Connection") + "\t\t\t   " + toUni("Save Modifier") + "\n" + "Likeness or picture\t\t\t\t-2" + "\n" + "Possession or garment\t\t\t-4" + "\n" + "Body part, lock of hair, bit of nail, or the like\t-10" + "\n\n" + "On a successful save, the target isn't affected, and you can't use this spell against it again for 24 hours." + "\n   " + "On a failed save, the spell creates an invisible sensor within 10 feet of the target. You can see and hear through the sensor as if you were there. The sensor moves with the target, remaining within 10 feet of it for the duration. A creature that can see invisible objects sees the sensor as a luminous orb about the size of your fist." + "\n   " + "Instead of targeting a creature, you can choose a location you have seen before as the target of this spell. When you do, the sensor appears at that location and doesn't move."
});
legacySpellRefactor("searing smite", {
  name: "Searing Smite",
  classes: ["paladin"],
  source: [["PHB2024", 314]],
  level: 1,
  school: "Evoc",
  time: "1 bns",
  timeFull: "Bonus Action, which you take immediately after hitting a target with a Melee weapon or an Unarmed Strike",
  range: "Self",
  components: "V",
  duration: "1 min",
  save: "Con",
  description: "on melee weapon hit +1d6+1d6/SL Fire dmg and target ignites: start of turn save to end or 1d6 dmg",
  descriptionShorter: "on melee wea hit +1d6+1d6/SL Fire dmg \u0026 ignites: start of turn save to end or 1d6 dmg",
  descriptionFull: "As you hit the target, it takes an extra 1d6 Fire damage from the attack. At the start of each of its turns until the spell ends, the target takes 1d6 Fire damage and then makes a Constitution saving throw. On a failed save, the spell continues. On a successful save, the spell ends." + AtHigherLevels + "All the damage increases by 1d6 for each spell slot level above 1.",
  dynamicDamageBonus: {
    extraDmgGroupsSameType: /(end or )((?:\+?\d+d?\d*)+)/i
  }
});
legacySpellRefactor("see invisibility", {
  name: "See Invisibility",
  classes: ["bard", "sorcerer", "wizard"],
  source: [["PHB2024", 314]],
  level: 2,
  school: "Div",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "A pinch of Talc",
  duration: "1 h",
  description: "See invisible/ethereal creatures and objects as if they were visible; ethereals are ghostly, translucent",
  descriptionFull: "For the duration, you see invisible creatures and objects as if they were visible, and you can see into the Ethereal Plane. Ethereal creatures and objects appear ghostly and translucent."
});
legacySpellRefactor("seeming", {
  name: "Seeming",
  classes: ["bard", "sorcerer", "wizard"],
  source: [["PHB2024", 314]],
  level: 5,
  school: "Illus",
  time: "1 a",
  range: "30 ft.",
  components: "V,S",
  duration: "8 h",
  save: "Cha",
  description: "Any crea save or disguised by changing physical appearance; Int(Investigation) check vs. spell DC",
  descriptionFull: "This spell allows you to change the appearance of any number of creatures that you can see within range. You give each target you choose a new, illusory appearance. An unwilling target can make a Charisma saving throw, and if it succeeds, it is unaffected by this spell." + "\n   " + "The spell disguises physical appearances as well as clothing, armor, weapons, and equipment. You can make each creature seem 1 foot shorter or taller and appear thin, fat, or in-between. You can't change a target's body type, so you must choose a form that has the same basic arrangement of limbs. Otherwise, the extent of the illusion is up to you. The spell lasts for the duration, unless you use your action to dismiss it sooner." + "\n   " + "The changes wrought by this spell fail to hold up to physical inspections. For example, if you use this spell to add a hat to a creature's outfit objects pass through the hat, and anyone who touches it would feel nothing or would feel the creature's head and hair. If you use this spell to appear thinner then you are, the hand of someone who reaches out to touch you would bump into you while it was seemingly still in midair." + "\n   " + "A creature can use its action to inspect a target and make an Intelligence (Investigation) check against your spell save DC. If it succeeds, it becomes aware that the target is disguised."
});
legacySpellRefactor("sending", {
  name: "Sending",
  classes: ["bard", "cleric", "wizard"],
  source: [["PHB2024", 314]],
  level: 3,
  school: "Div",
  time: "1 a",
  range: "Unlimited",
  components: "V,S,M",
  compMaterial: "A copper wire",
  duration: "Instantaneous",
  description: "Send a 25 word message to a familiar creature; it recognizes me and can respond with 25 words",
  descriptionFull: "You send a short message of 25 words of fewer to a creature you have met or a creature described to you by someone who has bet it. The target hears the message in its mind, recognizes you as the sender if it knows you, and can answer in a like manner immediately. The spell enables targets to understand the meaning of your message." + "\n   " + "You can send the message across any distance and even to other planes of existence, but if the target is on a different plane than you, there is a 5 percent chance that the message doesn't arrive. You know if the delivery fails." + "\n   " + "Upon receiving your message, a creature can block your ability to reach it again with this spell for 8 hours. If you try to send another message during that time, you learn that you are blocked, and the spell fails."
});
legacySpellRefactor("sequester", {
  name: "Sequester",
  classes: ["wizard"],
  source: [["PHB2024", 315]],
  level: 7,
  school: "Trans",
  time: "1 a",
  range: "Touch",
  components: "V,S,M\u2020",
  compMaterial: "Gem dust worth 5000+ gp, which the spell consumes",
  duration: "Until dispelled",
  description: "1 willing crea/obj suspended, invisible, hidden from divination magic; see book (5000gp cons.)",
  descriptionFull: "By means of this spell, a willing creature or an object can be hidden away, safe from detection for the duration. When you cast the spell and touch the target, it becomes invisible and can't be targeted by divination spells or perceived through scrying sensors created by the divination of spells." + "\n   " + "If the target is a creature, it falls into a state of suspended animation. Time ceases to flow for it, and it doesn't grow older." + "\n   " + "You can set a condition for the spell to end early. The condition can be anything you choose, but it must occur or be visible within 1 mile of the target. Examples include after 1,000 years or when the tarrasque awakes. This spell also ends if the target takes any damage."
});
legacySpellRefactor("shapechange", {
  name: "Shapechange",
  classes: ["druid", "wizard"],
  source: [["PHB2024", 315]],
  level: 9,
  school: "Trans",
  time: "1 a",
  range: "Self",
  components: "V,S,M\u0192",
  compMaterial: "A jade circlet worth 1,500+ gp",
  duration: "Conc, 1 h",
  description: "Take form of creature with CR of CL or lower; keep Int, Wis, Cha and alignment; see book (1500gp)",
  descriptionFull: "You assume the form of a different creature for the duration. The new form can be any creature with a challenge rating equal to your level or lower. The creature can't be a construct or an undead, and you must have seen the sort of creature at least once. You transform into an average example of that creature, one without any class levels or the Spellcasting trait." + "\n   " + "Your game statistics are replaced by the statistics of the chosen creature, though you retain your alignment and Intelligence, Wisdom, and Charisma scores You also retain all of your skill and saving throw proficiencies, in addition to gaining those of the creature, If the creature has the same proficiency as you, and the bonus listed in its statistics is higher than yours, use the creature's bonus in place of yours. You can't use any legendary actions or lair actions of the new form." + "\n   " + "You assume the hit points and Hit Dice of the new form. When you revert to your normal, you return to the number of hit points you had before you transformed. If you revert as a result of dropping to 0 hit points, any excess damage carries over to your normal form. As long as the excess damage doesn't reduce your normal form to 0 hit points, you aren't knocked unconscious." + "\n   " + "You retain the benefit of any features from your class, race, or other source and can use them, provided that your new form is physically capable of doing so. You can't use any special senses you have (for example, darkvision) unless your new form also has that sense. You can only speak if the creature can normally speak." + "\n   " + "When you transform, you choose whether your equipment falls to the ground, merges into the new form, or is worn by it. Worn equipment functions as normal. The DM determines whether it is practical for the new form to wear a piece of equipment, based on the creature's shape and size. Your equipment doesn't change shape or size to match the new form, and any equipment that the new form can't wear must either fall to the ground or merge into your new form. Equipment that merges has no effect in that state." + "\n   " + "During this spell's duration, you can use your action to assume a different form following the same restrictions and rules for the original form, with one exception - if your new form has more hit pints than your current one, your hit points remain at their current value."
});
legacySpellRefactor("shatter", {
  name: "Shatter",
  classes: ["bard", "sorcerer", "wizard"],
  source: [["PHB2024", 316]],
  level: 2,
  school: "Evoc",
  time: "1 a",
  range: "60 ft.",
  components: "V,S,M",
  compMaterial: "A chip of mica",
  duration: "Instantaneous",
  save: "Con",
  description: "10-ft. rad all 3d8+1d8/SL Thunder dmg; save halves; nonmagical unattended objects also take dmg",
  descriptionFull: "A sudden loud ringing noise, painfully intense, erupts from a point of your choice within range. Each creature in a 10-foot-radius sphere centered on that point must make a Constitution saving throw. A creature takes 3d8 thunder damage on a failed save, or half as much damage on a successful one. A creature made of inorganic material such as stone, crystal, or metal has disadvantage on this saving throw." + "\n   " + "A nonmagical object that isn't being worn or carried also takes the damage if it's in the spell's area." + AtHigherLevels + "When you cast this spell using a spell slot of or higher, the damage increases by 1d8 for each slot level above 2nd."
});
legacySpellRefactor("shield", {
  name: "Shield",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 316]],
  level: 1,
  school: "Abjur",
  time: "1 rea",
  timeFull: "1 reaction, which you take when you are hit by an attack or targeted by the magic missile spell",
  range: "Self",
  components: "V,S",
  duration: "1 rnd",
  description: "If hit by attack +5 AC until start of next turn; or stop Magic Missile spell from doing any dmg to me",
  descriptionFull: "An invisible barrier of magical force appears and protects you. Until the start of your next turn, you have a +5 bonus to AC, including against the triggering attack, and you take no damage from magic missile."
});
legacySpellRefactor("shield of faith", {
  name: "Shield of Faith",
  classes: ["cleric", "paladin"],
  source: [["PHB2024", 316]],
  level: 1,
  school: "Abjur",
  time: "1 bns",
  range: "60 ft.",
  components: "V,S,M",
  compMaterial: "A prayer scroll",
  duration: "Conc, 10 min",
  description: "1 creature gains +2 AC for the duration",
  descriptionFull: "A shimmering field appears and surrounds a creature of your choice within range, granting it a +2 bonus to AC for the duration."
});
legacySpellRefactor("shillelagh", {
  name: "Shillelagh",
  classes: ["druid"],
  source: [["PHB2024", 316]],
  level: 0,
  school: "Trans",
  time: "1 bns",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "Mistletoe",
  duration: "1 min",
  description: "Club/quarterstaff I hold does 1d8(1d10 at lvl 5/1d12 at lvl 11/2d6 at lvl 17) Bludg. dmg and uses my spellcasting ability modifier instead of Str",
  descriptionShorter: "Club/quarterstaff I hold does 1d8 Bludg. dmg \u0026 uses my spellcasting modifier instead of Str",
  descriptionFull: "The wood of a club or quarterstaff you are holding is imbued with nature's power. For the duration, you can use your spellcasting ability instead of Strength for the attack and damage rolls of melee attacks using that weapon, and the weapon's damage die becomes a d8. The weapon also becomes magical, if it isn't already. The spell ends if you cast it again or if you let go of the weapon."
});
legacySpellRefactor("shining smite", {
  replaces: 'branding smite',
  name: "Shining Smite",
  classes: ["paladin"],
  source: [["PHB2024", 316]],
  level: 2,
  school: "Trans",
  time: "1 bns",
  timeFull: "Bonus Action, which you take immediately after hitting a creature with a Melee weapon or an Unarmed Strike",
  range: "Self",
  components: "V",
  duration: "Conc. up to 1 min",
  description: "",
  descriptionFull: "The target hit by the strike takes an extra 2d6 Radian damage from the attac. Until the spell ends, the target sheds Bright Light in a 5-foot radius, attack rolls against it have Advantage, and it can't benefit from the Invisible condition." + AtHigherLevels + "The damage increases by 1d6 for each spell slot level above 2"
});
legacySpellRefactor("shocking grasp", {
  name: "Shocking Grasp",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 316]],
  level: 0,
  school: "Evoc",
  time: "1 a",
  range: "Touch",
  components: "V,S",
  duration: "Instantaneous",
  description: "Spell attack, adv. if metal armor, 1d8 Lightning dmg, no rea 1 turn; +1d8 at CL 5, 11, and 17",
  descriptionCantripDie: "Spell attack, adv. if metal armor, `CD`d8 Lightning dmg, no rea 1 turn",
  descriptionFull: "Lightning springs from your hand to deliver a shock to a creature you try to touch. Make a melee spell attack against the target. You have advantage on the attack roll if the target is wearing armor made of metal. On a hit, the target takes 1d8 lightning damage, and it can't take reactions until the start of its next turn." + "\n   " + "The spell's damage increases by 1d8 when you reach 5th level (2d8), 11th level (3d8), and 17th level (4d8)."
});
legacySpellRefactor("silence", {
  name: "Silence",
  classes: ["bard", "cleric", "ranger"],
  source: [["PHB2024", 316]],
  ritual: true,
  level: 2,
  school: "Illus",
  time: "1 a",
  range: "120 ft.",
  components: "V,S",
  duration: "Conc, 10 min",
  description: "20-ft. rad no sound propagates; all within deafened, immune to Thunder dmg, can't use verbal comp.",
  descriptionFull: "For the duration, no sound can be created within or pass through a 20-foot-radius sphere centered on a point you choose within range. Any creature or object entirely inside the sphere is immune to thunder damage, and creatures are deafened while entirely inside it. Casting a spell that includes a verbal component is impossible there."
});
legacySpellRefactor("silent image", {
  name: "Silent Image",
  classes: ["bard", "sorcerer", "wizard"],
  source: [["PHB2024", 317]],
  level: 1,
  school: "Illus",
  time: "1 a",
  range: "60 ft.",
  components: "V,S,M",
  compMaterial: "A bit of fleece",
  duration: "Conc, 10 min",
  description: "15-ft. cube illusion includes visible; 1 a move it; Int(Investigation) check vs. spell DC; see book",
  descriptionFull: "You create the image of an object, a creature, or some other visible phenomenon that is no larger than a 15-foot cube. The image appears at a spot within range and lasts for the duration. The image is purely visual, it isn't accompanied by sound, smell, or other sensory effects." + "\n   " + "You can use your action to cause the image to move to any spot within range. As the image changes location, you can alter its appearance so that its movements appear natural for the image. For example, if you create an image of a creature and move it, you can alter the image so that it appears to be walking." + "\n   " + "Physical interaction with the image reveals it to be an illusion, because things can pass through it. A creature that uses its action to examine the image can determine that it is an illusion with a successful Intelligence (Investigation) check against your spell save DC. If a creature discerns the illusion for what it is, the creature can see through the image."
});
legacySpellRefactor("simulacrum", {
  name: "Simulacrum",
  classes: ["wizard"],
  source: [["PHB2024", 317]],
  level: 7,
  school: "Illus",
  time: "12 h",
  range: "Touch",
  components: "V,S,M\u2020",
  compMaterial: "Powdered ruby worth 1500+ gp, which the spell consumes",
  duration: "Until dispelled",
  description: "Create snow/ice duplicate of humanoid/beast; follows my verbal commands; see B (1500gp cons.)",
  descriptionFull: "You shape an illusory duplicate of one beast or humanoid that is within range for the entire casting time of the spell. The duplicate is a creature, partially real and formed from ice or snow, and it can take actions and otherwise be affected as a normal creature. It appears to be the same as the original, but it has half the creature's hit point maximum and is formed without any equipment. Otherwise, the illusion uses all the statistics of the creature it duplicates, except that it is a construct." + "\n   " + "The simulacrum is friendly to you and creatures you designate. It obeys your spoken commands, moving and acting in accordance with your wishes and acting on your turn in combat. The simulacrum lacks the ability to learn or become more powerful, so it never increases its level or other abilities, nor can it regain expended spell slots." + "\n   " + "If the simulacrum is damaged, you can repair it in an alchemical laboratory, using rare herbs and minerals worth 100 gp per hit point it regains. The simulacrum lasts until it drops to 0 hit points, at which point it reverts to snow and melts instantly." + "\n   " + "If you cast this spell again, any currently active duplicates you created with this spell are instantly destroyed."
});
legacySpellRefactor("sleep", {
  name: "Sleep",
  classes: ["bard", "sorcerer", "wizard"],
  source: [["PHB2024", 317]],
  level: 1,
  school: "Ench",
  time: "1 a",
  range: "60 ft.",
  components: "V,S,M",
  compMaterial: "A pinch of sand or rose petals",
  duration: "1 min",
  description: "5-ft. rad Wis save, or have Incap. end of next turn Wis save, or Unconscious for duration",
  descriptionFull: "Each creature of your choice in a 5-foot-radius Sphere centered on a point within range must succeed on a Wisdom saving throw or have the Incapacitated condition until the end of its next turn, at which point it must repeat the save. If the target fails the second save, the target has the Unconscious condition for the duration. The spell ends on a target if it takes damage or someone within 5 feet of it takes an action to shake it out of the spell's effect." + "\n   " + "Creatures that don't sleep, such as elves, or that have Immunity to the Exhaustion condition automatically succeed on saves against this spell."
});
legacySpellRefactor("sleet storm", {
  name: "Sleet Storm",
  classes: ["druid", "sorcerer", "wizard"],
  source: [["PHB2024", 317]],
  level: 3,
  school: "Conj",
  time: "1 a",
  range: "150 ft.",
  components: "V,S,M",
  compMaterial: "A miniature umbrella",
  duration: "Conc, 1 min",
  save: "Dex",
  description: "40-ft. rad 20-ft. high; heavily obsc.; douses flames; difficult ter.; save or prone; Con save or lose conc.",
  descriptionFull: "Until the spell ends, freezing rain and sleet fall in a 20-foot-tall cylinder with a 40-foot radius centered on a point you choose within range. The area is heavily obscured, and exposed flames in the area are doused." + "\n   " + "The ground in the area is covered with slick ice, making it difficult terrain. When a creature enters the spell's area for the first time on a turn or starts its turn there, it must make a Dexterity saving throw. On a failed save, it falls prone." + "\n   " + "If a creature starts its turn in the spell's area and is concentrating on a spell, the creature must make a successful Constitution saving throw against your spell save DC or lose concentration"
});
legacySpellRefactor("slow", {
  name: "Slow",
  classes: ["bard", "sorcerer", "wizard"],
  source: [["PHB2024", 318]],
  level: 3,
  school: "Trans",
  time: "1 a",
  range: "120 ft.",
  components: "V,S,M",
  compMaterial: "A drop of molasses",
  duration: "Conc, 1 min",
  save: "Wis",
  description: "6 crea in 40-ft. cube save or half spd, -2 AC, -2 Dex saves, no rea, only 1 a or bns a, 1 atk; see book",
  descriptionFull: "You alter time around up to six creatures of your choice in a 40-foot cube within range. Each target must succeed on a Wisdom saving throw or be affected by this spell for the duration." + "\n   " + "An affected target's speed is halved, it takes a -2 penalty to AC and Dexterity saving throws, and it can't use reactions. On its turn, it can use either an action or a bonus action, not both. Regardless of the creature's abilities or magic items, it can't make more than one melee or ranged attack during its turn." + "\n   " + "If the creature attempts to cast a spell with a casting time of 1 action, roll a d20. On an 11 or higher, the spell doesn't take effect until the creature's next turn, and the creature must use its action on that turn to complete the spell. If it can't, the spell is wasted." + "\n   " + "A creature affected by this spell makes another Wisdom saving throw at the end of each of its turns. On a successful save, the effect ends for it."
});
legacySpellRefactor("sorcerous burst", {
  name: "Sorcerous Burst",
  classes: ["sorcerer"],
  source: [["PHB2024", 318]],
  level: 0,
  school: "Evoc",
  time: "1 a",
  range: "120 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "Spell atk 1 crea 1d8 (Acid/Cold/Fire/Lightn/Pois/Psy/Thund) dmg; if you roll an 8 add 1d8 dmg(you can add a number of d8's equal to spell mod); +1d8 at CL 5, 11, and 17",
  descriptionCantripDie: "Spell atk 1 crea `CD`d8 (Acid/Cold/Fire/Lightn/Pois/Psy/Thund) dmg; if you roll an 8 add 1d8 dmg(you can add a number of d8's equal to spell mod)",
  descriptionFull: "You cast sorcerous energy at one creature or object within range. Make a ranged attack roll against the target. On a hit, the target takes 1d8 damage of a type you choose: Acid, Cold, Fire, Lighting, Poison, Psychic, or Thunder." + "\n   " + "If you roll an 8 on the d8 for this spell, you can roll another d8, and add it to the damage. When you cast this spell, the maximum number of these d8s you can add to the spell's damage equals your spellcasting ability modifier." + "\n   " + "Cantrip Upgrade. The damage increases by 1d8 when you reach 5th level (2d8), 11th level (3d8), and 17th level (4d8)."
});
legacySpellRefactor("spare the dying", {
  name: "Spare the Dying",
  classes: ["cleric", "druid"],
  source: [["PHB2024", 318]],
  level: 0,
  school: "Necro",
  time: "1 a",
  range: "15 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "1 living creature with 0 current HP becomes stable",
  descriptionFull: "You touch a living creature that has 0 hit points. The creature becomes stable. This spell has no effect on undead or constructs." + "\n   " + "Cantrip Upgrade. The range doubles when you reach levels 5 (30 ft.), 11 (60 ft.), and 17 (120 ft.)"
});
legacySpellRefactor("speak with animals", {
  name: "Speak with Animals",
  classes: ["bard", "druid", "ranger", "warlock"],
  source: [["PHB2024", 318]],
  ritual: true,
  level: 1,
  school: "Div",
  time: "1 a",
  range: "Self",
  components: "V,S",
  duration: "10 min",
  description: "Speak verbally with and understand beasts for duration; interaction limited by intelligence of beasts",
  descriptionFull: "You gain the ability to comprehend and verbally communicate with beasts for the duration. The knowledge and awareness of many beasts is limited by their intelligence, but at minimum, beasts can give you information about nearby locations and monsters, including whatever they can perceive or have perceived within the past day. You might be able to persuade a beast to perform a small favor for you, at the DM's discretion."
});
legacySpellRefactor("speak with dead", {
  name: "Speak with Dead",
  classes: ["bard", "cleric", "wizard"],
  source: [["PHB2024", 318]],
  level: 3,
  school: "Necro",
  time: "1 a",
  range: "10 ft.",
  components: "V,S,M",
  compMaterial: "Burning incense",
  duration: "10 min",
  description: "1 corpse with mouth answers 5 questions with what it knew in life; can cast on same every 10 days",
  descriptionFull: "You grant the semblance of life and intelligence to a corpse of your choice within range, allowing it to answer the questions you pose. The corpse must still have a mouth and can't be undead. The spell fails if the corpse was the target of this spell within the last 10 days." + "\n   " + "Until the spell ends, you can ask the corpse up to five questions. The corpse knows only what it knew in life, including the languages it knew. Answers are usually brief, cryptic, or repetitive, and the corpse is under no compulsion to offer a truthful answer if you are hostile to it or it recognizes you as an enemy. This spell doesn't return the creature's soul to its body, only its animating spirit. Thus, the corpse can't learn new information, doesn't comprehend anything that has happened since it died, and can't speculate about future events."
});
legacySpellRefactor("speak with plants", {
  name: "Speak with Plants",
  classes: ["bard", "druid", "ranger"],
  source: [["PHB2024", 319]],
  level: 3,
  school: "Trans",
  time: "1 a",
  range: "Self",
  components: "V,S",
  duration: "10 min",
  description: "Speak with plants in range about last 24h events; turn difficult plant terrain to normal or vice versa",
  descriptionFull: "You imbue plants within 30 feet of you with limited sentience and animation, giving them the ability to communicate with you and follow your simple commands. You can question plants about events in the spell's area within the past day, gaining information about creatures that have passed, weather, and other circumstances." + "\n   " + "You can also turn difficult terrain caused by plant growth (such as thickets and undergrowth) into ordinary terrain that lasts for the duration. Or you can turn ordinary terrain where plants are present into difficult terrain that lasts for the duration, causing vines and branches to hinder pursuers, for example." + "\n   " + "Plants might be able to perform other tasks on your behalf, at the DM's discretion. The spell doesn't enable plants to uproot themselves and move about, but they can freely move branches, tendrils, and stalks." + "\n   " + "If a plant creature is in the area, you can communicate with it as if you shared a common language, but you gain no magical ability to influence it." + "\n   " + "This spell can cause the plants created by the entangle spell to release a restrained creature."
});
legacySpellRefactor("spider climb", {
  name: "Spider Climb",
  classes: ["sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 319]],
  level: 2,
  school: "Trans",
  time: "1 a",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "A drop of bitumen and a spider",
  duration: "Conc, 1 h",
  description: "1+1/SL gains climbing speed equal to walking speed; can go on walls and ceilings with hands free",
  descriptionFull: "Until the spell ends, one willing creature you touch gains the ability to move up, down, and across vertical surfaces and upside down along ceilings, while leaving its hands free. The target also gains a climbing speed equal to its walking speed." + AtHigherLevels + "You can target one additional creature for each spell slot above 2"
});
legacySpellRefactor("spike growth", {
  name: "Spike Growth",
  classes: ["druid", "ranger"],
  source: [["PHB2024", 319]],
  level: 2,
  school: "Trans",
  time: "1 a",
  range: "150 ft.",
  components: "V,S,M",
  compMaterial: "Seven thorns",
  duration: "Conc, 10 min",
  description: "20-ft. rad difficult terrain; all 2d4 Piercing dmg per 5 ft. moved; Wis(Perc) vs. Spell DC to recognize",
  descriptionShorter: "20-ft. rad dif. ter.; all 2d4 Piercing dmg per 5 ft. moved; Wis(Perc) vs. Spell DC to recognize",
  descriptionFull: "The ground in a 20-foot radius centered on a point within range twists and sprouts hard spikes and thorns. The area becomes difficult terrain for the duration. When a creature moves into or within the area, it takes 2d4 piercing damage for every 5 feet it travels." + "\n   " + "The transformation of the ground is camouflaged to look natural. Any creature that can't see the area at the time the spell is cast must make a Wisdom (Perception) check against your spell save DC to recognize the terrain as hazardous before entering it."
});
legacySpellRefactor("spirit guardians", {
  name: "Spirit Guardians",
  classes: ["cleric"],
  source: [["PHB2024", 319]],
  level: 3,
  school: "Conj",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "A prayer scroll",
  duration: "Conc, 10 min",
  save: "Wis",
  description: "Undesignated crea start turn/enter in area half speed, 3d8+1d8/SL Radiant/Necrotic dmg; save half",
  descriptionShorter: "Any crea start turn/enter area half speed, 3d8+1d8/SL Radiant/Necrotic dmg; save half",
  descriptionFull: "You call forth spirits to protect you. They flit around you to a distance of 15 feet for the duration. If you are good or neutral, their spectral form appears angelic or fey (your choice). If you are evil, they appear fiendish." + "\n   " + "When you cast this spell, you can designate any number of creatures you can see to be unaffected by it. An affected creature's speed is halved in the area, and when the creature enters the area for the first time on a turn or starts its turn there, it must make a Wisdom saving throw. On a failed save, the creature takes 3d8 radiant damage (if you are good or neutral) or 3d8 necrotic damage (if you are evil). On a successful save, the creature takes half as much damage." + AtHigherLevels + "When you cast this spell using a spell slot of 4th level or higher, the damage increases by 1d8 for each slot level above 3rd.",
  dynamicDamageBonus: {
    multipleDmgTypes: {
      dmgTypes: ["radiant", "necrotic"],
      inDescriptionAs: "Radiant/Necrotic"
    }
  }
});
legacySpellRefactor("spiritual weapon", {
  name: "Spiritual Weapon",
  classes: ["cleric"],
  source: [["PHB2024", 319 - 320]],
  level: 2,
  school: "Evoc",
  time: "1 bns",
  range: "60 ft.",
  components: "V,S",
  duration: "1 min",
  description: "Create weapon; spell atk 1d8+1d8/2SL+ability modifier Force dmg; bns a to move 20 ft. and/or attack",
  descriptionShorter: "Create wea; spell atk 1d8+1d8/2SL+spell modifier Force dmg; bns a move 20 ft. and/or atk",
  descriptionFull: "You create a floating, spectral weapon within range that lasts for the duration or until you cast this spell again. When you cast the spell, you can make a melee spell attack against a creature within 5 feet of the weapon. On a hit, the target takes force damage equal to 1d8 + your spellcasting ability modifier." + "\n   " + "As a bonus action on your turn, you can move the weapon up to 20 feet and repeat the attack against a creature within 5 feet of it." + "\n   " + "The weapon can take whatever form you choose. Clerics of deities who are associated with a particular weapon (as St. Cuthbert is known for his mace and Thor for his hammer) make this spell's effect resemble that weapon." + AtHigherLevels + "When you cast this spell using a spell slot 3rd level of or higher, the damage increases by 1d8 for every two slot levels above the 2nd."
});
legacySpellRefactor("staggering smite", {
  name: "Staggering Smite",
  classes: ["paladin"],
  source: [["PHB2024", 320]],
  level: 4,
  school: "Ench",
  time: "1 bns",
  timeFull: "Bonus Action, which you take immediately after hitting a creature with a Melee weapon or an Unarmed Strike.",
  range: "Self",
  components: "V",
  duration: "Instantaneous",
  save: "Wis",
  description: "On melee weapon hit 4d6+1/SL Psychic dmg and save or stunned, until end next turn",
  descriptionFull: "The target takes an extra 4d6 Psychic damage from the attack, and the target must succeed on a Wisdom saving throw or have the Stunned condition until the end of your next turn." + AtHigherLevels + "The extra damage increases by 1d6 for each spell slot level above 4."
});
legacySpellRefactor("starry wisp", {
  name: "Starry Wisp",
  classes: ["bard", "druid"],
  source: [["PHB2024", 320]],
  level: 0,
  school: "Evoc",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "Instantaneous",
  description: "Spell atk 1 crea 1d8 Radiant dmg and emit dim light in a 10ft rad. can't benefit from Invis.; +1d8 at CL 5, 11, and 17",
  descriptionCantripDie: "Spell atk 1 crea `CD`d8 Radiant dmg and emit dim light in a 10ft rad. can't benefit from Invis.",
  descriptionFull: "You launch a mote of light at one creature or object within range. Make a ranged spell attack against the target. On a hit, the target takes 1d8 Radiant damage, and until the end of your next turn, it emits Dim light in a 10-foot radius and can't benefit from the Invisible condition." + "\n   " + "Cantrip Upgrade. The damage increases by 1d8 when you reach 5th level (2d8), 11th level (3d8), and 17th level (4d8)."
});
legacySpellRefactor("steel wind strike", {
  name: "Steel Wind Strike",
  classes: ["ranger", "wizard"],
  source: [["PHB2024", 320]],
  level: 5,
  school: "Conj",
  time: "1 a",
  range: "30 ft.",
  components: "S,M\u0192",
  compMaterial: "A melee weapon worth 1+ sp",
  duration: "Instantaneous",
  description: "Melee spell attack vs. 5 crea in range; 6d10 Force dmg on hit; after, I teleport next to one target",
  descriptionFull: "You flourish the weapon used in the casting and then vanish to strike like the wind. Choose up to five creatures you can see within range. Make a melee spell attack against each target. On a hit, a target takes 6d10 force damage." + "\n   " + "You can then teleport to an unoccupied space you can see within 5 feet of one of the targets you hit or missed."
});
legacySpellRefactor("stinking cloud", {
  name: "Stinking Cloud",
  classes: ["bard", "sorcerer", "wizard"],
  source: [["PHB2024", 321]],
  level: 3,
  school: "Conj",
  time: "1 a",
  range: "90 ft.",
  components: "V,S,M",
  compMaterial: "A rotten egg",
  duration: "Conc, 1 min",
  save: "Con",
  description: "20-ft. rad; ignores cover, heavily obscures; all in area at start of turn save against poison or can't act",
  descriptionFull: "You create a 20-foot-radius sphere of yellow, nauseating gas centered on a point within range. The cloud spreads around corners, and its area is heavily obscured. The cloud lingers in the air for the duration." + "\n   " + "Each creature that is completely within the cloud at the start of its turn must make a Constitution saving throw against poison. On a failed save, the creature spends its action that turn retching and reeling. Creatures that don't need to breathe or are immune to poison automatically succeed on this saving throw." + "\n   " + "A moderate wind (at least 10 miles per hour) disperses the cloud after 4 rounds. A strong wind (at least 20 miles per hour) disperses it after 1 round."
});
legacySpellRefactor("stone shape", {
  name: "Stone Shape",
  classes: ["cleric", "druid", "wizard"],
  source: [["PHB2024", 321]],
  level: 4,
  school: "Trans",
  time: "1 a",
  range: "Touch",
  components: "V,S,M",
  compMaterial: "Soft clay",
  duration: "Instantaneous",
  description: "Form 5 cu ft. of stone into any shape; can have up to two hinges and a latch, but no finer mechanisms",
  descriptionFull: "You touch a stone object of Medium size or smaller or a section of stone no more than 5 feet in any dimension and form it into any shape that suits your purpose. So, for example, you could shape a large rock into a weapon, idol, or coffer, or make a small passage through a wall, as long as the wall is less than 5 feet thick. You could also shape a stone door or its frame to seal the door shut. The object you create can have up to two hinges and a latch, but finer mechanical detail isn't possible."
});
legacySpellRefactor("stoneskin", {
  name: "Stoneskin",
  classes: ["druid", "ranger", "sorcerer", "wizard"],
  source: [["PHB2024", 321]],
  level: 4,
  school: "Trans",
  time: "1 a",
  range: "Touch",
  components: "V,S,M\u2020",
  compMaterial: "Diamond dust worth 100+ gp, which the spell consumes",
  duration: "Conc, 1 h",
  description: "1 willing crea resistance to nonmagical Bludgeoning, Piercing, and Slashing dmg (100gp cons.)",
  descriptionFull: "This spell turns the flesh of a willing creature you touch as hard as stone. Until the spell ends, the target has resistance to nonmagical bludgeoning, piercing, and slashing damage."
});
legacySpellRefactor("storm of vengeance", {
  name: "Storm of Vengeance",
  classes: ["druid"],
  source: [["PHB2024", 321]],
  level: 9,
  school: "Conj",
  time: "1 a",
  range: "1 mile",
  components: "V,S",
  duration: "Conc, 1 min",
  save: "Con",
  description: "360-ft. rad all save or 2d6 Thunder dmg and deafened for 5 min; effect changes every round; see book",
  descriptionFull: "A churning storm cloud forms, centered on a point you can see and spreading to a radius of 360 feet. Lightning flashes in the area, thunder booms, and strong winds roar. Each creature under the cloud (no more than 5,000 feet beneath the cloud) when it appears must make a Constitution saving throw. On a failed save, a creature takes 2d6 thunder damage and becomes deafened for 5 minutes." + "\n   " + "Each round you maintain concentration on this spell, the storm produces different effects on your turn." + "\n   " + toUni("Round 2") + ": Acidic rain falls from the cloud. Each creature and object under the cloud takes 1d6 acid damage." + "\n   " + toUni("Round 3") + ": You call six bolts of lightning from the cloud to strike six creatures or objects of your choice beneath the cloud. A given creature or object can't be struck by more than one bolt. A struck creature must make a Dexterity saving throw. The creature takes 10d6 lightning damage on a failed save, or half as much damage on a successful one." + "\n   " + toUni("Round 4") + ": Hailstones rain down from the cloud. Each creature under the cloud takes 2d6 bludgeoning damage." + "\n   " + toUni("Round 5-10") + ": Gusts and freezing rain assail the area under the cloud. the area becomes difficult terrain and is heavily obscured. Each creature there takes 1d6 cold damage. Ranged weapon attacks in the area are impossible. The wind and rain count as a severe distraction for the purposes of maintaining concentration on spells. Finally, gusts of strong wind (ranging from 20 to 50 miles per hour) automatically disperse fog, mists, and similar phenomena in the area whether mundane or magical.",
  dynamicDamageBonus: {multipleDmgMoments: false}
});
legacySpellRefactor("suggestion", {
  name: "Suggestion",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 321]],
  level: 2,
  school: "Ench",
  time: "1 a",
  range: "30 ft.",
  components: "V,M",
  compMaterial: "A drop of honey",
  duration: "Conc, 8 h",
  save: "Wis",
  description: "1 crea save or follow understood reasonable stated course of action; ends if I or allies harm target",
  descriptionFull: "You suggest a course of activity (limited to 25 words) and magically influence a creature you can see within range that can hear and understand you. Creatures that can't be charmed are immune to this effect. The suggestion must be worded in such a manner as to make the course of action sound reasonable. Asking the creature to stab itself, throw itself onto a spear, immolate itself, or do some other obviously harmful act ends the spell." + "\n   " + "The target must make a Wisdom saving throw. On a failed save, it pursues the course of action you described to the best of its ability. The suggested course of action can continue for the entire duration. If the suggested activity can be completed in a shorter time, the spell ends when the subject finishes what it was asked to do." + "\n   " + "You can also specify conditions that will trigger a special activity during the duration. For example, you might suggest that a knight give her warhorse to the first beggar she meets. If the condition isn't met before the spell expires, the activity isn't performed." + "\n   " + "If you or any of your companions damage the target, the spell ends."
});
legacySpellRefactor("summon aberration", {
  name: "Summon Aberration",
  classes: ["warlock", "wizard"],
  source: [["PHB2024", 322]],
  level: 4,
  school: "Conj",
  time: "1 a",
  range: "90 ft.",
  components: "V,S,M\u0192",
  compMaterial: "A pickled tentacle and an eyeball in a platinum-inlaid vial worth 400+ gp",
  duration: "Conc, 1 h",
  description: "Summon choice of Abberant Spirit; obeys commands; takes turn after mine; vanishes at 0 hp (400gp)",
  descriptionFull: "You call forth an aberrant spirit. It manifests in an unoccupied space that you can see within range. This corporeal form uses the Aberrant Spirit stat block. When you cast the spell, choose Beholderkin, Slaad, or Star Spawn. The creature resembles an aberration of that kind, which determines certain traits in its stat block. The creature disappears when it drops to 0 hit points or when the spell ends.\n The creature is an ally to you and your companions. In combat, the creature shares your initiative count, but it takes its turn immediately after yours. It obeys your verbal commands (no action required by you). If you don't issue any, it takes the Dodge action and uses its move to avoid danger." + AtHigherLevels + "When you cast this spell using a spell slot of 5th level or higher, use the higher level wherever the spell's level appears in the stat block."
});
legacySpellRefactor("summon beast", {
  name: "Summon Beast",
  classes: ["druid", "ranger"],
  source: [["PHB2024", 322]],
  level: 2,
  school: "Conj",
  time: "1 a",
  range: "90 ft.",
  components: "V,S,M\u0192",
  compMaterial: "A feather, tuft of fur, and fish tail inside a gilded acorn worth 200+ gp",
  duration: "Conc, 1 h",
  description: "Summon choice of Bestial Spirit; obeys commands; takes turn after mine; disappears at 0 hp (200gp)",
  descriptionFull: "You call forth a bestial spirit. It manifests in an unoccupied space that you can see within range. This corporeal form uses the Bestial Spirit stat block. When you cast the spell, choose an environment: Air, Land, or Water. The creature resembles an animal of your choice that is native to the chosen environment, which determines certain traits in its stat block. The creature disappears when it drops to 0 hit points or when the spell ends.\n The creature is an ally to you and your companions. In combat, the creature shares your initiative count, but it takes its turn immediately after yours. It obeys your verbal commands (no action required by you). If you don't issue any, it takes the Dodge action and uses its move to avoid danger." + AtHigherLevels + "When you cast this spell using a spell slot of 3rd level or higher, use the higher level wherever the spell's level appears in the stat block."
});
legacySpellRefactor("summon celestial", {
  name: "Summon Celestial",
  classes: ["cleric", "paladin"],
  source: [["PHB2024", 323]],
  level: 5,
  school: "Conj",
  time: "1 a",
  range: "90 ft.",
  components: "V,S,M\u0192",
  compMaterial: "A golden reliquary worth 500+ gp",
  duration: "Conc, 1 h",
  description: "Summon choice of Celestial Spirit; obeys commands; takes turn after mine; disappears at 0 hp (500gp)",
  descriptionFull: "You call forth a celestial spirit. It manifests in an angelic form in an unoccupied space that you can see within range. This corporeal form uses the Celestial Spirit stat block. When you cast the spell, choose Avenger or Defender. Your choice determines the creature's attack in its stat block. The creature disappears when it drops to 0 hit points or when the spell ends.\n The creature is an ally to you and your companions. In combat, the creature shares your initiative count, but it takes its turn immediately after yours. It obeys your verbal commands (no action required by you). If you don't issue any, it takes the Dodge action and uses its move to avoid danger." + AtHigherLevels + "When you cast this spell using a spell slot of 5th level or higher, use the higher level wherever the spell's level appears in the stat block."
});
legacySpellRefactor("summon construct", {
  name: "Summon Construct",
  classes: ["wizard"],
  source: [["PHB2024", 324]],
  level: 4,
  school: "Conj",
  time: "1 a",
  range: "90 ft.",
  components: "V,S,M\u0192",
  compMaterial: "A lockbox worth 400+ gp",
  duration: "Conc, 1 h",
  description: "Summon choice of Construct Spirit; obeys commands; takes turn after mine; vanishes at 0 hp (400gp)",
  descriptionFull: "You call forth the spirit of a construct. It manifests in an unoccupied space that you can see within range. This corporeal form uses the Construct Spirit stat block. When you cast the spell, choose a material: Clay, Metal, or Stone. The creature resembles a golem or a modron (your choice) made of the chosen material, which determines certain traits in its stat block. The creature disappears when it drops to 0 hit points or when the spell ends.\n The creature is an ally to you and your companions. In combat, the creature shares your initiative count, but it takes its turn immediately after yours. It obeys your verbal commands (no action required by you). If you don't issue any, it takes the Dodge action and uses its move to avoid danger." + AtHigherLevels + "When you cast this spell using a spell slot of 5th level or higher, use the higher level wherever the spell's level appears in the stat block."
});
legacySpellRefactor("summon dragon", {
  name: "Summon Dragon",
  classes: ["wizard"],
  source: [["PHB2024", 324]],
  level: 5,
  school: "Conj",
  time: "1 a",
  range: "60 ft.",
  components: "V,S,M\u0192",
  compMaterial: "an object with the image of a dragon engraved on it, worth 500+ gp",
  duration: "Conc, 1 h",
  description: "Summon choice of Draconic Spirit; obeys commands; takes turn after mine; vanishes at 0 hp (500gp)",
  descriptionFull: "You call forth a Dragon spirit. It manifests in an unoccupied space that you can see within range and uses the Draconic Spirit stat block. The creature disappears when it drops to 0 hit points or when the spell ends." +
    "\n The creature is an ally to you and your companions. In combat, the creature shares your initiative count, but it takes its turn immediately after yours. It obeys your verbal commands (no action required by you). If you don't issue any, it takes the Dodge action and uses its move to avoid danger." +
    AtHigherLevels + "When you cast this spell using a spell slot of 6th level or higher, use the higher level wherever the spell's level appears in the stat block.",
});
legacySpellRefactor("summon elemental", {
  name: "Summon Elemental",
  classes: ["druid", "ranger", "wizard"],
  source: [["PHB2024", 325]],
  level: 4,
  school: "Conj",
  time: "1 a",
  range: "90 ft.",
  components: "V,S,M\u0192",
  compMaterial: "Air, a pebble, ash, and water inside a gold-inlaid vial worth 400+ gp",
  duration: "Conc, 1 h",
  description: "Summon choice of Elemental Spirit; obeys commands; takes turn after mine; vanishes at 0 hp (400gp)",
  descriptionFull: "You call forth an elemental spirit. It manifests in an unoccupied space that you can see within range. This corporeal form uses the Elemental Spirit stat block. When you cast the spell, choose an element: Air, Earth, Fire, or Water. The creature resembles a bipedal form wreathed in the chosen element, which determines certain traits in its stat block. The creature disappears when it drops to 0 hit points or when the spell ends.\n The creature is an ally to you and your companions. In combat, the creature shares your initiative count, but it takes its turn immediately after yours. It obeys your verbal commands (no action required by you). If you don't issue any, it takes the Dodge action and uses its move to avoid danger." + AtHigherLevels + "When you cast this spell using a spell slot of 5th level or higher, use the higher level wherever the spell's level appears in the stat block."
});
legacySpellRefactor("summon fey", {
  name: "Summon Fey",
  classes: ["druid", "ranger", "warlock", "wizard"],
  source: [["PHB2024", 326]],
  level: 3,
  school: "Conj",
  time: "1 a",
  range: "90 ft.",
  components: "V,S,M\u0192",
  compMaterial: "A gilded flower worth 300+ gp",
  duration: "Conc, 1 h",
  description: "Summon choice of Fey Spirit; obeys commands; takes turn after mine; disappears at 0 hp (300gp)",
  descriptionFull: "You call forth a fey spirit. It manifests in an unoccupied space that you can see within range. This corporeal form uses the Fey Spirit stat block. When you cast the spell, choose a mood: Fuming, Mirthful, or Tricksy. The creature resembles a fey creature of your choice marked by the chosen mood, which determines one of the traits in its stat block. The creature disappears when it drops to 0 hit points or when the spell ends.\n The creature is an ally to you and your companions. In combat, the creature shares your initiative count, but it takes its turn immediately after yours. It obeys your verbal commands (no action required by you). If you don't issue any, it takes the Dodge action and uses its move to avoid danger." + AtHigherLevels + "When you cast this spell using a spell slot of 4th level or higher, use the higher level wherever the spell's level appears in the stat block."
});
legacySpellRefactor("summon fiend", {
  name: "Summon Fiend",
  classes: ["warlock", "wizard"],
  source: [["PHB2024", 326]],
  level: 6,
  school: "Conj",
  time: "1 a",
  range: "90 ft.",
  components: "V,S,M\u0192",
  compMaterial: "A bloody vial worth 600+ gp",
  duration: "Conc, 1 h",
  description: "Summon choice of Fiendish Spirit; obeys commands; takes turn after mine; disappears at 0 hp (500gp)",
  descriptionFull: "You call forth a fiendish spirit. It manifests in an unoccupied space that you can see within range. This corporeal form uses the Fiendish Spirit stat block. When you cast the spell, choose Demon, Devil, or Yugoloth. The creature resembles a fiend of the chosen type, which determines certain traits in its stat block. The creature disappears when it drops to 0 hit points or when the spell ends.\n The creature is an ally to you and your companions. In combat, the creature shares your initiative count, but it takes its turn immediately after yours. It obeys your verbal commands (no action required by you). If you don't issue any, it takes the Dodge action and uses its move to avoid danger." + AtHigherLevels + "When you cast this spell using a spell slot of 5th level or higher, use the higher level wherever the spell's level appears in the stat block."
});
legacySpellRefactor("summon undead", {
  name: "Summon Undead",
  classes: ["warlock", "wizard"],
  source: [["PHB2024", 328]],
  level: 3,
  school: "Necro",
  time: "1 a",
  range: "90 ft.",
  components: "V,S,M\u0192",
  compMaterial: "A gilded skull worth 300+ gp",
  duration: "Conc, 1 h",
  description: "Summon choice of Undead Spirit; obeys commands; takes turn after mine; disappears at 0 hp (300gp)",
  descriptionFull: "You call forth an undead spirit. It manifests in an unoccupied space that you can see within range. This corporeal form uses the Undead Spirit stat block. When you cast the spell, choose the creature's form: Ghostly, Putrid, or Skeletal. The spirit resembles an undead creature with the chosen form, which determines certain traits in its stat block. The creature disappears when it drops to 0 hit points or when the spell ends.\n The creature is an ally to you and your companions. In combat, the creature shares your initiative count, but it takes its turn immediately after yours. It obeys your verbal commands (no action required by you). If you don't issue any, it takes the Dodge action and uses its move to avoid danger." + AtHigherLevels + "When you cast this spell using a spell slot of 5th level or higher, use the higher level wherever the spell's level appears in the stat block."
});
legacySpellRefactor("sunbeam", {
  name: "Sunbeam",
  classes: ["cleric", "druid", "sorcerer", "wizard"],
  source: [["PHB2024", 329]],
  level: 6,
  school: "Evoc",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  compMaterial: "A magnifying glass",
  duration: "Conc, 1 min",
  save: "Con",
  description: "60-ft. long 5-ft. wide all 6d8 Radiant dmg, 1 rnd blind; save halves and not blinded; 1 a for new line",
  descriptionShorter: "60-ft. long 5-ft. wide all 6d8 Radiant dmg, 1 rnd blind; save half, not blind; 1 a for new line",
  descriptionFull: "A beam of brilliant light flashes out from your hand in a 5-foot-wide, 60-foot-line. Each creature in the line must make a Constitution saving throw. On a failed save, a creature takes 6d8 radiant damage and is blinded until your next turn. On a successful save, it takes half as much damage and isn't blinded by this spell. Undead and oozes have disadvantage on this saving throw." + "\n   " + "You can create a new line of radiance as your action on any turn until the spell ends." + "\n   " + "For the duration, a mote of brilliant radiance shines in your hand. It sheds bright light in a 30-foot radius and dim light for an additional 30 feet. The light is sunlight.",
  dynamicDamageBonus: {multipleDmgMoments: false}
});
legacySpellRefactor("sunburst", {
  name: "Sunburst",
  classes: ["cleric", "druid", "sorcerer", "wizard"],
  source: [["PHB2024", 329]],
  level: 8,
  school: "Evoc",
  time: "1 a",
  range: "150 ft.",
  components: "V,S,M",
  compMaterial: "A piece of sunstone",
  duration: "Instantaneous",
  save: "Con",
  description: "60-ft. rad all 12d6 Radiant dmg, 1 min blind; save halves and not blinded; save at end of each turn",
  descriptionFull: "Brilliant sunlight flashes in a 60-foot radius centered on a point you choose within range. Each creature in that light must make a Constitution saving throw. On a failed save, a creature takes 12d6 radiant damage and is blinded for 1 minute. On a successful save, it takes half as much damage and isn't blinded by this spell. Undead and oozes have disadvantage on this saving throw." + "\n   " + "A creature blinded by this spell makes another Constitution saving throw at the end of each of its turns. On a successful save, it is no longer blinded." + "\n   " + "This spell dispels any darkness in its area that was created by a spell."
});
legacySpellRefactor("swift quiver", {
  name: "Swift Quiver",
  classes: ["ranger"],
  source: [["PHB2024", 329]],
  level: 5,
  school: "Trans",
  time: "1 bns",
  range: "Self",
  components: "V,S,M",
  compMaterial: "A quiver worth 1+ gp",
  duration: "Conc, 1 min",
  description: "Quiver gives nonmagical ammo; bns a to make 2 atks with weapon that uses ammo from that quiver",
  descriptionFull: "You transmute your quiver so it produces an endless supply of nonmagical ammunition, which seems to leap into your hand when you reach for it." + "\n   " + "On each of your turns until the spell ends, you can use a bonus action to make two attacks with a weapon that uses ammunition from the quiver. Each time you make such a ranged attack, your quiver magically replaces the piece of ammunition you used with a similar piece of nonmagical ammunition. Any pieces of ammunition created by this spell disintegrate when the spell ends. If the quiver leaves your possession, the spell ends."
});
legacySpellRefactor("symbol", {
  name: "Symbol",
  classes: ["bard", "cleric", "druid", "wizard"],
  source: [["PHB2024", 329]],
  level: 7,
  school: "Abjur",
  time: "1 min",
  range: "Touch",
  components: "V,S,M\u2020",
  compMaterial: "Powdered diamond worth 1,000+ gp, which the spell consumes",
  duration: "Until triggered",
  description: "Inscribe a glyph to activate for chosen effect on set trigger; see book (1000gp cons.)",
  descriptionFull: "When you cast this spell, you inscribe a harmful glyph either on a surface (such as a section of floor, a wall, or a table) or within an object that can be closed to conceal the glyph (such as a book, a scroll, or a treasure chest). If you choose a surface, the glyph can cover an area of the surface no larger than 10 feet in diameter. If you choose an object, that object must remain in its place, if the object is moved more than 10 feet from where you cast this spell, the glyph is broken, and the spell ends without being triggered." + "\n   " + "The glyph is nearly invisible, requiring an Intelligence (Investigation) check against your spell save DC to find it." + "\n   " + "You decide what triggers the glyph when you cast the spell. For glyphs inscribed on a surface, the most typical triggers include touching or stepping on the glyph, removing another object covering it, approaching within a certain distance of it, or manipulating the object that holds it. For glyphs inscribed within an object, the most common triggers are opening the object, approaching within a certain distance of it, or seeing or reading the glyph." + "\n   " + "You can further refine the trigger so the spell is activated only under certain circumstances or according to a creature's physical characteristics (such as height or weight), or physical kind (for example, the ward could be set to affect hags or shapechangers). You can also specify creatures that don't trigger the glyph, such as those who say a certain password." + "\n   " + "When you inscribe the glyph, choose one of the options below for its effect. Once triggered, the glyph glows, filling a 60-foot-radius sphere with dim light for 10 minutes, after which time the spell ends. Each creature in the sphere when the glyph activates is targeted by its effect, as is a creature that enters the sphere for the first time on a turn or ends its turn there." + "\n   " + toUni("Death") + ": Each target must make a Constitution saving throw, taking 10d10 necrotic damage on a failed save, or half as much damage on a successful save." + "\n   " + toUni("Discord") + ": Each target must make a Constitution saving throw. On a failed save, a target bickers and argues with other creatures for 1 minute. During this time, it is incapable of meaningful communication and has disadvantage on attack rolls and ability checks." + "\n   " + toUni("Fear") + ": Each target must make a Wisdom saving throw and becomes frightened for 1 minute on a failed save. While frightened, the target drops whatever it is holding and must move at least 30 feet away from the glyph on each of its turns, if able." + "\n   " + toUni("Hopelessness") + ": Each target must make a Charisma saving throw. On a failed save, the target is overwhelmed with despair for 1 minute. During this time, it can't attack or target any creature with harmful abilities, spells, or other magical effects." + "\n   " + toUni("Insanity") + ": Each target must make an Intelligence saving throw. On a failed save, the target is driven insane for 1 minute. An insane creature can't take actions, can't understand what other creatures say, can't read, and speaks only in gibberish. The DM controls its movement, which is erratic." + "\n   " + toUni("Pain") + ": Each target must make a Constitution saving throw and becomes incapacitated with excruciating pain for 1 minute on a failed save." + "\n   " + toUni("Sleep") + ": Each target must make a Wisdom saving throw and falls unconscious for 10 minutes on a failed save. A creature awakens if it takes damage or if someone uses an action to shake or slap it awake." + "\n   " + toUni("Stunning") + ": Each target must make a Wisdom saving throw and becomes stunned for 1 minute on a failed save."
});
legacySpellRefactor("synaptic static", {
  name: "Synaptic Static",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 330]],
  level: 5,
  school: "Ench",
  time: "1 a",
  range: "120 ft.",
  components: "V,S",
  duration: "Instantaneous",
  save: "Int",
  description: "20-ft. rad all crea Int>2 save or 8d6 Psychic dmg, -1d6 on atks/check/conc. save; save half, no -1d6",
  descriptionShorter: "20-ft. rad all crea Int>2 save or 8d6 Psychic dmg, -1d6 on atk/chk/conc save; save half, no -1d6",
  descriptionFull: "You choose a point within range and cause psychic energy to explode there. Each creature in a 20-foot-radius sphere centered on that point must make an Intelligence saving throw. A creature with an Intelligence score of 2 or lower can't be affected by this spell. A target takes 8d6 psychic damage on a failed save, or half as much damage on a successful one." + "\n   " + "After a failed save, a target has muddled thoughts for 1 minute. During that time, it rolls a d6 and subtracts the number rolled from all its attack rolls and ability checks, as well as its Constitution saving throws to maintain concentration. The target can make an Intelligence saving throw at the end of each of its turns, ending the effect on itself on a success."
});
legacySpellRefactor("tasha's bubbling cauldron", {
  name: "Tasha's Bubbling Cauldron",
  nameAlt: "Bubbling Cauldron",
  classes: ["warlock", "wizard"],
  source: [["PHB2024", 330]],
  level: 6,
  school: "Conj",
  time: "1 a",
  range: "5 ft.",
  components: "V,S,M",
  compMaterial: "A gilded ladle worth 500+ gp",
  duration: "10 min",
  description: "You conjure a cauldron which contains Spell mod number of potions of Common or Uncommon quality that last until consumed or the spell is cast again",
  descriptionFull: "You conjure a claw-footed cauldron filled with bubbling liquid. The cauldron appears in an unoccupied space on the ground within 5 feet of you and lasts for the duration. The cauldron can't be moved and disappears when the spell ends, along with the bubbling liquid inside it." + "\n   " + "The liquid inside the cauldron duplicates the properties of a Common or an Uncommon potion of your choice (such as a Potion of Healing). As a Bonus Action, you or an ally can reach into the cauldron and withdraw one potion of that kind. The potion is contained in a vial that disappears when the potion is consumed. The cauldron can produce a number of these potions equal to your spellcasting ability modifier (minimum 1). When the last of these potions is withdrawn from the cauldron, the cauldron disappears, and the spell ends." + "\n   " + "Potions obtained from the cauldron that aren't consumed disappear when you cast this spell again."
});
legacySpellRefactor("tasha's hideous laughter", {
  name: "Tasha's Hideous Laughter",
  nameAlt: "Hideous Laughter",
  classes: ["bard", "warlock", "wizard"],
  source: [["PHB2024", 331]],
  level: 1,
  school: "Ench",
  time: "1 a",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A tart and a feather",
  duration: "Conc, 1 min",
  save: "Wis",
  description: "1+1/SL crea save or fall prone, incapacitated, can't stand; save end of each turn or if taking dmg",
  descriptionFull: "A creature of your choice that you can see within range perceives everything as hilariously funny and falls into fits of laughter if this spell affects it. The target must succeed on a Wisdom saving throw of fall prone, becoming incapacitated and unable to stand up for the duration." + "\n   " + "At the end of each of its turns, and each time it takes damage, the target can make another Wisdom saving throw. The target has advantage on the saving throw if it's triggered by damage. On a success, the spell ends." + AtHigherLevels + "You can target one additional creature for each spell slot level above 1."
});
legacySpellRefactor("telekinesis", {
  name: "Telekinesis",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 331]],
  level: 5,
  school: "Trans",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "Conc, 10 min",
  description: "Move Huge creature or 1000 lb object 30 ft. as 1 a; spellcasting ability check vs. Str check; see B",
  descriptionFull: "You gain the ability to move or manipulate creatures or objects by thought. When you cast the spell, and as your action each round for the duration, you can exert your will on one creature or object that you can see within range, causing the appropriate effect below. You can affect the same target round after round, or choose a new one at any time. If you switch targets, the prior target is no longer affected by the spell." + "\n   " + toUni("Creature") + ": You can try to move a Huge or smaller creature. Make an ability check with your spellcasting ability contested by the creature's Strength check. If you win the contest, you move the creature up to 30 feet in any direction, including upward but not beyond the range of this spell. Until the end of your next turn, the creature is restrained in your telekinetic grip. A creature lifted upward is suspended in mid-air." + "\n   " + "On subsequent rounds, you can use your action to attempt to maintain your telekinetic grip on the creature by repeating the contest." + "\n   " + toUni("Object") + ": You can try to move an object that weighs up to 1,000 pounds. If the object isn't being worn or carried, you automatically move it up to 30 feet in any direction, but not beyond the range of this spell." + "\n   " + "If the object is worn or carried by a creature, you must make an ability check with your spellcasting ability contested by that creature's Strength check. If you succeed, you pull the object away from that creature and can move it up to 30 feet in any direction but not beyond the range of this spell." + "\n   " + "You can exert fine control on objects with your telekinetic grip, such as manipulating a simple tool, opening a door or a container, stowing or retrieving an item from an open container, or pouring the contents from a vial."
});
legacySpellRefactor("telepathy", {
  name: "Telepathy",
  classes: ["wizard"],
  source: [["PHB2024", 331]],
  level: 8,
  school: "Div",
  time: "1 a",
  range: "Unlimited",
  components: "V,S,M",
  compMaterial: "A pair of linked silver rings",
  duration: "24 h",
  description: "1 willing crea Int>0 and I telepathic link; share words, sensory information if on same plane",
  descriptionFull: "You create a telepathic link between yourself and a willing creature with which you are familiar. The creature can be anywhere on the same plane of existence as you. The spell ends if you or the target are no longer on the same plane." + "\n   " + "Until the spell ends, you and the target can instantaneously share words, images, sounds, and other sensory messages with one another through the link, and the target recognizes you as the creature it is communicating with. The spell enables a creature with an Intelligence score of at least 1 to understand the meaning of your words and take in the scope of any sensory messages you send to it."
});
legacySpellRefactor("teleport", {
  name: "Teleport",
  classes: ["bard", "sorcerer", "wizard"],
  source: [["PHB2024", 331]],
  level: 7,
  school: "Conj",
  time: "1 a",
  range: "10 ft.",
  components: "V",
  duration: "Instantaneous",
  description: "I + 8 willing crea, or an object teleport to a place I know, have seen, or can describe; see book",
  descriptionFull: [
    "This spell instantly transports you and up to eight willing creatures of your choice that you can see within range, or a single object that you can see within range, to a destination you select. If you target an object, it must be able to fit entirely inside a 10-foot cube, and it can't be held or carried by an unwilling creature. The destination you choose must be known to you, and it must be on the same plane of existence as you. Your familiarity with the destination determines whether you arrive there successfully. The DM rolls d100 and consults the table.\n",
    toUni("Familiarity\tMishap\tSimilar\t  Off\t   On"),
    "\t\t\t  " + toUni("Area\tTarget\tTarget"),
    "Permanent Circle\t    -\t    -\t    -\t01-100",
    "Linked Object\t    -\t    -\t    -\t01-100",
    "Very Familiar\t01-05\t06-13\t14-24\t25-100",
    "Seen Casually\t01-33\t34-43\t44-53\t54-100",
    "Viewed Once\t01-43\t44-53\t54-73\t74-100",
    "Description\t01-43\t44-53\t54-73\t74-100",
    "False Description\t01-50\t51-100\t    -\t    -\n"
  ].join("\n") + desc([
    toUni("Familiarity") + ": \"Permanent Circle\" means a permanent teleportation circle whose sigil sequence you know. \"Linked Object\" means that you possess an object taken from the desired destination within the last six months, such as a book from a wizard's library, bed linen from a royal suite, or a chunk of marble from a Lich's secret tomb.",
    "\"Very Familiar\" is a place you have been very often, a place you have carefully studied, or a place you can see when you cast the spell. \"Seen Casually\" is some place you have seen more than once but with which you aren't very familiar. \"Viewed Once\" is a place you have seen once, possibly using magic. \"Description\" is a place whose location and appearance you know through someone else's description, perhaps from a map.",
    "\"False Description\" is a place that doesn't exist. Perhaps you tried to scry an enemy's sanctum but instead viewed an illusion, or you are attempting to teleport to a familiar location that no longer exists.",
    toUni("On Target") + ": You and your group (or the target object) appear where you want to go.",
    toUni("Off Target") + ": You and your group (or the target object) appear a random distance away from the destination in a random direction. Distance off target is 1d10 \xD7 1d10 percent of the distance that was to be traveled. For example, if you tried to travel 120 miles, landed off target, and rolled a 5 and 3 on the two d10s, then you would be off target by 15 percent, or 18 miles. The DM determines the direction off target randomly by rolling a d8 and designating 1 as north, 2 as north-east, 3 as east, and so on around the points of the compass. If you were teleporting to a coastal city and wound up 18 miles out at sea, you could be in trouble.",
    toUni("Similar Area") + ": You and your group (or the target object) wind up in a different area that's visually or thematically similar to the target area. If you are heading for your home laboratory, for example, you might wind up in another wizard's laboratory or in an alchemical supply shop that has many of the same tools and implements as your laboratory. Generally, you appear in the closest similar place, but since the spell has no range limit, you could conceivably wind up anywhere on the plane.",
    toUni("Mishap") + ": The spell's unpredictable magic results in a difficult journey. Each teleporting creature (or the target object) takes 3d10 force damage and the DM rerolls on the table to see where you wind up (multiple mishaps can occur, dealing damage each time)."
  ])
});
legacySpellRefactor("teleportation circle", {
  name: "Teleportation Circle",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 332]],
  level: 5,
  school: "Conj",
  time: "1 min",
  range: "10 ft.",
  components: "V,M\u2020",
  compMaterial: "Rare inks worth 50+ gp, which the spell consumes",
  duration: "1 rnd",
  description: "Create a circle to teleport to another teleportation circle on same plane; see book (50gp cons.)",
  descriptionFull: "As you cast the spell, you draw a 10-foot-diameter circle on the ground inscribed with sigils that link your location to a permanent teleportation circle of your choice whose sigil sequence you know and that is on the same plane of existence as you. A shimmering portal opens within the circle you drew and remains open until the end of your next turn. Any creature that enters the portal instantly appears within 5 feet of the destination circle or in the nearest unoccupied space if that space is occupied." + "\n   " + "Many major temples, guilds, and other important places have permanent teleportation circles inscribed somewhere within their confines. Each such circle includes a unique sigil sequence - a string of magical runes arranged in a particular pattern. When you first gain the ability to cast this spell, you learn the sigil sequences for two destinations on the Material Plane, determined by the DM. You can learn additional sigil sequences during your adventures. You can commit a new sigil sequence to memory after studying it for 1 minute." + "\n   " + "You can create a permanent teleportation circle by casting this spell in the same location every day for one year. You need not use the circle to teleport when you cast the spell in this way."
});
legacySpellRefactor("tenser's floating disk", {
  name: "Tenser's Floating Disk",
  nameAlt: "Floating Disk",
  classes: ["wizard"],
  source: [["PHB2024", 332]],
  ritual: true,
  level: 1,
  school: "Conj",
  time: "1 a",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A drop of mercury",
  duration: "1 h",
  description: "Create a 3 ft. diameter disk that carries 500 lb and follows me if I move more than 20 ft. away",
  descriptionFull: "This spell creates a circular, horizontal plane of force, 3 feet in diameter and 1 inch thick, that floats 3 feet above the ground in an unoccupied space of your choice that you can see within range. The disk remains for the duration, and can hold up to 500 pounds. If more weight is placed on it, the spell ends, and everything on the disk falls to the ground." + "\n   " + "The disk is immobile while you are within 20 feet of it. If you move more than 20 feet away from it, the disk follows you so that it remains within 20 feet of you. It can move across uneven terrain, up or down stairs, slopes and the like, but it can't cross an elevation change of 10 feet or more. For example, the disk can't move across a 10-foot-deep pit, nor could it leave such a pit if it was created at the bottom." + "\n   " + "If you move more than 100 feet from the disk (typically because it can't move around an obstacle to follow you), the spell ends."
});
legacySpellRefactor("thaumaturgy", {
  name: "Thaumaturgy",
  classes: ["cleric"],
  source: [["PHB2024", 333]],
  level: 0,
  school: "Trans",
  time: "1 a",
  range: "30 ft.",
  components: "V",
  duration: "1 min (D)",
  description: "Minor wonder; my voice booms, flames flicker, tremors in the ground, ominous sounds, etc.",
  descriptionFull: "You manifest a minor wonder, a sign of supernatural power, within range. You create one of the following magical effects within range." + "\n " + "\u2022 Your voice booms up to three times as loud as normal for 1 minute." + "\n " + "\u2022 You cause flames to flicker, brighten, dim, or change color for 1 minute." + "\n " + "\u2022 You cause harmless tremors in the ground for 1 minute." + "\n " + "\u2022 You create an instantaneous sound that originates from a point of your choice within range, such as a rumble of thunder, the cry of a raven, or ominous whispers." + "\n " + "\u2022 You instantaneously cause an unlocked door or window to fly open or slam shut." + "\n " + "\u2022 You alter the appearance of your eyes for 1 minute." + "\n\n" + "If you cast this spell multiple times, you can have up to three of its 1-minute effects active at a time, and you can dismiss such an effect as an action."
});
legacySpellRefactor("thorn whip", {
  name: "Thorn Whip",
  classes: ["druid"],
  source: [["PHB2024", 333]],
  level: 0,
  school: "Trans",
  time: "1 a",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "The stem of a plant with thorns",
  duration: "Instantaneous",
  description: "Melee spell atk for 1d6 Piercing dmg and pull crea up to 10 ft. towards me; +1d6 at CL 5, 11, and 17",
  descriptionCantripDie: "Melee spell attack for `CD`d6 Piercing dmg and pull crea up to 10 ft. towards me",
  descriptionFull: "You create a long, vine-like whip covered in thorns that lashes out at your command toward a creature in range. Make a melee spell attack against the target. If the attack hits, the creature takes 1d6 piercing damage, and if the creature is Large or smaller, you pull the creature up to 10 feet closer to you." + "\n   " + "This spell's damage increases by 1d6 when you reach 5th level (2d6), 11th level (3d6), and 17th level (4d6)."
});
legacySpellRefactor("thunderclap", {
  name: "Thunderclap",
  classes: ["bard", "druid", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 333]],
  level: 0,
  school: "Evoc",
  time: "1 a",
  range: "Self",
  components: "S",
  duration: "Instantaneous",
  save: "Con",
  description: "100-ft. rad audible; all crea but me in area save or 1d6 Thunder dmg; +1d6 at CL 5, 11, and 17",
  descriptionCantripDie: "100-ft. rad audible; all crea but me in area save or `CD`d6 Thunder dmg",
  descriptionFull: "You create a burst of thunderous sound that can be heard up to 100 feet away. Each creature within range, other than you, must succeed on a Constitution saving throw or take 1d6 thunder damage." + "\n   " + "The spell's damage increases by 1d6 when you reach 5th level (2d6), 11th level (3d6), and 17th level (4d6)."
});
legacySpellRefactor("thunderous smite", {
  name: "Thunderous Smite",
  classes: ["paladin"],
  source: [["PHB2024", 334]],
  level: 1,
  school: "Evoc",
  time: "1 bns",
  timeFull: "Bonus Action, which you take immediately after hitting a target with a Melee weapon or an Unarmed Strike",
  range: "Self",
  components: "V",
  duration: "Instantaneous",
  save: "Str",
  description: "On melee weapon hit +2d6+1d6/SL Thunder dmg and save or 10 ft. push and prone; audible in 300 ft.",
  descriptionFull: "The first time you hit with a melee weapon attack during this spell's duration, your weapon rings with thunder that is audible within 300 feet of you, and the attack deals an extra 2d6 thunder damage to the target. Additionally, if the target is a creature, it must succeed on a Strength saving throw or be pushed 10 feet away from you and knocked prone." + AtHigherLevels + "The damage increases by 1d6 for each spell slot level above 1."
});
legacySpellRefactor("thunderwave", {
  name: "Thunderwave",
  classes: ["bard", "druid", "sorcerer", "wizard"],
  source: [["PHB2024", 334]],
  level: 1,
  school: "Evoc",
  time: "1 a",
  range: "Self",
  components: "V,S",
  duration: "Instantaneous",
  save: "Con",
  description: "All crea/obj in area 2d8+1d8/SL Thunder dmg, pushed 10 ft. away; save halves and not pushed",
  descriptionFull: "A wave of thunderous force sweeps out from you. Each creature in a 15-foot cube originating from you must make a Constitution saving throw. On a failed save, a creature takes 2d8 thunder damage and is pushed 10 feet away from you. On a successful save, the creature takes half as much damage and isn't pushed." + "\n   " + "In addition, unsecured objects that are completely within the area of effect are automatically pushed 10 feet away from you by the spell's effect, and the spell emits a thunderous boom audible out to 300 feet." + AtHigherLevels + "When you cast this spell using a spell slot of 2nd level or higher, the damage increases by 1d8 for each slot level above 1st."
});
legacySpellRefactor("time stop", {
  name: "Time Stop",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 334]],
  level: 9,
  school: "Trans",
  time: "1 a",
  range: "Self",
  components: "V",
  duration: "Instantaneous",
  description: "I instantly take 1d4+1 turns; if affecting other creatures or worn or carried object the spell ends",
  descriptionFull: "You briefly stop the flow of time for everyone but yourself. No time passes for other creatures, while you take 1d4+1 turns in a row, during which you can use actions and move as normal." + "\n   " + "This spell ends if one of the actions you use during this period, or any effects that you create during this period, affects a creature other than you or an object being worn or carried by someone other than you. In addition, the spell ends if you move to a place more than 1,000 feet from the location where you cast it."
});
legacySpellRefactor("tongues", {
  name: "Tongues",
  classes: ["bard", "cleric", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 334]],
  level: 3,
  school: "Div",
  time: "1 a",
  range: "Touch",
  components: "V,M",
  compMaterial: "A miniature ziggurat",
  duration: "1 h",
  description: "1 crea understands all spoken languages, all with a language can understand what it means",
  descriptionFull: "This spell grants the creature you touch the ability to understand any spoken language it hears. Moreover, when the target speaks, any creature that knows at least one language and can hear the target understands what it says."
});
legacySpellRefactor("transport via plants", {
  name: "Transport via Plants",
  classes: ["druid"],
  source: [["PHB2024", 334]],
  level: 6,
  school: "Conj",
  time: "1 a",
  range: "10 ft.",
  components: "V,S",
  duration: "1 min",
  description: "For duration all can transport from a Large plant to a plant on the same plane that I have touched",
  descriptionFull: "This spell creates a magical link between a Large or larger inanimate plant within range and another plant, at any distance, on the same plane of existence. You must have seen or touched the destination plant at least once before. For the duration, any creature can step into the target plant and exit from the destination plant by using 5 feet of movement."
});
legacySpellRefactor("tree stride", {
  name: "Tree Stride",
  classes: ["druid", "ranger"],
  source: [["PHB2024", 335]],
  level: 5,
  school: "Conj",
  time: "1 a",
  range: "Self",
  components: "V,S",
  duration: "Conc, 1 min",
  description: "I can teleport 1/rnd for 5 ft. move through a tree to another tree of the same kind within 500 ft.",
  descriptionFull: "You gain the ability to enter a tree and move from inside it to inside another tree of the same kind within 500 feet. Both trees must be living and at least the same size as you. You must use 5 feet of movement to enter a tree. You instantly know the location of all other trees of the same kind within 500 feet and, as part of the move used to enter the tree, can either pass into one of those trees or step out of the tree you're in. You appear in a spot of your choice within 5 feet of the destination tree, using another 5 feet of movement. If you have no movement left, you appear within 5 feet of the tree you entered." + "\n   " + "You can use this transportation ability once per round for the duration. You must end each turn outside a tree."
});
legacySpellRefactor("true polymorph", {
  name: "True Polymorph",
  classes: ["bard", "warlock", "wizard"],
  source: [["PHB2024", 335]],
  level: 9,
  school: "Trans",
  time: "1 a",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A drop of mercury, a dollop of gum arabic, and a wisp of smoke",
  duration: "Conc, 1 h",
  save: "Wis",
  description: "1 crea/obj > 0 HP save or transformed into another crea/obj with equal CR or lower; see book",
  descriptionFull: "Choose one creature or nonmagical object that you can see within range. You transform the creature into a different creature, the creature into a nonmagical object, or the object into a creature (the object must be neither worn nor carried by another creature). The transformation lasts for the duration, or until the target drops to 0 hit points or dies. If you concentrate on this spell for the full duration, the transformation lasts until it is dispelled." + "\n   " + "This spell has no effect on a shapechanger or a creature with 0 hit points. An unwilling creature can make a Wisdom saving throw, and if it succeeds, it isn't affected by this spell." + "\n   " + toUni("Creature into Creature") + ": If you turn a creature into another kind of creature, the new form can be any kind you choose whose challenge rating is equal to or less than the target's (or its level, if the target doesn't have a challenge rating). The target's game statistics, including mental ability scores, are replaced by the statistics of the new form. It retains its alignment and personality." + "\n   " + "The target assumes the hit points of its new form, and when it reverts to its normal form, the creature returns to the number of hit points it had before it transformed. If it reverts as a result of dropping to 0 hit points, any excess damage carries over to its normal form. As long as the excess damage doesn't reduce the creature's normal form to 0 hit points, it isn't knocked unconscious." + "\n   " + "The creature is limited in the actions it can perform by the nature of its new form, and it can't speak, cast spells, or take any other action that requires hands or speech unless its new form is capable of such actions." + "\n   " + "The target's gear melds into the new form. The creature can't activate, use, wield, or otherwise benefit from any of its equipment." + "\n   " + toUni("Object into Creature") + ": You can turn an object into any kind of creature, as long as the creature's size is no larger than the object's size and the creature's challenge rating is 9 or lower. The creature is friendly to you and your companions. It acts on each of your turns. You decide what action it takes and how it moves. The DM has the creature's statistics and resolves all of its actions and movement." + "\n   " + "If the spell becomes permanent, you no longer control the creature. It might remain friendly to you, depending on how you have treated it." + "\n   " + toUni("Creature into Object") + ": If you turn a creature into an object, it transforms along with whatever it is wearing and carrying into that form, as long as the object's size is no larger than the creature's size. The creature's statistics become those of the object, and the creature has no memory of time spent in this form, after the spell ends and it returns to its normal form."
});
legacySpellRefactor("true resurrection", {
  name: "True Resurrection",
  classes: ["cleric", "druid"],
  source: [["PHB2024", 336]],
  level: 9,
  school: "Necro",
  time: "1 h",
  range: "Touch",
  components: "V,S,M\u2020",
  compMaterial: "diamonds worth 25,000+ gp, which the spell consumes",
  duration: "Instantaneous",
  description: "Resurrects a crea that died in the last 200 years to life with new body and full HP; see B (25k gp cons.)",
  descriptionFull: "You touch a creature that has been dead for no longer than 200 years and that died for any reason except old age. If the creature's soul is free and willing, the creature is restored to life with all its hit points." + "\n   " + "This spell closes all wounds, neutralizes any poison, cures all diseases, and lifts any curses affecting the creature when it died. The spell replaces damaged or missing organs and limbs. If the creature was undead, it is restored to its non-undead form." + "\n   " + "The spell can even provide a new body if the original no longer exists, in which case you must speak the creature's name. The creature then appears in an unoccupied space you choose within 10 feet of you."
});
legacySpellRefactor("true seeing", {
  name: "True Seeing",
  classes: ["bard", "cleric", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 336]],
  level: 6,
  school: "Div",
  time: "1 a",
  range: "Touch",
  components: "V,S,M\u2020",
  compMaterial: "Mushroom powder worth 25+ gp, which the spell consumes",
  duration: "1 h",
  description: "1 willing crea gains truesight 120 ft.; see through illusions, hidden doors, ethereal plane (25gp cons.)",
  descriptionFull: "This spell gives the willing creature you touch the ability to see things as they actually are. For the duration, the creature has truesight, notices secret doors hidden by magic, and can see into the Ethereal Plane, all out to a range of 120 feet."
});
legacySpellRefactor("true strike", {
  name: "True Strike",
  classes: ["bard", "sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 336]],
  level: 0,
  school: "Div",
  time: "1 a",
  range: "Self",
  components: "S,M",
  compMaterial: "A weapon with which you have proficiency that is worth 1+ cp",
  duration: "Instantaneous",
  description: "Make an atk roll with the weapon used in casting, use spell mod instead of Str/Dex, can deal Rad dmg, at lvl 5, 11, 17 the atk does extra damage +1d6 per upgrade.",
  descriptionFull: "Guided by a flash of magical insight, you make one attack with the weapon used in the spell's casting. The attack uses your spellcasting ability for the attack and damage roll instead of using Strength or Dexterity. If the attack deals damage, it can be Radiant damage or the weapon's normal damage type (your choice)." + "\n   " + "Cantrip Upgrade. Whether you deal Radiant damage or the weapon's normal damage type, the attack deals extra Radiant damage when you reach levels 5 (1d6), 11 (2d6) , and 17 (3d6)."
});
legacySpellRefactor("tsunami", {
  name: "Tsunami",
  classes: ["druid"],
  source: [["PHB2024", 336]],
  level: 8,
  school: "Conj",
  time: "1 min",
  range: "1 mile",
  components: "V,S",
  duration: "Conc, 6 rnds",
  save: "Str",
  description: "300\xD750\xD7300ft (l\xD7w\xD7h) wall of water moves away at 50 ft./rnd; 6d10 Bludg. dmg; save halves; see B",
  descriptionShorter: "300\xD750\xD7300ft (l\xD7w\xD7h) wave moves away at 50 ft./rnd; 6d10 Bludg. dmg; save half; see B",
  descriptionMetric: "90\xD715\xD790m (l\xD7w\xD7h) wall of water moves away at 15 m/rnd; 6d10 Bludg. dmg; save halves; see B",
  descriptionShorterMetric: "90\xD715\xD790m (l\xD7w\xD7h) wave moves away at 15 m/rnd; 6d10 Bludg. dmg; save half; see B",
  descriptionFull: "A wall of water springs into existence at a point you choose within range. You can make the wall up to 300 feet long, 300 feet high, and 50 feet thick. The wall lasts for the duration." + "\n   " + "When the wall appears, each creature within its area must make a Strength saving throw. On a failed save, a creature takes 6d10 bludgeoning damage, or half as much damage on a successful save." + "\n   " + "At the start of each of your turns after the wall appears, the wall, along with any creatures in it, moves 50 feet away from you. Any Huge or smaller creature inside the wall or whose space the wall enters when it moves must succeed on a Strength saving throw or take 5d10 bludgeoning damage. A creature can take this damage only once per round. At the end of the turn, the wall's height is reduced by 50 feet, and the damage creatures take from the spell on subsequent rounds is reduced by 1d10. When the wall reaches 0 feet in height, the spell ends." + "\n   " + "A creature caught in the wall can move by swimming. Because of the force of the wave, though, the creature must make a successful Strength (Athletics) check against your spell save DC in order to move at all. If it fails the check, it can't move. A creature that moves out of the area falls to the ground."
});
legacySpellRefactor("unseen servant", {
  name: "Unseen Servant",
  classes: ["bard", "warlock", "wizard"],
  source: [["PHB2024", 336]],
  ritual: true,
  level: 1,
  school: "Conj",
  time: "1 a",
  range: "60 ft.",
  components: "V,S,M",
  compMaterial: "A piece of string and a bit of wood",
  duration: "1 h",
  description: "Create a mindless, invisible, shapeless, Medium servant for simple tasks; bns a to mentally command it",
  descriptionFull: "This spell creates an invisible, mindless, shapeless, Medium force that performs simple tasks at your command until the spell ends. The servant springs into existence in an unoccupied space on the ground within range. It has AC 10, 1 hit point, and a Strength of 2, and it can't attack. If it drops to 0 hit points, the spell ends." + "\n   " + "Once on each of your turns as a bonus action, you can mentally command the servant to move up to 15 feet and interact with an object. The servant can perform simple tasks that a human servant could do, such as fetching things, cleaning, mending, folding clothes, lighting fires, serving food, and pouring wine. Once you give the command, the servant performs the task to the best of its ability until it completes the task, then waits for your next command." + "\n   " + "If you command the servant to perform a task that would move it more than 60 feet away from you, the spell ends."
});
legacySpellRefactor("vampiric touch", {
  name: "Vampiric Touch",
  classes: ["sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 337]],
  level: 3,
  school: "Necro",
  time: "1 a",
  range: "Self",
  components: "V,S",
  duration: "Conc, 1 min",
  description: "Spell attack each turn as 1 a for 3d6+1d6/SL Necrotic dmg; I heal half the damage dealt",
  descriptionFull: "The touch of your shadow-wreathed hand can siphon force from others to heal your wounds. Make a melee spell attack against a creature within your reach. On a hit, the target takes 3d6 necrotic damage, and you regain hit points equal to half the amount of necrotic damage dealt. Until the spell ends, you can make the attack again on each of your turns as an action." + AtHigherLevels + "When you cast this spell using a spell slot of 4th level or higher, the damage increases by 1d6 for each slot level above 3rd."
});
legacySpellRefactor("vicious mockery", {
  name: "Vicious Mockery",
  classes: ["bard"],
  source: [["PHB2024", 337]],
  level: 0,
  school: "Ench",
  time: "1 a",
  range: "60 ft.",
  components: "V",
  duration: "Instantaneous",
  save: "Wis",
  description: "1 creature save or 1d6 Psychic dmg and dis. on next attack roll; +1d6 at CL 5, 11, and 17",
  descriptionCantripDie: "1 creature save or `CD`d6 Psychic dmg and dis. on next attack roll",
  descriptionFull: "You unleash a string of insults laced with subtle enchantments at a creature you can see within range. If the target can hear you (thought it need not understand you), it must succeed on a Wisdom saving throw or take 1d6 psychic damage and have disadvantage on the next attack roll it makes before the end of its next turn." + "\n   " + "This spell's damage increases by 1d4 when you reach 5th level (2d6), 11th level (3d6) and 17th level (4d6)."
});
legacySpellRefactor("vitriolic sphere", {
  name: "Vitriolic Sphere",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 337 - 338]],
  level: 4,
  school: "Evoc",
  time: "1 a",
  range: "150 ft.",
  components: "V,S,M",
  compMaterial: "A drop of bile",
  duration: "Instantaneous",
  save: "Dex",
  description: "20-ft. rad all crea 10d4+2d4/SL Acid dmg, +5d4 dmg next turn end; save half \u0026 no dmg next turn",
  descriptionShorter: "20-ft. rad all crea 10d4+2d4/SL Acid dmg, +5d4 dmg next turn; save half \u0026 no next turn",
  descriptionFull: "You point at a location within range, and a glowing, 1-foot-diameter ball of emerald acid streaks there and explodes in a 20-foot-radius sphere. Each creature in that area must make a Dexterity saving throw. On a failed save, a creature takes 10d4 acid damage and another 5d4 acid damage at the end of its next turn. On a successful save, a creature takes half the initial damage and no damage at the end of its next turn." + AtHigherLevels + "When you cast this spell using a spell slot of 5th level or higher, the initial damage increases by 2d4 for each slot level above 4th.",
  dynamicDamageBonus: {
    multipleDmgMoments: false,
    extraDmgGroupsSameType: /((?:\+?\d+d?\d*)+)( dmg next turn)/i
  }
});
legacySpellRefactor("wall of fire", {
  name: "Wall of Fire",
  classes: ["druid", "sorcerer", "wizard"],
  source: [["PHB2024", 338]],
  level: 4,
  school: "Evoc",
  time: "1 a",
  range: "120 ft.",
  components: "V,S,M",
  compMaterial: "A piece of charcoal",
  duration: "Conc, 1 min",
  save: "Dex",
  description: "60\xD71\xD720ft (l\xD7w\xD7h) or 10-ft. rad all in and 10 ft. on 1 side 5d8+1d8/SL Fire dmg; save halves; see B",
  descriptionMetric: "18\xD70,3\xD76m (l\xD7w\xD7h) or 3-m rad all in and 3 m on 1 side 5d8+1d8/SL Fire dmg; save halves; see B",
  descriptionShorter: "60|1|20ft (l|w|h) or 10-ft. rad all + 10 ft. on 1 side 5d8+1d8/SL Fire dmg; save half; see B",
  descriptionShorterMetric: "18|0,3|6m (l|w|h) or 3-m rad all + 3 m on 1 side 5d8+1d8/SL Fire dmg; save half; see B",
  descriptionFull: "You create a wall of fire on a solid surface within range. You can make the wall up to 60 feet long, 20 feet high, and 1 foot thick, or a ringed wall up to 20 feet in diameter, 20 feet high, and 1 foot thick. The wall is opaque and lasts for the duration." + "\n   " + "When the wall appears, each creature within its area must make a Dexterity saving throw. On a failed save, a creature takes 5d8 fire damage, or half as much damage on a successful save." + "\n   " + "One side of the wall, selected by you when you cast this spell, deals 5d8 fire damage to each creature that ends its turn within 10 feet of that side or inside the wall. A creature takes the same damage when it enters the wall for the first time on a turn or ends its turn there. The other side of the wall deals no damage." + AtHigherLevels + "When you cast this spell using a spell slot of 5th level or higher, the damage increases by 1d8 for each slot level above 4th."
});
legacySpellRefactor("wall of force", {
  name: "Wall of Force",
  classes: ["wizard"],
  source: [["PHB2024", 338]],
  level: 5,
  school: "Evoc",
  time: "1 a",
  range: "120 ft.",
  components: "V,S,M",
  compMaterial: "A shard of glass",
  duration: "Conc, 10 min",
  description: "10 10\xD710-ft. panels or 10-ft. rad (hemi)sphere invisible, impenetrable wall; can float in air; see book",
  descriptionFull: "An invisible wall of force springs into existence at a point you choose within range. The wall appears in any orientation you choose, as a horizontal or vertical barrier or at an angle. It can be free floating or resting on a solid surface. You can form it into a hemispherical dome or a sphere with a radius of up to 10 feet, or you can shape a flat surface made up of ten 10-foot-by-10-foot panels. Each panel must be contiguous with another panel. In any form, the wall is 1/4 inch thick. It lasts for the duration. If the wall cuts through a creature's space when it appears, the creature is pushed to one side of the wall (your choice which side)." + "\n   " + "Nothing can physically pass through the wall. It is immune to all damage and can't be dispelled by dispel magic. A disintegrate spell destroys the wall instantly, however. The wall also extends into the Ethereal Plane, blocking ethereal travel through the wall."
});
legacySpellRefactor("wall of ice", {
  name: "Wall of Ice",
  classes: ["wizard"],
  source: [["PHB2024", 339]],
  level: 6,
  school: "Evoc",
  time: "1 a",
  range: "120 ft.",
  components: "V,S,M",
  compMaterial: "A piece of quartz",
  duration: "Conc, 10 min",
  save: "Dex",
  description: "10 10\xD710-ft. panels 1-ft. thick wall; at casting 10d6 Cold dmg; save halves; can cut through; see book",
  descriptionFull: "You create a wall of ice on a solid surface within range. You can form it into a hemispherical dome or a sphere with radium of up to 10 feet, or you can shape a flat surface made up of ten 10-foot-square panels. Each panel must be contiguous with another panel. In any form, the wall is 1 foot thick and lasts for the duration." + "\n   " + "If the wall cuts through a creature's space when it appears, the creature within its area is pushed to one side of the wall and must make a Dexterity saving throw. On a failed save, the creature takes 10d6 cold damage, or half as much damage on a successful save." + "\n   " + "The wall is an object that can be damaged and thus breached. It has AC 12 and 30 hit points per 10-foot section, and it is vulnerable to fire damage. Reducing a 10-foot section of wall to 0 hit points destroys it and leaves behind a sheet of frigid air in the space the wall occupied. A creature moving through the sheet of frigid air for the first time on a turn must make a Constitution saving throw. The creature takes 5d6 cold damage on a failed save, or half as much damage on a successful one." + AtHigherLevels + "When you cast this spell using a spell slot of 7th level or higher, the damage the wall deals when it appears increases by 2d6, and the damage from passing through the sheet of frigid air increases by 1d6 for each slot level above 6th.",
  dynamicDamageBonus: {multipleDmgMoments: false}
});
legacySpellRefactor("wall of stone", {
  name: "Wall of Stone",
  classes: ["druid", "sorcerer", "wizard"],
  source: [["PHB2024", 339]],
  level: 5,
  school: "Evoc",
  time: "1 a",
  range: "120 ft.",
  components: "V,S,M",
  compMaterial: "A cube of granite",
  duration: "Conc, 10 min",
  description: "10 10\xD710-ft. panels 6\" thick wall connected with existing stone; half thickness, double surface; see B",
  descriptionMetric: "10 10\xD73m panels 15cm thick wall connected with existing stone; half thickness, double surface; see B",
  descriptionFull: "A nonmagical wall of solid stone springs into existence at a point you choose within range. The wall is 6 inches thick and is composed of ten 10-foot-by-10-foot panels. Each panel must be contiguous with at least on other panel. Alternatively, you can create 10-foot-by-20-foot panels that are only 3 inches thick." + "\n   " + "If the wall cuts through a creature's space when it appears, the creature is pushed to one side of the wall (your choice). If a creature would be surrounded on all sides by the wall (or the wall and another solid surface), that creature can make a Dexterity saving throw. On a success, it can use its reaction to move up to its speed so that it is no longer enclosed by the wall." + "\n   " + "The wall can have any shape you desire, though it can't occupy the same space as a creature or object. the wall doesn't need to be vertical or resting on any firm foundation. It must, however, merge with and be solidly supported by existing stone. Thus you can use this spell to bridge a chasm or create a ramp." + "\n   " + "If you create a span greater than 20 feet in length, you must halve the size of each panel to create supports. You can crudely shape the wall to create crenelations, battlements, and so on." + "\n   " + "The wall is an object made of stone that can be damaged and thus breached. Each panel has AC 15 and 30 hit points per inch of thickness. Reducing a panel to 0 hit points destroys it and might cause connected panels to collapse at the DM's discretion." + "\n   " + "If you maintain your concentration on this spell for its whole duration, the wall becomes permanent and can't be dispelled. Otherwise, the wall disappears when the spell ends."
});
legacySpellRefactor("wall of thorns", {
  name: "Wall of Thorns",
  classes: ["druid"],
  source: [["PHB2024", 339]],
  level: 6,
  school: "Conj",
  time: "1 a",
  range: "120 ft.",
  components: "V,S,M",
  compMaterial: "A handful of thorns",
  duration: "Conc, 10 min",
  save: "Dex",
  description: "60\xD75\xD720ft (l\xD7w\xD7h) or 10-ft. rad all 7d8+1d8/SL Piercing dmg; save halves; 1/4 move; see book",
  descriptionMetric: "18\xD71,5\xD76m (l\xD7w\xD7h) or 3-m rad all 7d8+1d8/SL Piercing dmg; save halves; 1/4 move; see book",
  descriptionFull: "You create a wall of tough, pliable, tangled brush bristling with needle-sharp thorns. The wall appears within range on a solid surface and lasts for the duration. You choose to make the wall up to 60 feet long, 10 feet high, and 5 feet thick or a circle that has a 20-foot diameter and is up to 20 feet high and 5 feet thick. The wall blocks line of sight." + "\n   " + "When the wall appears, each creature within its area must make a Dexterity saving throw. On a failed save, a creature takes 7d8 piercing damage, or half as much damage on a successful save." + "\n   " + "A creature can move through the wall, albeit slowly and painfully. For every 1 foot a creature moves through the wall, it must spend 4 feet of movement. Furthermore, the first time a creature enters the wall on a turn or ends its turn there, the creature must make a Dexterity saving throw. It takes 7d8 slashing damage on a failed save, or half as much on a successful save." + AtHigherLevels + "When you cast this spell using a spell slot of 7th level or higher, both types of damage increase by 1d8 for each slot level above 6th."
});
legacySpellRefactor("warding bond", {
  name: "Warding Bond",
  classes: ["cleric", "paladin"],
  source: [["PHB2024", 340]],
  level: 2,
  school: "Abjur",
  time: "1 a",
  range: "Touch",
  components: "V,S,M\u0192",
  compMaterial: "A pair of platinum rings worth 50+ gp each, which you and target must wear for the duration",
  duration: "1 h",
  description: "1 crea +1 AC, +1 saves, resistance all dmg; if takes dmg I take same dmg; ends if >60 ft. away (100gp)",
  descriptionFull: "This spell wards a willing creature you touch and creates a mystic connection between you and the target until the spell ends. While the target is within 60 feet of you, it gains a +1 bonus to AC and saving throws, and it has resistance to all damage. Also, each time it takes damage, you take the same amount of damage." + "\n   " + "The spell ends if you drop to 0 hit points or if you and the target become separated by more than 60 feet. It also ends if the spell is cast again on either of the connected creatures. You can also dismiss the spell as an action."
});
legacySpellRefactor("water breathing", {
  name: "Water Breathing",
  classes: ["druid", "ranger", "sorcerer", "wizard"],
  source: [["PHB2024", 340]],
  ritual: true,
  level: 3,
  school: "Trans",
  time: "1 a",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A short reed",
  duration: "24 h",
  description: "10 willing creatures can breathe underwater for the duration",
  descriptionFull: "This spell grants up to ten willing creatures you can see within range the ability to breathe underwater until the spell ends. Affected creatures also retain their normal mode of respiration."
});
legacySpellRefactor("water walk", {
  name: "Water Walk",
  classes: ["cleric", "druid", "ranger", "sorcerer"],
  source: [["PHB2024", 340]],
  ritual: true,
  level: 3,
  school: "Trans",
  time: "1 a",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A piece of cork",
  duration: "1 h",
  description: "10 willing creatures can move across any liquid for the duration; rise to surface if underwater",
  descriptionFull: "This spell grants the ability to move across any liquid surface - such as water, acid, mud, snow, quicksand, or lava - as if it were harmless solid ground (creatures crossing molten lava can still take damage from the heat). Up to ten willing creatures you can see within range gain this ability for the duration." + "\n   " + "If your target a creature submerged in a liquid, the spell carries the target to the surface of the liquid at a rate of 60 feet per round."
});
legacySpellRefactor("web", {
  name: "Web",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 340]],
  level: 2,
  school: "Conj",
  time: "1 a",
  range: "60 ft.",
  components: "V,S,M",
  compMaterial: "A bit of spiderweb",
  duration: "Conc, 1 h",
  save: "Dex",
  description: "20-ft. cube, anchored, all save or restrained; dif. ter.; lightly obscures; Str check vs. Spell DC to free",
  descriptionFull: "You conjure a mass of thick, sticky webbing at a point of your choice within range. The webs fill a 20-foot cube from that point for the duration. The webs are difficult terrain and lightly obscure their area." + "\n   " + "If the webs aren't anchored between two solid masses (such as walls or trees) or layered across a floor, wall, or ceiling, the conjured web collapses on itself, and the spell ends at the start of your next turn. Webs layered over a flat surface have a depth of 5 feet." + "\n   " + "Each creature that starts its turn in the webs or that enters them during its turn must make a Dexterity saving throw. On a failed save, the creature is restrained as long as it remains in the webs or until it breaks free." + "\n   " + "A creature restrained by the webs can use its actions to make a Strength check against your spell save DC. If it succeeds, it is no longer restrained." + "\n   " + "The webs are flammable. Any 5-foot cube of webs exposed to fire burns away in 1 round, dealing 2d4 fire damage to any creature that starts its turn in the fire."
});
legacySpellRefactor("weird", {
  name: "Weird",
  classes: ["warlock", "wizard"],
  source: [["PHB2024", 341]],
  level: 9,
  school: "Illus",
  time: "1 a",
  range: "120 ft.",
  components: "V,S",
  duration: "Conc, 1 min",
  save: "Wis",
  description: "30-ft. rad all crea save or frightened; extra save at end of each turn to stop, on fail 4d10 Psychic dmg", // errata from start of turn to end of turn
  descriptionShorter: "30-ft. rad all crea save or frightened; save at end of turn to stop, on fail 4d10 Psychic dmg",
  descriptionFull: "Drawing on the deepest fears of a group of creatures, you create illusory creatures in their minds, visible only to them. Each creature in a 30-foot-radius sphere centered on a point of your choice within range must make a Wisdom saving throw. On a failed save, a creature becomes frightened for the duration. The illusion calls on the creature's deepest fears, manifesting its worst nightmares as an implacable threat. At the end of each of the frightened creature's turns, it must succeed on a Wisdom saving throw or take 4d10 psychic damage. On a successful save, the spell ends for that creature."
});
legacySpellRefactor("wind walk", {
  name: "Wind Walk",
  classes: ["druid"],
  source: [["PHB2024", 341]],
  level: 6,
  school: "Trans",
  time: "1 min",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "a candle",
  duration: "8 h",
  description: "Me + 10 willing creatures assume gaseous form with fly 300 ft., resist. to nonmagical dmg; see book",
  descriptionFull: "You and up to ten willing creatures you can see within range assume a gaseous form for the duration, appearing as wisps of cloud. While in this cloud form, a creature has a flying speed of 300 feet and has resistance to damage from nonmagical weapons. The only actions a creature can take in this form are the Dash action or to revert to its normal form. Reverting takes 1 minute, during which time a creature is incapacitated and can't move. Until the spell ends, a creature can revert to cloud form, which also requires the 1-minute transformation." + "\n   " + "If a creature is in cloud form and flying when the effect ends, the creature descends 60 feet per round for 1 minute until it lands, which it does safely. If it can't land after 1 minute, the creature falls the remaining distance."
});
legacySpellRefactor("wind wall", {
  name: "Wind Wall",
  classes: ["druid", "ranger"],
  source: [["PHB2024", 341]],
  level: 3,
  school: "Evoc",
  time: "1 a",
  range: "120 ft.",
  components: "V,S,M",
  compMaterial: "A fan and a feather",
  duration: "Conc, 1 min",
  save: "Str",
  description: "50\xD71\xD715ft (l\xD7w\xD7h) wall, any line-shape, at cast all in 3d8 Bludg. dmg; save halves; blocks arrows",
  descriptionMetric: "15\xD70,3\xD74,5m (l\xD7w\xD7h) wall, any line-shape, at cast all in 3d8 Bludg. dmg; save halves; blocks arrows",
  descriptionShorterMetric: "15|0,3|4,5m (l|w|h) wall, any line-shape, at cast all in 3d8 Bludg. dmg; save halves; blocks arrows",
  descriptionFull: "A wall of strong wind rises from the ground at a point you choose within range. You can make the wall up to 50 feet long, 15 feet high, and 1 foot thick. You can shape the wall in any way you choose so long as it makes one continuous path along the ground. The wall lasts for the duration." + "\n   " + "When the wall appears, each creature within its area must make a Strength saving throw. A creature takes 3d8 bludgeoning damage on a failed save, or half as much damage on a successful one." + "\n   " + "The strong wind keeps fog, smoke, and other gases at bay. Small or smaller flying creatures or objects can't pass through the wall. Loose, lightweight materials brought into the wall fly upward. Arrows, bolts, and other ordinary projectiles launched at targets behind the wall are deflected upward and automatically miss. (Boulders hurled by giants or siege engines, and similar projectiles, are unaffected.) Creatures in gaseous form can't pass through it.",
  dynamicDamageBonus: {multipleDmgMoments: false}
});
legacySpellRefactor("wish", {
  name: "Wish",
  classes: ["sorcerer", "wizard"],
  source: [["PHB2024", 341]],
  level: 9,
  school: "Conj",
  time: "1 a",
  range: "Self",
  components: "V",
  duration: "Instantaneous",
  description: "Duplicate any 8th lvl or lower spell, create objects, heal, resurrect, alter time, etc.; see book",
  descriptionFull: "Wish is the mightiest spell a mortal can cast. By simply speaking aloud, you can alter reality itself." + "\n   " + "The basic use of this spell is to duplicate any other spell of level 8 or lower. If you use it in this way, you don't need to meet any requirements to cast that spell, including costly components. The spell simply takes effect." + "\n   " + "Alternatively, you can create one of the following effects of your choice:" + "\n " + "\u2022 Object creation. You create one object of up to 25,000 gp in value that isn't a magic item. The object can be no more than 300 feet in any dimension, and it appears in an unoccupied space that you can see on the ground." + "\n " + "\u2022 Instant Health. You allow yourself and up to twenty creatures that you can see to regain all Hit Points, and you end all effects on them listed in the Greater Restoration spell." + "\n " + "\u2022 Resistance. You grant up to ten creatures that you see Resistance to one damage type that you choose. This Resistance is permanent." + "\n " + "\u2022 You grant up to ten creatures you can see immunity to a single spell or other magical effect for 8 hours." + "\n " + "\u2022 Sudden Learning. You replace one of your feats with another feat for which you are eligible. You lose all the benefits of the old feat and gain the benefits of the new one. You can't replace a feat that is a prerequisite for any of your other feats or features." + "\n   " + "Roll Redo. You undo a single recent event by forcing a reroll of any die roll made within the last round (including your last turn). Reality reshapes itself to accommodate the new result. For example, a Wish spell could undo an ally's failed saving throw or a foe's Critical Hit. You can force the reroll to be made with Advantage or Disadvantage and you choose whether to use the reroll or the original roll." + "\n\n" + "Reshape Reality. You may wish for something not included in any of the other effects. To do so, state your wish to the DM as precisely as possible. The DM has great latitude in ruling what occurs in such an instance: the greater the wish, the greater likelihood that something goes wrong. This spell might simply fail, the effect you desire might be achieved only in part, or you might suffer an unforeseen consequence as a result of how you worded the wish. Fore example, wishing that a villain were dead might propel you forward in time to a period when the villain is no longer alive, effectively removing you from the game. Similarly, wishing for a Legendary magic item or an Artifact might instantly transport you to the presence of the item's current owner. If your wish is granted and its effects have consequences for a whole community, region, or world, you are likely to attract powerful foes. If your wish would affect a god, the god's divine servants might instantly intervene to prevent it or to encourage you to craft the wish in a particular way. If your wish would undo the multiverse itself, threaten the City of Sigil, or affect the Lady of pain in any way, you see an image of her in your mind for a moment, she shakes her head, and your wish fails." + "The stress of casting Wish to produce any effect other than duplicating another spell weakens you. After enduring that stress, each time you cast a spell until you finish a Long Rest, you take 1d10 Necrotic damage per level of that spell. This damage can't be reduced or prevented in any way. In addition, your Strength score becomes 3 for 2d4 days. For each of those days that you spend resting and doing nothing more than light activity, your remaining recovery time decreases by 2 days. Finally there is a 33 percent chance that you are unable to cast Wish ever again if you suffer this stress."
});
legacySpellRefactor("witch bolt", {
  name: "Witch Bolt",
  classes: ["sorcerer", "warlock", "wizard"],
  source: [["PHB2024", 343]],
  level: 1,
  school: "Evoc",
  time: "1 a",
  range: "30 ft.",
  components: "V,S,M",
  compMaterial: "A twig struck by lightning",
  duration: "Conc, 1 min",
  description: "Rngd spell atk 2d12+1d12/SL Lightn. dmg; 1 a 1d12 Lightn. dmg; ends if out of range or I do other a",
  descriptionShorter: "Rngd atk 2d12+1d12/SL Lightn. dmg; 1 a 1d12 Lightn. dmg; end: out of range/do other a",
  descriptionFull: "A beam of crackling, blue energy lances out toward a creature within range, forming a sustained arc of lightning between you and the target. Make a ranged spell attack against that creature. On a hit, the target takes 2d12 lightning damage, and on each of your turns for the duration, you can use your action to deal 1d12 lightning damage to the target automatically. The spell ends if you use your action to do anything else. The spell also ends if the target is ever outside the spell's range or if it has total cover from you." + AtHigherLevels + "When you cast this spell using a spell slot of 2nd level or higher, the initial damage increases by 1d12 for each slot level above 1st.",
  dynamicDamageBonus: {
    multipleDmgMoments: false,
    extraDmgGroupsSameType: /(1 a )(.*?)( Lightn. dmg)/i
  }
});
legacySpellRefactor("word of radiance", {
  name: "Word of Radiance",
  classes: ["cleric"],
  source: [["PHB2024", 343]],
  level: 0,
  school: "Evoc",
  time: "1 a",
  range: "Self",
  components: "V,M",
  compMaterial: "A sunburst token",
  duration: "Instantaneous",
  save: "Con",
  description: "Any crea within 5ft emanation save or 1d6 Radiant damage; +1d6 at CL 5, 11, and 17",
  descriptionCantripDie: "Any crea within range save or `CD`d6 Radiant damage",
  descriptionFull: "You utter a divine word, and burning radiance erupts from you in a 5-foot emanation. Each creature of your choice that you can see within range must succeed on a Constitution saving throw or take 1d6 radiant damage." + "\n   " + "The spell's damage increases by 1d6 when you reach 5th level (2d6), 11th level (3d6), and 17th level (4d6)."
});
legacySpellRefactor("word of recall", {
  name: "Word of Recall",
  classes: ["cleric"],
  source: [["PHB2024", 343]],
  level: 6,
  school: "Conj",
  time: "1 a",
  range: "5 ft.",
  components: "V",
  duration: "Instantaneous",
  description: "Me + 5 willing crea teleport to sanctuary of my deity, designated as such by casting this spell there",
  descriptionFull: "You and up to five willing creatures within 5 feet of you instantly teleport to a previously designated sanctuary. You and any creatures that teleport with you appear in the nearest unoccupied space to the spot you designated when you prepared your sanctuary (see below). If you cast this spell without first preparing a sanctuary, the spell has no effect." + "\n   " + "You must designate a sanctuary by casting this spell within a location, such as a temple, dedicated to or strongly linked to your deity. If you attempt to cast the spell in this manner in an area that isn't dedicated to your deity, the spell has no effect."
});
legacySpellRefactor("wrathful smite", {
  name: "Wrathful Smite",
  classes: ["paladin"],
  source: [["PHB2024", 343]],
  level: 1,
  school: "Necro",
  time: "1 bns",
  timeFull: "Bonus Action, which you take immediately after hitting a creature with a Melee weapon or Unarmed strike",
  range: "Self",
  components: "V",
  duration: "Conc, 1 min",
  save: "Wis",
  description: "Next melee weapon hit 1d6+1d6/SL Necrotic dmg and save or frightened; it can take 1 a for extra save",
  descriptionFull: "The next time you hit with a melee weapon attack during this spell's duration, your attack deals an extra 1d6 Necrotic damage. Additionally, if the target is a creature, it must make a Wisdom saving throw or be frightened of you until the spell ends. As an action, the creature can make a Wisdom check against your spell save DC to steel its resolve and end this spell." + AtHigherLevels + "The damage increases by 1d6 for each spell slot above 1."
});
legacySpellRefactor("yolande's regal presence", {
  name: "Yolande's Regal Presence",
  classes: ["bard", "wizard"],
  source: [["PHB2024", 343]],
  level: 5,
  school: "Ench",
  time: "1 a",
  range: "Self",
  components: "V,S,M",
  duration: "Con. up to 1 min",
  save: "Wis",
  description: "10ft Emanation, when crea you can see enters space for first time on turn, Wis Save or 4d6 Psy dmg, falls Prone and be pushed up to 10ft away, half dmg on success",
  descriptionFull: "You surround yourself with unearthly majesty in a 10-foot Emanation. Whenever the Emanation enters the space of a creature you can see and whenever a creature you can see enters the Emanation or ends its turn there, you can force that creature to make a Wisdom saving throw. On a failed save, the target takes 4d6 Psychic damage and has the Prone condition, and you can push it up to 10 feet away. On a successful save, the target takes half as much damage only. A creature makes this save only once per turn."
});
legacySpellRefactor("zone of truth", {
  name: "Zone of Truth",
  classes: ["bard", "cleric", "paladin"],
  source: [["PHB2024", 343]],
  level: 2,
  school: "Ench",
  time: "1 a",
  range: "60 ft.",
  components: "V,S",
  duration: "10 min",
  save: "Cha",
  description: "15-ft. rad all in or enter save or unable to lie; I'm aware if saved or not; crea aware it cannot lie",
  descriptionFull: "You create a magical zone that guards against deception in a 15-foot-radius sphere centered on a point of your choice within range. Until the spell ends, a creature that enters the spell's area for the first time on a turn or starts its turn there must make a Charisma saving throw. On a failed save, a creature can't speak a deliberate lie while in the radius. You know whether each creature succeeds or fails on its saving throw." + "\n   " + "An affected creature is aware of the spell and can thus avoid answering questions to which it would normally respond with a lie. Such creatures can be evasive in its answers as long as it remains within the boundaries of the truth."
});
//Creatures
CompanionList["familiar"] = {
	name : "Find Familiar",
	nameTooltip : "the Find Familiar spell",
	nameOrigin : "1st-level conjuration [ritual] spell",
	nameMenu : "Familiar (Find Familiar spell)",
	source : [["PHB2024", 272]],
	action : [
		["action", "Familiar (dismiss/reappear)"],
		["action", "Use familiar's senses"]
	],
	notes : [{
		name : "Summon a spirit that serves as a familiar",
		description : [
			"appearing in an unoccupied space within 10 ft",
			"It assumes a chosen form (can change at every casting): Bat, Cat, Frog, Hawk, Lizard, Octopus, Owl, Rat, Raven, Spider, Weasel, or another Beast that has a Challenge Rating of 0.",
			"It has the chosen form's statistics, but its type changes from beast to celestial, fey, or fiend",
			"When the familiar drops to 0 hit points, it disappears, leaving behind no physical form",
			"It reappears when I cast this spell again (in a new form if so desired)"
		].join("\n   "),
		joinString : ", "
	}, {
		name : "The familiar acts independently of me",
		description : [
			"but it always obeys my commands",
			"In combat, it rolls its own initiative and acts on its own turn, but it can't attack"
		].join("\n   "),
		joinString : ", "
	}, {
		name : "While it is within 100 ft of me",
		description : "I can communicate with it telepathically",
		joinString : ", "
	}, {
		name : "As a bonus action, I see/hear what it does",
		description : " (but not with my senses) until the start of my next turn",
		joinString : ""
	}, {
		name : "As a magic action, I can temporarily dismiss it",
		description : "having it disappear into a pocket dimension",
		joinString : ", "
	}, {
		name : "As a magic action, while it is temporarily dismissed",
		description : "I can cause it to reappear within 30 ft",
		joinString : ", "
	}, {
		name : "I can't have more than one familiar bonded at a time",
		description : "As a magic action, I can dismiss it forever",
		joinString : "; "
	}, {
		name : "When I cast a spell with a range of touch",
		description : [
			"my familiar can deliver the spell",
			"It must be within 100 ft of me and it must use its reaction to deliver the spell when I cast it",
			"It acts as if it cast the spell, but it can use my modifiers for any attack rolls the spell requires"
		].join("\n   "),
		joinString : ", "
	}],
	attributesAdd : {
		header : "Familiar",
		features : [{
			name : "Find Familiar",
			description : "If dropped to 0 HP, the familiar disappears, leaving behind no physical form. The familiar must obey all commands of its master."
		}]
	},
};
CompanionList["pact_of_the_chain"] = {
	name : "Pact of the Chain",
	nameTooltip : "Warlock (Pact of the Chain)",
	nameOrigin : "variant of the Find Familiar 1st-level conjuration [ritual] spell",
	nameMenu : "Pact of the Chain familiar (Warlock feature)",
	source : [["PHB2024", 157]],
	includeCheck : function(sCrea, objCrea, iCreaCR, bIsAL) {
		// return true if to be included, or a string to add a note to the menu option
		return !objCrea.companion ? false : objCrea.companion.indexOf("familiar") !== -1 ? true : bIsAL && objCrea.companion.indexOf("familiar_not_al") !== -1 ? " (if DM approves)" : false;
	},
	action : [
		["action", "Familiar (dismiss/reappear)"],
		["action", "Use familiar's senses"]
	],
	attributesAdd : {
		header : "Familiar",
		features : [{
			name : "Pact of the Chain",
			description : "If dropped to 0 HP, the familiar disappears, leaving behind no physical form. The familiar must obey all commands of its master."
		}]
	},
	attributesChange : function(sCrea, objCrea) {
		if (objCrea.type.toLowerCase() === "beast") {
			objCrea.type = ["Celestial", "Fey", "Fiend"];
			objCrea.subtype = "";
		}
	}
};
CompanionList["mount"] = {
	name : "Find Steed",
	nameTooltip : "the Find Steed spell",
	nameOrigin : "2nd-level conjuration spell",
	nameMenu : "Steed (Find Steed spell)",
	source : [["PHB2024", 272]],
	action : [["action", "Find Steed (dismiss)"]],
	notes : [{
		name : "Summon an otherworldly being that appears as a loyal steed",
		description : [
			"appearing in an unoccupied space within 30 ft",
			"The steed resembles a Larg, ridable animal fo your choice, such as a horse, a camel, a dire wolf, or an elk",
			"The steed has the statistics of the otherworldly steed, choose its type celestial, fey, or fiend",
			"When the steed drops to 0 hit points, it disappears, leaving behind no physical form"
		].join("\n   "),
		joinString : ", "
	}, {
		name : "The steed serves me as a mount",
		description : "I have a bond with it that allows us to fight as a seamless unit",
		joinString : ". "
	}, {
		name : "While my steed is within 1 mile of me",
		description : "I can communicate with it telepathically",
		joinString : ", "
	}, {
		name : "Casting this spell again",
		description : "can summon the same steed, or a different one",
		joinString : " "
	}, {
		name : "I can't have more than one steed bonded at a time",
		description : "As an action, I can release it from its bond",
		joinString : "; "
	}],
	attributesAdd : {
		header : "Mount",
		features : [{
			name : "Find Steed",
			description : "If dropped to 0 HP, the steed disappears, leaving behind no physical form."
		}],
	},
};
CompanionList["companion"] = {
	name : "Ranger's Companion",
	nameTooltip : "Beast Master: Ranger's Companion",
	nameOrigin : "Beast Master 3",
	nameMenu : "Ranger's Companion (Beast Master feature)",
	source : [["PHB2024", 122]],
	action : [["bonus action", "Ranger's Companion (command)"]],
	notes : [{
		name : "If the beast has died within the lasts hour,",
		description : [
		"I can take a Magic action to touch it and expend a spell slot.",
		"The beast returns to life after 1 minute with all its Hit Points restored."
		].join("\n   "),
		joinString : ", "
	}, {
		name : "The beast adds my Proficiency Bonus",
		description : "any ability check or saving throw the beast makes",
		joinString : " "
	}, {
		name : "The beast's hit point maximum equals",
		description : "five times my ranger level",
		joinString : " "
	}, {
		name : "In Combat",
		description : [
			"The beast takes its turn on my initiative",
			"I can verbally command the beast where to move (no action)",
			"As a bonus action, I can have the beast do a Dash, Disengage, or Help action on its turn",
			"I can sacrifice one of my attacks when I take the Attack action to command the beast to take the Beast's Strike action.",
			"If I don't command it to take an action, it takes the Dodge action instead"
		].join("\n   "),
		joinString : typePF ? ": " : ":\n   "
	}, {
		name : "Extra Attack (Ranger 5, PHB2024 120)",
		description : "If the beast takes the Attack action, I can use my Extra Attack feature to attack once myself",
		joinString : "\n   ",
		minlevel : 5
	}, {
		name : "Exceptional Training (Beast Master 7, PHB2024 123)",
		description : [
			"The beast's attacks can deal Force damage or its normal damage type",
			"As a bonus action, I can command it to take the Dash, Disengage, Dodge, or Help action on its turn"
		].join("\n   "),
		joinString : "\n   ",
		minlevel : 7,
		eval : function(prefix, lvl) {
			for (var i = 1; i <= 3; i++) {
				if (!What(prefix + "Comp.Use.Attack." + i + ".Weapon Selection")) continue;
				var sDescrFld = prefix + "Comp.Use.Attack." + i + ".Description";
				if (!/(,|;)? ?can deal force damage or its normal damage type/i.test(What(sDescrFld))) {
					AddString(sDescrFld, "Can deal Force damage or its normal damage type", "; ");
				}
			}
			processActions(true, "Beast Master: Ranger's Companion", [["bonus action", "Exceptional Training (Dash/Disengage/Dodge/Help)"]], "Ranger's Companion");
		},
		removeeval : function(prefix, lvl) {
			for (var i = 1; i <= 3; i++) {
				var sDescrFld = prefix + "Comp.Use.Attack." + i + ".Description";
				var sDescr = What(sDescrFld);
				var rCaM = /(,|;)? ?counts as magical/i;
				if (rCaM.test(sDescr)) Value(sDescrFld, sDescr.replace(rCaM, ''));
			}
			processActions(false, "Beast Master: Ranger's Companion", [["bonus action", "Exceptional Training (Dash/Disengage/Dodge/Help)"]], "Ranger's Companion");
		}
	}, {
		name : "Bestial Fury (Beast Master 11, PHB2024 123)",
		description : "The beast can make two attacks (or multiattack) when I command it to take an Attack action, In addition, the first time each turn it hits a creature affected by my Hunter's Mark spell, it deals extra Force damage equal to the bonus damage of that spell.",
		joinString : "\n   ",
		minlevel : 11,
		eval : function(prefix, lvl) {
			Value(prefix + "Comp.Use.Attack.perAction", 2);
		},
		removeeval : function(prefix, lvl) {
			Value(prefix + "Comp.Use.Attack.perAction", 1);
		}
	}, {
		name : "Share Spells (Beast Master 15, PHB2024 123)",
		description : "When I cast a spell on myself, I can have it also affect my primal companion if it is within 30 ft of me",
		joinString : "\n   ",
		minlevel : 15
	}],
	attributesAdd : {
		header : "Companion",
		minlevelLinked : ["ranger"],
		attacksAction : 1
	},
	attributesChange : function(sCrea, objCrea) {
		// Change multiattack trait/feature/action to level 11 feature
		["traits", "features", "actions"].forEach(function (n) {
			if (!objCrea[n]) return;
			for (var i = 0; i < objCrea[n].length; i++) {
				var oN = objCrea[n][i];
				if (oN.name && /multiattack/i.test(oN.name)) {
					objCrea[n][i].minlevel = 11;
				}
			}
		});
	},
};
CreatureList["ape"] = {
	name : "Ape",
	regExpSearch : /ape/i,
	source : [["PHB2024", 346]],
	size : 3,
	type : "Beast",
	alignment : "Unaligned",
	ac : 12,
	hp : 19,
	hd : [3, 8],
	speed : "30 ft., Climb 30 ft.",
	scores : [16, 14, 14, 6, 12, 7],
	skills : {
		"Athletics" : 5,
		"Perception" : 3,
	},
	senses : "",
	passivePerception : 13,
	languages : "None",
	challengeRating : "1/2",
	proficiencyBonus : 2,
	attacksAction : 2,
	actions : [{
		name : "Multiattack",
		description : "The ape makes two Fist attacks.",
	}],
	attacks : [{
		name : "Fist",
		ability : 1,
		damage : [1, 4, "Bludgeoning"],
		description : "Two fist attacks as an Attack action",
		range : "Melee (5 ft.)",
	}, {
		name : "Rock (Recharge 6)",
		ability : 1,
		damage : [2, 6, "Bludgeoning"],
		range : "25/50 ft.",
	}],
};
CreatureList["badger"] = {
	name : "Badger",
	regExpSearch : /badger/i,
	source : [["PHB2024", 346]],
	size : 5,
	type : "Beast",
	alignment : "Unaligned",
	ac : 11,
	hp : 5,
	hd : [1, 4],
	speed : "20 ft., Burrow 5 ft.",
	scores : [10, 11, 16, 2, 12, 5],
	skills : {
		"Perception" : 3,
	},
	damage_resistances : "Poison",
	senses : "Darkvision 30 ft.",
	passivePerception : 13,
	languages : "None",
	challengeRating : "0",
	proficiencyBonus : 2,
	attacksAction : 1,
	attacks : [{
		name : "Bite",
		ability : 1,
		damage : [1, "", "Piercing"],
		range : "Melee (5 ft.)",
	}],
};
CreatureList["bat"] = {
	name : "Bat",
	regExpSearch : /bat/i,
	source : [["PHB2024", 346]],
	size : 5,
	type : "Beast",
	alignment : "Unaligned",
	companion : "familiar",
	ac : 12,
	hp : 1,
	hd : [1, 4],
	speed : "5 ft., Fly 30 ft.",
	scores : [2, 15, 8, 2, 12, 4],
	senses : "Blindsight 60 ft.",
	passivePerception : 11,
	languages : "None",
	challengeRating : "0",
	proficiencyBonus : 2,
	attacksAction : 1,
	attacks : [{
		name : "Bite",
		ability : 2,
		damage : [1, "", "Piercing"],
		range : "Melee (5 ft.)",
	}],
};
CreatureList["black bear"] = {
	name : "Black Bear",
	regExpSearch : /^(?=.*(black))(?=.*(bear)).*$/i,
	source : [["PHB2024", 346]],
	size : 3,
	type : "Beast",
	alignment : "Unaligned",
	ac : 11,
	hp : 19,
	hd : [3, 8],
	speed : "30 ft., Climb 30 ft., Swim 30 ft.",
	scores : [15, 12, 14, 2, 12, 7],
	skills : {
		"Perception" : 5,
	},
	senses : "Darkvision 60 ft.",
	passivePerception : 15,
	languages : "None",
	challengeRating : "1/2",
	proficiencyBonus : 2,
	attacksAction : 2,
	actions : [{
		name : "Multiattack",
		description : "The black bear makes two Rend attacks.",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 6, "Slashing"],
		description : "Two Rend attacks as an Attack action",
		range : "Melee (5 ft.)",
	}],
};
CreatureList["boar"] = {
	name : "Boar",
	regExpSearch : /boar/i,
	source : [["PHB2024", 347]],
	size : 3,
	type : "Beast",
	alignment : "Unaligned",
	ac : 11,
	hp : 13,
	hd : [2, 8],
	speed : "40 ft.",
	scores : [13, 11, 14, 2, 9, 5],
	senses : "",
	passivePerception : 9,
	languages : "None",
	challengeRating : "1/4",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
		name : "Bloodied Fury",
		description : "While Bloodied, the boar has Advantage on attack rolls.",
		joinString : "\n   "
	}],
	attacks : [{
		name : "Gore",
		ability : 1,
		damage : [1, 6, "Piercing"],
		description : "If boar moves 20 ft. in straight line toward a crea. immediately before hit, the crea. takes an extra 3 (1d6) Pierc. dmg. & if crea. is Large or smaller, it has the Prone cond.",
		range : "Melee (5 ft.)",
	}],
	wildshapeString : "Bloodied Fury: While Bloodied, the boar has Advantage on attack rolls.",
};
CreatureList["brown bear"] = {
	name : "Brown Bear",
	regExpSearch : /^(?=.*(brown))(?=.*(bear)).*$/i,
	source : [["PHB2024", 347]],
	size : 2,
	type : "Beast",
	alignment : "Unaligned",
	ac : 11,
	hp : 22,
	hd : [3, 10],
	speed : "40 ft., Climb 30 ft.",
	scores : [17, 12, 15, 2, 13, 7],
	skills : {
		"Perception" : 3,
	},
	senses : "Darkvision 60 ft.",
	passivePerception : 13,
	languages : "None",
	challengeRating : "1",
	proficiencyBonus : 2,
	attacksAction : 2,
	actions : [{
		name : "Multiattack",
		description : "The brown bear makes one Bite attack and one Claw attack.",
	}],
	attacks : [{
		name : "Bite",
		ability : 1,
		damage : [1, 8, "Piercing"],
		description : "One Bite attack and One Claw attack as an Attack action",
		range : "Melee (5 ft.)",
	}, {
		name : "Claw",
		ability : 1,
		damage : [1, 4, "Slashing"],
		description : "On a hit, a Huge or smaller target has the Prone condition.",
		range : "Melee (5 ft.)",
	}],
};
CreatureList["camel"] = {
	name : "Camel",
	regExpSearch : /camel/i,
	source : [["PHB2024", 347]],
	size : 2,
	type : "Beast",
	alignment : "Unaligned",
	companion : "mount",
	ac : 10,
	hp : 17,
	hd : [2, 10],
	speed : "50 ft.",
	scores : [15, 8, 17, 2, 11, 5],
	saves : ["", 5, "", "", "", ""],
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "None",
	challengeRating : "1/8",
	proficiencyBonus : 2,
	attacksAction : 1,
	attacks : [{
		name : "Bite",
		ability : 1,
		damage : [1, 4, "Bludgeoning"],
		range : "Melee (5 ft.)",
	}],
};
CreatureList["cat"] = {
	name : "Cat",
	regExpSearch : /cat/i,
	source : [["PHB2024", 347]],
	size : 5,
	type : "Beast",
	alignment : "Unaligned",
	companion : "familiar",
	ac : 12,
	hp : 2,
	hd : [1, 4],
	speed : "40 ft., Climb 40 ft.",
	scores : [3, 15, 10, 3, 12, 7],
	saves : ["", 4, "", "", "", ""],
	skills : {
		"Perception" : 3,
		"Stealth" : 4,			
	},
	senses : "Darkvision 60 ft.",
	passivePerception : 13,
	languages : "None",
	challengeRating : "0",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
	name : "Jumper",
	description : "The cat's jump distances is determined using its Dexterity rather than its Strength.",
	joinString : "\n   "
	}],
	attacks : [{
		name : "Claws",
		ability : 2,
		damage : [1, "", "Slashing"],
		range : "Melee (5 ft.)",
	}],
	wildshapeString : "Jumper: The cat's jump distances is determined using its Dexterity rather than its Strength.",
};
CreatureList["constrictor snake"] = {
	name : "Constrictor Snake",
	regExpSearch : /^(?=.*(constrictor))(?=.*(snake)).*$/i,
	source : [["PHB2024", 348]],
	size : 2,
	type : "Beast",
	alignment : "Unaligned",
	ac : 13,
	hp : 13,
	hd : [2, 10],
	speed : "30 ft., Swim 30 ft.",
	scores : [15, 14, 12, 1, 10, 3],
	skills : {
		"Perception" : 2,
		"Stealth" : 4,			
	},
	senses : "Blindsight 10 ft.",
	passivePerception : 12,
	languages : "None",
	challengeRating : "1/4",
	proficiencyBonus : 2,
	attacksAction : 1,
	attacks : [{
		name : "Bite",
		ability : 1,
		damage : [1, 8, "Piercing"],
		range : "Melee (5 ft.)",
	}, {
		name : "Constrict",
		ability : 1,
		damage : [3, 4, "Bludgeoning"],
		range : "Melee (5 ft.)",
		dc : true,
		description : "one Medium or smaller creature the snake can see within 5 ft. must make a Str save, or take 7 (3d4) Bludgeoning damage and have the Grappled condition. While Grappled, the target has the Restrained condition. A grappled creature can end the condition by making a successful Athletics check as an action on its turn.",
	}],
};
CreatureList["crab"] = {
	name : "Crab",
	regExpSearch : /crab/i,
	source : [["PHB2024", 348]],
	size : 5,
	type : "Beast",
	alignment : "Unaligned",
	ac : 11,
	hp : 3,
	hd : [1, 4],
	speed : "20 ft., Swim 20 ft.",
	scores : [6, 11, 12, 1, 8, 2],
	skills : {
		"Stealth" : 2,			
	},
	senses : "Blindsight 30 ft.",
	passivePerception : 9,
	languages : "None",
	challengeRating : "0",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
		name : "Amphibious",
		description : "The crab can breathe air and water.",
		joinString : "\n   "
	}],
	attacks : [{
		name : "Claw",
		ability : 2,
		damage : [1, "", "Bludgeoning"],
		range : "Melee (5 ft.)",
	}],
	wildshapeString : "Amphibious: The crab can breathe air and water.",
};
CreatureList["crocodile"] = {
	name : "Crocodile",
	regExpSearch : /crocodile/i,
	source : [["PHB2024", 348]],
	size : 2,
	type : "Beast",
	alignment : "Unaligned",
	ac : 12,
	hp : 13,
	hd : [2, 10],
	speed : "20 ft., Swim 30 ft.",
	scores : [15, 10, 13, 2, 10, 5],
	saves : ["", "", 3, "", "", ""],
	skills : {
		"Stealth" : 2,			
	},
	senses : "",
	passivePerception : 10,
	languages : "None",
	challengeRating : "1/2",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
		name : "Hold Breath",
		description : "The crocodile can hold its breath for 1 hour.",
		joinString : "\n   "
	}],
	attacks : [{
		name : "Bite",
		ability : 1,
		damage : [1, 8, "Piercing"],
		range : "Melee (5 ft.)",
		description : "If the target is Medium or smaller, it has the Grappled condition. While Grappled, the target has the Restrained condition. A Grappled creature can end the condition by making a successful Athletics check (escape DC 12) as an action on its turn.",
	}],
	wildshapeString : "Hold Breath: The crocodile can hold its breath for 1 hour.",
};
CreatureList["dire wolf"] = {
	name : "Dire Wolf",
	regExpSearch : /^(?=.*(dire))(?=.*(wolf)).*$/i,
	source : [["PHB2024", 348]],
	size : 2,
	type : "Beast",
	alignment : "Unaligned",
	ac : 14,
	hp : 22,
	hd : [3, 10],
	speed : "50 ft.",
	scores : [17, 15, 15, 3, 12, 7],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Perception" : 5,
		"Stealth" : 4,			
	},
	passivePerception : 15,
	senses : "Darkvision 60 ft.",
	languages : "None",
	challengeRating : "1",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
		name : "Pack Tactics",
		description : "The wolf has Advantage on an attack roll against a creature if at least one of the wolf's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
		joinString : "\n   "
	}],
	attacks : [{
		name : "Bite",
		ability : 1,
		damage : [1, 10, "Piercing"],
		range : "Melee (5 ft.)",
		description : "On a hit, a Huge or smaller target has the Prone condition.",
	}],
	wildshapeString : "Pack Tactics: The wolf has Advantage on an attack roll against a creature if at least one of the wolf's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
};
CreatureList["draft horse"] = {
	name : "Draft Horse",
	regExpSearch : /^(?=.*(draft))(?=.*(horse)).*$/i,
	source : [["PHB2024", 349]],
	size : 2,
	type : "Beast",
	alignment : "Unaligned",
	companion : "mount",
	ac : 10,
	hp : 15,
	hd : [2, 10],
	speed : "40 ft.",
	scores : [18, 10, 15, 2, 11, 7],
	saves : ["", "", "", "", "", ""],
	senses : "",
	passivePerception : 10,
	languages : "None",
	challengeRating : "1/4",
	proficiencyBonus : 2,
	attacksAction : 1,
	attacks : [{
		name : "Hooves",
		ability : 1,
		damage : [1, 4, "Bludgeoning"],
		range : "Melee (5 ft.)",
	}],
};
CreatureList["elephant"] = {
	name : "Elephant",
	regExpSearch : /elephant/i,
	source : [["PHB2024", 349]],
	size : 1,
	type : "Beast",
	alignment : "Unaligned",
	companion : "mount",
	ac : 12,
	hp : 76,
	hd : [8, 12],
	speed : "40 ft.",
	scores : [22, 9, 17, 3, 11, 6],
	saves : ["", "", "", "", "", ""],
	senses : "",
	passivePerception : 10,
	languages : "None",
	challengeRating : "4",
	proficiencyBonus : 2,
	attacksAction : 2,
	actions : [{
		name : "Multiattack",
		description : "The elephant makes two Gore attacks.",
	}],
	attacks : [{
		name : "Gore",
		ability : 1,
		damage : [2, 8, "Piercing"],
		range : "Melee (5 ft.)",
		description : "Two Gore attacks as an Attack action. If the elephant moved at least 20 feet straight toward the target immediately before the hit, the target has the Prone condition.",
	}, {
		name : "Trample",
		ability : 1,
		damage : [2, 10, "Bludgeoning"],
		range : "Melee (5 ft.)",
		dc : true,
		description : "As a Bonus Action, the elephant can make one Trample attack against a creature within 5 feet that has the Prone condition, forcing it to make a Dex save, taking half damage on a successful save.",		
	}],
};
CreatureList["elk"] = {
	name : "Elk",
	regExpSearch : /elk/i,
	source : [["PHB2024", 349]],
	size : 2,
	type : "Beast",
	alignment : "Unaligned",
	ac : 10,
	hp : 11,
	hd : [2, 10],
	speed : "50 ft.",
	scores : [16, 10, 11, 2, 10, 6],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Perception" : 2,			
	},
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "None",
	challengeRating : "1/4",
	proficiencyBonus : 2,
	attacksAction : 1,
	attacks : [{
		name : "Ram",
		ability : 1,
		damage : [1, 6, "Bludgeoning"],
		range : "Melee (5 ft.)",
		description : "If the elk moved at least 20 feet straight toward the target immediately before the hit, the target takes an extra 3 (1d6) Bludgeoning damage and, if it is Huge or smaller, has the Prone condition.",
	}],
};
CreatureList["frog"] = {
	name : "Frog",
	regExpSearch : /frog/i,
	source : [["PHB2024", 349]],
	size : 5,
	type : "Beast",
	alignment : "Unaligned",
	companion : "familiar",
	ac : 11,
	hp : 1,
	hd : [1, 4],
	speed : "20 ft., Swim 20 ft.",
	scores : [1, 13, 8, 1, 8, 3],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Perception" : 1,
		"Stealth" : 3,			
	},
	senses : "Darkvision 30 ft.",
	passivePerception : 11,
	languages : "None",
	challengeRating : "0",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
		name : "Amphibious",
		description : "The frog can breathe air and water.",
		joinString : "\n   "
	}, {
		name : "Standing Leap",
		description : "The Frog's Long Jump is up to 10 feet and its High Jump is up to 5 feet with or without a running start.",
		joinString : "\n   "
	}],
	attacks : [{
		name : "Bite",
		ability : 2,
		damage : [1, "", "Piercing"],
		range : "Melee (5 ft.)",
	}],
	wildshapeString : "Amphibious: The frog can breathe air and water| Standing Leap: The Frog's Long Jump is up to 10 feet and its High Jump is up to 5 feet with or without a running start.",
};
CreatureList["giant badger"] = {
	name : "Giant Badger",
	regExpSearch : /^(?=.*(giant))(?=.*(badger)).*$/i,
	source : [["PHB2024", 350]],
	size : 3,
	type : "Beast",
	alignment : "Unaligned",
	ac : 13,
	hp : 15,
	hd : [2, 8],
	speed : "30 ft., Burrow 10 ft.",
	scores : [13, 10, 17, 2, 12, 5],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Perception" : 3,		
	},
	damage_resistances : "Poison",
	senses : "Darkvision 60 ft.",
	passivePerception : 13,
	languages : "None",
	challengeRating : "1/4",
	proficiencyBonus : 2,
	attacksAction : 1,
	attacks : [{
		name : "Bite",
		ability : 1,
		damage : [2, 4, "Piercing"],
		range : "Melee (5 ft.)",
	}],
};
CreatureList["giant crab"] = {
	name : "Giant Crab",
	regExpSearch : /^(?=.*(giant))(?=.*(crab)).*$/i,
	source : [["PHB2024", 350]],
	size : 3,
	type : "Beast",
	alignment : "Unaligned",
	ac : 15,
	hp : 13,
	hd : [3, 8],
	speed : "30 ft., Swim 30 ft.",
	scores : [13, 13, 11, 1, 9, 3],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Stealth" : 3,		
	},
	senses : "Blindsight 30 ft.",
	passivePerception : 9,
	languages : "None",
	challengeRating : "1/8",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
		name : "Amphibious",
		description : "The giant crab can breathe air and water.",
		joinString : "\n   "
	}],
	attacks : [{
		name : "Claw",
		ability : 1,
		damage : [1, 6, "Bludgeoning"],
		range : "Melee (5 ft.)",
		description : "If the target is Medium or smaller, it has the Grappled condition. The crab has two claws, each of which can grapple one target. A grappled creature can end the condition by making a successful (escape DC 11) Athletics check as an action on its turn.",
	}],
	wildshapeString : "Amphibious: The giant crab can breathe air and water.",
};
CreatureList["giant goat"] = {
	name : "Giant Goat",
	regExpSearch : /^(?=.*(giant))(?=.*(goat)).*$/i,
	source : [["PHB2024", 350]],
	size : 2,
	type : "Beast",
	alignment : "Unaligned",
	ac : 11,
	hp : 19,
	hd : [3, 10],
	speed : "40 ft., Climb 30 ft.",
	scores : [17, 13, 12, 3, 12, 6],
	saves : [5, "", "", "", "", ""],
	skills : {
		"Perception" : 3,		
	},
	senses : "Darkvision 60 ft.",
	passivePerception : 13,
	languages : "None",
	challengeRating : "1/2",
	proficiencyBonus : 2,
	attacksAction : 1,
	attacks : [{
		name : "Ram",
		ability : 1,
		damage : [1, 6, "Bludgeoning"],
		range : "Melee (5 ft.)",
		description : "If the giant goat moved at least 20 feet straight toward the target immediately before the hit, the target takes an extra 5 (2d4) Bludgeoning damage and, if it is Huge or smaller, has the Prone condition.",
	}],
};
CreatureList["giant seahorse"] = {
	name : "Giant Seahorse",
	regExpSearch : /^(?=.*(giant))(?=.*(seahorse)).*$/i,
	source : [["PHB2024", 350]],
	size : 2,
	type : "Beast",
	alignment : "Unaligned",
	ac : 14,
	hp : 16,
	hd : [3, 10],
	speed : "5 ft., Swim 40 ft.",
	scores : [15, 12, 11, 2, 12, 5],
	saves : ["", "", "", "", "", ""],
	senses : "",
	passivePerception : 11,
	languages : "None",
	challengeRating : "1/2",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
		name : "Water Breathing",
		description : "The giant seahorse can breathe only underwater.",
		joinString : "\n   "
	}],
	action : [{
		name : "Bubble Dash",
		description : "As a Bonus Action, while underwater, the giant seahorse moves up to half its Swim Speed without provoking Opportunity Attacks.",
		joinString : "\n   "
	}],
	attacks : [{
		name : "Ram",
		ability : 1,
		damage : [2, 6, "Bludgeoning"],
		range : "Melee (5 ft.)",
		description : "If the giant seahorse moved at least 20 feet straight toward the target immediately before the hit this attack deals 11 (2d8 + 2) Bludgeoning damage instead.",
	}],
	wildshapeString : "Water Breathing: The giant seahorse can breathe only underwater| Bubble Dash: As a Bonus Action, while underwater, the giant seahorse moves up to half its Swim Speed without provoking Opportunity Attacks.",
};
CreatureList["giant spider"] = {
	name : "Giant Spider",
	regExpSearch : /^(?=.*(giant))(?=.*(spider)).*$/i,
	source : [["PHB2024", 351]],
	size : 2,
	type : "Beast",
	alignment : "Unaligned",
	ac : 14,
	hp : 26,
	hd : [4, 10],
	speed : "30 ft., Climb 30 ft.",
	scores : [14, 16, 12, 2, 11, 4],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Perception" : 4,
		"Stealth" : 7,			
	},
	senses : "Darkvision 60 ft.",
	passivePerception : 14,
	languages : "None",
	challengeRating : "1",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
		name : "Spider Climb",
		description : "The spider can climb difficult surfaces, including along ceilings, without needing to make an ability check.",
		joinString : "\n   "
	}, {
		name : "Web Walker",
		description : "The spider ignores movement restrictions caused by webs, and it knows the location of any other creature in contact with the same web.",
		joinString : "\n   "
	}],
	action : [{
		name : "Web (Recharge 5-6)",
		description : "Dexterity Saving Throw: DC 13, one creature the spider can see within 60 feet. Failure: The target has the Restrained condition condition until the web is destroyed (AC 10; HP 5; Vulnerability to Fire damage; Immunity to Poison and Psychic damage).",
		joinString : "\n   "
	}],
	attacks : [{
		name : "Bite",
		ability : 2,
		damage : [1, 8, "Piercing"],
		range : "Melee (5 ft.)",
		description : "On a hit, this attack deals an additional 7 (2d6) Poison damage.",
	}],
	wildshapeString : "Spider Climb: The spider can climb difficult surfaces, including along ceilings, without needing to make an ability check| Web Walker: The spider ignores movement restrictions caused by webs, and it knows the location of any other creature in contact with the same web| Web (Recharge 5-6): Dexterity Saving Throw: DC 13, one creature the spider can see within 60 feet. Failure: The target has the Restrained condition condition until the web is destroyed (AC 10; HP 5; Vulnerability to Fire damage; Immunity to Poison and Psychic damage).",
};
CreatureList["giant weasel"] = {
	name : "Giant Weasel",
	regExpSearch : /^(?=.*(giant))(?=.*(weasel)).*$/i,
	source : [["PHB2024", 351]],
	size : 3,
	type : "Beast",
	alignment : "Unaligned",
	ac : 13,
	hp : 9,
	hd : [2, 8],
	speed : "40 ft., Climb 30 ft.",
	scores : [11, 17, 10, 4, 12, 5],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Acrobatics" : 5,
		"Perception" : 3,
		"Stealth" : 5,			
	},
	senses : "Darkvision 60 ft.",
	passivePerception : 13,
	languages : "None",
	challengeRating : "1/8",
	proficiencyBonus : 2,
	attacksAction : 1,
	attacks : [{
		name : "Bite",
		ability : 2,
		damage : [1, 4, "Piercing"],
		range : "Melee (5 ft.)",
	}],
};
CreatureList["goat"] = {
	name : "Goat",
	regExpSearch : /goat/i,
	source : [["PHB2024", 351]],
	size : 3,
	type : "Beast",
	alignment : "Unaligned",
	ac : 10,
	hp : 4,
	hd : [1, 8],
	speed : "40 ft., Climb 30 ft.",
	scores : [11, 10, 11, 2, 10, 5],
	saves : [2, "", "", "", "", ""],
	skills : {
		"Perception" : 2,		
	},
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "None",
	challengeRating : "0",
	proficiencyBonus : 2,
	attacksAction : 1,
	attacks : [{
		name : "Ram",
		ability : 1,
		damage : [1, "", "Bludgeoning"],
		range : "Melee (5 ft.)",
		description : "If the goat moved at least 20 feet straight toward the target immediately before the hit, the target takes an extra 2 (1d4) Bludgeoning damage.",
	}],
};
CreatureList["hawk"] = {
	name : "Hawk",
	regExpSearch : /hawk/i,
	source : [["PHB2024", 352]],
	size : 5,
	type : "Beast",
	alignment : "Unaligned",
	companion : "familiar",
	ac : 13,
	hp : 1,
	hd : [1, 4],
	speed : "10 ft., Fly 60 ft.",
	scores : [5, 16, 8, 2, 14, 6],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Perception" : 6,			
	},
	senses : "",
	passivePerception : 16,
	languages : "None",
	challengeRating : "0",
	proficiencyBonus : 2,
	attacksAction : 1,
	attacks : [{
		name : "Talons",
		ability : 2,
		damage : [1, "", "Slashing"],
		range : "Melee (5 ft.)",
	}],
};
CreatureList["imp"] = {
	name : "Imp",
	regExpSearch : /imp/i,
	source : [["PHB2024", 352]],
	size : 5,
	type : "Fiend",
	subtype : "devil",
	alignment : "Lawful Evil",
	companion : "pact_of_the_chain",
	ac : 13,
	hp : 21,
	hd : [6, 4],
	speed : "20 ft., Fly 40 ft.",
	scores : [6, 17, 13, 11, 12, 14],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Deception" : 4,
		"Insight" : 3,
		"Stealth" : 5,
	},
	damage_resistances : "Cold",
	damage_immunities : "Fire; Poison",
	condition_immunities : "Poisoned",
	senses : "Darkvision 120 ft.",
	passivePerception : 11,
	languages : "Common, Infernal",
	challengeRating : "1",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
		name : "Devil's Sight",
		description : "Magical Darkness doesn't impede the imp's Darkvision",
		joinString : "\n   ",
	}, {
		name : "Magic Resistance",
		description : "The imp has Advantage on saving throws against spells and other magical effects.",
		joinString : "\n   ",
	}], 
	actions : [{
		name : "Invisibility",
		description : "The imp casts Invisibility on itself, requiring no spell components and using Charisma as the spellcasting ability",
		joinString : "\n   ",
	}, {
		name : "Shape-Shift",
		description : "The imp shape-shifts to resemble a rat (Speed 20 ft..), a raven (20ft., Fly 60ft.), or a spider (20ft., Climb 20 ft..), or it returns to its true form. Its statistics are the same in each form, except for its Speed changes noted. Any equipment it is wearing or carrying isn't transformed. It reverts to its true form if it dies.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Sting",
		ability : 2,
		damage : [1, 6, "Piercing"],
		description : "On a hit this attack deals an additional 2d6 Poison damage",
		range : "Melee (5 ft.)",
	}],
};
CreatureList["lion"] = {
	name : "Lion",
	regExpSearch : /lion/i,
	source : [["PHB2024", 352]],
	size : 2,
	type : "Beast",
	alignment : "Unaligned",
	ac : 12,
	hp : 22,
	hd : [4, 10],
	speed : "50 ft.",
	scores : [17, 15, 11, 3, 12, 8],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Perception" : 3,
		"Stealth" : 4,
	},
	senses : "Darkvision 60 ft.",
	passivePerception : 13,
	languages : "None",
	challengeRating : "1",
	proficiencyBonus : 2,
	attacksAction : 2,
	actions : [{
		name : "Roar",
		description : "Wisdom Saving Throw: DC 11, one creature within 15 feet. Failure: The target has the Frightened condition until the start of the lion's next turn.",
		joinString : "\n   "
	}, {
		name : "Multiattack",
		description : "The lion makes two Rend attacks. It can replace one of these attacks with a use of Roar.",
	}],
	features : [{
		name : "Pack Tactics",
		description : "The lion has Advantage on an attack roll against a creature if at least one of the lion's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
		joinString : "\n   "
	}, {
		name : "Running Leap",
		description : "With a 10-foot running start, the lion can Long Jump up to 25 feet.",
		joinString : "\n   "
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 8, "Slashing"],
		range : "Melee (5 ft.)",
		description : "Two Rend attacks as an Attack action. Can replace one of these attacks with a use of Roar.",
	}],
	wildshapeString : "Pack Tactics: The lion has Advantage on an attack roll against a creature if at least one of the lion's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition| Running Leap: With a 10-foot running start, the lion can Long Jump up to 25 feet.",
};
CreatureList["lizard"] = {
	name : "Lizard",
	regExpSearch : /lizard/i,
	source : [["PHB2024", 353]],
	size : 5,
	type : "Beast",
	alignment : "Unaligned",
	companion : "familiar",
	ac : 10,
	hp : 2,
	hd : [1, 4],
	speed : "20 ft., Climb 20 ft.",
	scores : [2, 11, 10, 1, 8, 3],
	saves : ["", "", "", "", "", ""],
	skills : {		
	},
	senses : "Darkvision 30 ft.",
	passivePerception : 9,
	languages : "None",
	challengeRating : "0",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
		name : "Spider Climb",
		description : "The lizard can climb difficult surfaces, including along ceilings, without needing to make an ability check.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Bite",
		ability : 2,
		damage : [1, "", "Piercing"],
		range : "Melee (5 ft.)",
	}],
	wildshapeString : "Spider Climb: The lizard can climb difficult surfaces, including along ceilings, without needing to make an ability check.",
};
CreatureList["mastiff"] = {
	name : "Mastiff",
	regExpSearch : /mastiff/i,
	source : [["PHB2024", 353]],
	size : 3,
	type : "Beast",
	alignment : "Unaligned",
	companion : "mount",
	ac : 12,
	hp : 5,
	hd : [1, 8],
	speed : "40 ft.",
	scores : [13, 14, 12, 3, 12, 7],
	saves : ["", "", "", "", 3, ""],
	skills : {	
		"Perception" : 5,
	},
	senses : "Darkvision 60 ft.",
	passivePerception : 15,
	languages : "None",
	challengeRating : "1/8",
	proficiencyBonus : 2,
	attacksAction : 1,
	attacks : [{
		name : "Bite",
		ability : 1,
		damage : [1, 6, "Piercing"],
		range : "Melee (5 ft.)",
		description : "On a hit, a Large or smaller target has the Prone condition.", 
	}],
};
CreatureList["mule"] = {
	name : "Mule",
	regExpSearch : /mule/i,
	source : [["PHB2024", 353]],
	size : 3,
	type : "Beast",
	alignment : "Unaligned",
	companion : "mount",
	ac : 10,
	hp : 11,
	hd : [2, 8],
	speed : "40 ft.",
	scores : [14, 10, 13, 3, 10, 5],
	saves : [4, "", "", "", "", ""],
	senses : "",
	passivePerception : 10,
	languages : "None",
	challengeRating : "1/8",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
		name : "Beast of Burden",
		description : "The mule counts as one size larger for the purpose of determining its carrying capacity.",
		joinString : "\n   "
	}],
	attacks : [{
		name : "Hooves",
		ability : 1,
		damage : [1, 4, "Bludgeoning"],
		range : "Melee (5 ft.)",
	}],
	wildshapeString : "Beast of Burden: The mule counts as one size larger for the purpose of determining its carrying capacity.",
};
CreatureList["octopus"] = {
	name : "Octopus",
	regExpSearch : /octopus/i,
	source : [["PHB2024", 353]],
	size : 4,
	type : "Beast",
	alignment : "Unaligned",
	companion : "familiar",
	ac : 12,
	hp : 3,
	hd : [1, 6],
	speed : "5 ft., Swim 30 ft.",
	scores : [4, 15, 11, 3, 10, 4],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Perception" : 2,
		"Stealth" : 6,
	},
	senses : "Darkvision 30 ft.",
	passivePerception : 12,
	languages : "None",
	challengeRating : "0",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
		name : "Compression",
		description : "The octopus can move through a space as narrow as 1 inch without squeezing.",
		joinString : "\n   ",
	}, {
		name : "Water Breathing",
		description : "The octopus can breathe only underwater.",
		joinString : "\n   ",
	}], 
	actions : [{
		name : "Ink Cloud (1/Day)",
		description : "As a Reaction, Trigger: A creature ends its turn within 5 feet of the octopus while underwater. Response: The octopus releases ink that fills a 5-foot Cube centered on itself, and the octopus moves up to its Swim Speed away from the triggering creature.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Tentacles",
		ability : 2,
		damage : [1, "", "Bludgeoning"],
		range : "Melee (5 ft.)",
	}],
	wildshapeString : "Compression: The octopus can move through a space as narrow as 1 inch without squeezing| Water Breathing: The octopus can breathe only underwater.",
};
CreatureList["owl"] = {
	name : "Owl",
	regExpSearch : /owl/i,
	source : [["PHB2024", 354]],
	size : 5,
	type : "Beast",
	alignment : "Unaligned",
	companion : "familiar",
	ac : 11,
	hp : 1,
	hd : [1, 4],
	speed : "5 ft., Fly 60 ft.",
	scores : [3, 13, 8, 2, 12, 7],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Perception" : 5,
		"Stealth" : 5,
	},
	senses : "Darkvision 120 ft.",
	passivePerception : 15,
	languages : "None",
	challengeRating : "0",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
		name : "Flyby",
		description : "The owl doesn't provoke Opportunity Attacks when it flies out of an enemy's reach.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Talons",
		ability : 2,
		damage : [1, "", "Slashing"],
		range : "Melee (5 ft.)",
	}],
	wildshapeString : "Flyby: The owl doesn't provoke Opportunity Attacks when it flies out of an enemy's reach.",
};
CreatureList["panther"] = {
	name : "Panther",
	regExpSearch : /panther/i,
	source : [["PHB2024", 354]],
	size : 3,
	type : "Beast",
	alignment : "Unaligned",
	ac : 12,
	hp : 13,
	hd : [3, 8],
	speed : "50 ft., Climb 40 ft.",
	scores : [14, 15, 10, 3, 14, 7],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Perception" : 4,
		"Stealth" : 6,
	},
	senses : "Darkvision 60 ft.",
	passivePerception : 14,
	languages : "None",
	challengeRating : "1/4",
	proficiencyBonus : 2,
	attacksAction : 1,
	actions : [{
		name : "Prowl",
		description : "The panther moves up to half its Speed without provoking Opportunity Attacks. At the end of this movement, the panther can take the Hide action.",
		joinString : "\n   ",
	}, {
		name : "Multiattack",
		description : "The panther makes one Pounce attack and uses Prowl.",
	}],
	attacks : [{
		name : "Pounce",
		ability : 1,
		damage : [1, 4, "Slashing"],
		range : "Melee (5 ft.)",
		description : "The panther deals 7 (2d4 +2) Slashing damage if it had Advantage on the attack roll. The panther makes one Pounce attack and uses Prowl.",
	}],
};
CreatureList["pony"] = {
	name : "Pony",
	regExpSearch : /pony/i,
	source : [["PHB2024", 354]],
	size : 3,
	type : "Beast",
	alignment : "Unaligned",
	companion : "mount",
	ac : 10,
	hp : 11,
	hd : [2, 8],
	speed : "40 ft.",
	scores : [15, 10, 13, 2, 11, 7],
	saves : [4, "", "", "", "", ""],
	senses : "",
	passivePerception : 10,
	languages : "None",
	challengeRating : "1/8",
	proficiencyBonus : 2,
	attacksAction : 1,
	attacks : [{
		name : "Hooves",
		ability : 1,
		damage : [1, 4, "Bludgeoning"],
		range : "Melee (5 ft.)",
	}],
};
CreatureList["pseudodragon"] = {
	name : "Pseudodragon",
	regExpSearch : /pseudodragon/i,
	source : [["PHB2024", 354]],
	size : 5,
	type : "Dragon",
	alignment : "Neutral Good",
	companion : "pact_of_the_chain",
	ac : 14,
	hp : 10,
	hd : [3, 4],
	speed : "15 ft., Fly 60 ft.",
	scores : [6, 15, 13, 10, 12, 10],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Perception" : 5,
		"Stealth" : 4,
	},
	senses : "Blindsight 10ft, Darkvision 60 ft.",
	passivePerception : 15,
	languages : "Understands Common and Draconic but can't speak",
	challengeRating : "1/4",
	proficiencyBonus : 2,
	attacksAction : 2,
	features : [{
		name : "Magic Resistance",
		description : "The pseudodragon has Advantage on saving throws against spells and other magical effects.",
		joinString : "\n   ",
	}], 
	actions : [{
		name : "Sting",
		description : "Constitution Saving Throw: DC 12, one creature the pseudodragon can see within 5 feet. Failure 2d4+2 Poison damage, and the target has the Poisoned condition for 1 hour. Failure by 5 or More: The Poisoned target also has the Unconscious Condition until it takes damage or another creature uses an action to shake it awake.",
		joinString : "\n   ",
	}, {
		name : "Multiattack",
		description : "The pseudodragon makes two Bite attacks.",
	}],
	attacks : [{
		name : "Bite",
		ability : 2,
		damage : [1, 4, "Piercing"],
		description : "Two Bite attacks as an Attack action.",
		range : "Melee (5 ft.)",
	}],
};
CreatureList["quasit"] = {
	name : "Quasit",
	regExpSearch : /quasit/i,
	source : [["PHB2024", 355]],
	size : 5,
	type : "Fiend",
	subtype : "demon",
	alignment : "Chaotic Evil",
	companion : "pact_of_the_chain",
	ac : 13,
	hp : 25,
	hd : [10, 4],
	speed : "40 ft.",
	scores : [5, 17, 10, 7, 10, 10],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Stealth" : 5,
	},
	damage_resistances : "Cold; Fire; Lightning",
	damage_immunities : "Poison",
	condition_immunities : "Poisoned",
	senses : "Darkvision 120 ft.",
	passivePerception : 10,
	languages : "Abyssal, Common",
	challengeRating : "1",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
		name : "Magic Resistance",
		description : "The quasit has Advantage on saving throws against spells and other magical effects.",
		joinString : "\n   ",
	}], 
	actions : [{
		name : "Invisibility",
		description : "The quasit casts Invisibility on itself, requiring no spell components and using Charisma as the spellcasting ability",
		joinString : "\n   ",
	}, {
		name : "Scare (1/Day)",
		description : "Wisdom Saving Throw: DC 10, one creature within 20 feet. Failure: The target has the Frightened condition. At the end of each of its turns, the target repeats the save, ending the effect on itself on a success. After 1 minute, it succeeds automatically.",
		joinString : "\n   ",
	}, {
		name : "Shape-Shift",
		description : "The quasit shape-shifts to resemble a bat (Speed 10 ft.., Fly 40 ft..), a centipede (40 ft.., Climb 40 ft..), or a toad (40 ft.., Swim 40 ft..), or it returns to its true form. Its statistics are the same in each form, except for its Speed changes noted. Any equipment it is wearing or carrying isn't transformed. It reverts to its true form if it dies.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 2,
		damage : [1, 4, "Slashing"],
		description : "and the target has the Poisoned condition until the start of the quasit's next turn.",
		range : "Melee (5 ft.)",
	}],
};
CreatureList["rat"] = {
	name : "Rat",
	regExpSearch : /rat/i,
	source : [["PHB2024", 355]],
	size : 5,
	type : "Beast",
	alignment : "Unaligned",
	companion : "familiar",
	ac : 10,
	hp : 1,
	hd : [1, 4],
	speed : "20 ft., Climb 20 ft.",
	scores : [2, 11, 9, 2, 10, 4],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Perception" : 2,			
	},
	senses : "Darkvision 30 ft.",
	passivePerception : 12,
	languages : "None",
	challengeRating : "0",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
	name : "Agile",
	description : "The rat doesn't provoke Opportunity Attacks when it moves out of an enemy's reach.",
	joinString : "\n   "
	}],
	attacks : [{
		name : "Bite",
		ability : 2,
		damage : [1, "", "Piercing"],
		range : "Melee (5 ft.)",
	}],
	wildshapeString : "Agile: The rat doesn't provoke Opportunity Attacks when it moves out of an enemy's reach.",
};
CreatureList["raven"] = {
	name : "Raven",
	regExpSearch : /raven/i,
	source : [["PHB2024", 355]],
	size : 5,
	type : "Beast",
	alignment : "Unaligned",
	companion : "familiar",
	ac : 12,
	hp : 2,
	hd : [1, 4],
	speed : "10 ft., Fly 50 ft.",
	scores : [2, 14, 10, 5, 13, 6],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Perception" : 3,		
	},
	senses : "",
	passivePerception : 13,
	languages : "None",
	challengeRating : "0",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
	name : "Mimicry",
	description : "The raven can mimic simple sounds it has heard, such as a whisper or chitter. A hearer can discern the sounds are imitations with a successful DC 10 Wisdom (Insight) check.",
	joinString : "\n   "
	}],
	attacks : [{
		name : "Beak",
		ability : 2,
		damage : [1, "", "Piercing"],
		range : "Melee (5 ft.)",
	}],
	wildshapeString : "Mimicry: The raven can mimic simple sounds it has heard, such as a whisper or chitter. A hearer can discern the sounds are imitations with a successful DC 10 Wisdom (Insight) check.",
};
CreatureList["reef shark"] = {
	name : "Reef Shark",
	regExpSearch : /^(?=.*(reef))(?=.*(shark)).*$/i,
	source : [["PHB2024", 356]],
	size : 3,
	type : "Beast",
	alignment : "Unaligned",
	ac : 12,
	hp : 22,
	hd : [4, 8],
	speed : "5 ft., Swim 30 ft.",
	scores : [14, 15, 13, 1, 10, 4],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Perception" : 2,		
	},
	senses : "Blindsight 30 ft.",
	passivePerception : 12,
	languages : "None",
	challengeRating : "1/2",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
	name : "Pack Tactics",
	description : "The shark has Advantage on an attack roll against a creature if at least one of the shark's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
	joinString : "\n   "
	}, {
		name : "Water Breathing",
		description : "The shark can breathe only underwater.",
		joinString : "\n   "
	}],
	attacks : [{
		name : "Bite",
		ability : 1,
		damage : [2, 4, "Piercing"],
		range : "Melee (5 ft.)",
	}],
	wildshapeString : "Pack Tactics: The shark has Advantage on an attack roll against a creature if at least one of the shark's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition| Water Breathing: The shark can breathe only underwater.",
};
CreatureList["riding horse"] = {
	name : "Riding Horse",
	regExpSearch : /^(?=.*(riding))(?=.*(horse)).*$/i,
	source : [["PHB2024", 356]],
	size : 2,
	type : "Beast",
	alignment : "Unaligned",
	companion : "mount",
	ac : 11,
	hp : 13,
	hd : [2, 10],
	speed : "60 ft.",
	scores : [16, 13, 12, 2, 11, 7],
	saves : ["", "", "", "", "", ""],
	senses : "",
	passivePerception : 10,
	languages : "None",
	challengeRating : "1/4",
	proficiencyBonus : 2,
	attacksAction : 1,
	attacks : [{
		name : "Hooves",
		ability : 1,
		damage : [1, 8, "Bludgeoning"],
		range : "Melee (5 ft.)",
	}],
};
CreatureList["scorpion"] = {
	name : "Scorpion",
	regExpSearch : /scorpion/i,
	source : [["PHB2024", 356]],
	size : 5,
	type : "Beast",
	alignment : "Unaligned",
	ac : 11,
	hp : 1,
	hd : [1, 4],
	speed : "10 ft.",
	scores : [2, 11, 8, 1, 8, 2],
	saves : ["", "", "", "", "", ""],
	senses : "Blindsight 10 ft.",
	passivePerception : 9,
	languages : "None",
	challengeRating : "0",
	proficiencyBonus : 2,
	attacksAction : 1,
	attacks : [{
		name : "Sting",
		ability : 1,
		damage : [1, "", "Piercing"],
		range : "Melee (5 ft.)",
		description : "On a hit, target takes an additional 3 (1d6) Poison damage.",
	}],
};
CreatureList["skeleton"] = {
	name : "Skeleton",
	regExpSearch : /skeleton/i,
	source : [["PHB2024", 355]],
	size : 3,
	type : "Undead",
	alignment : "Lawful Evil",
	companion : "pact_of_the_chain",
	ac : 13,
	hp : 13,
	hd : [2, 8],
	speed : "30 ft.",
	scores : [10, 16, 15, 6, 8, 5],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Stealth" : 5,
	},
	damage_vulnerabilities : "Bludgeoning",
	damage_immunities : "Poison",
	condition_immunities : "Exhausted; Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 9,
	languages : "Understands the languages it knew in life but can't speak",
	challengeRating : "1/4",
	proficiencyBonus : 2,
	attacksAction : 1,
	attacks : [{
		name : "Shortsword",
		ability : 2,
		damage : [1, 6, "Piercing"],
		range : "Melee (5 ft.)",
	}, {
		name : "Shortbow",
		ability : 2,
		damage : [1, 6, "Piercing"],
		range : "80/320",
	}],
};
CreatureList["slaad Tadpole"] = {
	name : "Slaad Tadpole",
	regExpSearch : /^(?=.*(slaad))(?=.*(tadpole)).*$/i,
	source : [["PHB2024", 357]],
	size : 5,
	type : "Aberration",
	alignment : "Chaotic Neutral",
	companion : "pact_of_the_chain",
	ac : 12,
	hp : 7,
	hd : [3, 4],
	speed : "30 ft., Burrow 10 ft.",
	scores : [7, 15, 10, 3, 5, 3],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Stealth" : 4,
	},
	damage_immunities : "Acid; Cold; Fire; Lightning; Thunder",
	senses : "Darkvision 60 ft.",
	passivePerception : 7,
	languages : "Understands Slaad but can't speak",
	challengeRating : "1/8",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
		name : "Magic Resistance",
		description : "The slaad has Advantage on saving throws against spells and other magical effects",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Bite",
		ability : 2,
		damage : [1, 6, "Piercing"],
		range : "Melee (5 ft.)",
	}],
};
CreatureList["sphinx of wonder"] = {
	name : "Sphinx of Wonder",
	regExpSearch : /^(?=.*(sphinx))(?=.*(wonder)).*$/i,
	source : [["PHB2024", 357]],
	size : 5,
	type : "Celestial",
	alignment : "Lawful Good",
	companion : "pact_of_the_chain",
	ac : 13,
	hp : 24,
	hd : [7, 4],
	speed : "20 ft., Fly 40 ft.",
	scores : [6, 17, 13, 15, 12, 11],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Arcana" : 4,
		"Religion" : 4,
		"Stealth" : 5,
	},
	damage_resistances : "Necrotic; Psychic; Radiant",
	senses : "Darkvision 60 ft.",
	passivePerception : 11,
	languages : "Celestial, Common",
	challengeRating : "1",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
		name : "Magic Resistance",
		description : "The sphinx has Advantage on saving throws against spells and other magical effects",
		joinString : "\n   ",
	}, {
		name : "Burst of Ingenuity (2/Day)",
		description : "Reaction. Trigger: he sphinx or another creature within 30 feet makes an ability check or a saving throw. Response: The sphinx adds 2 to the roll.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 2,
		damage : [1, 4, "Slashing"],
		description : "plus 2d6 Radiant damage",
		range : "Melee (5 ft.)",
	}],
};
CreatureList["spider"] = {
	name : "Spider",
	regExpSearch : /spider/i,
	source : [["PHB2024", 357]],
	size : 5,
	type : "Beast",
	alignment : "Unaligned",
	companion : "familiar",
	ac : 12,
	hp : 1,
	hd : [1, 4],
	speed : "20 ft., Climb 20 ft.",
	scores : [2, 14, 8, 1, 10, 2],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Stealth" : 4,		
	},
	senses : "Darkvision 30 ft.",
	passivePerception : 10,
	languages : "None",
	challengeRating : "0",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
		name : "Spider Climb",
		description : "The spider can climb difficult surfaces including ceilings, without needing to make an ability check.",
		joinString : "\n   "
	}, {
		name : "Web Walker",
		description : "The spider ignores movement restrictions caused by webs, and the spider knows the location of any other creature in contact with the same web.",
		joinString : "\n   "
	}],
	attacks : [{
		name : "Bite",
		ability : 2,
		damage : [1, "", "Piercing"],
		description : "and the target must succeed on a DC 9 Constitution saving throw or take 1d4 poison damage",
		range : "Melee (5 ft.)",
	}],
	wildshapeString : "Spider Climb: The spider can climb difficult surfaces including ceilings, without needing to make an ability check| Web Walker: The spider ignores movement restrictions caused by webs, and the spider knows the location of any other creature in contact with the same web.",
};
CreatureList["sprite"] = {
	name : "Sprite",
	regExpSearch : /sprite/i,
	source : [["PHB2024", 358]],
	size : 5,
	type : "Fey",
	alignment : "Neutral Good",
	companion : "pact_of_the_chain",
	ac : 15,
	hp : 10,
	hd : [4, 4],
	speed : "10 ft., Fly 40 ft.",
	scores : [3, 18, 10, 14, 13, 11],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Perception" : 3,
		"Stealth" : 8,
	},
	senses : "",
	passivePerception : 13,
	languages : "Common, Elvish, Sylvan",
	challengeRating : "1/4",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
		name : "Heart Sight",
		description : "Charisma Saving Throw: DC 10, one creature within 5 feet the sprite can see. Celestials, Fiends, and Undead automatically fail the save. Failure: The sprite knows the target's emotions and alignment.",
		joinString : "\n   ",
	}, {
		name : "Invisibility",
		description : "The Sprite casts Invisibility on itself, requiring no spell components and using Charisma as the spellcasting ability",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Needle Sword",
		ability : 2,
		damage : [1, 4, "Piercing"],
		range : "Melee (5 ft.)",
	}, {
		name : "Enchanting Bow",
		ability : 2,
		damage : [1, "", "Piercing"],
		description : "and the target has the Charmed condition until the start of the sprite's next turn.",
		range : "40/60",
	}],
};
CreatureList["tiger"] = {
	name : "Tiger",
	regExpSearch : /tiger/i,
	source : [["PHB2024", 358]],
	size : 2,
	type : "Beast",
	alignment : "Unaligned",
	ac : 13,
	hp : 22,
	hd : [3, 10],
	speed : "40 ft.",
	scores : [17, 16, 14, 3, 12, 8],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Perception" : 3,
		"Stealth" : 7,
	},
	senses : "Darkvision 60 ft.",
	passivePerception : 13,
	languages : "None",
	challengeRating : "1",
	proficiencyBonus : 2,
	attacksAction : 1,
	actions : [{
		name : "Prowl",
		description : "The tiger moves up to half its Speed without provoking Opportunity Attacks. At the end of this movement, the tiger can take the Hide action.",
		joinString : "\n   ",
	}, {
		name : "Multiattack",
		description : "The tiger makes one Pounce attack and uses Prowl.",
	}],
	attacks : [{
		name : "Pounce",
		ability : 1,
		damage : [1, 6, "Slashing"],
		range : "Melee (5 ft.)",
		description : "The tiger deals an extra 3 (1d6) Slashing damage if it had Advantage on the attack roll and, if the target is Huge or smaller, it has the Prone condition. The tiger makes one Pounce attack and uses Prowl.",
	}],
};
CreatureList["venomous snake"] = {
	name : "Venomous Snake",
	regExpSearch : /^(?=.*(venomous))(?=.*(snake)).*$/i,
	source : [["PHB2024", 358]],
	size : 5,
	type : "Beast",
	alignment : "Unaligned",
	companion : "pact_of_the_chain",
	ac : 12,
	hp : 5,
	hd : [2, 4],
	speed : "30 ft., Swim 30 ft.",
	scores : [2, 15, 11, 1, 10, 3],
	saves : ["", "", "", "", "", ""],
	skills : {
	},
	senses : "Blindsight 10 ft.",
	passivePerception : 10,
	languages : "None",
	challengeRating : "1/8",
	proficiencyBonus : 2,
	attacksAction : 1,
	attacks : [{
		name : "Bite",
		ability : 2,
		damage : [1, "", "Piercing"],
		description : "and the target must make a DC 10 Constitution saving throw, taking 2d4 poison damage on a failed save, or half as much damage on a successful one.",
		range : "Melee (5 ft.)",
	}],
};
CreatureList["warhorse"] = {
	name : "Warhorse",
	regExpSearch : /warhorse/i,
	source : [["PHB2024", 359]],
	size : 2,
	type : "Beast",
	alignment : "Unaligned",
	companion : "mount",
	ac : 11,
	hp : 19,
	hd : [3, 10],
	speed : "60 ft.",
	scores : [18, 12, 13, 2, 12, 7],
	saves : ["", "", "", "", 3, ""],
	senses : "",
	passivePerception : 11,
	languages : "None",
	challengeRating : "1/2",
	proficiencyBonus : 2,
	attacksAction : 1,
	attacks : [{
		name : "Hooves",
		ability : 1,
		damage : [2, 4, "Bludgeoning"],
		description : "If the warhorse moved at least 20 feet straight toward the target immediately before the hit, the target takes an extra 5 (2d4) Bludgeoning damage and, if it is Huge or smaller, has the Prone condition.",
	}],
};
CreatureList["weasel"] = {
	name : "Weasel",
	regExpSearch : /weasel/i,
	source : [["PHB2024", 359]],
	size : 5,
	type : "Beast",
	alignment : "Unaligned",
	companion : "familiar",
	ac : 13,
	hp : 1,
	hd : [1, 4],
	speed : "30 ft., Climb 30 ft.",
	scores : [3, 16, 8, 2, 12, 3],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Acrobatics" : 5,
		"Perception" : 3,
		"Stealth" : 5,		
	},
	senses : "Darkvision 60 ft.",
	passivePerception : 11,
	languages : "None",
	challengeRating : "0",
	proficiencyBonus : 2,
	attacksAction : 1,
	attacks : [{
		name : "Bite",
		ability : 2,
		damage : [1, "", "Piercing"],
		range : "Melee (5 ft.)",
	}],
};
CreatureList["wolf"] = {
	name : "Wolf",
	regExpSearch : /wolf/i,
	source : [["PHB2024", 359]],
	size : 3,
	type : "Beast",
	alignment : "Unaligned",
	ac : 12,
	hp : 11,
	hd : [2, 8],
	speed : "40 ft.",
	scores : [14, 15, 12, 3, 12, 6],
	saves : ["", "", "", "", "", ""],
	skills : {
		"Perception" : 5,
		"Stealth" : 4,		
	},
	senses : "Darkvision 60 ft.",
	passivePerception : 15,
	languages : "None",
	challengeRating : "1/4",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
		name : "Pack Tactics",
		description : "The wolf has Advantage on attack rolls against a creature if at least one of the wolf's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Bite",
		ability : 1,
		damage : [1, 6, "Piercing"],
		range : "Melee (5 ft.)",
		description : "If the target is Medium or smaller, it has the Prone condition.",
	}],
	wildshapeString : "Pack Tactics: The wolf has Advantage on attack rolls against a creature if at least one of the wolf's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
};
CreatureList["zombie"] = {
	name : "Zombie",
	regExpSearch : /zombie/i,
	source : [["PHB2024", 359]],
	size : 3,
	type : "Undead",
	alignment : "Neutral Evil",
	ac : 8,
	hp : 15,
	hd : [2, 8],
	speed : "20 ft.",
	scores : [13, 6, 16, 3, 6, 5],
	saves : ["", "", "", "", 0, ""],
	damage_immunities : "Poison",
	condition_immunities : "Exhausted; Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 8,
	languages : "Understands the languages it knew in life but can't speak",
	challengeRating : "1/4",
	proficiencyBonus : 2,
	attacksAction : 1,
	features : [{
		name : "Undead Fortitude",
		description : "If damage reduces the zombie to 0 Hit Points, it must make a Constitution saving throw with a DC of 5 plus the damage taken unless the damage is Radiant or from a Critical Hit. On a successful save, the zombie drops to 1 Hit Point instead.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Slam",
		ability : 1,
		damage : [1, 6, "Bludgeoning"],
		range : "Melee (5 ft.)",
	}],
};
CreatureList["beast of the land"] = {
	name : "Beast of the Land",
	source : [["PHB2024", 123]],
	regExpSearch : /^(?=.*beast)(?=.*of)(?=.*the)(?=.*land).*$/i,
	size : 3,
	type : ["Beast"],
	companion : ["companion"],
	companionApply : "companion",
	alignment : "Neutral",
	ac : "11+oWis",
	hp : 10,
	hd : [1, 8],
	hdLinked : ["ranger"],
	speed : "40 ft, climb 40 ft",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [14, 14, 15, 8, 14, 11],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	attacksAction : 1,
	addMod : [
			{ type : "skill", field : "all", mod : "Prof", text : "The primal companion adds it proficiency bonus to all its ability check and saving throws." },
			{ type : "skill", field : "Init", mod : "Prof", text : "The primal companion adds it proficiency bonus to all its ability check and saving throws." },
			{ type : "save", field : "all", mod : "Prof", text : "The primal companion adds it proficiency bonus to all its ability check and saving throws." }
		],
	calcChanges : {
		hp : function (totalHD, HDobj, prefix) {
			if (!classes.known.ranger && !classes.known.ranger_ua23pt6) return;
			var rgrLvl = classes.known.ranger ? classes.known.ranger.level : classes.known.ranger_ua23pt6.level;
			HDobj.alt.push(5 + 5 * rgrLvl);
			HDobj.altStr.push(" = 5 as a base\n + " + "5 \xD7" + rgrLvl + " from its master's Ranger level");
		},
		setAltHp : true,
		hpForceRecalc : true,
	},
	attacks : [{
		name : "Beast's Strike",
		ability : 1,
		damage : [1, 8, "Bludg./Pierc./Slash."],
		modifiers : ["", "oWis"],
		range : "Melee (5 ft)",
		description : "+1d6 damage if hits after moving 20 ft straight in same round, if taget is Large or smaller it falls Prone.",
		tooltip : "If the beast moved at least 20 feet straight toward the target before the hit, the target takes an extra 1d6 damageof the same type, and the target has the Prone condition if it is a Large or smaller creature.",
		useSpellMod : "ranger",
	}],
	languages : "understands the languages you speak",
	features : [{
		name : "Primal Bond",
		description : "You can add your Proficiency Bonus to any ability check or saving throw that the beast makes.",
		joinString : "\n   ",
	}],
	header : "Companion",
};
CreatureList["beast of the sea"] = {
	name : "Beast of the Sea",
	source : [["PHB2024", 124]],
	regExpSearch : /^(?=.*beast)(?=.*of)(?=.*the)(?=.*sea).*$/i,
	size : 3,
	type : ["Beast"],
	companion : ["companion"],
	companionApply : "companion",
	alignment : "Neutral",
	ac : "11+oWis",
	hp : 10,
	hd : [1, 8],
	hdLinked : ["ranger", "ranger_ua23pt6"],
	speed : "5 ft, swim 60 ft",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [14, 14, 15, 8, 14, 11],
	attacksAction : 1,
	addMod : [
			{ type : "skill", field : "all", mod : "Prof", text : "The primal companion adds it proficiency bonus to all its ability check and saving throws." },
			{ type : "skill", field : "Init", mod : "Prof", text : "The primal companion adds it proficiency bonus to all its ability check and saving throws." },
			{ type : "save", field : "all", mod : "Prof", text : "The primal companion adds it proficiency bonus to all its ability check and saving throws." }
		],
	calcChanges : {
		hp : function (totalHD, HDobj, prefix) {
			if (!classes.known.ranger && !classes.known.ranger_ua23pt6) return;
			var rgrLvl = classes.known.ranger ? classes.known.ranger.level : classes.known.ranger_ua23pt6.level;
			HDobj.alt.push(5 + 5 * rgrLvl);
			HDobj.altStr.push(" = 5 as a base\n + " + "5 \xD7" + rgrLvl + " from its master's Ranger level");
		},
		setAltHp : true,
		hpForceRecalc : true,
	},
	attacks : [{
		name : "Beast's Strike",
		ability : 1,
		damage : [1, 6, "Bludg./Slash."],
		modifiers : ["", "oWis"],
		range : "Melee (5 ft)",
		description : "Target has the Grappled condition (escape DC = my Spell Save DC)",
		useSpellMod : "ranger",
	}],
	languages : "understands the languages you speak",
	features : [{
		name : "Primal Bond",
		description : "You can add your Proficiency Bonus to any ability check or saving throw that the beast makes.",
		joinString : "\n   ",
	}, {
		name : "Amphibious",
		description : "The beast can breathe air and water.",
		joinString : "\n   ",
	}],
	header : "Companion",
};
CreatureList["beast of the sky"] = {
	name : "Beast of the Sky",
	source : [["PHB2024", 124]],
	regExpSearch : /^(?=.*beast)(?=.*of)(?=.*the)(?=.*sky).*$/i,
	size : 4,
	type : ["Beast"],
	companion : ["companion"],
	companionApply : "companion",
	alignment : "Neutral",
	ac : "10+oWis",
	hp : 8,
	hd : [1, 6],
	hdLinked : ["ranger", "ranger_ua23pt6"],
	speed : "10 ft, fly 60 ft",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	challengeRating : "0",
	scores : [6, 16, 13, 8, 14, 11],
	attacksAction : 1,
	addMod : [
			{ type : "skill", field : "all", mod : "Prof", text : "The primal companion adds it proficiency bonus to all its ability check and saving throws." },
			{ type : "skill", field : "Init", mod : "Prof", text : "The primal companion adds it proficiency bonus to all its ability check and saving throws." },
			{ type : "save", field : "all", mod : "Prof", text : "The primal companion adds it proficiency bonus to all its ability check and saving throws." }
		],
	calcChanges : {
		hp : function (totalHD, HDobj, prefix) {
			if (!classes.known.ranger && !classes.known.ranger_ua23pt6) return;
			var rgrLvl = classes.known.ranger ? classes.known.ranger.level : classes.known.ranger_ua23pt6.level;
			HDobj.alt.push(4 + 4 * rgrLvl);
			HDobj.altStr.push(" = 4 as a base\n + " + "4 \xD7" + rgrLvl + " from its master's Ranger level");
		},
		setAltHp : true,
		hpForceRecalc : true,
	},
	attacks : [{
		name : "Beast's Strike",
		ability : 2,
		damage : [1, 4, "Slashing"],
		modifiers : ["", "oWis"],
		range : "Melee (5 ft)",
		description : "",
		tooltip : "",
		useSpellMod : "ranger",
	}],
	languages : "understands the languages you speak",
	features : [{
		name : "Primal Bond",
		description : "You can add your Proficiency Bonus to any ability check or saving throw that the beast makes.",
		joinString : "\n   ",
	}, {
		name : "Flyby",
		description : "The beast doesn’t provoke Opportunity Attacks when it flies out of an enemy’s reach.",
		joinString : "\n   ",
	}],
	header : "Companion",
};
//Animated Object Stat Blocks
CompanionList["animated object"] = {
	name : "Animated Object",
	nameMenu : "Animated Object (Animate Object Spell)",
	nameOrigin : "Animated Object of the Animate Object 5th-level transmutation spell",
	source : [["PHB2024", 240]],
	attributesChange : function(sCrea, objCrea) {
        var casters = isSpellUsed('animate object');
        var oScore = undefined;
        
        for (var caster of casters) {
            if (CurrentSpells[caster].refType !== "class") continue;
            
            var ability = CurrentSpells[caster].ability;
    
            var abilityMod = What(AbilityScores.abbreviations[ability - 1] + " Mod");
            
            if (oScore === undefined || abilityMod > What(AbilityScores.abbreviations[oScore[1] - 1] + " Mod")) {
                oScore = [caster, ability];
            }
        }

        if (oScore === undefined) return;
    
        for (var i = 0; i < objCrea.attacks.length; i++) {
            var oAtk = objCrea.attacks[i];
            oAtk.useSpellMod = oScore[0];
        }
        
    },
};
CreatureList["animated object (tsm)"] = {
	name : "Animated Object (Tiny/Small/Medium)",
	regExpSearch : /^(?=.*animated)(?=.*object)(?=.*tsm).*$/i,
	source : [["PHB2024", 241]],
	size : [3, 4, 5],
	type : "Construct",
	alignment : "Unaligned",
	companion : "animated object",
	companionApply : "animated object",
	ac : 15,
	hp : 10,
	hd : [2, 8],
	speed : "30 ft.",
	scores : [16, 10, 10, 3, 3, 1],
	damage_immunities : "Poison, Psychic",
	condition_immunities : "Charmed, Exhaustion, Frightened, Paralyzed, Poisoned",
	senses : "Blindsight 30 ft.",
	passivePerception : 6,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 1,
	attacks : [{
		name : "Slam",
		ability : 1,
		damage : [1, 4, "Force"],
		range : "Melee (5 ft.)",
		useSpellMod : ["bard", "sorcerer", "wizard"]
	}],
};
CreatureList["animated object (l)"] = {
	name : "Animated Object (Large)",
	regExpSearch : /^(?=.*animated)(?=.*object)(?=.*l).*$/i,
	source : [["PHB2024", 241]],
	size : 2,
	type : "Construct",
	alignment : "Unaligned",
	companion : "animated object",
	companionApply : "animated object",
	ac : 15,
	hp : 20,
	hd : [4, 8],
	speed : "30 ft.",
	scores : [16, 10, 10, 3, 3, 1],
	damage_immunities : "Poison, Psychic",
	condition_immunities : "Charmed, Exhaustion, Frightened, Paralyzed, Poisoned",
	senses : "Blindsight 30 ft.",
	passivePerception : 6,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 1,
	attacks : [{
		name : "Slam",
		ability : 1,
		damage : [2, 6, "Force"],
		range : "Melee (5 ft.)",
		useSpellMod : ["bard", "sorcerer", "wizard"]
	}],
};
CreatureList["animated object (h)"] = {
	name : "Animated Object (Huge)",
	regExpSearch : /^(?=.*animated)(?=.*object)(?=.*h).*$/i,
	source : [["PHB2024", 241]],
	size : 1,
	type : "Construct",
	alignment : "Unaligned",
	companion : "animated object",
	companionApply : "animated object",
	ac : 15,
	hp : 40,
	hd : [8, 8],
	speed : "30 ft.",
	scores : [16, 10, 10, 3, 3, 1],
	damage_immunities : "Poison, Psychic",
	condition_immunities : "Charmed, Exhaustion, Frightened, Paralyzed, Poisoned",
	senses : "Blindsight 30 ft.",
	passivePerception : 6,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 1,
	attacks : [{
		name : "Slam",
		ability : 1,
		damage : [2, 12, "Force"],
		range : "Melee (5 ft.)",
		useSpellMod : ["bard", "sorcerer", "wizard"]
	}],
};
//Otherworldly Steed Stat Blocks
CreatureList["otherworldly steed (2)"] = {
	name : "Otherworldly Steed (lvl 2)",
	regExpSearch : /^(?=.*otherworldly)(?=.*steed)(?=.*2).*$/i,
	source : [["PHB2024", 273]],
	size : 2,
	type : ["Celestial", "Fey", "Fiend"],
	alignment : "Neutral",
	companion : "mount",
	companionApply : "mount",
	ac : 12,
	hp : 25,
	hd : [2, 10],
	speed : "60 ft.",
	scores : [18, 12, 14, 6, 12, 8],
	passivePerception : 11,
	languages : "Telepathy 1 mile (works only with you)",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 1,
	features : [{
		name : "Life Bond",
		description : "When you regain Hit Points from a level 1+ spell, the steed regains the same number of Hit Points if you're within 5 feet of it.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Fell Glare 1/LR (Fiend Only)",
		description : "As a Bonus Action, Wisdom Saving Throw: DC equals your spell save DC, one creature within 60 feet the steed can see. Failure: The target has the Frightened condition until the end of your next turn.",
		joinString : "\n   ",
	}, {
		name : "Fey Step 1/LR (Fey Only)",
		description : "As a Bonus Action, The steed teleports, along with its rider, to an unoccupied space of your choice up to 60 feet away from itself.",
		joinString : "\n   ",
	}, {
		name : "Healing Touch 1/LR (Celestial Only)",
		description : "As a Bonus Action, One creature within 5 feet of the steed regains a number of Hit Points equal to 2d8+2",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Otherworldly Slam",
		ability : 1,
		damage : [1, 8, "Rad(C)/Psy(Fy)/Nec(Fd)"],
		modifiers : ["", 2],
		modToDmg : false,
		range : "Melee (5 ft.)",
	}],
};
CreatureList["otherworldly steed (3)"] = {
	name : "Otherworldly Steed (lvl 3)",
	regExpSearch : /^(?=.*otherworldly)(?=.*steed)(?=.*3).*$/i,
	source : [["PHB2024", 273]],
	size : 2,
	type : ["Celestial", "Fey", "Fiend"],
	alignment : "Neutral",
	companion : "mount",
	companionApply : "mount",
	ac : 12,
	hp : 35,
	hd : [3, 10],
	speed : "60 ft.",
	scores : [18, 12, 14, 6, 12, 8],
	passivePerception : 11,
	languages : "Telepathy 1 mile (works only with you)",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 1,
	features : [{
		name : "Life Bond",
		description : "When you regain Hit Points from a level 1+ spell, the steed regains the same number of Hit Points if you're within 5 feet of it.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Fell Glare 1/LR (Fiend Only)",
		description : "As a Bonus Action, Wisdom Saving Throw: DC equals your spell save DC, one creature within 60 feet the steed can see. Failure: The target has the Frightened condition until the end of your next turn.",
		joinString : "\n   ",
	}, {
		name : "Fey Step 1/LR (Fey Only)",
		description : "As a Bonus Action, The steed teleports, along with its rider, to an unoccupied space of your choice up to 60 feet away from itself.",
		joinString : "\n   ",
	}, {
		name : "Healing Touch 1/LR (Celestial Only)",
		description : "As a Bonus Action, One creature within 5 feet of the steed regains a number of Hit Points equal to 2d8+3",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Otherworldly Slam",
		ability : 1,
		damage : [1, 8, "Rad(C)/Psy(Fy)/Nec(Fd)"],
		modifiers : ["", 3],
		modToDmg : false,
		range : "Melee (5 ft.)",
	}],
};
CreatureList["otherworldly steed (4)"] = {
	name : "Otherworldly Steed (lvl 4)",
	regExpSearch : /^(?=.*otherworldly)(?=.*steed)(?=.*4).*$/i,
	source : [["PHB2024", 273]],
	size : 2,
	type : ["Celestial", "Fey", "Fiend"],
	alignment : "Neutral",
	companion : "mount",
	companionApply : "mount",
	ac : 12,
	hp : 45,
	hd : [4, 10],
	speed : "60 ft., Fly 60 ft.",
	scores : [18, 12, 14, 6, 12, 8],
	passivePerception : 11,
	languages : "Telepathy 1 mile (works only with you)",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 1,
	features : [{
		name : "Life Bond",
		description : "When you regain Hit Points from a level 1+ spell, the steed regains the same number of Hit Points if you're within 5 feet of it.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Fell Glare 1/LR (Fiend Only)",
		description : "As a Bonus Action, Wisdom Saving Throw: DC equals your spell save DC, one creature within 60 feet the steed can see. Failure: The target has the Frightened condition until the end of your next turn.",
		joinString : "\n   ",
	}, {
		name : "Fey Step 1/LR (Fey Only)",
		description : "As a Bonus Action, The steed teleports, along with its rider, to an unoccupied space of your choice up to 60 feet away from itself.",
		joinString : "\n   ",
	}, {
		name : "Healing Touch 1/LR (Celestial Only)",
		description : "As a Bonus Action, One creature within 5 feet of the steed regains a number of Hit Points equal to 2d8+4",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Otherworldly Slam",
		ability : 1,
		damage : [1, 8, "Rad(C)/Psy(Fy)/Nec(Fd)"],
		modifiers : ["", 4],
		modToDmg : false,
		range : "Melee (5 ft.)",
	}],
};
CreatureList["otherworldly steed (5)"] = {
	name : "Otherworldly Steed (lvl 5)",
	regExpSearch : /^(?=.*otherworldly)(?=.*steed)(?=.*5).*$/i,
	source : [["PHB2024", 273]],
	size : 2,
	type : ["Celestial", "Fey", "Fiend"],
	alignment : "Neutral",
	companion : "mount",
	companionApply : "mount",
	ac : 12,
	hp : 55,
	hd : [5, 10],
	speed : "60 ft., Fly 60 ft.",
	scores : [18, 12, 14, 6, 12, 8],
	passivePerception : 11,
	languages : "Telepathy 1 mile (works only with you)",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 1,
	features : [{
		name : "Life Bond",
		description : "When you regain Hit Points from a level 1+ spell, the steed regains the same number of Hit Points if you're within 5 feet of it.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Fell Glare 1/LR (Fiend Only)",
		description : "As a Bonus Action, Wisdom Saving Throw: DC equals your spell save DC, one creature within 60 feet the steed can see. Failure: The target has the Frightened condition until the end of your next turn.",
		joinString : "\n   ",
	}, {
		name : "Fey Step 1/LR (Fey Only)",
		description : "As a Bonus Action, The steed teleports, along with its rider, to an unoccupied space of your choice up to 60 feet away from itself.",
		joinString : "\n   ",
	}, {
		name : "Healing Touch 1/LR (Celestial Only)",
		description : "As a Bonus Action, One creature within 5 feet of the steed regains a number of Hit Points equal to 2d8+5",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Otherworldly Slam",
		ability : 1,
		damage : [1, 8, "Rad(C)/Psy(Fy)/Nec(Fd)"],
		modifiers : ["", 5],
		modToDmg : false,
		range : "Melee (5 ft.)",
	}],
};
//Giant Insect Stat Blocks
CompanionList["giant insect"] = {
	name : "Giant Insect",
	nameMenu : "Giant Insect (Giant Insect Spell)",
	nameOrigin : "Summon Insect of the Giant Insect 4th-level conjuration spell",
	source : [["PHB2024", 279]],
	attributesChange : function(sCrea, objCrea) {
        var casters = isSpellUsed('giant insect');
        var oScore = undefined;
        
        for (var caster of casters) {
            if (CurrentSpells[caster].refType !== "class") continue;
            
            var ability = CurrentSpells[caster].ability;
    
            var abilityMod = What(AbilityScores.abbreviations[ability - 1] + " Mod");
            
            if (oScore === undefined || abilityMod > What(AbilityScores.abbreviations[oScore[1] - 1] + " Mod")) {
                oScore = [caster, ability];
            }
        }

        if (oScore === undefined) return;
    
        for (var i = 0; i < objCrea.attacks.length; i++) {
            var oAtk = objCrea.attacks[i];
            oAtk.useSpellMod = oScore[0];
        }
        
    },
};
CreatureList["giant insect (4)"] = {
	name : "Giant Insect (lvl 4)",
	regExpSearch : /^(?=.*giant)(?=.*insect)(?=.*4).*$/i,
	source : [["PHB2024", 379]],
	size : 2,
	type : ["Beast"],
	alignment : "Unaligned",
	companion : "giant insect",
	companionApply : "giant insect",
	ac : 15,
	hp : 30,
	hd : [5, 10],
	speed : "40 ft., Climb 40 ft., Fly 40 ft.(Wasp Only)",
	scores : [17, 13, 15, 4, 14, 3],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the langages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 2,
	features : [{
		name : "Spider Climb",
		description : "The insect can climb difficult surfaces, including along ceilings, without needing to make an ability check.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Venomous Spew (Centipede Only)",
		description : "As a Bonus Action, Constitution Saving Throw: Your spell save DC, one creature the insect can see within 10 feet. Failure: The target has the Poisoned condition until the start of the insect's next turn.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Poison Jab",
		ability : 1,
		damage : [1, 6, "Piercing"],
		modifiers : ["", 4],
		range : "Melee (10 ft.)",
		description : "+1d4 Poison damage",
		useSpellMod : ["druid"]
	}, {
		name : "Web Bolt (Spider Only)",
		ability : 1,
		damage : [1, 10, "Bludgeoning"],
		modifiers : ["", 4],
		range : "Ranged (60 ft.)",
		description : "The target's Speed is reduced to 0 until the start of the insect's next turn",
		useSpellMod : ["druid"]
	}],
};
CreatureList["giant insect (5)"] = {
	name : "Giant Insect (lvl 5)",
	regExpSearch : /^(?=.*giant)(?=.*insect)(?=.*5).*$/i,
	source : [["PHB2024", 379]],
	size : 2,
	type : ["Beast"],
	alignment : "Unaligned",
	companion : "giant insect",
	companionApply : "giant insect",
	ac : 16,
	hp : 40,
	hd : [7, 10],
	speed : "40 ft., Climb 40 ft., Fly 40 ft.(Wasp Only)",
	scores : [17, 13, 15, 4, 14, 3],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the langages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 2,
	features : [{
		name : "Spider Climb",
		description : "The insect can climb difficult surfaces, including along ceilings, without needing to make an ability check.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Venomous Spew (Centipede Only)",
		description : "As a Bonus Action, Constitution Saving Throw: Your spell save DC, one creature the insect can see within 10 feet. Failure: The target has the Poisoned condition until the start of the insect's next turn.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Poison Jab",
		ability : 1,
		damage : [1, 6, "Piercing"],
		modifiers : ["", 5],
		range : "Melee (10 ft.)",
		description : "+1d4 Poison damage",
		useSpellMod : ["druid"]
	}, {
		name : "Web Bolt (Spider Only)",
		ability : 1,
		damage : [1, 10, "Bludgeoning"],
		modifiers : ["", 5],
		range : "Ranged (60 ft.)",
		description : "The target's Speed is reduced to 0 until the start of the insect's next turn",
		useSpellMod : ["druid"]
	}],
};
CreatureList["giant insect (6)"] = {
	name : "Giant Insect (lvl 6)",
	regExpSearch : /^(?=.*giant)(?=.*insect)(?=.*6).*$/i,
	source : [["PHB2024", 379]],
	size : 2,
	type : ["Beast"],
	alignment : "Unaligned",
	companion : "giant insect",
	companionApply : "giant insect",
	ac : 17,
	hp : 50,
	hd : [8, 10],
	speed : "40 ft., Climb 40 ft., Fly 40 ft.(Wasp Only)",
	scores : [17, 13, 15, 4, 14, 3],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the langages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Spider Climb",
		description : "The insect can climb difficult surfaces, including along ceilings, without needing to make an ability check.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Venomous Spew (Centipede Only)",
		description : "As a Bonus Action, Constitution Saving Throw: Your spell save DC, one creature the insect can see within 10 feet. Failure: The target has the Poisoned condition until the start of the insect's next turn.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Poison Jab",
		ability : 1,
		damage : [1, 6, "Piercing"],
		modifiers : ["", 6],
		range : "Melee (10 ft.)",
		description : "+1d4 Poison damage",
		useSpellMod : ["druid"]
	}, {
		name : "Web Bolt (Spider Only)",
		ability : 1,
		damage : [1, 10, "Bludgeoning"],
		modifiers : ["", 6],
		range : "Ranged (60 ft.)",
		description : "The target's Speed is reduced to 0 until the start of the insect's next turn",
		useSpellMod : ["druid"]
	}],
};
CreatureList["giant insect (7)"] = {
	name : "Giant Insect (lvl 7)",
	regExpSearch : /^(?=.*giant)(?=.*insect)(?=.*7).*$/i,
	source : [["PHB2024", 379]],
	size : 2,
	type : ["Beast"],
	alignment : "Unaligned",
	companion : "giant insect",
	companionApply : "giant insect",
	ac : 18,
	hp : 60,
	hd : [10, 10],
	speed : "40 ft., Climb 40 ft., Fly 40 ft.(Wasp Only)",
	scores : [17, 13, 15, 4, 14, 3],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the langages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Spider Climb",
		description : "The insect can climb difficult surfaces, including along ceilings, without needing to make an ability check.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Venomous Spew (Centipede Only)",
		description : "As a Bonus Action, Constitution Saving Throw: Your spell save DC, one creature the insect can see within 10 feet. Failure: The target has the Poisoned condition until the start of the insect's next turn.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Poison Jab",
		ability : 1,
		damage : [1, 6, "Piercing"],
		modifiers : ["", 7],
		range : "Melee (10 ft.)",
		description : "+1d4 Poison damage",
		useSpellMod : ["druid"]
	}, {
		name : "Web Bolt (Spider Only)",
		ability : 1,
		damage : [1, 10, "Bludgeoning"],
		modifiers : ["", 7],
		range : "Ranged (60 ft.)",
		description : "The target's Speed is reduced to 0 until the start of the insect's next turn",
		useSpellMod : ["druid"]
	}],
};
CreatureList["giant insect (8)"] = {
	name : "Giant Insect (lvl 8)",
	regExpSearch : /^(?=.*giant)(?=.*insect)(?=.*8).*$/i,
	source : [["PHB2024", 379]],
	size : 2,
	type : ["Beast"],
	alignment : "Unaligned",
	companion : "giant insect",
	companionApply : "giant insect",
	ac : 19,
	hp : 70,
	hd : [12, 10],
	speed : "40 ft., Climb 40 ft., Fly 40 ft.(Wasp Only)",
	scores : [17, 13, 15, 4, 14, 3],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the langages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	features : [{
		name : "Spider Climb",
		description : "The insect can climb difficult surfaces, including along ceilings, without needing to make an ability check.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Venomous Spew (Centipede Only)",
		description : "As a Bonus Action, Constitution Saving Throw: Your spell save DC, one creature the insect can see within 10 feet. Failure: The target has the Poisoned condition until the start of the insect's next turn.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Poison Jab",
		ability : 1,
		damage : [1, 6, "Piercing"],
		modifiers : ["", 8],
		range : "Melee (10 ft.)",
		description : "+1d4 Poison damage",
		useSpellMod : ["druid"]
	}, {
		name : "Web Bolt (Spider Only)",
		ability : 1,
		damage : [1, 10, "Bludgeoning"],
		modifiers : ["", 8],
		range : "Ranged (60 ft.)",
		description : "The target's Speed is reduced to 0 until the start of the insect's next turn",
		useSpellMod : ["druid"]
	}],
};
CreatureList["giant insect (9)"] = {
	name : "Giant Insect (lvl 9)",
	regExpSearch : /^(?=.*giant)(?=.*insect)(?=.*9).*$/i,
	source : [["PHB2024", 379]],
	size : 2,
	type : ["Beast"],
	alignment : "Unaligned",
	companion : "giant insect",
	companionApply : "giant insect",
	ac : 20,
	hp : 80,
	hd : [13, 10],
	speed : "40 ft., Climb 40 ft., Fly 40 ft.(Wasp Only)",
	scores : [17, 13, 15, 4, 14, 3],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the langages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 8,
	features : [{
		name : "Spider Climb",
		description : "The insect can climb difficult surfaces, including along ceilings, without needing to make an ability check.",
		joinString : "\n   ",
	}],
	actions : [{
		name : "Venomous Spew (Centipede Only)",
		description : "As a Bonus Action, Constitution Saving Throw: Your spell save DC, one creature the insect can see within 10 feet. Failure: The target has the Poisoned condition until the start of the insect's next turn.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Poison Jab",
		ability : 1,
		damage : [1, 6, "Piercing"],
		modifiers : ["", 9],
		range : "Melee (10 ft.)",
		description : "+1d4 Poison damage",
		useSpellMod : ["druid"]
	}, {
		name : "Web Bolt (Spider Only)",
		ability : 1,
		damage : [1, 10, "Bludgeoning"],
		modifiers : ["", 9],
		range : "Ranged (60 ft.)",
		description : "The target's Speed is reduced to 0 until the start of the insect's next turn",
		useSpellMod : ["druid"]
	}],
};
//Aberrant Spirit Stat Blocks
CompanionList["aberrant spirit"] = {
	name : "Aberrant Spirit",
	nameMenu : "Aberrant Spirit (Summon Aberration Spell)",
	nameOrigin : "Summon Spirit of the Summon Aberration 4th-level conjuration spell",
	source : [["PHB2024", 322]],
	attributesChange : function(sCrea, objCrea) {
        var casters = isSpellUsed('summon aberration');
        var oScore = undefined;
        
        for (var caster of casters) {
            if (CurrentSpells[caster].refType !== "class") continue;
            
            var ability = CurrentSpells[caster].ability;
    
            var abilityMod = What(AbilityScores.abbreviations[ability - 1] + " Mod");
            
            if (oScore === undefined || abilityMod > What(AbilityScores.abbreviations[oScore[1] - 1] + " Mod")) {
                oScore = [caster, ability];
            }
        }

        if (oScore === undefined) return;
    
        for (var i = 0; i < objCrea.attacks.length; i++) {
            var oAtk = objCrea.attacks[i];
            oAtk.useSpellMod = oScore[0];
        }
        
    },
};
CreatureList["aberrant spirit (4)"] = {
	name : "Aberrant Spirit (lvl 4)",
	regExpSearch : /^(?=.*aberrant)(?=.*spirit)(?=.*4).*$/i,
	source : [["PHB2024", 322]],
	size : 3,
	type : "Aberration",
	alignment : "Neutral",
	companion : "aberrant spirit",
	companionApply : "aberrant spirit",
	ac : 15,
	hp : 40,
	hd : [8, 8],
	speed : "30 ft./Fly 30 ft. (Beholderkin)",
	scores : [16, 10, 15, 16, 10, 6],
	damage_immunities : "Psychic",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Deep Speech, understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 2,
	features : [{
		name : "Regeneration (Slaad Only)",
		description : "The spirit regains 5 Hit Points at the start of its turn if it has at least 1 Hit Point.",
		joinString : "\n   ",
	}, {
		name : "Whispering Aura (Mind Flayer Only)",
		description : "At the start of each of the spirit's turns, the spirit emeits psionic energy if it doesn't have the Incapacitated condition. Wisdom Saving Throw: DC equals your spell save DC, each ceature (other than you) within 5 feet of the spirit. Failure: 2d6 Psychic damage.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Claw (Slaad Only)",
		ability : 1,
		damage : [1, 10, "Slashing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 4],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["warlock", "wizard"]
	}, {
		name : "Eye Ray (Beholderkin Only)",
		ability : 4,
		damage : [1, 8, "Psychic"],
		range : "150 ft.",
		modifiers : ["", 4],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["warlock", "wizard"]
	}, {
		name : "Psychic Slam (Mind Flayer Only)",
		ability : 4,
		damage : [1, 8, "Psychic"],
		range : "Melee (5 ft.)",
		modifiers : ["", 4],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["warlock", "wizard"]
	}],
};
CreatureList["aberrant spirit (5)"] = {
	name : "Aberrant Spirit (lvl 5)",
	regExpSearch : /^(?=.*aberrant)(?=.*spirit)(?=.*5).*$/i,
	source : [["PHB2024", 322]],
	size : 3,
	type : "Aberration",
	alignment : "Neutral",
	companion : "aberrant spirit",
	companionApply : "aberrant spirit",
	ac : 16,
	hp : 50,
	hd : [10, 8],
	speed : "30 ft./Fly 30 ft. (Beholderkin)",
	scores : [16, 10, 15, 16, 10, 6],
	damage_immunities : "Psychic",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Deep Speech, understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 2,
	features : [{
		name : "Regeneration (Slaad Only)",
		description : "The spirit regains 5 Hit Points at the start of its turn if it has at least 1 Hit Point.",
		joinString : "\n   ",
	}, {
		name : "Whispering Aura (Mind Flayer Only)",
		description : "At the start of each of the spirit's turns, the spirit emeits psionic energy if it doesn't have the Incapacitated condition. Wisdom Saving Throw: DC equals your spell save DC, each ceature (other than you) within 5 feet of the spirit. Failure: 2d6 Psychic damage.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Claw (Slaad Only)",
		ability : 1,
		damage : [1, 10, "Slashing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 5],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["warlock", "wizard"]
	}, {
		name : "Eye Ray (Beholderkin Only)",
		ability : 4,
		damage : [1, 8, "Psychic"],
		range : "150 ft.",
		modifiers : ["", 5],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["warlock", "wizard"]
	}, {
		name : "Psychic Slam (Mind Flayer Only)",
		ability : 4,
		damage : [1, 8, "Psychic"],
		range : "Melee (5 ft.)",
		modifiers : ["", 5],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["warlock", "wizard"]
	}],
};
CreatureList["aberrant spirit (6)"] = {
	name : "Aberrant Spirit (lvl 6)",
	regExpSearch : /^(?=.*aberrant)(?=.*spirit)(?=.*6).*$/i,
	source : [["PHB2024", 322]],
	size : 3,
	type : "Aberration",
	alignment : "Neutral",
	companion : "aberrant spirit",
	companionApply : "aberrant spirit",
	ac : 17,
	hp : 60,
	hd : [12, 8],
	speed : "30 ft./Fly 30 ft. (Beholderkin)",
	scores : [16, 10, 15, 16, 10, 6],
	damage_immunities : "Psychic",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Deep Speech, understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Regeneration (Slaad Only)",
		description : "The spirit regains 5 Hit Points at the start of its turn if it has at least 1 Hit Point.",
		joinString : "\n   ",
	}, {
		name : "Whispering Aura (Mind Flayer Only)",
		description : "At the start of each of the spirit's turns, the spirit emeits psionic energy if it doesn't have the Incapacitated condition. Wisdom Saving Throw: DC equals your spell save DC, each ceature (other than you) within 5 feet of the spirit. Failure: 2d6 Psychic damage.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Claw (Slaad Only)",
		ability : 1,
		damage : [1, 10, "Slashing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 6],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["warlock", "wizard"]
	}, {
		name : "Eye Ray (Beholderkin Only)",
		ability : 4,
		damage : [1, 8, "Psychic"],
		range : "150 ft.",
		modifiers : ["", 6],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["warlock", "wizard"]
	}, {
		name : "Psychic Slam (Mind Flayer Only)",
		ability : 4,
		damage : [1, 8, "Psychic"],
		range : "Melee (5 ft.)",
		modifiers : ["", 6],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["warlock", "wizard"]
	}],
};
CreatureList["aberrant spirit (7)"] = {
	name : "Aberrant Spirit (lvl 7)",
	regExpSearch : /^(?=.*aberrant)(?=.*spirit)(?=.*7).*$/i,
	source : [["PHB2024", 322]],
	size : 3,
	type : "Aberration",
	alignment : "Neutral",
	companion : "aberrant spirit",
	companionApply : "aberrant spirit",
	ac : 18,
	hp : 70,
	hd : [14, 8],
	speed : "30 ft./Fly 30 ft. (Beholderkin)",
	scores : [16, 10, 15, 16, 10, 6],
	damage_immunities : "Psychic",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Deep Speech, understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Regeneration (Slaad Only)",
		description : "The spirit regains 5 Hit Points at the start of its turn if it has at least 1 Hit Point.",
		joinString : "\n   ",
	}, {
		name : "Whispering Aura (Mind Flayer Only)",
		description : "At the start of each of the spirit's turns, the spirit emeits psionic energy if it doesn't have the Incapacitated condition. Wisdom Saving Throw: DC equals your spell save DC, each ceature (other than you) within 5 feet of the spirit. Failure: 2d6 Psychic damage.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Claw (Slaad Only)",
		ability : 1,
		damage : [1, 10, "Slashing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 7],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["warlock", "wizard"]
	}, {
		name : "Eye Ray (Beholderkin Only)",
		ability : 4,
		damage : [1, 8, "Psychic"],
		range : "150 ft.",
		modifiers : ["", 7],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["warlock", "wizard"]
	}, {
		name : "Psychic Slam (Mind Flayer Only)",
		ability : 4,
		damage : [1, 8, "Psychic"],
		range : "Melee (5 ft.)",
		modifiers : ["", 7],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["warlock", "wizard"]
	}],
};
CreatureList["aberrant spirit (8)"] = {
	name : "Aberrant Spirit (lvl 8)",
	regExpSearch : /^(?=.*aberrant)(?=.*spirit)(?=.*8).*$/i,
	source : [["PHB2024", 322]],
	size : 3,
	type : "Aberration",
	alignment : "Neutral",
	companion : "aberrant spirit",
	companionApply : "aberrant spirit",
	ac : 19,
	hp : 80,
	hd : [16, 8],
	speed : "30 ft./Fly 30 ft. (Beholderkin)",
	scores : [16, 10, 15, 16, 10, 6],
	damage_immunities : "Psychic",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Deep Speech, understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	features : [{
		name : "Regeneration (Slaad Only)",
		description : "The spirit regains 5 Hit Points at the start of its turn if it has at least 1 Hit Point.",
		joinString : "\n   ",
	}, {
		name : "Whispering Aura (Mind Flayer Only)",
		description : "At the start of each of the spirit's turns, the spirit emeits psionic energy if it doesn't have the Incapacitated condition. Wisdom Saving Throw: DC equals your spell save DC, each ceature (other than you) within 5 feet of the spirit. Failure: 2d6 Psychic damage.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Claw (Slaad Only)",
		ability : 1,
		damage : [1, 10, "Slashing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 8],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["warlock", "wizard"]
	}, {
		name : "Eye Ray (Beholderkin Only)",
		ability : 4,
		damage : [1, 8, "Psychic"],
		range : "150 ft.",
		modifiers : ["", 8],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["warlock", "wizard"]
	}, {
		name : "Psychic Slam (Mind Flayer Only)",
		ability : 4,
		damage : [1, 8, "Psychic"],
		range : "Melee (5 ft.)",
		modifiers : ["", 8],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["warlock", "wizard"]
	}],
};
CreatureList["aberrant spirit (9)"] = {
	name : "Aberrant Spirit (lvl 9)",
	regExpSearch : /^(?=.*aberrant)(?=.*spirit)(?=.*9).*$/i,
	source : [["PHB2024", 322]],
	size : 3,
	type : "Aberration",
	alignment : "Neutral",
	companion : "aberrant spirit",
	companionApply : "aberrant spirit",
	ac : 20,
	hp : 90,
	hd : [18, 8],
	speed : "30 ft./Fly 30 ft. (Beholderkin)",
	scores : [16, 10, 15, 16, 10, 6],
	damage_immunities : "Psychic",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Deep Speech, understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	features : [{
		name : "Regeneration (Slaad Only)",
		description : "The spirit regains 5 Hit Points at the start of its turn if it has at least 1 Hit Point.",
		joinString : "\n   ",
	}, {
		name : "Whispering Aura (Mind Flayer Only)",
		description : "At the start of each of the spirit's turns, the spirit emeits psionic energy if it doesn't have the Incapacitated condition. Wisdom Saving Throw: DC equals your spell save DC, each ceature (other than you) within 5 feet of the spirit. Failure: 2d6 Psychic damage.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Claw (Slaad Only)",
		ability : 1,
		damage : [1, 10, "Slashing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 9],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["warlock", "wizard"]
	}, {
		name : "Eye Ray (Beholderkin Only)",
		ability : 4,
		damage : [1, 8, "Psychic"],
		range : "150 ft.",
		modifiers : ["", 9],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["warlock", "wizard"]
	}, {
		name : "Psychic Slam (Mind Flayer Only)",
		ability : 4,
		damage : [1, 8, "Psychic"],
		range : "Melee (5 ft.)",
		modifiers : ["", 9],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["warlock", "wizard"]
	}],
};
//Beast Spirit Stat Blocks
CompanionList["bestial spirit"] = {
	name : "Bestial Spirit",
	nameMenu : "Bestial Spirit (Summon Beast Spell)",
	nameOrigin : "Summon Spirit of the Summon Beast 2nd-level conjuration spell",
	source : [["PHB2024", 322]],
	attributesChange : function(sCrea, objCrea) {
        var casters = isSpellUsed('summon beast');
        var oScore = undefined;
        
        for (var caster of casters) {
            if (CurrentSpells[caster].refType !== "class") continue;
            
            var ability = CurrentSpells[caster].ability;
    
            var abilityMod = What(AbilityScores.abbreviations[ability - 1] + " Mod");
            
            if (oScore === undefined || abilityMod > What(AbilityScores.abbreviations[oScore[1] - 1] + " Mod")) {
                oScore = [caster, ability];
            }
        }

        if (oScore === undefined) return;
    
        for (var i = 0; i < objCrea.attacks.length; i++) {
            var oAtk = objCrea.attacks[i];
            oAtk.useSpellMod = oScore[0];
        }
        
    },
};
CreatureList["bestial spirit (lw)(2)"] = {
	name : "Bestial Spirit (Land/Water)(lvl 2)",
	regExpSearch : /^(?=.*bestial)(?=.*spirit)(?=.*landwater)(?=.*2).*$/i,
	source : [["PHB2024", 323]],
	size : 4,
	type : "Beast",
	alignment : "Neutral",
	companion : "bestial spirit",
	companionApply : "bestial spirit",
	ac : 13,
	hp : 30,
	hd : [8, 6],
	speed : "30 ft./Climb 30 ft. (Land), Swim 30 ft. (Water)",
	scores : [18, 11, 16, 4, 14, 5],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 1,
	features : [{
		name : "Pack Tactics (Land and Water Only)",
		description : "The spirit has Advantage on an attack roll against a creature if at least one of the spirit's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
		joinString : "\n   ",
	}, {
		name : "Water Breathing (Water Only)",
		description : "The spirit can breath only underwater.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 8, "Piercing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 2],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["druid", "ranger"]
	}],
};
CreatureList["bestial spirit (lw)(3)"] = {
	name : "Bestial Spirit (Land/Water)(lvl 3)",
	regExpSearch : /^(?=.*bestial)(?=.*spirit)(?=.*landwater)(?=.*3).*$/i,
	source : [["PHB2024", 323]],
	size : 4,
	type : "Beast",
	alignment : "Neutral",
	companion : "bestial spirit",
	companionApply : "bestial spirit",
	ac : 14,
	hp : 35,
	hd : [9, 6],
	speed : "30 ft./Climb 30 ft. (Land), Swim 30 ft. (Water)",
	scores : [18, 11, 16, 4, 14, 5],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 1,
	features : [{
		name : "Pack Tactics (Land and Water Only)",
		description : "The spirit has Advantage on an attack roll against a creature if at least one of the spirit's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
		joinString : "\n   ",
	}, {
		name : "Water Breathing (Water Only)",
		description : "The spirit can breath only underwater.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 8, "Piercing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 3],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["druid", "ranger"]
	}],
};
CreatureList["bestial spirit (lw)(4)"] = {
	name : "Bestial Spirit (Land/Water)(lvl 4)",
	regExpSearch : /^(?=.*bestial)(?=.*spirit)(?=.*landwater)(?=.*4).*$/i,
	source : [["PHB2024", 323]],
	size : 4,
	type : "Beast",
	alignment : "Neutral",
	companion : "bestial spirit",
	companionApply : "bestial spirit",
	ac : 15,
	hp : 40,
	hd : [10, 6],
	speed : "30 ft./Climb 30 ft. (Land), Swim 30 ft. (Water)",
	scores : [18, 11, 16, 4, 14, 5],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 2,
	features : [{
		name : "Pack Tactics (Land and Water Only)",
		description : "The spirit has Advantage on an attack roll against a creature if at least one of the spirit's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
		joinString : "\n   ",
	}, {
		name : "Water Breathing (Water Only)",
		description : "The spirit can breath only underwater.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 8, "Piercing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 4],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["druid", "ranger"]
	}],
};
CreatureList["bestial spirit (lw)(5)"] = {
	name : "Bestial Spirit (Land/Water)(lvl 5)",
	regExpSearch : /^(?=.*bestial)(?=.*spirit)(?=.*landwater)(?=.*5).*$/i,
	source : [["PHB2024", 323]],
	size : 4,
	type : "Beast",
	alignment : "Neutral",
	companion : "bestial spirit",
	companionApply : "bestial spirit",
	ac : 16,
	hp : 45,
	hd : [11, 6],
	speed : "30 ft./Climb 30 ft. (Land), Swim 30 ft. (Water)",
	scores : [18, 11, 16, 4, 14, 5],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 2,
	features : [{
		name : "Pack Tactics (Land and Water Only)",
		description : "The spirit has Advantage on an attack roll against a creature if at least one of the spirit's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
		joinString : "\n   ",
	}, {
		name : "Water Breathing (Water Only)",
		description : "The spirit can breath only underwater.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 8, "Piercing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 5],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["druid", "ranger"]
	}],
};
CreatureList["bestial spirit (lw)(6)"] = {
	name : "Bestial Spirit (Land/Water)(lvl 6)",
	regExpSearch : /^(?=.*bestial)(?=.*spirit)(?=.*landwater)(?=.*6).*$/i,
	source : [["PHB2024", 323]],
	size : 4,
	type : "Beast",
	alignment : "Neutral",
	companion : "bestial spirit",
	companionApply : "bestial spirit",
	ac : 17,
	hp : 50,
	hd : [12, 6],
	speed : "30 ft./Climb 30 ft. (Land), Swim 30 ft. (Water)",
	scores : [18, 11, 16, 4, 14, 5],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Pack Tactics (Land and Water Only)",
		description : "The spirit has Advantage on an attack roll against a creature if at least one of the spirit's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
		joinString : "\n   ",
	}, {
		name : "Water Breathing (Water Only)",
		description : "The spirit can breath only underwater.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 8, "Piercing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 6],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["druid", "ranger"]
	}],
};
CreatureList["bestial spirit (lw)(7)"] = {
	name : "Bestial Spirit (Land/Water)(lvl 7)",
	regExpSearch : /^(?=.*bestial)(?=.*spirit)(?=.*landwater)(?=.*7).*$/i,
	source : [["PHB2024", 323]],
	size : 4,
	type : "Beast",
	alignment : "Neutral",
	companion : "bestial spirit",
	companionApply : "bestial spirit",
	ac : 18,
	hp : 55,
	hd : [14, 6],
	speed : "30 ft./Climb 30 ft. (Land), Swim 30 ft. (Water)",
	scores : [18, 11, 16, 4, 14, 5],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Pack Tactics (Land and Water Only)",
		description : "The spirit has Advantage on an attack roll against a creature if at least one of the spirit's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
		joinString : "\n   ",
	}, {
		name : "Water Breathing (Water Only)",
		description : "The spirit can breath only underwater.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 8, "Piercing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 7],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["druid", "ranger"]
	}],
};
CreatureList["bestial spirit (lw)(8)"] = {
	name : "Bestial Spirit (Land/Water)(lvl 8)",
	regExpSearch : /^(?=.*bestial)(?=.*spirit)(?=.*landwater)(?=.*8).*$/i,
	source : [["PHB2024", 323]],
	size : 4,
	type : "Beast",
	alignment : "Neutral",
	companion : "bestial spirit",
	companionApply : "bestial spirit",
	ac : 19,
	hp : 60,
	hd : [15, 6],
	speed : "30 ft./Climb 30 ft. (Land), Swim 30 ft. (Water)",
	scores : [18, 11, 16, 4, 14, 5],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	features : [{
		name : "Pack Tactics (Land and Water Only)",
		description : "The spirit has Advantage on an attack roll against a creature if at least one of the spirit's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
		joinString : "\n   ",
	}, {
		name : "Water Breathing (Water Only)",
		description : "The spirit can breath only underwater.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 8, "Piercing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 8],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["druid", "ranger"]
	}],
};
CreatureList["bestial spirit (lw)(9)"] = {
	name : "Bestial Spirit (Land/Water)(lvl 9)",
	regExpSearch : /^(?=.*bestial)(?=.*spirit)(?=.*landwater)(?=.*9).*$/i,
	source : [["PHB2024", 323]],
	size : 4,
	type : "Beast",
	alignment : "Neutral",
	companion : "bestial spirit",
	companionApply : "bestial spirit",
	ac : 20,
	hp : 65,
	hd : [16, 6],
	speed : "30 ft./Climb 30 ft. (Land), Swim 30 ft. (Water)",
	scores : [18, 11, 16, 4, 14, 5],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	features : [{
		name : "Pack Tactics (Land and Water Only)",
		description : "The spirit has Advantage on an attack roll against a creature if at least one of the spirit's allies is within 5 feet of the creature and the ally doesn't have the Incapacitated condition.",
		joinString : "\n   ",
	}, {
		name : "Water Breathing (Water Only)",
		description : "The spirit can breath only underwater.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 8, "Piercing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 9],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["druid", "ranger"]
	}],
};
CreatureList["bestial spirit (a)(2)"] = {
	name : "Bestial Spirit (Air)(lvl 2)",
	regExpSearch : /^(?=.*bestial)(?=.*spirit)(?=.*air)(?=.*2).*$/i,
	source : [["PHB2024", 323]],
	size : 4,
	type : "Beast",
	alignment : "Neutral",
	companion : "bestial spirit",
	companionApply : "bestial spirit",
	ac : 13,
	hp : 20,
	hd : [5, 6],
	speed : "30 ft., Fly 60 ft. (Air)",
	scores : [18, 11, 16, 4, 14, 5],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 1,
	features : [{
		name : "Flyby (Air Only)",
		description : "The spirit doesn't Opportunity Attacks when it flies out of an enemy's reach.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 8, "Piercing"],
		range : "Melee (5 ft.)",
		modifiers : ["", "Str+2"],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["druid", "ranger"],
	}],
};
CreatureList["bestial spirit (a)(3)"] = {
	name : "Bestial Spirit (Air)(lvl 3)",
	regExpSearch : /^(?=.*bestial)(?=.*spirit)(?=.*air)(?=.*3).*$/i,
	source : [["PHB2024", 323]],
	size : 4,
	type : "Beast",
	alignment : "Neutral",
	companion : "bestial spirit",
	companionApply : "bestial spirit",
	ac : 14,
	hp : 25,
	hd : [6, 6],
	speed : "30 ft., Fly 60 ft. (Air)",
	scores : [18, 11, 16, 4, 14, 5],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 1,
	features : [{
		name : "Flyby (Air Only)",
		description : "The spirit doesn't Opportunity Attacks when it flies out of an enemy's reach.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 8, "Piercing"],
		range : "Melee (5 ft.)",
		modifiers : ["", "Str+3"],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["druid", "ranger"]
	}],
};
CreatureList["bestial spirit (a)(4)"] = {
	name : "Bestial Spirit (Air)(lvl 4)",
	regExpSearch : /^(?=.*bestial)(?=.*air)(?=.*spirit)(?=.*4).*$/i,
	source : [["PHB2024", 323]],
	size : 4,
	type : "Beast",
	alignment : "Neutral",
	companion : "bestial spirit",
	companionApply : "bestial spirit",
	ac : 15,
	hp : 30,
	hd : [7, 6],
	speed : "30 ft., Fly 60 ft. (Air)",
	scores : [18, 11, 16, 4, 14, 5],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 2,
	features : [{
		name : "Flyby (Air Only)",
		description : "The spirit doesn't Opportunity Attacks when it flies out of an enemy's reach.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 8, "Piercing"],
		range : "Melee (5 ft.)",
		modifiers : ["", "Str+4"],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["druid", "ranger"]
	}],
};
CreatureList["bestial spirit (a)(5)"] = {
	name : "Bestial Spirit (Air)(lvl 5)",
	regExpSearch : /^(?=.*bestial)(?=.*spirit)(?=.*air)(?=.*5).*$/i,
	source : [["PHB2024", 323]],
	size : 4,
	type : "Beast",
	alignment : "Neutral",
	companion : "bestial spirit",
	companionApply : "bestial spirit",
	ac : 16,
	hp : 35,
	hd : [9, 6],
	speed : "30 ft., Fly 60 ft. (Air)",
	scores : [18, 11, 16, 4, 14, 5],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 2,
	features : [{
		name : "Flyby (Air Only)",
		description : "The spirit doesn't Opportunity Attacks when it flies out of an enemy's reach.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 8, "Piercing"],
		range : "Melee (5 ft.)",
		modifiers : ["", "Str+5"],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["druid", "ranger"]
	}],
};
CreatureList["bestial spirit (a)(6)"] = {
	name : "Bestial Spirit (Air)(lvl 6)",
	regExpSearch : /^(?=.*bestial)(?=.*spirit)(?=.*air)(?=.*6).*$/i,
	source : [["PHB2024", 323]],
	size : 4,
	type : "Beast",
	alignment : "Neutral",
	companion : "bestial spirit",
	companionApply : "bestial spirit",
	ac : 17,
	hp : 40,
	hd : [10, 6],
	speed : "30 ft., Fly 60 ft. (Air)",
	scores : [18, 11, 16, 4, 14, 5],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Flyby (Air Only)",
		description : "The spirit doesn't Opportunity Attacks when it flies out of an enemy's reach.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 8, "Piercing"],
		range : "Melee (5 ft.)",
		modifiers : ["", "Str+6"],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["druid", "ranger"]
	}],
};
CreatureList["bestial spirit (a)(7)"] = {
	name : "Bestial Spirit (Air)(lvl 7)",
	regExpSearch : /^(?=.*bestial)(?=.*spirit)(?=.*air)(?=.*7).*$/i,
	source : [["PHB2024", 323]],
	size : 4,
	type : "Beast",
	alignment : "Neutral",
	companion : "bestial spirit",
	companionApply : "bestial spirit",
	ac : 18,
	hp : 45,
	hd : [11, 6],
	speed : "30 ft., Fly 60 ft. (Air)",
	scores : [18, 11, 16, 4, 14, 5],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Flyby (Air Only)",
		description : "The spirit doesn't Opportunity Attacks when it flies out of an enemy's reach.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 8, "Piercing"],
		range : "Melee (5 ft.)",
		modifiers : ["", "Str+7"],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["druid", "ranger"]
	}],
};
CreatureList["bestial spirit (a)(8)"] = {
	name : "Bestial Spirit (Air)(lvl 8)",
	regExpSearch : /^(?=.*bestial)(?=.*spirit)(?=.*air)(?=.*8).*$/i,
	source : [["PHB2024", 323]],
	size : 4,
	type : "Beast",
	alignment : "Neutral",
	companion : "bestial spirit",
	companionApply : "bestial spirit",
	ac : 19,
	hp : 50,
	hd : [12, 6],
	speed : "30 ft., Fly 60 ft. (Air)",
	scores : [18, 11, 16, 4, 14, 5],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	features : [{
		name : "Flyby (Air Only)",
		description : "The spirit doesn't Opportunity Attacks when it flies out of an enemy's reach.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 8, "Piercing"],
		range : "Melee (5 ft.)",
		modifiers : ["", "Str+8"],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["druid", "ranger"]
	}],
};
CreatureList["bestial spirit (a)(9)"] = {
	name : "Bestial Spirit (Air)(lvl 9)",
	regExpSearch : /^(?=.*bestial)(?=.*spirit)(?=.*air)(?=.*9).*$/i,
	source : [["PHB2024", 323]],
	size : 4,
	type : "Beast",
	alignment : "Neutral",
	companion : "bestial spirit",
	companionApply : "bestial spirit",
	ac : 20,
	hp : 55,
	hd : [14, 6],
	speed : "30 ft., Fly 60 ft. (Air)",
	scores : [18, 11, 16, 4, 14, 5],
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	features : [{
		name : "Flyby (Air Only)",
		description : "The spirit doesn't Opportunity Attacks when it flies out of an enemy's reach.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 8, "Piercing"],
		range : "Melee (5 ft.)",
		modifiers : ["", "Str+9"],
		description : "The target can't regain Hit Points until the start of the spirit's next turn.",
		useSpellMod : ["druid", "ranger"]
	}],
};
//Celestial Spirit Stat Blocks
CompanionList["celestial spirit"] = {
	name : "Celestial Spirit",
	nameMenu : "Celestial Spirit (Summon Celestial Spell)",
	nameOrigin : "Summon Spirit of the Summon Celestial 5th-level conjuration spell",
	source : [["PHB2024", 323]],
	attributesChange : function(sCrea, objCrea) {
        var casters = isSpellUsed('summon celestial');
        var oScore = undefined;
        
        for (var caster of casters) {
            if (CurrentSpells[caster].refType !== "class") continue;
            
            var ability = CurrentSpells[caster].ability;
    
            var abilityMod = What(AbilityScores.abbreviations[ability - 1] + " Mod");
            
            if (oScore === undefined || abilityMod > What(AbilityScores.abbreviations[oScore[1] - 1] + " Mod")) {
                oScore = [caster, ability];
            }
        }

        if (oScore === undefined) return;
    
        for (var i = 0; i < objCrea.attacks.length; i++) {
            var oAtk = objCrea.attacks[i];
            oAtk.useSpellMod = oScore[0];
        }
        
    },
};
CreatureList["celestial spirit (a)(5)"] = {
	name : "Celestial Spirit (Avenger)(lvl 5)",
	regExpSearch : /^(?=.*celestial)(?=.*spirit)(?=.*avenger)(?=.*5).*$/i,
	source : [["PHB2024", 323]],
	size : 2,
	type : "Celestial",
	alignment : "Neutral",
	companion : "celestial spirit",
	companionApply : "celestial spirit",
	ac : 16,
	hp : 40,
	hd : [7, 10],
	speed : "30 ft., Fly 40 ft.",
	scores : [16, 14, 16, 10, 14, 16],
	damage_resistances : "Radiant",
	condition_immunities : "Charmed; Frightened",
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Celestial; Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 2,
	actions : [{
		name : "Healing Touch (1/Day)",
		description : "The spirit touches another creature. The target regains Hit Points equal to 2d8+5",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Radiant Bow (Avenger Only)",
		ability : 2,
		damage : [2, 6, "Radiant"],
		range : "Ranged (600 ft.)",
		modifiers : ["", 5],
		useSpellMod : ["cleric", "paladin"]
	}],
};
CreatureList["celestial spirit (a)(6)"] = {
	name : "Celestial Spirit (Avenger)(lvl 6)",
	regExpSearch : /^(?=.*celestial)(?=.*spirit)(?=.*avenger)(?=.*6).*$/i,
	source : [["PHB2024", 323]],
	size : 2,
	type : "Celestial",
	alignment : "Neutral",
	companion : "celestial spirit",
	companionApply : "celestial spirit",
	ac : 17,
	hp : 50,
	hd : [8, 10],
	speed : "30 ft., Fly 40 ft.",
	scores : [16, 14, 16, 10, 14, 16],
	damage_resistances : "Radiant",
	condition_immunities : "Charmed; Frightened",
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Celestial; Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	actions : [{
		name : "Healing Touch (1/Day)",
		description : "The spirit touches another creature. The target regains Hit Points equal to 2d8+6",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Radiant Bow (Avenger Only)",
		ability : 2,
		damage : [2, 6, "Radiant"],
		range : "Ranged (600 ft.)",
		modifiers : ["", 6],
		useSpellMod : ["cleric", "paladin"]
	}],
};
CreatureList["celestial spirit (a)(7)"] = {
	name : "Celestial Spirit (Avenger)(lvl 7)",
	regExpSearch : /^(?=.*celestial)(?=.*spirit)(?=.*avenger)(?=.*7).*$/i,
	source : [["PHB2024", 323]],
	size : 2,
	type : "Celestial",
	alignment : "Neutral",
	companion : "celestial spirit",
	companionApply : "celestial spirit",
	ac : 18,
	hp : 60,
	hd : [10, 10],
	speed : "30 ft., Fly 40 ft.",
	scores : [16, 14, 16, 10, 14, 16],
	damage_resistances : "Radiant",
	condition_immunities : "Charmed; Frightened",
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Celestial; Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	actions : [{
		name : "Healing Touch (1/Day)",
		description : "The spirit touches another creature. The target regains Hit Points equal to 2d8+7",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Radiant Bow (Avenger Only)",
		ability : 2,
		damage : [2, 6, "Radiant"],
		range : "Ranged (600 ft.)",
		modifiers : ["", 7],
		useSpellMod : ["cleric", "paladin"]
	}],
};
CreatureList["celestial spirit (a)(8)"] = {
	name : "Celestial Spirit (Avenger)(lvl 8)",
	regExpSearch : /^(?=.*celestial)(?=.*spirit)(?=.*avenger)(?=.*8).*$/i,
	source : [["PHB2024", 323]],
	size : 2,
	type : "Celestial",
	alignment : "Neutral",
	companion : "celestial spirit",
	companionApply : "celestial spirit",
	ac : 19,
	hp : 70,
	hd : [12, 10],
	speed : "30 ft., Fly 40 ft.",
	scores : [16, 14, 16, 10, 14, 16],
	damage_resistances : "Radiant",
	condition_immunities : "Charmed; Frightened",
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Celestial; Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	actions : [{
		name : "Healing Touch (1/Day)",
		description : "The spirit touches another creature. The target regains Hit Points equal to 2d8+8",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Radiant Bow (Avenger Only)",
		ability : 2,
		damage : [2, 6, "Radiant"],
		range : "Ranged (600 ft.)",
		modifiers : ["", 8],
		useSpellMod : ["cleric", "paladin"]
	}],
};
CreatureList["celestial spirit (a)(9)"] = {
	name : "Celestial Spirit (Avenger)(lvl 9)",
	regExpSearch : /^(?=.*celestial)(?=.*spirit)(?=.*avenger)(?=.*9).*$/i,
	source : [["PHB2024", 323]],
	size : 2,
	type : "Celestial",
	alignment : "Neutral",
	companion : "celestial spirit",
	companionApply : "celestial spirit",
	ac : 20,
	hp : 80,
	hd : [13, 10],
	speed : "30 ft., Fly 40 ft.",
	scores : [16, 14, 16, 10, 14, 16],
	damage_resistances : "Radiant",
	condition_immunities : "Charmed; Frightened",
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Celestial; Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	actions : [{
		name : "Healing Touch (1/Day)",
		description : "The spirit touches another creature. The target regains Hit Points equal to 2d8+9",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Radiant Bow (Avenger Only)",
		ability : 2,
		damage : [2, 6, "Radiant"],
		range : "Ranged (600 ft.)",
		modifiers : ["", 9],
		useSpellMod : ["cleric", "paladin"]
	}],
};
CreatureList["celestial spirit (d)(5)"] = {
	name : "Celestial Spirit (Defender)(lvl 5)",
	regExpSearch : /^(?=.*celestial)(?=.*spirit)(?=.*defender)(?=.*5).*$/i,
	source : [["PHB2024", 323]],
	size : 2,
	type : "Celestial",
	alignment : "Neutral",
	companion : "celestial spirit",
	companionApply : "celestial spirit",
	ac : 18,
	hp : 40,
	hd : [7, 10],
	speed : "30 ft., Fly 40 ft.",
	scores : [16, 14, 16, 10, 14, 16],
	damage_resistances : "Radiant",
	condition_immunities : "Charmed; Frightened",
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Celestial; Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 2,
	actions : [{
		name : "Healing Touch (1/Day)",
		description : "The spirit touches another creature. The target regains Hit Points equal to 2d8+5",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Radiant Mace (Defender Only)",
		ability : 1,
		damage : [1, 10, "Radiant"],
		range : "Melee (5 ft.)",
		modifiers : ["", 5],
		description : "The spirit choose either itself or another creature it can see within 10 ft. and grants 1d10 Temp HP.",
		useSpellMod : ["cleric", "paladin"]
	}],
};
CreatureList["celestial spirit (d)(6)"] = {
	name : "Celestial Spirit (Defender)(lvl 6)",
	regExpSearch : /^(?=.*celestial)(?=.*spirit)(?=.*defender)(?=.*6).*$/i,
	source : [["PHB2024", 323]],
	size : 2,
	type : "Celestial",
	alignment : "Neutral",
	companion : "celestial spirit",
	companionApply : "celestial spirit",
	ac : 19,
	hp : 50,
	hd : [8, 10],
	speed : "30 ft., Fly 40 ft.",
	scores : [16, 14, 16, 10, 14, 16],
	damage_resistances : "Radiant",
	condition_immunities : "Charmed; Frightened",
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Celestial; Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	actions : [{
		name : "Healing Touch (1/Day)",
		description : "The spirit touches another creature. The target regains Hit Points equal to 2d8+6",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Radiant Mace (Defender Only)",
		ability : 1,
		damage : [1, 10, "Radiant"],
		range : "Melee (5 ft.)",
		modifiers : ["", 5],
		description : "The spirit choose either itself or another creature it can see within 10 ft. and grants 1d10 Temp HP.",
		useSpellMod : ["cleric", "paladin"]
	}],
};
CreatureList["celestial spirit (d)(7)"] = {
	name : "Celestial Spirit (Defender)(lvl 7)",
	regExpSearch : /^(?=.*celestial)(?=.*spirit)(?=.*defender)(?=.*7).*$/i,
	source : [["PHB2024", 323]],
	size : 2,
	type : "Celestial",
	alignment : "Neutral",
	companion : "celestial spirit",
	companionApply : "celestial spirit",
	ac : 20,
	hp : 60,
	hd : [10, 10],
	speed : "30 ft., Fly 40 ft.",
	scores : [16, 14, 16, 10, 14, 16],
	damage_resistances : "Radiant",
	condition_immunities : "Charmed; Frightened",
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Celestial; Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	attacks : [{
		name : "Radiant Mace (Defender Only)",
		ability : 1,
		damage : [1, 10, "Radiant"],
		range : "Melee (5 ft.)",
		modifiers : ["", 5],
		description : "The spirit choose either itself or another creature it can see within 10 ft. and grants 1d10 Temp HP.",
		useSpellMod : ["cleric", "paladin"]
	}],
};
CreatureList["celestial spirit (d)(8)"] = {
	name : "Celestial Spirit (Defender)(lvl 8)",
	regExpSearch : /^(?=.*celestial)(?=.*spirit)(?=.*defender)(?=.*8).*$/i,
	source : [["PHB2024", 323]],
	size : 2,
	type : "Celestial",
	alignment : "Neutral",
	companion : "celestial spirit",
	companionApply : "celestial spirit",
	ac : 21,
	hp : 70,
	hd : [12, 10],
	speed : "30 ft., Fly 40 ft.",
	scores : [16, 14, 16, 10, 14, 16],
	damage_resistances : "Radiant",
	condition_immunities : "Charmed; Frightened",
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Celestial; Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	actions : [{
		name : "Healing Touch (1/Day)",
		description : "The spirit touches another creature. The target regains Hit Points equal to 2d8+8",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Radiant Mace (Defender Only)",
		ability : 1,
		damage : [1, 10, "Radiant"],
		range : "Melee (5 ft.)",
		modifiers : ["", 5],
		description : "The spirit choose either itself or another creature it can see within 10 ft. and grants 1d10 Temp HP.",
		useSpellMod : ["cleric", "paladin"]
	}],
};
CreatureList["celestial spirit (d)(9)"] = {
	name : "Celestial Spirit (Defender)(lvl 9)",
	regExpSearch : /^(?=.*celestial)(?=.*spirit)(?=.*defender)(?=.*9).*$/i,
	source : [["PHB2024", 323]],
	size : 2,
	type : "Celestial",
	alignment : "Neutral",
	companion : "celestial spirit",
	companionApply : "celestial spirit",
	ac : 22,
	hp : 80,
	hd : [13, 10],
	speed : "30 ft., Fly 40 ft.",
	scores : [16, 14, 16, 10, 14, 16],
	damage_resistances : "Radiant",
	condition_immunities : "Charmed; Frightened",
	senses : "Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Celestial; Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	actions : [{
		name : "Healing Touch (1/Day)",
		description : "The spirit touches another creature. The target regains Hit Points equal to 2d8+9",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Radiant Mace (Defender Only)",
		ability : 1,
		damage : [1, 10, "Radiant"],
		range : "Melee (5 ft.)",
		modifiers : ["", 5],
		description : "The spirit choose either itself or another creature it can see within 10 ft. and grants 1d10 Temp HP.",
		useSpellMod : ["cleric", "paladin"]
	}],
};
//Construct Spirit Stat Blocks
CompanionList["construct spirit"] = {
	name : "Construct Spirit",
	nameMenu : "Construct Spirit (Summon Construct Spell)",
	nameOrigin : "Summon Spirit of the Summon Construct 4th-level conjuration spell",
	source : [["PHB2024", 328]],
	attributesChange : function(sCrea, objCrea) {
        var casters = isSpellUsed('summon construct');
        var oScore = undefined;
        
        for (var caster of casters) {
            if (CurrentSpells[caster].refType !== "class") continue;
            
            var ability = CurrentSpells[caster].ability;
    
            var abilityMod = What(AbilityScores.abbreviations[ability - 1] + " Mod");
            
            if (oScore === undefined || abilityMod > What(AbilityScores.abbreviations[oScore[1] - 1] + " Mod")) {
                oScore = [caster, ability];
            }
        }

        if (oScore === undefined) return;
    
        for (var i = 0; i < objCrea.attacks.length; i++) {
            var oAtk = objCrea.attacks[i];
            oAtk.useSpellMod = oScore[0];
        }
        
    },
};
CreatureList["construct spirit (4)"] = {
	name : "Construct Spirit (lvl 4)",
	regExpSearch : /^(?=.*construct)(?=.*spirit)(?=.*4).*$/i,
	source : [["PHB2024", 324]],
	size : 3,
	type : "Construct",
	alignment : "Neutral",
	companion : "construct spirit",
	companionApply : "construct spirit",
	ac : 17,
	hp : 40,
	hd : [8, 8],
	speed : "30 ft.",
	scores : [18, 10, 18, 14, 11, 5],
	damage_resistances : "Poison",
	condition_immunities : "Charmed, Exhausted, Frightened, Paralyzed, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 2,
	actions : [{
		name : "Berserk Lashing (Clay Only)",
		description : "Trigger: The spirit takes damage from a creature. Response: The spirit makes a Slam attack against that creature if possible, or the spirit moves up to half its Speed toward that creature without provoking Opportunity Attacks.",
	}],
	features : [{
		name : "Heated Body (Metal Only)",
		description : "A creature that hits the spirit with a melee attack or that starts its turn in a grapple with the spirit takes 1d10 Fire damage.",
		joinString : "\n   ",
	}, {
		name : "Stony Lethargy (Stone Only)",
		description : "When a creature starts its turn within 10 feet of the spirit, the spirit can target it with magical energy if the spirit can see it. Wisdom Saving Throw: DC equals your spell save DC, the target. Failure: Until the start of its next turn, the target can't make Opportunity Attacks, and its Speed is halved.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Slam",
		ability : 1,
		damage : [1, 8, "Bludgeoning"],
		range : "Melee (5 ft.)",
		modifiers : ["", 4],
		useSpellMod : ["wizard"]
	}],
};
CreatureList["construct spirit (5)"] = {
	name : "Construct Spirit (lvl 5)",
	regExpSearch : /^(?=.*construct)(?=.*spirit)(?=.*5).*$/i,
	source : [["PHB2024", 324]],
	size : 3,
	type : "Construct",
	alignment : "Neutral",
	companion : "construct spirit",
	companionApply : "construct spirit",
	ac : 18,
	hp : 55,
	hd : [11, 8],
	speed : "30 ft.",
	scores : [18, 10, 18, 14, 11, 5],
	damage_resistances : "Poison",
	condition_immunities : "Charmed, Exhausted, Frightened, Paralyzed, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 2,
	actions : [{
		name : "Berserk Lashing (Clay Only)",
		description : "Trigger: The spirit takes damage from a creature. Response: The spirit makes a Slam attack against that creature if possible, or the spirit moves up to half its Speed toward that creature without provoking Opportunity Attacks.",
	}],
	features : [{
		name : "Heated Body (Metal Only)",
		description : "A creature that hits the spirit with a melee attack or that starts its turn in a grapple with the spirit takes 1d10 Fire damage.",
		joinString : "\n   ",
	}, {
		name : "Stony Lethargy (Stone Only)",
		description : "When a creature starts its turn within 10 feet of the spirit, the spirit can target it with magical energy if the spirit can see it. Wisdom Saving Throw: DC equals your spell save DC, the target. Failure: Until the start of its next turn, the target can't make Opportunity Attacks, and its Speed is halved.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Slam",
		ability : 1,
		damage : [1, 8, "Bludgeoning"],
		range : "Melee (5 ft.)",
		modifiers : ["", 5],
		useSpellMod : ["wizard"]
	}],
};
CreatureList["construct spirit (6)"] = {
	name : "Construct Spirit (lvl 6)",
	regExpSearch : /^(?=.*construct)(?=.*spirit)(?=.*6).*$/i,
	source : [["PHB2024", 324]],
	size : 3,
	type : "Construct",
	alignment : "Neutral",
	companion : "construct spirit",
	companionApply : "construct spirit",
	ac : 19,
	hp : 70,
	hd : [14, 8],
	speed : "30 ft.",
	scores : [18, 10, 18, 14, 11, 5],
	damage_resistances : "Poison",
	condition_immunities : "Charmed, Exhausted, Frightened, Paralyzed, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	actions : [{
		name : "Berserk Lashing (Clay Only)",
		description : "Trigger: The spirit takes damage from a creature. Response: The spirit makes a Slam attack against that creature if possible, or the spirit moves up to half its Speed toward that creature without provoking Opportunity Attacks.",
	}],
	features : [{
		name : "Heated Body (Metal Only)",
		description : "A creature that hits the spirit with a melee attack or that starts its turn in a grapple with the spirit takes 1d10 Fire damage.",
		joinString : "\n   ",
	}, {
		name : "Stony Lethargy (Stone Only)",
		description : "When a creature starts its turn within 10 feet of the spirit, the spirit can target it with magical energy if the spirit can see it. Wisdom Saving Throw: DC equals your spell save DC, the target. Failure: Until the start of its next turn, the target can't make Opportunity Attacks, and its Speed is halved.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Slam",
		ability : 1,
		damage : [1, 8, "Bludgeoning"],
		range : "Melee (5 ft.)",
		modifiers : ["", 6],
		useSpellMod : ["wizard"]
	}],
};
CreatureList["construct spirit (7)"] = {
	name : "Construct Spirit (lvl 7)",
	regExpSearch : /^(?=.*construct)(?=.*spirit)(?=.*7).*$/i,
	source : [["PHB2024", 324]],
	size : 3,
	type : "Construct",
	alignment : "Neutral",
	companion : "construct spirit",
	companionApply : "construct spirit",
	ac : 20,
	hp : 85,
	hd : [17, 8],
	speed : "30 ft.",
	scores : [18, 10, 18, 14, 11, 5],
	damage_resistances : "Poison",
	condition_immunities : "Charmed, Exhausted, Frightened, Paralyzed, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	actions : [{
		name : "Berserk Lashing (Clay Only)",
		description : "Trigger: The spirit takes damage from a creature. Response: The spirit makes a Slam attack against that creature if possible, or the spirit moves up to half its Speed toward that creature without provoking Opportunity Attacks.",
	}],
	features : [{
		name : "Heated Body (Metal Only)",
		description : "A creature that hits the spirit with a melee attack or that starts its turn in a grapple with the spirit takes 1d10 Fire damage.",
		joinString : "\n   ",
	}, {
		name : "Stony Lethargy (Stone Only)",
		description : "When a creature starts its turn within 10 feet of the spirit, the spirit can target it with magical energy if the spirit can see it. Wisdom Saving Throw: DC equals your spell save DC, the target. Failure: Until the start of its next turn, the target can't make Opportunity Attacks, and its Speed is halved.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Slam",
		ability : 1,
		damage : [1, 8, "Bludgeoning"],
		range : "Melee (5 ft.)",
		modifiers : ["", 7],
		useSpellMod : ["wizard"]
	}],
};
CreatureList["construct spirit (8)"] = {
	name : "Construct Spirit (lvl 8)",
	regExpSearch : /^(?=.*construct)(?=.*spirit)(?=.*8).*$/i,
	source : [["PHB2024", 324]],
	size : 3,
	type : "Construct",
	alignment : "Neutral",
	companion : "construct spirit",
	companionApply : "construct spirit",
	ac : 21,
	hp : 100,
	hd : [20, 8],
	speed : "30 ft.",
	scores : [18, 10, 18, 14, 11, 5],
	damage_resistances : "Poison",
	condition_immunities : "Charmed, Exhausted, Frightened, Paralyzed, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	actions : [{
		name : "Berserk Lashing (Clay Only)",
		description : "Trigger: The spirit takes damage from a creature. Response: The spirit makes a Slam attack against that creature if possible, or the spirit moves up to half its Speed toward that creature without provoking Opportunity Attacks.",
	}],
	features : [{
		name : "Heated Body (Metal Only)",
		description : "A creature that hits the spirit with a melee attack or that starts its turn in a grapple with the spirit takes 1d10 Fire damage.",
		joinString : "\n   ",
	}, {
		name : "Stony Lethargy (Stone Only)",
		description : "When a creature starts its turn within 10 feet of the spirit, the spirit can target it with magical energy if the spirit can see it. Wisdom Saving Throw: DC equals your spell save DC, the target. Failure: Until the start of its next turn, the target can't make Opportunity Attacks, and its Speed is halved.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Slam",
		ability : 1,
		damage : [1, 8, "Bludgeoning"],
		range : "Melee (5 ft.)",
		modifiers : ["", 8],
		useSpellMod : ["wizard"]
	}],
};
CreatureList["construct spirit (9)"] = {
	name : "Construct Spirit (lvl 9)",
	regExpSearch : /^(?=.*construct)(?=.*spirit)(?=.*9).*$/i,
	source : [["PHB2024", 324]],
	size : 3,
	type : "Construct",
	alignment : "Neutral",
	companion : "construct spirit",
	companionApply : "construct spirit",
	ac : 22,
	hp : 115,
	hd : [23, 8],
	speed : "30 ft.",
	scores : [18, 10, 18, 14, 11, 5],
	damage_resistances : "Poison",
	condition_immunities : "Charmed, Exhausted, Frightened, Paralyzed, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	actions : [{
		name : "Berserk Lashing (Clay Only)",
		description : "Trigger: The spirit takes damage from a creature. Response: The spirit makes a Slam attack against that creature if possible, or the spirit moves up to half its Speed toward that creature without provoking Opportunity Attacks.",
	}],
	features : [{
		name : "Heated Body (Metal Only)",
		description : "A creature that hits the spirit with a melee attack or that starts its turn in a grapple with the spirit takes 1d10 Fire damage.",
		joinString : "\n   ",
	}, {
		name : "Stony Lethargy (Stone Only)",
		description : "When a creature starts its turn within 10 feet of the spirit, the spirit can target it with magical energy if the spirit can see it. Wisdom Saving Throw: DC equals your spell save DC, the target. Failure: Until the start of its next turn, the target can't make Opportunity Attacks, and its Speed is halved.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Slam",
		ability : 1,
		damage : [1, 8, "Bludgeoning"],
		range : "Melee (5 ft.)",
		modifiers : ["", 9],
		useSpellMod : ["wizard"]
	}],
};
//Draconic Spirit Stat Block
CompanionList["draconic spirit"] = {
	name : "Draconic Spirit",
	nameMenu : "Draconic Spirit (Summon Dragon Spell)",
	nameOrigin : "Summon Spirit of the Summon Dragon 5th-level conjuration spell",
	source : [["PHB2024", 324]],
	attributesChange : function(sCrea, objCrea) {
        var casters = isSpellUsed('summon dragon');
        var oScore = undefined;
        
        for (var caster of casters) {
            if (CurrentSpells[caster].refType !== "class") continue;
            
            var ability = CurrentSpells[caster].ability;
    
            var abilityMod = What(AbilityScores.abbreviations[ability - 1] + " Mod");
            
            if (oScore === undefined || abilityMod > What(AbilityScores.abbreviations[oScore[1] - 1] + " Mod")) {
                oScore = [caster, ability];
            }
        }

        if (oScore === undefined) return;
    
        for (var i = 0; i < objCrea.attacks.length; i++) {
            var oAtk = objCrea.attacks[i];
            oAtk.useSpellMod = oScore[0];
        }
        
    },
};
CreatureList["draconic spirit (5)"] = {
	name : "Draconic Spirit (lvl 5)",
	regExpSearch : /^(?=.*draconic)(?=.*spirit)(?=.*5).*$/i,
	source : [["PHB2024", 325]],
	size : 2,
	type : "Dragon",
	alignment : "Neutral",
	companion : "draconic spirit",
	companionApply : "draconic spirit",
	ac : 19,
	hp : 50,
	hd : [8, 10],
	speed : "30 ft., Fly 60 ft., Swim 30 ft.",
	scores : [19, 14, 17, 10, 14, 14],
	damage_resistances : "Acid, Cold, Fire, Lightning, Poison",
	condition_immunities : "Charmed, Frightened, Poisoned",
	senses : "Blindsight 30 ft., Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Draconic, Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 2,
	features : [{
		name : "Shared Resistances",
		description : "When you smmon the spirit, choose one of its Resistances. You have Resistane to the chosen damage type until the spell ends.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 6, "Piercing"],
		range : "Melee (10 ft.)",
		modifiers : ["", 5],
		useSpellMod : ["wizard"]
	}, {
		name : "Breath Weapon",
		ability : 1,
		dc : true,
		damage : [2, 6, "Ac/Cd/Fi/Li/Po"],
		abilitytodamage : false,
		range : "30 ft. Cone",
		useSpellMod : ["wizard"]
	}],
};
CreatureList["draconic spirit (6)"] = {
	name : "Draconic Spirit (lvl 6)",
	regExpSearch : /^(?=.*draconic)(?=.*spirit)(?=.*6).*$/i,
	source : [["PHB2024", 325]],
	size : 2,
	type : "Dragon",
	alignment : "Neutral",
	companion : "draconic spirit",
	companionApply : "draconic spirit",
	ac : 20,
	hp : 60,
	hd : [10, 10],
	speed : "30 ft., Fly 60 ft., Swim 30 ft.",
	scores : [19, 14, 17, 10, 14, 14],
	damage_resistances : "Acid, Cold, Fire, Lightning, Poison",
	condition_immunities : "Charmed, Frightened, Poisoned",
	senses : "Blindsight 30 ft., Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Draconic, Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Shared Resistances",
		description : "When you smmon the spirit, choose one of its Resistances. You have Resistane to the chosen damage type until the spell ends.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 6, "Piercing"],
		range : "Melee (10 ft.)",
		modifiers : ["", 6],
		useSpellMod : ["wizard"]
	}, {
		name : "Breath Weapon",
		ability : 1,
		dc : true,
		damage : [2, 6, "Ac/Cd/Fi/Li/Po"],
		abilitytodamage : false,
		range : "30 ft. Cone",
		useSpellMod : ["wizard"]
	}],
};
CreatureList["draconic spirit (7)"] = {
	name : "Draconic Spirit (lvl 7)",
	regExpSearch : /^(?=.*draconic)(?=.*spirit)(?=.*7).*$/i,
	source : [["PHB2024", 325]],
	size : 2,
	type : "Dragon",
	alignment : "Neutral",
	companion : "draconic spirit",
	companionApply : "draconic spirit",
	ac : 21,
	hp : 70,
	hd : [12, 10],
	speed : "30 ft., Fly 60 ft., Swim 30 ft.",
	scores : [19, 14, 17, 10, 14, 14],
	damage_resistances : "Acid, Cold, Fire, Lightning, Poison",
	condition_immunities : "Charmed, Frightened, Poisoned",
	senses : "Blindsight 30 ft., Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Draconic, Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Shared Resistances",
		description : "When you smmon the spirit, choose one of its Resistances. You have Resistane to the chosen damage type until the spell ends.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 6, "Piercing"],
		range : "Melee (10 ft.)",
		modifiers : ["", 7],
		useSpellMod : ["wizard"]
	}, {
		name : "Breath Weapon",
		ability : 1,
		dc : true,
		damage : [2, 6, "Ac/Cd/Fi/Li/Po"],
		abilitytodamage : false,
		range : "30 ft. Cone",
		useSpellMod : ["wizard"]
	}],
};
CreatureList["draconic spirit (8)"] = {
	name : "Draconic Spirit (lvl 8)",
	regExpSearch : /^(?=.*draconic)(?=.*spirit)(?=.*8).*$/i,
	source : [["PHB2024", 325]],
	size : 2,
	type : "Dragon",
	alignment : "Neutral",
	companion : "draconic spirit",
	companionApply : "draconic spirit",
	ac : 22,
	hp : 80,
	hd : [13, 10],
	speed : "30 ft., Fly 60 ft., Swim 30 ft.",
	scores : [19, 14, 17, 10, 14, 14],
	damage_resistances : "Acid, Cold, Fire, Lightning, Poison",
	condition_immunities : "Charmed, Frightened, Poisoned",
	senses : "Blindsight 30 ft., Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Draconic, Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	features : [{
		name : "Shared Resistances",
		description : "When you smmon the spirit, choose one of its Resistances. You have Resistane to the chosen damage type until the spell ends.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 6, "Piercing"],
		range : "Melee (10 ft.)",
		modifiers : ["", 8],
		useSpellMod : ["wizard"]
	}, {
		name : "Breath Weapon",
		ability : 1,
		dc : true,
		damage : [2, 6, "Ac/Cd/Fi/Li/Po"],
		abilitytodamage : false,
		range : "30 ft. Cone",
		useSpellMod : ["wizard"]
	}],
};
CreatureList["draconic spirit (9)"] = {
	name : "Draconic Spirit (lvl 9)",
	regExpSearch : /^(?=.*draconic)(?=.*spirit)(?=.*9).*$/i,
	source : [["PHB2024", 325]],
	size : 2,
	type : "Dragon",
	alignment : "Neutral",
	companion : "draconic spirit",
	companionApply : "draconic spirit",
	ac : 23,
	hp : 90,
	hd : [15, 10],
	speed : "30 ft., Fly 60 ft., Swim 30 ft.",
	scores : [19, 14, 17, 10, 14, 14],
	damage_resistances : "Acid, Cold, Fire, Lightning, Poison",
	condition_immunities : "Charmed, Frightened, Poisoned",
	senses : "Blindsight 30 ft., Darkvision 60 ft.",
	passivePerception : 12,
	languages : "Draconic, Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	features : [{
		name : "Shared Resistances",
		description : "When you smmon the spirit, choose one of its Resistances. You have Resistane to the chosen damage type until the spell ends.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Rend",
		ability : 1,
		damage : [1, 6, "Piercing"],
		range : "Melee (10 ft.)",
		modifiers : ["", 9],
		useSpellMod : ["wizard"]
	}, {
		name : "Breath Weapon",
		ability : 1,
		dc : true,
		damage : [2, 6, "Ac/Cd/Fi/Li/Po"],
		abilitytodamage : false,
		range : "30 ft. Cone",
		useSpellMod : ["wizard"]
	}],
};
//Elemental Spirit Stat Blocks
CompanionList["elemental spirit"] = {
	name : "Elemental Spirit",
	nameMenu : "Elemental Spirit (Summon Elemental Spell)",
	nameOrigin : "Summon Spirit of the Summon Elemental 4th-level conjuration spell",
	source : [["PHB2024", 325]],
	attributesChange : function(sCrea, objCrea) {
        var casters = isSpellUsed('summon elemental');
        var oScore = undefined;
        
        for (var caster of casters) {
            if (CurrentSpells[caster].refType !== "class") continue;
            
            var ability = CurrentSpells[caster].ability;
    
            var abilityMod = What(AbilityScores.abbreviations[ability - 1] + " Mod");
            
            if (oScore === undefined || abilityMod > What(AbilityScores.abbreviations[oScore[1] - 1] + " Mod")) {
                oScore = [caster, ability];
            }
        }

        if (oScore === undefined) return;
    
        for (var i = 0; i < objCrea.attacks.length; i++) {
            var oAtk = objCrea.attacks[i];
            oAtk.useSpellMod = oScore[0];
        }
        
    },
};
CreatureList["elemental spirit (4)"] = {
	name : "Elemental Spirit (lvl 4)",
	regExpSearch : /^(?=.*elemental)(?=.*spirit)(?=.*4).*$/i,
	source : [["PHB2024", 325]],
	size : 3,
	type : "Elemental",
	alignment : "Neutral",
	companion : "elemental spirit",
	companionApply : "elemental spirit",
	ac : 15,
	hp : 50,
	hd : [8, 10],
	speed : "40 ft., Burrow(E) 40 ft., Fly 40 ft.(Hover(A)), Swim(W) 40 ft.",
	scores : [18, 15, 17, 4, 10, 16],
	damage_resistances : "Acid(W), Lightning and Thunder(A), Piercing and Slashing(E)",
	damage_immunities : "Fire(F), Poison",
	condition_immunities : "Exhaustion, Paralyzed, Petrified, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Primordial, Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 2,
	features : [{
		name : "Amorphous Form (A,F,W)",
		description : "The spirit can move through a space as narrow as 1 inch wide without it counting as Difficult Terrain.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Slam",
		ability : 1,
		damage : [1, 10, "Blud(E)/Cd(W)/Li(A)/Fi(F)"],
		range : "Melee (10 ft.)",
		modifiers : ["", 4],
		useSpellMod : ["druid", "ranger", "wizard"]
	}],
};
CreatureList["elemental spirit (5)"] = {
	name : "Elemental Spirit (lvl 5)",
	regExpSearch : /^(?=.*elemental)(?=.*spirit)(?=.*5).*$/i,
	source : [["PHB2024", 325]],
	size : 3,
	type : "Elemental",
	alignment : "Neutral",
	companion : "elemental spirit",
	companionApply : "elemental spirit",
	ac : 16,
	hp : 60,
	hd : [10, 10],
	speed : "40 ft., Burrow(E) 40 ft., Fly 40 ft.(Hover(A)), Swim(W) 40 ft.",
	scores : [18, 15, 17, 4, 10, 16],
	damage_resistances : "Acid(W), Lightning and Thunder(A), Piercing and Slashing(E)",
	damage_immunities : "Fire(F), Poison",
	condition_immunities : "Exhaustion, Paralyzed, Petrified, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Primordial, Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 2,
	features : [{
		name : "Amorphous Form (A,F,W)",
		description : "The spirit can move through a space as narrow as 1 inch wide without it counting as Difficult Terrain.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Slam",
		ability : 1,
		damage : [1, 10, "Blud(E)/Cd(W)/Li(A)/Fi(F)"],
		range : "Melee (10 ft.)",
		modifiers : ["", 5],
		useSpellMod : ["druid", "ranger", "wizard"]
	}],
};
CreatureList["elemental spirit (6)"] = {
	name : "Elemental Spirit (lvl 6)",
	regExpSearch : /^(?=.*elemental)(?=.*spirit)(?=.*6).*$/i,
	source : [["PHB2024", 325]],
	size : 3,
	type : "Elemental",
	alignment : "Neutral",
	companion : "elemental spirit",
	companionApply : "elemental spirit",
	ac : 17,
	hp : 70,
	hd : [12, 10],
	speed : "40 ft., Burrow(E) 40 ft., Fly 40 ft.(Hover(A)), Swim(W) 40 ft.",
	scores : [18, 15, 17, 4, 10, 16],
	damage_resistances : "Acid(W), Lightning and Thunder(A), Piercing and Slashing(E)",
	damage_immunities : "Fire(F), Poison",
	condition_immunities : "Exhaustion, Paralyzed, Petrified, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Primordial, Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Amorphous Form (A,F,W)",
		description : "The spirit can move through a space as narrow as 1 inch wide without it counting as Difficult Terrain.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Slam",
		ability : 1,
		damage : [1, 10, "Blud(E)/Cd(W)/Li(A)/Fi(F)"],
		range : "Melee (10 ft.)",
		modifiers : ["", 6],
		useSpellMod : ["druid", "ranger", "wizard"]
	}],
};
CreatureList["elemental spirit (7)"] = {
	name : "Elemental Spirit (lvl 7)",
	regExpSearch : /^(?=.*elemental)(?=.*spirit)(?=.*7).*$/i,
	source : [["PHB2024", 325]],
	size : 3,
	type : "Elemental",
	alignment : "Neutral",
	companion : "elemental spirit",
	companionApply : "elemental spirit",
	ac : 18,
	hp : 80,
	hd : [14, 10],
	speed : "40 ft., Burrow(E) 40 ft., Fly 40 ft.(Hover(A)), Swim(W) 40 ft.",
	scores : [18, 15, 17, 4, 10, 16],
	damage_resistances : "Acid(W), Lightning and Thunder(A), Piercing and Slashing(E)",
	damage_immunities : "Fire(F), Poison",
	condition_immunities : "Exhaustion, Paralyzed, Petrified, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Primordial, Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Amorphous Form (A,F,W)",
		description : "The spirit can move through a space as narrow as 1 inch wide without it counting as Difficult Terrain.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Slam",
		ability : 1,
		damage : [1, 10, "Blud(E)/Cd(W)/Li(A)/Fi(F)"],
		range : "Melee (10 ft.)",
		modifiers : ["", 7],
		useSpellMod : ["druid", "ranger", "wizard"]
	}],
};
CreatureList["elemental spirit (8)"] = {
	name : "Elemental Spirit (lvl 8)",
	regExpSearch : /^(?=.*elemental)(?=.*spirit)(?=.*8).*$/i,
	source : [["PHB2024", 325]],
	size : 3,
	type : "Elemental",
	alignment : "Neutral",
	companion : "elemental spirit",
	companionApply : "elemental spirit",
	ac : 19,
	hp : 90,
	hd : [15, 10],
	speed : "40 ft., Burrow(E) 40 ft., Fly 40 ft.(Hover(A)), Swim(W) 40 ft.",
	scores : [18, 15, 17, 4, 10, 16],
	damage_resistances : "Acid(W), Lightning and Thunder(A), Piercing and Slashing(E)",
	damage_immunities : "Fire(F), Poison",
	condition_immunities : "Exhaustion, Paralyzed, Petrified, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Primordial, Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Amorphous Form (A,F,W)",
		description : "The spirit can move through a space as narrow as 1 inch wide without it counting as Difficult Terrain.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Slam",
		ability : 1,
		damage : [1, 10, "Blud(E)/Cd(W)/Li(A)/Fi(F)"],
		range : "Melee (10 ft.)",
		modifiers : ["", 8],
		useSpellMod : ["druid", "ranger", "wizard"]
	}],
};
CreatureList["elemental spirit (9)"] = {
	name : "Elemental Spirit (lvl 9)",
	regExpSearch : /^(?=.*elemental)(?=.*spirit)(?=.*9).*$/i,
	source : [["PHB2024", 325]],
	size : 3,
	type : "Elemental",
	alignment : "Neutral",
	companion : "elemental spirit",
	companionApply : "elemental spirit",
	ac : 20,
	hp : 100,
	hd : [17, 10],
	speed : "40 ft., Burrow(E) 40 ft., Fly 40 ft.(Hover(A)), Swim(W) 40 ft.",
	scores : [18, 15, 17, 4, 10, 16],
	damage_resistances : "Acid(W), Lightning and Thunder(A), Piercing and Slashing(E)",
	damage_immunities : "Fire(F), Poison",
	condition_immunities : "Exhaustion, Paralyzed, Petrified, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Primordial, Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Amorphous Form (A,F,W)",
		description : "The spirit can move through a space as narrow as 1 inch wide without it counting as Difficult Terrain.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Slam",
		ability : 1,
		damage : [1, 10, "Blud(E)/Cd(W)/Li(A)/Fi(F)"],
		range : "Melee (10 ft.)",
		modifiers : ["", 9],
		useSpellMod : ["druid", "ranger", "wizard"]
	}],
};
//Fey Spirit Stat Blocks
CompanionList["fey spirit"] = {
	name : "Fey Spirit",
	nameMenu : "Fey Spirit (Summon Fey Spell)",
	nameOrigin : "Summon Spirit of the Summon Fey 3rd-level conjuration spell",
	source : [["PHB2024", 326]],
	attributesChange : function(sCrea, objCrea) {
        var casters = isSpellUsed('summon fey');
        var oScore = undefined;
        
        for (var caster of casters) {
            if (CurrentSpells[caster].refType !== "class") continue;
            
            var ability = CurrentSpells[caster].ability;
    
            var abilityMod = What(AbilityScores.abbreviations[ability - 1] + " Mod");
            
            if (oScore === undefined || abilityMod > What(AbilityScores.abbreviations[oScore[1] - 1] + " Mod")) {
                oScore = [caster, ability];
            }
        }

        if (oScore === undefined) return;
    
        for (var i = 0; i < objCrea.attacks.length; i++) {
            var oAtk = objCrea.attacks[i];
            oAtk.useSpellMod = oScore[0];
        }
        
    },
};
CreatureList["fey spirit (3)"] = {
	name : "Fey Spirit (lvl 3)",
	regExpSearch : /^(?=.*fey)(?=.*spirit)(?=.*3).*$/i,
	source : [["PHB2024", 326]],
	size : 4,
	type : "Fey",
	alignment : "Neutral",
	companion : "fey spirit",
	companionApply : "fey spirit",
	ac : 15,
	hp : 30,
	hd : [7, 6],
	speed : "30 ft., Fly 30 ft.",
	scores : [13, 16, 14, 14, 11, 16],
	condition_immunities : "Charmed",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Sylvan, Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 1,
	actions : [{
		name : "Fey Step",
		description : desc([
			"As a Bonus Action, The spirit magically teleports up to 30 feet to an unoccupied space it can see. Then one of the following effects occur, based on the spirit's chosen mood:",
			"Fuming. The spirit has Advantage on the next attack roll it makes before the end of this turn",
			"Mirthful. Wisdom Saving Throw: DC equals your spell save DC, one creature the spirit can see within 10 feet of itself. Failure: The target is Charmed by you and the spirit for 1 minute or until the target takes any damage.",
			"Tricksy. The spirit fills a 10-foot Cube within 5 feet of it with magical Darkness, which last suntilt eh end of its next turn.",
		]),
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Fey Blade",
		ability : 2,
		damage : [2, 6, "Force"],
		range : "Melee (5 ft.)",
		modifiers : ["", 3],
		useSpellMod : ["druid", "ranger", "warlock", "wizard"]
	}],
};
CreatureList["fey spirit (4)"] = {
	name : "Fey Spirit (lvl 4)",
	regExpSearch : /^(?=.*fey)(?=.*spirit)(?=.*4).*$/i,
	source : [["PHB2024", 326]],
	size : 4,
	type : "Fey",
	alignment : "Neutral",
	companion : "fey spirit",
	companionApply : "fey spirit",
	ac : 16,
	hp : 40,
	hd : [10, 6],
	speed : "30 ft., Fly 30 ft.",
	scores : [13, 16, 14, 14, 11, 16],
	condition_immunities : "Charmed",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Sylvan, Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 2,
	actions : [{
		name : "Fey Step",
		description : desc([
			"As a Bonus Action, The spirit magically teleports up to 30 feet to an unoccupied space it can see. Then one of the following effects occur, based on the spirit's chosen mood:",
			"Fuming. The spirit has Advantage on the next attack roll it makes before the end of this turn",
			"Mirthful. Wisdom Saving Throw: DC equals your spell save DC, one creature the spirit can see within 10 feet of itself. Failure: The target is Charmed by you and the spirit for 1 minute or until the target takes any damage.",
			"Tricksy. The spirit fills a 10-foot Cube within 5 feet of it with magical Darkness, which last suntilt eh end of its next turn.",
		]),
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Fey Blade",
		ability : 2,
		damage : [2, 6, "Force"],
		range : "Melee (5 ft.)",
		modifiers : ["", 4],
		useSpellMod : ["druid", "ranger", "warlock", "wizard"]
	}],
};
CreatureList["fey spirit (5)"] = {
	name : "Fey Spirit (lvl 5)",
	regExpSearch : /^(?=.*fey)(?=.*spirit)(?=.*5).*$/i,
	source : [["PHB2024", 326]],
	size : 4,
	type : "Fey",
	alignment : "Neutral",
	companion : "fey spirit",
	companionApply : "fey spirit",
	ac : 17,
	hp : 50,
	hd : [12, 6],
	speed : "30 ft., Fly 30 ft.",
	scores : [13, 16, 14, 14, 11, 16],
	condition_immunities : "Charmed",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Sylvan, Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 2,
	actions : [{
		name : "Fey Step",
		description : desc([
			"As a Bonus Action, The spirit magically teleports up to 30 feet to an unoccupied space it can see. Then one of the following effects occur, based on the spirit's chosen mood:",
			"Fuming. The spirit has Advantage on the next attack roll it makes before the end of this turn",
			"Mirthful. Wisdom Saving Throw: DC equals your spell save DC, one creature the spirit can see within 10 feet of itself. Failure: The target is Charmed by you and the spirit for 1 minute or until the target takes any damage.",
			"Tricksy. The spirit fills a 10-foot Cube within 5 feet of it with magical Darkness, which last suntilt eh end of its next turn.",
		]),
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Fey Blade",
		ability : 2,
		damage : [2, 6, "Force"],
		range : "Melee (5 ft.)",
		modifiers : ["", 5],
		useSpellMod : ["druid", "ranger", "warlock", "wizard"]
	}],
};
CreatureList["fey spirit (6)"] = {
	name : "Fey Spirit (lvl 6)",
	regExpSearch : /^(?=.*fey)(?=.*spirit)(?=.*6).*$/i,
	source : [["PHB2024", 326]],
	size : 4,
	type : "Fey",
	alignment : "Neutral",
	companion : "fey spirit",
	companionApply : "fey spirit",
	ac : 18,
	hp : 60,
	hd : [15, 6],
	speed : "30 ft., Fly 30 ft.",
	scores : [13, 16, 14, 14, 11, 16],
	condition_immunities : "Charmed",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Sylvan, Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	actions : [{
		name : "Fey Step",
		description : desc([
			"As a Bonus Action, The spirit magically teleports up to 30 feet to an unoccupied space it can see. Then one of the following effects occur, based on the spirit's chosen mood:",
			"Fuming. The spirit has Advantage on the next attack roll it makes before the end of this turn",
			"Mirthful. Wisdom Saving Throw: DC equals your spell save DC, one creature the spirit can see within 10 feet of itself. Failure: The target is Charmed by you and the spirit for 1 minute or until the target takes any damage.",
			"Tricksy. The spirit fills a 10-foot Cube within 5 feet of it with magical Darkness, which last suntilt eh end of its next turn.",
		]),
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Fey Blade",
		ability : 2,
		damage : [2, 6, "Force"],
		range : "Melee (5 ft.)",
		modifiers : ["", 6],
		useSpellMod : ["druid", "ranger", "warlock", "wizard"]
	}],
};
CreatureList["fey spirit (7)"] = {
	name : "Fey Spirit (lvl 7)",
	regExpSearch : /^(?=.*fey)(?=.*spirit)(?=.*7).*$/i,
	source : [["PHB2024", 326]],
	size : 4,
	type : "Fey",
	alignment : "Neutral",
	companion : "fey spirit",
	companionApply : "fey spirit",
	ac : 19,
	hp : 70,
	hd : [17, 6],
	speed : "30 ft., Fly 30 ft.",
	scores : [13, 16, 14, 14, 11, 16],
	condition_immunities : "Charmed",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Sylvan, Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	actions : [{
		name : "Fey Step",
		description : desc([
			"As a Bonus Action, The spirit magically teleports up to 30 feet to an unoccupied space it can see. Then one of the following effects occur, based on the spirit's chosen mood:",
			"Fuming. The spirit has Advantage on the next attack roll it makes before the end of this turn",
			"Mirthful. Wisdom Saving Throw: DC equals your spell save DC, one creature the spirit can see within 10 feet of itself. Failure: The target is Charmed by you and the spirit for 1 minute or until the target takes any damage.",
			"Tricksy. The spirit fills a 10-foot Cube within 5 feet of it with magical Darkness, which last suntilt eh end of its next turn.",
		]),
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Fey Blade",
		ability : 2,
		damage : [2, 6, "Force"],
		range : "Melee (5 ft.)",
		modifiers : ["", 7],
		useSpellMod : ["druid", "ranger", "warlock", "wizard"]
	}],
};
CreatureList["fey spirit (8)"] = {
	name : "Fey Spirit (lvl 8)",
	regExpSearch : /^(?=.*fey)(?=.*spirit)(?=.*8).*$/i,
	source : [["PHB2024", 326]],
	size : 4,
	type : "Fey",
	alignment : "Neutral",
	companion : "fey spirit",
	companionApply : "fey spirit",
	ac : 20,
	hp : 80,
	hd : [20, 6],
	speed : "30 ft., Fly 30 ft.",
	scores : [13, 16, 14, 14, 11, 16],
	condition_immunities : "Charmed",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Sylvan, Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	actions : [{
		name : "Fey Step",
		description : desc([
			"As a Bonus Action, The spirit magically teleports up to 30 feet to an unoccupied space it can see. Then one of the following effects occur, based on the spirit's chosen mood:",
			"Fuming. The spirit has Advantage on the next attack roll it makes before the end of this turn",
			"Mirthful. Wisdom Saving Throw: DC equals your spell save DC, one creature the spirit can see within 10 feet of itself. Failure: The target is Charmed by you and the spirit for 1 minute or until the target takes any damage.",
			"Tricksy. The spirit fills a 10-foot Cube within 5 feet of it with magical Darkness, which last suntilt eh end of its next turn.",
		]),
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Fey Blade",
		ability : 2,
		damage : [2, 6, "Force"],
		range : "Melee (5 ft.)",
		modifiers : ["", 8],
		useSpellMod : ["druid", "ranger", "warlock", "wizard"]
	}],
};
CreatureList["fey spirit (9)"] = {
	name : "Fey Spirit (lvl 9)",
	regExpSearch : /^(?=.*fey)(?=.*spirit)(?=.*9).*$/i,
	source : [["PHB2024", 326]],
	size : 4,
	type : "Fey",
	alignment : "Neutral",
	companion : "fey spirit",
	companionApply : "fey spirit",
	ac : 21,
	hp : 90,
	hd : [22, 6],
	speed : "30 ft., Fly 30 ft.",
	scores : [13, 16, 14, 14, 11, 16],
	condition_immunities : "Charmed",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Sylvan, Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	actions : [{
		name : "Fey Step",
		description : desc([
			"As a Bonus Action, The spirit magically teleports up to 30 feet to an unoccupied space it can see. Then one of the following effects occur, based on the spirit's chosen mood:",
			"Fuming. The spirit has Advantage on the next attack roll it makes before the end of this turn",
			"Mirthful. Wisdom Saving Throw: DC equals your spell save DC, one creature the spirit can see within 10 feet of itself. Failure: The target is Charmed by you and the spirit for 1 minute or until the target takes any damage.",
			"Tricksy. The spirit fills a 10-foot Cube within 5 feet of it with magical Darkness, which last suntilt eh end of its next turn.",
		]),
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Fey Blade",
		ability : 2,
		damage : [2, 6, "Force"],
		range : "Melee (5 ft.)",
		modifiers : ["", 9],
		useSpellMod : ["druid", "ranger", "warlock", "wizard"]
	}],
};
//Fiendish Spirit Stat Blocks
CompanionList["fiendish spirit"] = {
	name : "Fiendish Spirit",
	nameMenu : "Fiendish Spirit (Summon Fiend Spell)",
	nameOrigin : "Summon Spirit of the Summon Fiend 6th-level conjuration spell",
	source : [["PHB2024", 326]],
	attributesChange : function(sCrea, objCrea) {
        var casters = isSpellUsed('summon fiend');
        var oScore = undefined;
        
        for (var caster of casters) {
            if (CurrentSpells[caster].refType !== "class") continue;
            
            var ability = CurrentSpells[caster].ability;
    
            var abilityMod = What(AbilityScores.abbreviations[ability - 1] + " Mod");
            
            if (oScore === undefined || abilityMod > What(AbilityScores.abbreviations[oScore[1] - 1] + " Mod")) {
                oScore = [caster, ability];
            }
        }

        if (oScore === undefined) return;
    
        for (var i = 0; i < objCrea.attacks.length; i++) {
            var oAtk = objCrea.attacks[i];
            oAtk.useSpellMod = oScore[0];
        }
        
    },
};
CreatureList["fiendish spirit (demon)(6)"] = {
	name : "Fiendish Spirit (Demon)(lvl 6)",
	regExpSearch : /^(?=.*fiendish)(?=.*spirit)(?=.*demon)(?=.*6).*$/i,
	source : [["PHB2024", 327]],
	size : 2,
	type : "Fiend",
	alignment : "Neutral",
	companion : "fiendish spirit",
	companionApply : "fiendish spirit",
	ac : 18,
	hp : 50,
	hd : [8, 10],
	speed : "40 ft., Climb 40 ft.",
	scores : [13, 16, 15, 10, 10, 16],
	damage_resistances : "Fire",
	damage_immunities : "Poison",
	condition_immunities : "Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Abyssal, Infernal, Telepathy 60 ft.",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Death Throes",
		description : "When the spirit drops to 0 Hit Points or the spell ends, the spirit explodes. Dexterity Saving Throw: DC equals your spell save DC, each creature in a 10-foot Emanation originating from the spirit. Failure: 2d10+6 Fire damage. Success: Half damage.",
		joinString : "\n   ",
	}, {
		name : "Magic Resistance",
		description : "The spirit has Advantage on saving throws against spells and other magical effects.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Bite",
		ability : 2,
		damage : [1, 12, "Necrotic"],
		range : "Melee (5 ft.)",
		modifiers : ["", 6],
		useSpellMod : ["warlock", "wizard"]
	}],
};
CreatureList["fiendish spirit (demon)(7)"] = {
	name : "Fiendish Spirit (Demon)(lvl 7)",
	regExpSearch : /^(?=.*fiendish)(?=.*spirit)(?=.*demon)(?=.*7).*$/i,
	source : [["PHB2024", 327]],
	size : 2,
	type : "Fiend",
	alignment : "Neutral",
	companion : "fiendish spirit",
	companionApply : "fiendish spirit",
	ac : 19,
	hp : 65,
	hd : [11, 10],
	speed : "40 ft., Climb 40 ft.",
	scores : [13, 16, 15, 10, 10, 16],
	damage_resistances : "Fire",
	damage_immunities : "Poison",
	condition_immunities : "Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Abyssal, Infernal, Telepathy 60 ft.",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Death Throes",
		description : "When the spirit drops to 0 Hit Points or the spell ends, the spirit explodes. Dexterity Saving Throw: DC equals your spell save DC, each creature in a 10-foot Emanation originating from the spirit. Failure: 2d10+7 Fire damage. Success: Half damage.",
		joinString : "\n   ",
	}, {
		name : "Magic Resistance",
		description : "The spirit has Advantage on saving throws against spells and other magical effects.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Bite",
		ability : 2,
		damage : [1, 12, "Necrotic"],
		range : "Melee (5 ft.)",
		modifiers : ["", 7],
		useSpellMod : ["warlock", "wizard"]
	}],
};
CreatureList["fiendish spirit (demon)(8)"] = {
	name : "Fiendish Spirit (Demon)(lvl 8)",
	regExpSearch : /^(?=.*fiendish)(?=.*spirit)(?=.*demon)(?=.*8).*$/i,
	source : [["PHB2024", 327]],
	size : 2,
	type : "Fiend",
	alignment : "Neutral",
	companion : "fiendish spirit",
	companionApply : "fiendish spirit",
	ac : 19,
	hp : 80,
	hd : [13, 10],
	speed : "40 ft., Climb 40 ft.",
	scores : [13, 16, 15, 10, 10, 16],
	damage_resistances : "Fire",
	damage_immunities : "Poison",
	condition_immunities : "Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Abyssal, Infernal, Telepathy 60 ft.",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	features : [{
		name : "Death Throes",
		description : "When the spirit drops to 0 Hit Points or the spell ends, the spirit explodes. Dexterity Saving Throw: DC equals your spell save DC, each creature in a 10-foot Emanation originating from the spirit. Failure: 2d10+8 Fire damage. Success: Half damage.",
		joinString : "\n   ",
	}, {
		name : "Magic Resistance",
		description : "The spirit has Advantage on saving throws against spells and other magical effects.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Bite",
		ability : 2,
		damage : [1, 12, "Necrotic"],
		range : "Melee (5 ft.)",
		modifiers : ["", 8],
		useSpellMod : ["warlock", "wizard"]
	}],
};
CreatureList["fiendish spirit (demon)(9)"] = {
	name : "Fiendish Spirit (Demon)(lvl 9)",
	regExpSearch : /^(?=.*fiendish)(?=.*spirit)(?=.*demon)(?=.*9).*$/i,
	source : [["PHB2024", 327]],
	size : 2,
	type : "Fiend",
	alignment : "Neutral",
	companion : "fiendish spirit",
	companionApply : "fiendish spirit",
	ac : 21,
	hp : 95,
	hd : [16, 10],
	speed : "40 ft., Climb 40 ft.",
	scores : [13, 16, 15, 10, 10, 16],
	damage_resistances : "Fire",
	damage_immunities : "Poison",
	condition_immunities : "Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Abyssal, Infernal, Telepathy 60 ft.",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	features : [{
		name : "Death Throes",
		description : "When the spirit drops to 0 Hit Points or the spell ends, the spirit explodes. Dexterity Saving Throw: DC equals your spell save DC, each creature in a 10-foot Emanation originating from the spirit. Failure: 2d10+9 Fire damage. Success: Half damage.",
		joinString : "\n   ",
	}, {
		name : "Magic Resistance",
		description : "The spirit has Advantage on saving throws against spells and other magical effects.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Bite",
		ability : 2,
		damage : [1, 12, "Necrotic"],
		range : "Melee (5 ft.)",
		modifiers : ["", 9],
		useSpellMod : ["warlock", "wizard"]
	}],
};
CreatureList["fiendish spirit (devil)(6)"] = {
	name : "Fiendish Spirit (Devil)(lvl 6)",
	regExpSearch : /^(?=.*fiendish)(?=.*spirit)(?=.*devil)(?=.*6).*$/i,
	source : [["PHB2024", 327]],
	size : 2,
	type : "Fiend",
	alignment : "Neutral",
	companion : "fiendish spirit",
	companionApply : "fiendish spirit",
	ac : 18,
	hp : 40,
	hd : [7, 10],
	speed : "40 ft., Fly 60 ft.",
	scores : [13, 16, 15, 10, 10, 16],
	damage_resistances : "Fire",
	damage_immunities : "Poison",
	condition_immunities : "Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Abyssal, Infernal, Telepathy 60 ft.",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Devil's Sight",
		description : "Magical Darkness doesn't impede the spirit's Darkvision.",
		joinString : "\n   ",
	}, {
		name : "Magic Resistance",
		description : "The spirit has Advantage on saving throws against spells and other magical effects.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Fiery Strike",
		ability : 2,
		damage : [2, 6, "Fire"],
		range : "Melee/Ranged (5 ft./150 ft.)",
		modifiers : ["", 6],
		useSpellMod : ["warlock", "wizard"]
	}],
};
CreatureList["fiendish spirit (devil)(7)"] = {
	name : "Fiendish Spirit (Devil)(lvl 7)",
	regExpSearch : /^(?=.*fiendish)(?=.*spirit)(?=.*devil)(?=.*7).*$/i,
	source : [["PHB2024", 327]],
	size : 2,
	type : "Fiend",
	alignment : "Neutral",
	companion : "fiendish spirit",
	companionApply : "fiendish spirit",
	ac : 19,
	hp : 55,
	hd : [9, 10],
	speed : "40 ft., Fly 60 ft.",
	scores : [13, 16, 15, 10, 10, 16],
	damage_resistances : "Fire",
	damage_immunities : "Poison",
	condition_immunities : "Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Abyssal, Infernal, Telepathy 60 ft.",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Devil's Sight",
		description : "Magical Darkness doesn't impede the spirit's Darkvision.",
		joinString : "\n   ",
	}, {
		name : "Magic Resistance",
		description : "The spirit has Advantage on saving throws against spells and other magical effects.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Fiery Strike",
		ability : 2,
		damage : [2, 6, "Fire"],
		range : "Melee/Ranged (5 ft./150 ft.)",
		modifiers : ["", 7],
		useSpellMod : ["warlock", "wizard"]
	}],
};
CreatureList["fiendish spirit (devil)(8)"] = {
	name : "Fiendish Spirit (Devil)(lvl 8)",
	regExpSearch : /^(?=.*fiendish)(?=.*spirit)(?=.*devil)(?=.*8).*$/i,
	source : [["PHB2024", 327]],
	size : 2,
	type : "Fiend",
	alignment : "Neutral",
	companion : "fiendish spirit",
	companionApply : "fiendish spirit",
	ac : 19,
	hp : 70,
	hd : [12, 10],
	speed : "40 ft., Fly 60 ft.",
	scores : [13, 16, 15, 10, 10, 16],
	damage_resistances : "Fire",
	damage_immunities : "Poison",
	condition_immunities : "Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Abyssal, Infernal, Telepathy 60 ft.",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	features : [{
		name : "Devil's Sight",
		description : "Magical Darkness doesn't impede the spirit's Darkvision.",
		joinString : "\n   ",
	}, {
		name : "Magic Resistance",
		description : "The spirit has Advantage on saving throws against spells and other magical effects.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Fiery Strike",
		ability : 2,
		damage : [2, 6, "Fire"],
		range : "Melee/Ranged (5 ft./150 ft.)",
		modifiers : ["", 8],
		useSpellMod : ["warlock", "wizard"]
	}],
};
CreatureList["fiendish spirit (devil)(9)"] = {
	name : "Fiendish Spirit (Devil)(lvl 9)",
	regExpSearch : /^(?=.*fiendish)(?=.*spirit)(?=.*devil)(?=.*9).*$/i,
	source : [["PHB2024", 327]],
	size : 2,
	type : "Fiend",
	alignment : "Neutral",
	companion : "fiendish spirit",
	companionApply : "fiendish spirit",
	ac : 21,
	hp : 85,
	hd : [14, 10],
	speed : "40 ft., Fly 60 ft.",
	scores : [13, 16, 15, 10, 10, 16],
	damage_resistances : "Fire",
	damage_immunities : "Poison",
	condition_immunities : "Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Abyssal, Infernal, Telepathy 60 ft.",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	features : [{
		name : "Devil's Sight",
		description : "Magical Darkness doesn't impede the spirit's Darkvision.",
		joinString : "\n   ",
	}, {
		name : "Magic Resistance",
		description : "The spirit has Advantage on saving throws against spells and other magical effects.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Fiery Strike",
		ability : 2,
		damage : [2, 6, "Fire"],
		range : "Melee/Ranged (5 ft./150 ft.)",
		modifiers : ["", 9],
		useSpellMod : ["warlock", "wizard"]
	}],
};
CreatureList["fiendish spirit (yugoloth)(6)"] = {
	name : "Fiendish Spirit (Yugoloth)(lvl 6)",
	regExpSearch : /^(?=.*fiendish)(?=.*spirit)(?=.*yugoloth)(?=.*6).*$/i,
	source : [["PHB2024", 327]],
	size : 2,
	type : "Fiend",
	alignment : "Neutral",
	companion : "fiendish spirit",
	companionApply : "fiendish spirit",
	ac : 18,
	hp : 60,
	hd : [10, 10],
	speed : "40 ft.",
	scores : [13, 16, 15, 10, 10, 16],
	damage_resistances : "Fire",
	damage_immunities : "Poison",
	condition_immunities : "Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Abyssal, Infernal, Telepathy 60 ft.",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Magic Resistance",
		description : "The spirit has Advantage on saving throws against spells and other magical effects.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Claws",
		ability : 2,
		damage : [1, 8, "Slashing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 6],
		description : "Immediately after the attack hits or misses, teh spirit can teleport up to 30 feet to an unoccupied space it can see.",
		useSpellMod : ["warlock", "wizard"]
	}],
};
CreatureList["fiendish spirit (yugoloth)(7)"] = {
	name : "Fiendish Spirit (Yugoloth)(lvl 7)",
	regExpSearch : /^(?=.*fiendish)(?=.*spirit)(?=.*yugoloth)(?=.*7).*$/i,
	source : [["PHB2024", 327]],
	size : 2,
	type : "Fiend",
	alignment : "Neutral",
	companion : "fiendish spirit",
	companionApply : "fiendish spirit",
	ac : 19,
	hp : 75,
	hd : [12, 10],
	speed : "40 ft.",
	scores : [13, 16, 15, 10, 10, 16],
	damage_resistances : "Fire",
	damage_immunities : "Poison",
	condition_immunities : "Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Abyssal, Infernal, Telepathy 60 ft.",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Magic Resistance",
		description : "The spirit has Advantage on saving throws against spells and other magical effects.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Claws",
		ability : 2,
		damage : [1, 8, "Slashing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 7],
		description : "Immediately after the attack hits or misses, teh spirit can teleport up to 30 feet to an unoccupied space it can see.",
		useSpellMod : ["warlock", "wizard"]
	}],
};
CreatureList["fiendish spirit (yugoloth)(8)"] = {
	name : "Fiendish Spirit (Yugoloth)(lvl 8)",
	regExpSearch : /^(?=.*fiendish)(?=.*spirit)(?=.*yugoloth)(?=.*8).*$/i,
	source : [["PHB2024", 327]],
	size : 2,
	type : "Fiend",
	alignment : "Neutral",
	companion : "fiendish spirit",
	companionApply : "fiendish spirit",
	ac : 19,
	hp : 90,
	hd : [15, 10],
	speed : "40 ft.",
	scores : [13, 16, 15, 10, 10, 16],
	damage_resistances : "Fire",
	damage_immunities : "Poison",
	condition_immunities : "Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Abyssal, Infernal, Telepathy 60 ft.",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	features : [{
		name : "Magic Resistance",
		description : "The spirit has Advantage on saving throws against spells and other magical effects.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Claws",
		ability : 2,
		damage : [1, 8, "Slashing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 8],
		description : "Immediately after the attack hits or misses, teh spirit can teleport up to 30 feet to an unoccupied space it can see.",
		useSpellMod : ["warlock", "wizard"]
	}],
};
CreatureList["fiendish spirit (yugoloth)(9)"] = {
	name : "Fiendish Spirit (Yugoloth)(lvl 9)",
	regExpSearch : /^(?=.*fiendish)(?=.*spirit)(?=.*yugoloth)(?=.*9).*$/i,
	source : [["PHB2024", 327]],
	size : 2,
	type : "Fiend",
	alignment : "Neutral",
	companion : "fiendish spirit",
	companionApply : "fiendish spirit",
	ac : 21,
	hp : 105,
	hd : [17, 10],
	speed : "40 ft.",
	scores : [13, 16, 15, 10, 10, 16],
	damage_resistances : "Fire",
	damage_immunities : "Poison",
	condition_immunities : "Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Abyssal, Infernal, Telepathy 60 ft.",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	features : [{
		name : "Magic Resistance",
		description : "The spirit has Advantage on saving throws against spells and other magical effects.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Claws",
		ability : 2,
		damage : [1, 8, "Slashing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 9],
		description : "Immediately after the attack hits or misses, teh spirit can teleport up to 30 feet to an unoccupied space it can see.",
		useSpellMod : ["warlock", "wizard"]
	}],
};
//Undead Spirit Stat Blocks
CompanionList["undead spirit"] = {
	name : "Undead Spirit",
	nameMenu : "Undead Spirit (Summon Undead Spell)",
	nameOrigin : "Summon Spirit of the Summon Undead 3rd-level conjuration spell",
	source : [["PHB2024", 328]],
	attributesChange : function(sCrea, objCrea) {
        var casters = isSpellUsed('summon undead');
        var oScore = undefined;
        
        for (var caster of casters) {
            if (CurrentSpells[caster].refType !== "class") continue;
            
            var ability = CurrentSpells[caster].ability;
    
            var abilityMod = What(AbilityScores.abbreviations[ability - 1] + " Mod");
            
            if (oScore === undefined || abilityMod > What(AbilityScores.abbreviations[oScore[1] - 1] + " Mod")) {
                oScore = [caster, ability];
            }
        }

        if (oScore === undefined) return;
    
        for (var i = 0; i < objCrea.attacks.length; i++) {
            var oAtk = objCrea.attacks[i];
            oAtk.useSpellMod = oScore[0];
        }
        
    },
};
CreatureList["undead spirit (skeletal)(3)"] = {
	name : "Undead Spirit (Skeletal)(lvl 3)",
	regExpSearch : /^(?=.*undead)(?=.*spirit)(?=.*skeletal)(?=.*3).*$/i,
	source : [["PHB2024", 328]],
	size : 3,
	type : "Undead",
	alignment : "Neutral",
	companion : "undead spirit",
	companionApply : "undead spirit",
	ac : 14,
	hp : 20,
	hd : [4, 8],
	speed : "30 ft., Fly 40 ft.",
	scores : [12, 16, 15, 4, 10, 9],
	damage_immunities : "Necrotic, Poison",
	condition_immunities : "Exhaustion, Frightened, Paralyzed, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 1,
	attacks : [{
		name : "Grave Bolt",
		ability : 2,
		damage : [2, 4, "Necrotic"],
		range : "Ranged (150 ft.)",
		modifiers : ["", 3],
	}],
};
CreatureList["undead spirit (skeletal)(4)"] = {
	name : "Undead Spirit (Skeletal)(lvl 4)",
	regExpSearch : /^(?=.*undead)(?=.*spirit)(?=.*skeletal)(?=.*4).*$/i,
	source : [["PHB2024", 328]],
	size : 3,
	type : "Undead",
	alignment : "Neutral",
	companion : "undead spirit",
	companionApply : "undead spirit",
	ac : 15,
	hp : 30,
	hd : [6, 8],
	speed : "30 ft., Fly 40 ft.",
	scores : [12, 16, 15, 4, 10, 9],
	damage_immunities : "Necrotic, Poison",
	condition_immunities : "Exhaustion, Frightened, Paralyzed, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 2,
	attacks : [{
		name : "Grave Bolt",
		ability : 2,
		damage : [2, 4, "Necrotic"],
		range : "Ranged (150 ft.)",
		modifiers : ["", 4],
	}],
};
CreatureList["undead spirit (skeletal)(5)"] = {
	name : "Undead Spirit (Skeletal)(lvl 5)",
	regExpSearch : /^(?=.*undead)(?=.*spirit)(?=.*skeletal)(?=.*5).*$/i,
	source : [["PHB2024", 328]],
	size : 3,
	type : "Undead",
	alignment : "Neutral",
	companion : "undead spirit",
	companionApply : "undead spirit",
	ac : 16,
	hp : 40,
	hd : [8, 8],
	speed : "30 ft., Fly 40 ft.",
	scores : [12, 16, 15, 4, 10, 9],
	damage_immunities : "Necrotic, Poison",
	condition_immunities : "Exhaustion, Frightened, Paralyzed, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 2,
	attacks : [{
		name : "Grave Bolt",
		ability : 2,
		damage : [2, 4, "Necrotic"],
		range : "Ranged (150 ft.)",
		modifiers : ["", 5],
	}],
};
CreatureList["undead spirit (skeletal)(6)"] = {
	name : "Undead Spirit (Skeletal)(lvl 6)",
	regExpSearch : /^(?=.*undead)(?=.*spirit)(?=.*skeletal)(?=.*6).*$/i,
	source : [["PHB2024", 328]],
	size : 3,
	type : "Undead",
	alignment : "Neutral",
	companion : "undead spirit",
	companionApply : "undead spirit",
	ac : 17,
	hp : 50,
	hd : [10, 8],
	speed : "30 ft., Fly 40 ft.",
	scores : [12, 16, 15, 4, 10, 9],
	damage_immunities : "Necrotic, Poison",
	condition_immunities : "Exhaustion, Frightened, Paralyzed, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	attacks : [{
		name : "Grave Bolt",
		ability : 2,
		damage : [2, 4, "Necrotic"],
		range : "Ranged (150 ft.)",
		modifiers : ["", 6],
	}],
};
CreatureList["undead spirit (skeletal)(7)"] = {
	name : "Undead Spirit (Skeletal)(lvl 7)",
	regExpSearch : /^(?=.*undead)(?=.*spirit)(?=.*skeletal)(?=.*7).*$/i,
	source : [["PHB2024", 328]],
	size : 3,
	type : "Undead",
	alignment : "Neutral",
	companion : "undead spirit",
	companionApply : "undead spirit",
	ac : 18,
	hp : 60,
	hd : [12, 8],
	speed : "30 ft., Fly 40 ft.",
	scores : [12, 16, 15, 4, 10, 9],
	damage_immunities : "Necrotic, Poison",
	condition_immunities : "Exhaustion, Frightened, Paralyzed, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	attacks : [{
		name : "Grave Bolt",
		ability : 2,
		damage : [2, 4, "Necrotic"],
		range : "Ranged (150 ft.)",
		modifiers : ["", 7],
	}],
};
CreatureList["undead spirit (skeletal)(8)"] = {
	name : "Undead Spirit (Skeletal)(lvl 8)",
	regExpSearch : /^(?=.*undead)(?=.*spirit)(?=.*skeletal)(?=.*8).*$/i,
	source : [["PHB2024", 328]],
	size : 3,
	type : "Undead",
	alignment : "Neutral",
	companion : "undead spirit",
	companionApply : "undead spirit",
	ac : 19,
	hp : 70,
	hd : [14, 8],
	speed : "30 ft., Fly 40 ft.",
	scores : [12, 16, 15, 4, 10, 9],
	damage_immunities : "Necrotic, Poison",
	condition_immunities : "Exhaustion, Frightened, Paralyzed, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	attacks : [{
		name : "Grave Bolt",
		ability : 2,
		damage : [2, 4, "Necrotic"],
		range : "Ranged (150 ft.)",
		modifiers : ["", 8],
	}],
};
CreatureList["undead spirit (skeletal)(9)"] = {
	name : "Undead Spirit (Skeletal)(lvl 9)",
	regExpSearch : /^(?=.*undead)(?=.*spirit)(?=.*skeletal)(?=.*9).*$/i,
	source : [["PHB2024", 328]],
	size : 3,
	type : "Undead",
	alignment : "Neutral",
	companion : "undead spirit",
	companionApply : "undead spirit",
	ac : 20,
	hp : 80,
	hd : [16, 8],
	speed : "30 ft., Fly 40 ft.",
	scores : [12, 16, 15, 4, 10, 9],
	damage_immunities : "Necrotic, Poison",
	condition_immunities : "Exhaustion, Frightened, Paralyzed, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	attacks : [{
		name : "Grave Bolt",
		ability : 2,
		damage : [2, 4, "Necrotic"],
		range : "Ranged (150 ft.)",
		modifiers : ["", 9],
	}],
};
CreatureList["undead spirit (putrid/ghostly)(3)"] = {
	name : "Undead Spirit (Putrid/Ghostly)(lvl 3)",
	regExpSearch : /^(?=.*undead)(?=.*putridghostly)(?=.*skeletal)(?=.*3).*$/i,
	source : [["PHB2024", 328]],
	size : 3,
	type : "Undead",
	alignment : "Neutral",
	companion : "undead spirit",
	companionApply : "undead spirit",
	ac : 14,
	hp : 30,
	hd : [6, 8],
	speed : "30 ft., Fly 40 ft.(Hover, Ghostly)",
	scores : [12, 16, 15, 4, 10, 9],
	damage_immunities : "Necrotic, Poison",
	condition_immunities : "Exhaustion, Frightened, Paralyzed, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 1,
	features : [{
		name : "Festering Aura (Putrid Only)",
		description : "Constitution Saving Throw: DC equals your spell save DC, any creature (other than you) that starts its turn within a 5-foot Emanation originating from the spirit. Failure: The creature has the Poisoned condition until the start of its next turn.",
		joinString : "\n   ",
	}, {
		name : "Incorporeal Passage (Ghostly Only)",
		description : "The spirit can move through other creatures and objects as if they were Difficult Terrain. If it ends its turninside an object, it is shunted to teh nearest unoccupied space and takes 1d10 Force damage for every 5 feet traveled.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Deathly Touch (Ghostly Only)",
		ability : 2,
		damage : [1, 8, "Necrotic"],
		range : "Melee (5 ft.)",
		modifiers : ["", 3],
		description : "On a hit, the target has the Frightened condition until the end of its next turn.",
	}, {
		name : "Rotting Claw (Putrid Only)",
		ability : 2,
		damage : [1, 6, "Slashing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 3],
		description : "On a hit, if the target has the Poisoned condition, it has the Paralyzed condition until the end of its next turn.",
	}],
};
CreatureList["undead spirit (putrid/ghostly)(4)"] = {
	name : "Undead Spirit (Putrid/Ghostly)(lvl 4)",
	regExpSearch : /^(?=.*undead)(?=.*putridghostly)(?=.*skeletal)(?=.*4).*$/i,
	source : [["PHB2024", 328]],
	size : 3,
	type : "Undead",
	alignment : "Neutral",
	companion : "undead spirit",
	companionApply : "undead spirit",
	ac : 15,
	hp : 40,
	hd : [8, 8],
	speed : "30 ft., Fly 40 ft.(Hover, Ghostly)",
	scores : [12, 16, 15, 4, 10, 9],
	damage_immunities : "Necrotic, Poison",
	condition_immunities : "Exhaustion, Frightened, Paralyzed, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 2,
	features : [{
		name : "Festering Aura (Putrid Only)",
		description : "Constitution Saving Throw: DC equals your spell save DC, any creature (other than you) that starts its turn within a 5-foot Emanation originating from the spirit. Failure: The creature has the Poisoned condition until the start of its next turn.",
		joinString : "\n   ",
	}, {
		name : "Incorporeal Passage (Ghostly Only)",
		description : "The spirit can move through other creatures and objects as if they were Difficult Terrain. If it ends its turninside an object, it is shunted to teh nearest unoccupied space and takes 1d10 Force damage for every 5 feet traveled.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Deathly Touch (Ghostly Only)",
		ability : 2,
		damage : [1, 8, "Necrotic"],
		range : "Melee (5 ft.)",
		modifiers : ["", 4],
		description : "On a hit, the target has the Frightened condition until the end of its next turn.",
	}, {
		name : "Rotting Claw (Putrid Only)",
		ability : 2,
		damage : [1, 6, "Slashing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 4],
		description : "On a hit, if the target has the Poisoned condition, it has the Paralyzed condition until the end of its next turn.",
	}],
};
CreatureList["undead spirit (putrid/ghostly)(5)"] = {
	name : "Undead Spirit (Putrid/Ghostly)(lvl 5)",
	regExpSearch : /^(?=.*undead)(?=.*putridghostly)(?=.*skeletal)(?=.*5).*$/i,
	source : [["PHB2024", 328]],
	size : 3,
	type : "Undead",
	alignment : "Neutral",
	companion : "undead spirit",
	companionApply : "undead spirit",
	ac : 16,
	hp : 50,
	hd : [10, 8],
	speed : "30 ft., Fly 40 ft.(Hover, Ghostly)",
	scores : [12, 16, 15, 4, 10, 9],
	damage_immunities : "Necrotic, Poison",
	condition_immunities : "Exhaustion, Frightened, Paralyzed, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 2,
	features : [{
		name : "Festering Aura (Putrid Only)",
		description : "Constitution Saving Throw: DC equals your spell save DC, any creature (other than you) that starts its turn within a 5-foot Emanation originating from the spirit. Failure: The creature has the Poisoned condition until the start of its next turn.",
		joinString : "\n   ",
	}, {
		name : "Incorporeal Passage (Ghostly Only)",
		description : "The spirit can move through other creatures and objects as if they were Difficult Terrain. If it ends its turninside an object, it is shunted to teh nearest unoccupied space and takes 1d10 Force damage for every 5 feet traveled.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Deathly Touch (Ghostly Only)",
		ability : 2,
		damage : [1, 8, "Necrotic"],
		range : "Melee (5 ft.)",
		modifiers : ["", 5],
		description : "On a hit, the target has the Frightened condition until the end of its next turn.",
	}, {
		name : "Rotting Claw (Putrid Only)",
		ability : 2,
		damage : [1, 6, "Slashing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 5],
		description : "On a hit, if the target has the Poisoned condition, it has the Paralyzed condition until the end of its next turn.",
	}],
};
CreatureList["undead spirit (putrid/ghostly)(6)"] = {
	name : "Undead Spirit (Putrid/Ghostly)(lvl 6)",
	regExpSearch : /^(?=.*undead)(?=.*putridghostly)(?=.*skeletal)(?=.*6).*$/i,
	source : [["PHB2024", 328]],
	size : 3,
	type : "Undead",
	alignment : "Neutral",
	companion : "undead spirit",
	companionApply : "undead spirit",
	ac : 17,
	hp : 60,
	hd : [12, 8],
	speed : "30 ft., Fly 40 ft.(Hover, Ghostly)",
	scores : [12, 16, 15, 4, 10, 9],
	damage_immunities : "Necrotic, Poison",
	condition_immunities : "Exhaustion, Frightened, Paralyzed, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Festering Aura (Putrid Only)",
		description : "Constitution Saving Throw: DC equals your spell save DC, any creature (other than you) that starts its turn within a 5-foot Emanation originating from the spirit. Failure: The creature has the Poisoned condition until the start of its next turn.",
		joinString : "\n   ",
	}, {
		name : "Incorporeal Passage (Ghostly Only)",
		description : "The spirit can move through other creatures and objects as if they were Difficult Terrain. If it ends its turninside an object, it is shunted to teh nearest unoccupied space and takes 1d10 Force damage for every 5 feet traveled.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Deathly Touch (Ghostly Only)",
		ability : 2,
		damage : [1, 8, "Necrotic"],
		range : "Melee (5 ft.)",
		modifiers : ["", 6],
		description : "On a hit, the target has the Frightened condition until the end of its next turn.",
	}, {
		name : "Rotting Claw (Putrid Only)",
		ability : 2,
		damage : [1, 6, "Slashing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 6],
		description : "On a hit, if the target has the Poisoned condition, it has the Paralyzed condition until the end of its next turn.",
	}],
};
CreatureList["undead spirit (putrid/ghostly)(7)"] = {
	name : "Undead Spirit (Putrid/Ghostly)(lvl 7)",
	regExpSearch : /^(?=.*undead)(?=.*putridghostly)(?=.*skeletal)(?=.*7).*$/i,
	source : [["PHB2024", 328]],
	size : 3,
	type : "Undead",
	alignment : "Neutral",
	companion : "undead spirit",
	companionApply : "undead spirit",
	ac : 18,
	hp : 70,
	hd : [14, 8],
	speed : "30 ft., Fly 40 ft.(Hover, Ghostly)",
	scores : [12, 16, 15, 4, 10, 9],
	damage_immunities : "Necrotic, Poison",
	condition_immunities : "Exhaustion, Frightened, Paralyzed, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 3,
	features : [{
		name : "Festering Aura (Putrid Only)",
		description : "Constitution Saving Throw: DC equals your spell save DC, any creature (other than you) that starts its turn within a 5-foot Emanation originating from the spirit. Failure: The creature has the Poisoned condition until the start of its next turn.",
		joinString : "\n   ",
	}, {
		name : "Incorporeal Passage (Ghostly Only)",
		description : "The spirit can move through other creatures and objects as if they were Difficult Terrain. If it ends its turninside an object, it is shunted to teh nearest unoccupied space and takes 1d10 Force damage for every 5 feet traveled.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Deathly Touch (Ghostly Only)",
		ability : 2,
		damage : [1, 8, "Necrotic"],
		range : "Melee (5 ft.)",
		modifiers : ["", 7],
		description : "On a hit, the target has the Frightened condition until the end of its next turn.",
	}, {
		name : "Rotting Claw (Putrid Only)",
		ability : 2,
		damage : [1, 6, "Slashing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 7],
		description : "On a hit, if the target has the Poisoned condition, it has the Paralyzed condition until the end of its next turn.",
	}],
};
CreatureList["undead spirit (putrid/ghostly)(8)"] = {
	name : "Undead Spirit (Putrid/Ghostly)(lvl 8)",
	regExpSearch : /^(?=.*undead)(?=.*putridghostly)(?=.*skeletal)(?=.*8).*$/i,
	source : [["PHB2024", 328]],
	size : 3,
	type : "Undead",
	alignment : "Neutral",
	companion : "undead spirit",
	companionApply : "undead spirit",
	ac : 19,
	hp : 80,
	hd : [16, 8],
	speed : "30 ft., Fly 40 ft.(Hover, Ghostly)",
	scores : [12, 16, 15, 4, 10, 9],
	damage_immunities : "Necrotic, Poison",
	condition_immunities : "Exhaustion, Frightened, Paralyzed, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	features : [{
		name : "Festering Aura (Putrid Only)",
		description : "Constitution Saving Throw: DC equals your spell save DC, any creature (other than you) that starts its turn within a 5-foot Emanation originating from the spirit. Failure: The creature has the Poisoned condition until the start of its next turn.",
		joinString : "\n   ",
	}, {
		name : "Incorporeal Passage (Ghostly Only)",
		description : "The spirit can move through other creatures and objects as if they were Difficult Terrain. If it ends its turninside an object, it is shunted to teh nearest unoccupied space and takes 1d10 Force damage for every 5 feet traveled.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Deathly Touch (Ghostly Only)",
		ability : 2,
		damage : [1, 8, "Necrotic"],
		range : "Melee (5 ft.)",
		modifiers : ["", 8],
		description : "On a hit, the target has the Frightened condition until the end of its next turn.",
	}, {
		name : "Rotting Claw (Putrid Only)",
		ability : 2,
		damage : [1, 6, "Slashing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 8],
		description : "On a hit, if the target has the Poisoned condition, it has the Paralyzed condition until the end of its next turn.",
	}],
};
CreatureList["undead spirit (putrid/ghostly)(9)"] = {
	name : "Undead Spirit (Putrid/Ghostly)(lvl 9)",
	regExpSearch : /^(?=.*undead)(?=.*putridghostly)(?=.*skeletal)(?=.*9).*$/i,
	source : [["PHB2024", 328]],
	size : 3,
	type : "Undead",
	alignment : "Neutral",
	companion : "undead spirit",
	companionApply : "undead spirit",
	ac : 20,
	hp : 90,
	hd : [18, 8],
	speed : "30 ft., Fly 40 ft.(Hover, Ghostly)",
	scores : [12, 16, 15, 4, 10, 9],
	damage_immunities : "Necrotic, Poison",
	condition_immunities : "Exhaustion, Frightened, Paralyzed, Poisoned",
	senses : "Darkvision 60 ft.",
	passivePerception : 10,
	languages : "Understands the languages you know",
	challengeRating : "0",
	proficiencyBonus : 2,
	proficiencyBonusLinked : true,
	attacksAction : 4,
	features : [{
		name : "Festering Aura (Putrid Only)",
		description : "Constitution Saving Throw: DC equals your spell save DC, any creature (other than you) that starts its turn within a 5-foot Emanation originating from the spirit. Failure: The creature has the Poisoned condition until the start of its next turn.",
		joinString : "\n   ",
	}, {
		name : "Incorporeal Passage (Ghostly Only)",
		description : "The spirit can move through other creatures and objects as if they were Difficult Terrain. If it ends its turninside an object, it is shunted to teh nearest unoccupied space and takes 1d10 Force damage for every 5 feet traveled.",
		joinString : "\n   ",
	}],
	attacks : [{
		name : "Deathly Touch (Ghostly Only)",
		ability : 2,
		damage : [1, 8, "Necrotic"],
		range : "Melee (5 ft.)",
		modifiers : ["", 9],
		description : "On a hit, the target has the Frightened condition until the end of its next turn.",
	}, {
		name : "Rotting Claw (Putrid Only)",
		ability : 2,
		damage : [1, 6, "Slashing"],
		range : "Melee (5 ft.)",
		modifiers : ["", 9],
		description : "On a hit, if the target has the Poisoned condition, it has the Paralyzed condition until the end of its next turn.",
	}],
};
